%!PS-Adobe-2.0
%%Creator: dvips(k) 5.86 Copyright 1999 Radical Eye Software
%%Title: omniORB.dvi
%%Pages: 155
%%PageOrder: Ascend
%%BoundingBox: 0 0 596 842
%%DocumentFonts: Palatino-Roman Palatino-Italic Palatino-Bold Courier
%%+ Courier-Oblique Courier-Bold
%%DocumentPaperSizes: A4
%%EndComments
%DVIPSWebPage: (www.radicaleye.com)
%DVIPSCommandLine: dvips omniORB
%DVIPSParameters: dpi=600, compressed
%DVIPSSource:  TeX output 2000.09.19:1206
%%BeginProcSet: texc.pro
%!
/TeXDict 300 dict def TeXDict begin/N{def}def/B{bind def}N/S{exch}N/X{S
N}B/A{dup}B/TR{translate}N/isls false N/vsize 11 72 mul N/hsize 8.5 72
mul N/landplus90{false}def/@rigin{isls{[0 landplus90{1 -1}{-1 1}ifelse 0
0 0]concat}if 72 Resolution div 72 VResolution div neg scale isls{
landplus90{VResolution 72 div vsize mul 0 exch}{Resolution -72 div hsize
mul 0}ifelse TR}if Resolution VResolution vsize -72 div 1 add mul TR[
matrix currentmatrix{A A round sub abs 0.00001 lt{round}if}forall round
exch round exch]setmatrix}N/@landscape{/isls true N}B/@manualfeed{
statusdict/manualfeed true put}B/@copies{/#copies X}B/FMat[1 0 0 -1 0 0]
N/FBB[0 0 0 0]N/nn 0 N/IEn 0 N/ctr 0 N/df-tail{/nn 8 dict N nn begin
/FontType 3 N/FontMatrix fntrx N/FontBBox FBB N string/base X array
/BitMaps X/BuildChar{CharBuilder}N/Encoding IEn N end A{/foo setfont}2
array copy cvx N load 0 nn put/ctr 0 N[}B/sf 0 N/df{/sf 1 N/fntrx FMat N
df-tail}B/dfs{div/sf X/fntrx[sf 0 0 sf neg 0 0]N df-tail}B/E{pop nn A
definefont setfont}B/Cw{Cd A length 5 sub get}B/Ch{Cd A length 4 sub get
}B/Cx{128 Cd A length 3 sub get sub}B/Cy{Cd A length 2 sub get 127 sub}
B/Cdx{Cd A length 1 sub get}B/Ci{Cd A type/stringtype ne{ctr get/ctr ctr
1 add N}if}B/id 0 N/rw 0 N/rc 0 N/gp 0 N/cp 0 N/G 0 N/CharBuilder{save 3
1 roll S A/base get 2 index get S/BitMaps get S get/Cd X pop/ctr 0 N Cdx
0 Cx Cy Ch sub Cx Cw add Cy setcachedevice Cw Ch true[1 0 0 -1 -.1 Cx
sub Cy .1 sub]/id Ci N/rw Cw 7 add 8 idiv string N/rc 0 N/gp 0 N/cp 0 N{
rc 0 ne{rc 1 sub/rc X rw}{G}ifelse}imagemask restore}B/G{{id gp get/gp
gp 1 add N A 18 mod S 18 idiv pl S get exec}loop}B/adv{cp add/cp X}B
/chg{rw cp id gp 4 index getinterval putinterval A gp add/gp X adv}B/nd{
/cp 0 N rw exit}B/lsh{rw cp 2 copy get A 0 eq{pop 1}{A 255 eq{pop 254}{
A A add 255 and S 1 and or}ifelse}ifelse put 1 adv}B/rsh{rw cp 2 copy
get A 0 eq{pop 128}{A 255 eq{pop 127}{A 2 idiv S 128 and or}ifelse}
ifelse put 1 adv}B/clr{rw cp 2 index string putinterval adv}B/set{rw cp
fillstr 0 4 index getinterval putinterval adv}B/fillstr 18 string 0 1 17
{2 copy 255 put pop}for N/pl[{adv 1 chg}{adv 1 chg nd}{1 add chg}{1 add
chg nd}{adv lsh}{adv lsh nd}{adv rsh}{adv rsh nd}{1 add adv}{/rc X nd}{
1 add set}{1 add clr}{adv 2 chg}{adv 2 chg nd}{pop nd}]A{bind pop}
forall N/D{/cc X A type/stringtype ne{]}if nn/base get cc ctr put nn
/BitMaps get S ctr S sf 1 ne{A A length 1 sub A 2 index S get sf div put
}if put/ctr ctr 1 add N}B/I{cc 1 add D}B/bop{userdict/bop-hook known{
bop-hook}if/SI save N @rigin 0 0 moveto/V matrix currentmatrix A 1 get A
mul exch 0 get A mul add .99 lt{/QV}{/RV}ifelse load def pop pop}N/eop{
SI restore userdict/eop-hook known{eop-hook}if showpage}N/@start{
userdict/start-hook known{start-hook}if pop/VResolution X/Resolution X
1000 div/DVImag X/IEn 256 array N 2 string 0 1 255{IEn S A 360 add 36 4
index cvrs cvn put}for pop 65781.76 div/vsize X 65781.76 div/hsize X}N
/p{show}N/RMat[1 0 0 -1 0 0]N/BDot 260 string N/Rx 0 N/Ry 0 N/V{}B/RV/v{
/Ry X/Rx X V}B statusdict begin/product where{pop false[(Display)(NeXT)
(LaserWriter 16/600)]{A length product length le{A length product exch 0
exch getinterval eq{pop true exit}if}{pop}ifelse}forall}{false}ifelse
end{{gsave TR -.1 .1 TR 1 1 scale Rx Ry false RMat{BDot}imagemask
grestore}}{{gsave TR -.1 .1 TR Rx Ry scale 1 1 false RMat{BDot}
imagemask grestore}}ifelse B/QV{gsave newpath transform round exch round
exch itransform moveto Rx 0 rlineto 0 Ry neg rlineto Rx neg 0 rlineto
fill grestore}B/a{moveto}B/delta 0 N/tail{A/delta X 0 rmoveto}B/M{S p
delta add tail}B/b{S p tail}B/c{-4 M}B/d{-3 M}B/e{-2 M}B/f{-1 M}B/g{0 M}
B/h{1 M}B/i{2 M}B/j{3 M}B/k{4 M}B/w{0 rmoveto}B/l{p -4 w}B/m{p -3 w}B/n{
p -2 w}B/o{p -1 w}B/q{p 1 w}B/r{p 2 w}B/s{p 3 w}B/t{p 4 w}B/x{0 S
rmoveto}B/y{3 2 roll p a}B/bos{/SS save N}B/eos{SS restore}B end

%%EndProcSet
%%BeginProcSet: 8r.enc
% @@psencodingfile@{
%   author = "S. Rahtz, P. MacKay, Alan Jeffrey, B. Horn, K. Berry",
%   version = "0.6",
%   date = "1 July 1998",
%   filename = "8r.enc",
%   email = "tex-fonts@@tug.org",
%   docstring = "Encoding for TrueType or Type 1 fonts
%                to be used with TeX."
% @}
% 
% Idea is to have all the characters normally included in Type 1 fonts
% available for typesetting. This is effectively the characters in Adobe
% Standard Encoding + ISO Latin 1 + extra characters from Lucida.
% 
% Character code assignments were made as follows:
% 
% (1) the Windows ANSI characters are almost all in their Windows ANSI
% positions, because some Windows users cannot easily reencode the
% fonts, and it makes no difference on other systems. The only Windows
% ANSI characters not available are those that make no sense for
% typesetting -- rubout (127 decimal), nobreakspace (160), softhyphen
% (173). quotesingle and grave are moved just because it's such an
% irritation not having them in TeX positions.
% 
% (2) Remaining characters are assigned arbitrarily to the lower part
% of the range, avoiding 0, 10 and 13 in case we meet dumb software.
% 
% (3) Y&Y Lucida Bright includes some extra text characters; in the
% hopes that other PostScript fonts, perhaps created for public
% consumption, will include them, they are included starting at 0x12.
% 
% (4) Remaining positions left undefined are for use in (hopefully)
% upward-compatible revisions, if someday more characters are generally
% available.
% 
% (5) hyphen appears twice for compatibility with both 
% ASCII and Windows.
% 
/TeXBase1Encoding [
% 0x00 (encoded characters from Adobe Standard not in Windows 3.1)
  /.notdef /dotaccent /fi /fl
  /fraction /hungarumlaut /Lslash /lslash
  /ogonek /ring /.notdef
  /breve /minus /.notdef 
% These are the only two remaining unencoded characters, so may as
% well include them.
  /Zcaron /zcaron 
% 0x10
 /caron /dotlessi 
% (unusual TeX characters available in, e.g., Lucida Bright)
 /dotlessj /ff /ffi /ffl 
 /.notdef /.notdef /.notdef /.notdef
 /.notdef /.notdef /.notdef /.notdef
 % very contentious; it's so painful not having quoteleft and quoteright
 % at 96 and 145 that we move the things normally found there to here.
 /grave /quotesingle 
% 0x20 (ASCII begins)
 /space /exclam /quotedbl /numbersign
 /dollar /percent /ampersand /quoteright
 /parenleft /parenright /asterisk /plus /comma /hyphen /period /slash
% 0x30
 /zero /one /two /three /four /five /six /seven
 /eight /nine /colon /semicolon /less /equal /greater /question
% 0x40
 /at /A /B /C /D /E /F /G /H /I /J /K /L /M /N /O
% 0x50
 /P /Q /R /S /T /U /V /W
 /X /Y /Z /bracketleft /backslash /bracketright /asciicircum /underscore
% 0x60
 /quoteleft /a /b /c /d /e /f /g /h /i /j /k /l /m /n /o
% 0x70
 /p /q /r /s /t /u /v /w
 /x /y /z /braceleft /bar /braceright /asciitilde
 /.notdef % rubout; ASCII ends
% 0x80
 /.notdef /.notdef /quotesinglbase /florin
 /quotedblbase /ellipsis /dagger /daggerdbl
 /circumflex /perthousand /Scaron /guilsinglleft
 /OE /.notdef /.notdef /.notdef
% 0x90
 /.notdef /.notdef /.notdef /quotedblleft
 /quotedblright /bullet /endash /emdash
 /tilde /trademark /scaron /guilsinglright
 /oe /.notdef /.notdef /Ydieresis
% 0xA0
 /.notdef % nobreakspace
 /exclamdown /cent /sterling
 /currency /yen /brokenbar /section
 /dieresis /copyright /ordfeminine /guillemotleft
 /logicalnot
 /hyphen % Y&Y (also at 45); Windows' softhyphen
 /registered
 /macron
% 0xD0
 /degree /plusminus /twosuperior /threesuperior
 /acute /mu /paragraph /periodcentered
 /cedilla /onesuperior /ordmasculine /guillemotright
 /onequarter /onehalf /threequarters /questiondown
% 0xC0
 /Agrave /Aacute /Acircumflex /Atilde /Adieresis /Aring /AE /Ccedilla
 /Egrave /Eacute /Ecircumflex /Edieresis
 /Igrave /Iacute /Icircumflex /Idieresis
% 0xD0
 /Eth /Ntilde /Ograve /Oacute
 /Ocircumflex /Otilde /Odieresis /multiply
 /Oslash /Ugrave /Uacute /Ucircumflex
 /Udieresis /Yacute /Thorn /germandbls
% 0xE0
 /agrave /aacute /acircumflex /atilde
 /adieresis /aring /ae /ccedilla
 /egrave /eacute /ecircumflex /edieresis
 /igrave /iacute /icircumflex /idieresis
% 0xF0
 /eth /ntilde /ograve /oacute
 /ocircumflex /otilde /odieresis /divide
 /oslash /ugrave /uacute /ucircumflex
 /udieresis /yacute /thorn /ydieresis
] def

%%EndProcSet
%%BeginProcSet: texps.pro
%!
TeXDict begin/rf{findfont dup length 1 add dict begin{1 index/FID ne 2
index/UniqueID ne and{def}{pop pop}ifelse}forall[1 index 0 6 -1 roll
exec 0 exch 5 -1 roll VResolution Resolution div mul neg 0 0]/Metrics
exch def dict begin Encoding{exch dup type/integertype ne{pop pop 1 sub
dup 0 le{pop}{[}ifelse}{FontMatrix 0 get div Metrics 0 get div def}
ifelse}forall Metrics/Metrics currentdict end def[2 index currentdict
end definefont 3 -1 roll makefont/setfont cvx]cvx def}def/ObliqueSlant{
dup sin S cos div neg}B/SlantFont{4 index mul add}def/ExtendFont{3 -1
roll mul exch}def/ReEncodeFont{CharStrings rcheck{/Encoding false def
dup[exch{dup CharStrings exch known not{pop/.notdef/Encoding true def}
if}forall Encoding{]exch pop}{cleartomark}ifelse}if/Encoding exch def}
def end

%%EndProcSet
%%BeginProcSet: special.pro
%!
TeXDict begin/SDict 200 dict N SDict begin/@SpecialDefaults{/hs 612 N
/vs 792 N/ho 0 N/vo 0 N/hsc 1 N/vsc 1 N/ang 0 N/CLIP 0 N/rwiSeen false N
/rhiSeen false N/letter{}N/note{}N/a4{}N/legal{}N}B/@scaleunit 100 N
/@hscale{@scaleunit div/hsc X}B/@vscale{@scaleunit div/vsc X}B/@hsize{
/hs X/CLIP 1 N}B/@vsize{/vs X/CLIP 1 N}B/@clip{/CLIP 2 N}B/@hoffset{/ho
X}B/@voffset{/vo X}B/@angle{/ang X}B/@rwi{10 div/rwi X/rwiSeen true N}B
/@rhi{10 div/rhi X/rhiSeen true N}B/@llx{/llx X}B/@lly{/lly X}B/@urx{
/urx X}B/@ury{/ury X}B/magscale true def end/@MacSetUp{userdict/md known
{userdict/md get type/dicttype eq{userdict begin md length 10 add md
maxlength ge{/md md dup length 20 add dict copy def}if end md begin
/letter{}N/note{}N/legal{}N/od{txpose 1 0 mtx defaultmatrix dtransform S
atan/pa X newpath clippath mark{transform{itransform moveto}}{transform{
itransform lineto}}{6 -2 roll transform 6 -2 roll transform 6 -2 roll
transform{itransform 6 2 roll itransform 6 2 roll itransform 6 2 roll
curveto}}{{closepath}}pathforall newpath counttomark array astore/gc xdf
pop ct 39 0 put 10 fz 0 fs 2 F/|______Courier fnt invertflag{PaintBlack}
if}N/txpose{pxs pys scale ppr aload pop por{noflips{pop S neg S TR pop 1
-1 scale}if xflip yflip and{pop S neg S TR 180 rotate 1 -1 scale ppr 3
get ppr 1 get neg sub neg ppr 2 get ppr 0 get neg sub neg TR}if xflip
yflip not and{pop S neg S TR pop 180 rotate ppr 3 get ppr 1 get neg sub
neg 0 TR}if yflip xflip not and{ppr 1 get neg ppr 0 get neg TR}if}{
noflips{TR pop pop 270 rotate 1 -1 scale}if xflip yflip and{TR pop pop
90 rotate 1 -1 scale ppr 3 get ppr 1 get neg sub neg ppr 2 get ppr 0 get
neg sub neg TR}if xflip yflip not and{TR pop pop 90 rotate ppr 3 get ppr
1 get neg sub neg 0 TR}if yflip xflip not and{TR pop pop 270 rotate ppr
2 get ppr 0 get neg sub neg 0 S TR}if}ifelse scaleby96{ppr aload pop 4
-1 roll add 2 div 3 1 roll add 2 div 2 copy TR .96 dup scale neg S neg S
TR}if}N/cp{pop pop showpage pm restore}N end}if}if}N/normalscale{
Resolution 72 div VResolution 72 div neg scale magscale{DVImag dup scale
}if 0 setgray}N/psfts{S 65781.76 div N}N/startTexFig{/psf$SavedState
save N userdict maxlength dict begin/magscale true def normalscale
currentpoint TR/psf$ury psfts/psf$urx psfts/psf$lly psfts/psf$llx psfts
/psf$y psfts/psf$x psfts currentpoint/psf$cy X/psf$cx X/psf$sx psf$x
psf$urx psf$llx sub div N/psf$sy psf$y psf$ury psf$lly sub div N psf$sx
psf$sy scale psf$cx psf$sx div psf$llx sub psf$cy psf$sy div psf$ury sub
TR/showpage{}N/erasepage{}N/copypage{}N/p 3 def @MacSetUp}N/doclip{
psf$llx psf$lly psf$urx psf$ury currentpoint 6 2 roll newpath 4 copy 4 2
roll moveto 6 -1 roll S lineto S lineto S lineto closepath clip newpath
moveto}N/endTexFig{end psf$SavedState restore}N/@beginspecial{SDict
begin/SpecialSave save N gsave normalscale currentpoint TR
@SpecialDefaults count/ocount X/dcount countdictstack N}N/@setspecial{
CLIP 1 eq{newpath 0 0 moveto hs 0 rlineto 0 vs rlineto hs neg 0 rlineto
closepath clip}if ho vo TR hsc vsc scale ang rotate rwiSeen{rwi urx llx
sub div rhiSeen{rhi ury lly sub div}{dup}ifelse scale llx neg lly neg TR
}{rhiSeen{rhi ury lly sub div dup scale llx neg lly neg TR}if}ifelse
CLIP 2 eq{newpath llx lly moveto urx lly lineto urx ury lineto llx ury
lineto closepath clip}if/showpage{}N/erasepage{}N/copypage{}N newpath}N
/@endspecial{count ocount sub{pop}repeat countdictstack dcount sub{end}
repeat grestore SpecialSave restore end}N/@defspecial{SDict begin}N
/@fedspecial{end}B/li{lineto}B/rl{rlineto}B/rc{rcurveto}B/np{/SaveX
currentpoint/SaveY X N 1 setlinecap newpath}N/st{stroke SaveX SaveY
moveto}N/fil{fill SaveX SaveY moveto}N/ellipse{/endangle X/startangle X
/yrad X/xrad X/savematrix matrix currentmatrix N TR xrad yrad scale 0 0
1 startangle endangle arc savematrix setmatrix}N end

%%EndProcSet
TeXDict begin 39158280 55380996 1000 600 600 (omniORB.dvi)
@start /Fa 138[51 28 1[32 3[51 8[42 18[60 2[69 5[32 73[{
TeXBase1Encoding ReEncodeFont}8 83.022 /Palatino-Bold
rf
%DVIPSBitmapFont: Fb cmr8 8 2
/Fb 2 52 df<130C133C137CEA03FC12FFEAFC7C1200B3B113FE387FFFFEA2172C7AAB23
>49 D<EB3FC03801FFF03807C0FC380E007E487FEC1F80003F14C0A2EB800F1300A2000C
131FC7FC1580A2EC3F00143E5C5CEB03F0EBFFC014F0EB00FC143FEC1F8015C0140F15E0
A2EC07F0A21238127C12FEA3EC0FE012F8006014C00070131F6C1480001EEB3F00380780
FC3801FFF038007FC01C2D7DAB23>51 D E
%EndDVIPSBitmapFont
/Fc 134[55 1[55 55 55 55 55 55 55 55 55 55 55 55 55 1[55
55 55 55 55 55 55 1[55 1[55 11[55 41[55 55 40[{
TeXBase1Encoding ReEncodeFont}26 90.9091 /Courier-Bold
rf /Fd 131[50 2[50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 1[50 1[50 1[50 2[50
50 50 50 50 50 50 1[50 50 50 50 50 2[50 50 1[50 50 50
50 50 50 2[50 50 50 1[50 50 50 1[50 50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 3[50 50 50 33[{TeXBase1Encoding ReEncodeFont}
74 83.022 /Courier-Oblique rf /Fe 129[50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 1[50 50 50 1[50 50 50 50 50
50 50 50 1[50 50 50 50 50 50 50 50 50 50 50 50 50 50
50 50 50 1[50 50 50 50 50 1[50 50 50 50 50 50 50 50 50
50 50 50 50 50 50 50 50 50 50 50 50 50 50 50 33[{
TeXBase1Encoding ReEncodeFont}89 83.022 /Courier rf /Ff
133[55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55 55
55 55 55 55 55 55 55 55 55 1[55 1[55 55 55 55 55 55 55
55 55 55 55 55 1[55 55 55 55 55 55 55 55 55 55 55 55
55 55 55 55 55 55 55 55 55 1[55 55 55 55 55 55 55 55
55 55 55 55 55 55 55 1[55 55 55 1[55 55 55 55 55 34[{
TeXBase1Encoding ReEncodeFont}83 90.9091 /Courier rf
/Fg 104[91 55[45 5[61 61 91 66 71 56 48 61 71 55 71 76
86 56 66 30 31 76 69 51 56 70 64 56 71 7[45 45 45 45
45 45 45 45 45 45 1[23 30 1[55 1[30 30 40[{
.167 SlantFont TeXBase1Encoding ReEncodeFont}42 90.9091
/Palatino-Roman rf /Fh 136[45 45 45 45 45 45 45 45 45
45 45 45 45 45 45 45 45 45 45 1[45 45 45 1[45 8[45 1[45
45 45 1[45 45 5[45 3[45 1[45 45 45 6[45 45 1[45 7[45
45 45 2[45 45 45 40[{TeXBase1Encoding ReEncodeFont}43
74.7198 /Courier rf /Fi 134[42 39 62 42 45 24 32 30 42
45 41 43 66 22 42 17 22 43 42 25 36 46 33 41 37 21 37
1[25 1[25 1[50 1[75 1[58 46 39 50 1[45 59 62 71 46 1[25
25 62 57 42 46 58 53 46 58 5[19 19 37 37 37 37 1[37 37
37 37 37 45 19 25 19 45 1[25 25 21 5[21 30[45 2[{
TeXBase1Encoding ReEncodeFont}71 74.7198 /Palatino-Roman
rf /Fj 198[25 25 25 25 25 25 25 25 25 25 48[{
TeXBase1Encoding ReEncodeFont}10 49.8132 /Palatino-Roman
rf /Fk 134[55 50 83 55 61 33 44 39 61 61 55 61 89 33
61 33 33 61 55 39 50 61 44 61 50 1[50 5[66 66 100 78
78 66 61 72 1[61 83 83 100 61 78 1[39 83 83 55 61 83
72 66 78 6[25 50 50 50 50 50 50 50 50 50 50 1[25 33 7[89
34[61 2[{TeXBase1Encoding ReEncodeFont}64 99.6264 /Palatino-Bold
rf /Fl 198[33 33 33 33 33 33 33 33 33 33 48[{
TeXBase1Encoding ReEncodeFont}10 66.4176 /Palatino-Roman
rf /Fm 135[86 3[57 1[67 1[105 1[105 4[57 105 2[86 105
2[86 29[124 1[134 7[86 86 86 86 86 86 86 86 86 86 48[{
TeXBase1Encoding ReEncodeFont}22 172.188 /Palatino-Bold
rf /Fn 105[45 28[51 45 76 51 56 30 40 35 56 56 51 56
81 30 56 30 30 56 51 35 45 56 40 56 45 1[45 7[91 71 1[61
56 66 1[56 76 76 91 56 2[35 76 76 1[56 76 66 61 71 7[45
45 45 45 45 45 45 45 45 45 1[23 30 23 55 1[30 30 37[56
2[{TeXBase1Encoding ReEncodeFont}62 90.9091 /Palatino-Bold
rf /Fo 134[115 2[115 126 69 92 80 1[126 115 126 184 69
126 1[69 126 115 80 103 126 92 126 103 1[103 8[161 1[138
126 149 1[126 172 172 207 126 2[80 4[172 149 138 161
11[103 9[125 1[69 69 40[{TeXBase1Encoding ReEncodeFont}40
206.559 /Palatino-Bold rf
%DVIPSBitmapFont: Fp cmsy10 10.95 1
/Fp 1 16 df<EB0FFCEB3FFF90B512C0000314F04880488048804880A2481580A3B712C0
AA6C1580A36C1500A26C5C6C5C6C5C6C5CC614C0013F90C7FCEB0FFC22227BA72D>15
D E
%EndDVIPSBitmapFont
/Fq 104[120 28[60 66 60 100 66 73 40 53 47 73 73 66 73
106 40 73 40 40 73 66 47 60 73 53 73 60 1[60 5[80 1[120
1[93 80 73 86 100 73 100 100 120 73 2[47 100 100 66 73
100 86 80 93 7[60 60 60 60 60 60 60 60 60 60 1[30 40
30 72 40[73 2[{TeXBase1Encoding ReEncodeFont}64 119.552
/Palatino-Bold rf /Fr 105[45 27[40 45 45 66 45 51 30
35 35 42 45 40 51 71 25 40 25 25 45 45 25 35 45 37 42
40 1[45 1[30 6[66 71 56 51 61 1[56 71 71 86 3[30 1[66
1[56 71 61 56 66 68 5[23 2[45 45 45 45 45 45 45 45 1[23
30 23 55 1[30 30 37[48 2[{TeXBase1Encoding ReEncodeFont}62
90.9091 /Palatino-Italic rf /Fs 75[30 28[91 45 27[45
51 47 76 51 55 30 39 36 51 55 50 53 80 26 51 21 26 53
51 30 44 56 40 50 45 25 45 1[30 1[30 1[61 61 91 66 71
56 48 61 71 55 71 76 86 56 66 30 31 76 69 51 56 70 64
56 71 68 1[55 55 55 23 23 45 45 45 45 45 45 45 45 45
45 55 23 30 23 55 1[30 30 25 71 76 2[34 25 29[55 55 2[{
TeXBase1Encoding ReEncodeFont}88 90.9091 /Palatino-Roman
rf /Ft 134[66 2[68 72 39 51 47 2[65 70 106 3[35 70 66
1[57 73 53 66 60 12[73 63 80 5[73 4[91 2[93 85 1[93 19[40
6[93 38[{TeXBase1Encoding ReEncodeFont}27 119.552 /Palatino-Roman
rf /Fu 137[117 125 1[88 82 2[113 120 182 3[60 120 2[99
126 14[161 127 1[138 2[162 7[158 4[126 14[103 2[103 1[52
6[57 39[{TeXBase1Encoding ReEncodeFont}21 206.559 /Palatino-Roman
rf end
%%EndProlog
%%BeginSetup
%%Feature: *Resolution 600dpi
TeXDict begin
%%PaperSize: A4

%%EndSetup
%%Page: 1 1
1 0 bop 538 597 a Fu(The)51 b(omniORB)i(version)d(3.0)1077
853 y(User)15 b('s)51 b(Guide)1441 1733 y Ft(Sai-Lai)28
b(Lo)1116 1882 y Fs(\()p Fr(email:)h(slo@uk.r)n(esear)n(ch.att.com)p
Fs(\))1304 2144 y Ft(David)f(Riddoch)1114 2293 y Fs(\()p
Fr(email:)h(djr@uk.r)n(esear)n(ch.att.com)p Fs(\))1306
2555 y Ft(Duncan)f(Grisby)1029 2704 y Fs(\()p Fr(email:)i(dgrisby@uk.r)
n(esear)n(ch.att.com)p Fs(\))885 2966 y Ft(A)-9 b(T&T)31
b(Laboratories)f(Cambridge)1514 4539 y Fs(May)23 b(2000)p
eop
%%Page: 2 2
2 1 bop 362 539 a Fq(Changes)31 b(and)e(Additions,)h(May)g(2000)358
726 y Fp(\017)45 b Fs(Updated)21 b(to)h(omniORB)h(3.)p
eop
%%Page: 3 3
3 2 bop 63 1204 a Fo(Contents)63 1743 y Fn(1)91 b(Introduction)2581
b(1)199 1858 y Fs(1.1)96 b(Featur)n(es)85 b(.)46 b(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)129 b(1)408
1973 y(1.1.1)110 b(CORBA)23 b(2.3)g(compliant)68 b(.)45
b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)129 b(1)408 2088 y(1.1.2)110 b(Multithr)n(eading)67
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)129 b(2)408 2203
y(1.1.3)110 b(Portability)52 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)129 b(2)408 2318 y(1.1.4)110 b(Missing)22
b(featur)n(es)87 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)129
b(2)199 2433 y(1.2)96 b(Setting)21 b(Up)h(Y)-8 b(our)22
b(Envir)n(onment)49 b(.)c(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)129 b(3)408
2547 y(1.2.1)110 b(Depr)n(ecated)22 b(con\002guration)g(\002le)g
(entries)31 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)129 b(4)199 2662 y(1.3)96 b(Platform)23 b(speci\002c)g(variables)50
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)129 b(4)63 2869 y Fn(2)91
b(The)22 b(Basics)2667 b(7)199 2984 y Fs(2.1)96 b(The)22
b(Echo)g(Object)h(Example)81 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)129
b(7)199 3099 y(2.2)96 b(Specifying)22 b(the)g(Echo)g(interface)h(in)g
(IDL)72 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)129 b(8)199 3214 y(2.3)96 b(Generating)22
b(the)g(C++)h(stubs)77 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)129
b(8)199 3329 y(2.4)96 b(Object)23 b(Refer)n(ences)e(and)i(Servants)58
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)129 b(9)199 3443 y(2.5)96 b(A)23
b(Quick)g(T)-8 b(our)21 b(of)i(the)f(C++)h(stubs)82 b(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)129 b(9)408 3558 y(2.5.1)110 b(Servant)22
b(Object)i(Implementation)39 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(12)199 3673 y(2.6)96
b(W)-7 b(riting)23 b(the)f(servant)g(implementation)78
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)84 b(13)199 3788 y(2.7)96 b(W)-7 b(riting)23
b(the)f(client)71 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
84 b(14)199 3903 y(2.8)96 b(Example)23 b(1)g(\227)f(Colocated)h(Client)
g(and)g(Implementation)57 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(15)408 4018 y(2.8.1)110 b(ORB)22 b(initialisation)39
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(16)408 4132
y(2.8.2)110 b(Obtaining)24 b(the)e(Root)f(POA)36 b(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)84 b(17)408 4247 y(2.8.3)110 b(Object)23
b(initialisation)38 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(17)408 4362 y(2.8.4)110 b(Activating)23 b(the)f(POA)k(.)45
b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(18)408 4477 y(2.8.5)110
b(Performing)22 b(a)h(call)62 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(18)408 4592 y(2.8.6)110 b(ORB)22 b(destr)o(uction)82
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(18)199 4707
y(2.9)96 b(Example)23 b(2)g(\227)f(Dif)n(fer)n(ent)i(Addr)n(ess)c
(Spaces)85 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)84 b(18)408 4821 y(2.9.1)110 b(Object)25 b(Implementation:)
31 b(Generating)23 b(a)i(Stringi\002ed)f(Object)h(Ref-)699
4934 y(er)n(ence)82 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)84 b(19)408 5049 y(2.9.2)110 b(Client:)28
b(Using)22 b(a)h(Stringi\002ed)f(Object)h(Refer)n(ence)29
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(19)408
5164 y(2.9.3)110 b(Catching)23 b(System)e(Exceptions)89
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)84 b(20)408 5279 y(2.9.4)110 b(Lifetime)22 b(of)h(a)g(CORBA)g
(object)49 b(.)c(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)84 b(20)199 5394 y(2.10)51 b(Example)23
b(3)g(\227)f(Using)g(the)g(Naming)h(Service)44 b(.)h(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(21)1667
5622 y(iii)p eop
%%Page: 4 4
4 3 bop 567 539 a Fs(2.10.1)65 b(Obtaining)23 b(the)f(Root)g(Context)f
(Object)i(Refer)n(ence)38 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(21)567 659 y(2.10.2)65 b(The)21 b(Naming)i(Service)g(Interface)34
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)84 b(22)358 779 y(2.1)-5 b(1)56 b(Example)22
b(4)h(\227)g(Using)f(tie)g(implementation)h(templates)64
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(22)358
899 y(2.12)51 b(Sour)n(ce)22 b(Listings)87 b(.)45 b(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(24)567 1019 y(2.12.1)65
b(eg1.cc)29 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)84 b(24)567 1140 y(2.12.2)65 b(eg2_impl.cc)70
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(27)567
1260 y(2.12.3)65 b(eg2_clt.cc)25 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)84 b(29)567 1380 y(2.12.4)65 b(eg3_impl.cc)70
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(31)567
1500 y(2.12.5)65 b(eg3_clt.cc)25 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)84 b(35)567 1620 y(2.12.6)65 b(eg3_tieimpl.cc)38
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(38)567
1741 y(2.12.7)65 b(dir)-7 b(.mk)75 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)84 b(42)221 1957 y Fn(3)92 b(C++)22
b(language)h(mapping)2086 b(45)358 2077 y Fs(3.1)96 b
(Incompatibilities)23 b(with)g(pr)n(e-2.8.0)g(r)n(eleases)64
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
84 b(45)358 2197 y(3.2)96 b(BOA)22 b(compatibility)81
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(46)221
2413 y Fn(4)92 b(Interoperable)24 b(Naming)e(Service)1810
b(49)358 2533 y Fs(4.1)96 b(Object)23 b(URIs)82 b(.)45
b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(49)567 2653 y(4.1.1)110 b(corbaloc)72 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(49)567 2774 y(4.1.2)110
b(corbaname)34 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(50)358 2894 y(4.2)96 b(Con\002guring)22 b(r)n(esolve_initial_r)n
(efer)n(ences)54 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)84 b(51)567 3014 y(4.2.1)110 b(ORBInitRef)82
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(51)567
3134 y(4.2.2)110 b(ORBDefaultInitRef)55 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)84 b(51)567 3254 y(4.2.3)110 b(omniORB)22 b(con\002guration)g
(\002le)49 b(.)c(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)84 b(52)567 3375 y(4.2.4)110 b(Resolution)21
b(or)n(der)74 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(52)358 3495 y(4.3)96 b(omniNames)70 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(53)567 3615 y(4.3.1)110
b(NamingContextExt)36 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(53)567 3735 y(4.3.2)110 b(Use)21 b(with)i(corbaname)60
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(54)358 3855 y(4.4)96
b(omniMapper)33 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)84 b(54)358 3976 y(4.5)96 b(Cr)n(eating)23
b(objects)f(with)g(simple)h(object)f(keys)46 b(.)f(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(55)221
4192 y Fn(5)92 b(The)22 b(IDL)g(compiler)2320 b(57)358
4312 y Fs(5.1)96 b(Common)23 b(options)65 b(.)45 b(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)84 b(57)567 4432 y(5.1.1)110
b(Pr)n(epr)n(ocessor)20 b(interactions)78 b(.)46 b(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(58)858 4552 y(5.1.1.1)123 b(W)-5 b(indows)22 b(9x)82
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)84 b(58)567 4672 y(5.1.2)110
b(Forwar)n(d-declar)n(ed)21 b(interfaces)28 b(.)45 b(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(58)567 4793 y(5.1.3)110 b(Comments)37 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)84 b(58)358 4913 y(5.2)96 b(C++)23
b(back-end)g(options)80 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(59)567 5033 y(5.2.1)110 b(Module)21 b(splicing)27 b(.)45
b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(59)567 5153 y(5.2.2)110
b(Flattened)21 b(tie)h(classes)i(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(60)567 5274 y(5.2.3)110 b(Generating)22 b(example)g(implementations)
51 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84
b(60)358 5394 y(5.3)96 b(Examples)35 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)84 b(61)p eop
%%Page: 5 5
5 4 bop 63 539 a Fn(6)91 b(The)22 b(omniORB)f(API)2274
b(63)199 665 y Fs(6.1)96 b(ORB)23 b(initialisation)h(options)70
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(63)199 792 y(6.2)96
b(Hostname)21 b(and)i(port)50 b(.)c(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)84 b(64)199 918 y(6.3)96 b(Run-time)22 b(T)-8 b(racing)23
b(and)g(Diagnostic)g(Messages)51 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(64)199 1045 y(6.4)96
b(Server)22 b(Name)38 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)84 b(65)199 1171 y(6.5)96 b(GIOP)23 b(Message)e(Size)55
b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(65)199
1298 y(6.6)96 b(Object)23 b(table)g(size)49 b(.)c(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(66)199 1424 y(6.7)96
b(POA)23 b(r)n(equest)e(holding)h(timeout)56 b(.)45 b(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
84 b(66)199 1551 y(6.8)96 b(Obsolete)22 b(Initial)i(Object)f(Refer)n
(ence)e(Bootstrapping)f(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)84 b(66)199 1677 y(6.9)96 b(GIOP)23 b(Lowest)e(Common)i
(Denominator)f(Mode)31 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)84 b(68)199 1804 y(6.10)51 b(GIOP)23 b(Requesting)e
(Principal)j(\002eld)f(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(68)199
1930 y(6.1)-5 b(1)56 b(T)-8 b(rapping)22 b(omniORB)h(Internal)f(Err)n
(ors)48 b(.)d(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)84 b(68)199 2057 y(6.12)51 b(System)21
b(Exception)g(Handlers)67 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(69)408 2184 y(6.12.1)65 b(CORBA::TRANSIENT)19 b(handlers)24
b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)84 b(69)408 2310 y(6.12.2)65 b(CORBA::COMM_F)-7 b(AILURE)48
b(.)d(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)84 b(71)408 2437 y(6.12.3)65 b(CORBA::SystemException)29
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)84 b(72)199 2563 y(6.13)51 b(Location)22
b(forwar)n(ding)76 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(72)63 2790 y Fn(7)91 b(Interface)25 b(T)-8 b(ype)22
b(Checking)2044 b(75)199 2916 y Fs(7.1)96 b(Intr)n(oduction)56
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(75)199 3043 y(7.2)96 b(Basic)23 b(Interface)f(T)-8
b(ype)21 b(Checking)41 b(.)k(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(76)199
3169 y(7.3)96 b(Interface)22 b(Inheritance)75 b(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(77)63 3396
y Fn(8)91 b(Connection)21 b(Management)2015 b(81)199
3522 y Fs(8.1)96 b(Backgr)n(ound)73 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(81)199 3649 y(8.2)96
b(The)22 b(Model)59 b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)84 b(82)199 3775 y(8.3)96 b(Idle)22
b(Connection)g(Shutdown)f(and)i(Remote)e(Call)j(T)-5
b(imeout)66 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(82)199 3902 y(8.4)96 b(Inter)n(operability)22 b(Considerations)50
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)84 b(83)199 4028 y(8.5)96 b(Connection)22
b(Acceptance)k(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(84)63 4255 y Fn(9)91 b(T)-8 b(ype)22 b(Any)f(and)i(T)-8
b(ypeCode)2033 b(87)199 4381 y Fs(9.1)96 b(Example)23
b(using)f(type)f(Any)43 b(.)i(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(87)408 4508 y(9.1.1)110 b(T)-8 b(ype)21 b(Any)h(in)h(IDL)75
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(88)408 4635
y(9.1.2)110 b(Inserting)21 b(and)h(Extracting)h(Basic)g(T)-8
b(ypes)20 b(fr)n(om)j(an)g(Any)49 b(.)d(.)f(.)g(.)g(.)g(.)h(.)84
b(88)408 4761 y(9.1.3)110 b(Inserting)21 b(and)h(Extracting)h(Constr)o
(ucted)e(T)-8 b(ypes)20 b(fr)n(om)j(an)g(Any)34 b(.)45
b(.)h(.)84 b(89)199 4888 y(9.2)96 b(T)-8 b(ype)21 b(Any)h(in)h(omniORB)
58 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(91)199
5014 y(9.3)96 b(T)-8 b(ypeCode)20 b(in)j(omniORB)42 b(.)j(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)84 b(93)199 5141 y(9.4)96 b(Sour)n(ce)22
b(Listing)58 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)84 b(96)408 5267 y(9.4.1)110 b(anyExample_impl.cc)49
b(.)d(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)84 b(96)408 5394 y(9.4.2)110
b(anyExample_clt.cc)72 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)84
b(99)p eop
%%Page: 6 6
6 5 bop 221 539 a Fn(10)47 b(Dynamic)22 b(Management)h(of)g(Any)e(V)-10
b(alues)1462 b(103)358 661 y Fs(10.1)51 b(C++)23 b(mapping)69
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39
b(103)358 783 y(10.2)51 b(The)22 b(DynAny)f(Interface)74
b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39 b(107)567
905 y(10.2.1)65 b(Example:)27 b(extract)22 b(data)h(values)g(fr)n(om)g
(an)g(Any)80 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39
b(107)858 1027 y(10.2.1.1)78 b(Iterate)21 b(thr)n(ough)h(the)g
(components)60 b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39
b(108)858 1149 y(10.2.1.2)78 b(Extract)22 b(basic)i(type)d(components)
39 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39
b(109)858 1271 y(10.2.1.3)78 b(Extract)22 b(complex)h(components)31
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39
b(109)858 1393 y(10.2.1.4)78 b(Clean-up)c(.)45 b(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)f(1)-5 b(10)567 1515 y(10.2.2)65 b(Example:)27 b(insert)22
b(data)h(values)g(into)f(an)h(Any)h(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)f(1)-5 b(10)858 1637 y(10.2.2.1)78
b(Insert)21 b(basic)j(type)d(components)i(.)45 b(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)k(1)-5 b(1)g(1)858 1759 y(10.2.2.2)78
b(Insert)21 b(complex)i(components)83 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)f(1)-5 b(12)358 1881 y(10.3)51
b(The)22 b(DynStr)o(uct)f(Interface)79 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)f(1)-5 b(13)358 2003 y(10.4)51 b(The)22 b(DynSequence)e(Interface)
76 b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)f(1)-5 b(14)358 2125 y(10.5)51
b(The)22 b(DynArray)g(Interface)77 b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
f(1)-5 b(15)358 2247 y(10.6)51 b(The)22 b(DynEnum)g(Interface)72
b(.)46 b(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)f(1)-5 b(16)358 2369
y(10.7)51 b(The)22 b(DynUnion)g(Interface)63 b(.)46 b(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)f(1)-5 b(16)567 2491 y(10.7.1)65 b(Thr)n(ee)21
b(Categories)h(of)g(Union)32 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)f(1)-5
b(16)567 2613 y(10.7.2)65 b(Example:)27 b(extract)22
b(data)h(values)g(fr)n(om)g(a)g(union)71 b(.)45 b(.)h(.)f(.)g(.)g(.)g
(.)g(.)h(.)f(.)g(.)f(1)-5 b(17)858 2735 y(10.7.2.1)78
b(Explicit)23 b(default)g(union)48 b(.)d(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)f(1)-5 b(17)858 2857
y(10.7.2.2)78 b(Implicit)24 b(default)e(union)40 b(.)45
b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)f
(1)-5 b(18)858 2979 y(10.7.2.3)78 b(No)22 b(default)h(union)h(.)46
b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)f(1)-5 b(19)567 3101 y(10.7.3)65 b(Example:)27
b(insert)22 b(data)h(values)g(into)f(a)h(union)83 b(.)45
b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)f(1)-5 b(19)858
3223 y(10.7.3.1)78 b(Ambiguous)22 b(usage)54 b(.)45 b(.)g(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39
b(120)358 3345 y(10.8)51 b(Duplicate)23 b(DynAny)f(Refer)n(ences)27
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)39 b(121)358 3467 y(10.9)51 b(Other)22
b(Operations)63 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39
b(121)221 3686 y Fn(1)m(1)50 b(The)22 b(Dynamic)g(Invocation)h
(Interface)1597 b(123)358 3808 y Fs(1)-5 b(1.1)56 b(Overview)28
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)39 b(123)358 3930 y(1)-5 b(1.2)56 b(Pseudo)20 b(Objects)86
b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39
b(124)567 4052 y(1)-5 b(1.2.1)70 b(Request)85 b(.)45
b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39
b(124)567 4174 y(1)-5 b(1.2.2)70 b(NamedV)-8 b(alue)84
b(.)45 b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)
g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39 b(125)567
4296 y(1)-5 b(1.2.3)70 b(NVList)47 b(.)f(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)39 b(125)567 4418 y(1)-5 b(1.2.4)70
b(Context)22 b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)39 b(125)567 4540 y(1)-5 b(1.2.5)70 b(ContextList)76
b(.)45 b(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)
g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39 b(126)567
4662 y(1)-5 b(1.2.6)70 b(ExceptionList)61 b(.)45 b(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)39 b(126)567 4784 y(1)-5 b(1.2.7)70 b
(UnknownUserException)24 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39 b(127)567
4906 y(1)-5 b(1.2.8)70 b(Envir)n(onment)83 b(.)45 b(.)g(.)h(.)f(.)g(.)g
(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)39 b(127)358 5028 y(1)-5 b(1.3)56 b(Cr)n(eating)23
b(Requests)35 b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39
b(128)567 5150 y(1)-5 b(1.3.1)70 b(Examples)85 b(.)45
b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39 b(129)358
5272 y(1)-5 b(1.4)56 b(Invoking)21 b(Operations)68 b(.)45
b(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g
(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)39 b(129)358 5394
y(1)-5 b(1.5)56 b(Multiple)22 b(Requests)35 b(.)45 b(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)39 b(130)p eop
%%Page: 7 7
7 6 bop 63 539 a Fn(12)46 b(The)22 b(Dynamic)h(Skeleton)f(Interface)
1673 b(133)199 652 y Fs(12.1)51 b(Overview)28 b(.)46
b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)38
b(133)199 764 y(12.2)51 b(DSI)23 b(T)-8 b(ypes)87 b(.)45
b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)38
b(134)408 877 y(12.2.1)65 b(PortableServer::DynamicImplementation)52
b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)38
b(134)408 990 y(12.2.2)65 b(ServerRequest)31 b(.)45 b(.)g(.)g(.)g(.)h
(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)
f(.)g(.)g(.)g(.)h(.)38 b(134)199 1103 y(12.3)51 b(Cr)n(eating)23
b(Dynamic)h(Implementations)73 b(.)45 b(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g
(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)38 b(135)408 1216
y(12.3.1)65 b(Operations)22 b(on)g(the)g(ServerRequest)36
b(.)45 b(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)
38 b(135)199 1329 y(12.4)51 b(Registering)21 b(Dynamic)j(Objects)80
b(.)45 b(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)
h(.)f(.)g(.)g(.)g(.)h(.)38 b(136)199 1442 y(12.5)51 b(Example)74
b(.)46 b(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)
g(.)h(.)f(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)g(.)h(.)f(.)g(.)g(.)g(.)h
(.)38 b(136)63 1646 y Fn(A)65 b(hosts_access\(5\))2399
b(139)p eop
%%Page: 8 8
8 7 bop eop
%%Page: 1 9
1 8 bop 63 1174 a Fm(Chapter)44 b(1)63 1602 y Fo(Introduction)63
2060 y Fs(omniORB)23 b(is)g(an)h(Object)g(Request)d(Br)n(oker)g
(\(ORB\))j(that)f(implements)f(the)h(2.3)g(speci\002cation)63
2172 y(of)31 b(the)g(Common)g(Object)h(Request)e(Br)n(oker)g(Ar)n
(chitectur)n(e)h(\(CORBA\))h([OMG99)r(])3008 2140 y Fl(1)3045
2172 y Fs(.)55 b(It)31 b(has)63 2285 y(passed)24 b(the)h(Open)g(Gr)n
(oup)h(CORBA)g(compliant)g(testsuite)e(and)i(is)g(one)f(of)g(the)g(thr)
n(ee)g(ORBs)63 2398 y(to)d(have)h(been)f(granted)f(the)h(CORBA)g(brand)
h(in)g(June)g(1999)2174 2365 y Fl(2)2213 2398 y Fs(.)204
2524 y(This)18 b(user)f(guide)g(tells)h(you)f(how)h(to)f(use)g(omniORB)
h(to)g(develop)f(CORBA)h(applications.)63 2637 y(It)k(assumes)f(a)i
(basic)h(understanding)d(of)h(CORBA.)204 2763 y(In)c(this)h(chapter)-7
b(,)19 b(we)f(give)h(an)g(overview)g(of)f(the)g(main)i(featur)n(es)e
(of)h(omniORB)g(and)g(what)63 2875 y(you)i(need)h(to)g(do)g(to)g(setup)
e(your)i(envir)n(onment)g(to)g(r)o(un)h(omniORB.)63 3252
y Fq(1.1)119 b(Features)63 3492 y Fk(1.1.1)99 b(CORBA)24
b(2.3)h(compliant)63 3695 y Fs(omniORB)31 b(implements)f(the)g
(Internet)f(Inter)n(-ORB)h(Pr)n(otocol)h(\(IIOP\).)g(This)f(pr)n
(otocol)h(pr)n(o-)63 3808 y(vides)39 b(omniORB)g(the)g(means)g(of)g
(achieving)i(inter)n(operability)e(with)g(the)g(ORBs)g(imple-)63
3921 y(mented)31 b(by)i(other)e(vendors.)57 b(In)33 b(fact,)j(this)c
(is)h(the)f(native)h(pr)n(otocol)f(used)g(by)g(omniORB)63
4034 y(for)j(the)g(communication)h(amongst)f(its)g(objects)g(r)n
(esiding)f(in)i(dif)n(fer)n(ent)g(addr)n(ess)e(spaces.)63
4147 y(Mor)n(eover)-7 b(,)25 b(the)g(IDL)g(to)f(C++)j(language)e
(mapping)g(pr)n(ovided)g(by)g(omniORB)h(conforms)f(to)63
4260 y(the)h(latest)g(r)n(evision)h(of)g(the)f(CORBA)g
(speci\002cation.)41 b(T)-8 b(ype)25 b(Any)h(and)h(T)-8
b(ypeCode)24 b(ar)n(e)j(now)63 4373 y(supported)k(\(intr)n(oduced)i(in)
h(version)g(2.5.0\).)63 b(DynAny)33 b(is)h(supported)d(since)j(2.6.0.)
63 b(The)63 4485 y(Dynamic)21 b(Invocation)g(Interface)e(and)h(Dynamic)
i(Skeleton)c(Interface)i(ar)n(e)g(supported)e(since)63
4598 y(2.7.0.)50 b(The)29 b(C++)i(mapping)f(has)g(been)f(updated)f(to)h
(the)g(CORBA)h(2.3)h(speci\002cation)f(since)63 4711
y(2.8.0.)e(The)22 b(POA)h(was)g(intr)n(oduced)e(with)i(3.0.)p
63 5030 1316 4 v 168 5086 a Fj(1)197 5117 y Fi(Most)i(of)h(the)g(2.3)g
(featur)o(es)f(have)i(been)f(implemented.)43 b(The)26
b(featur)o(es)f(still)g(missing)f(in)i(this)g(r)o(elease)e(ar)o(e)63
5209 y(listed)18 b(in)i(section)g(1.1.4.)25 b(Wher)o(e)19
b(possible,)f(backwar)o(d)h(compatibility)h(has)g(been)g(maintained)g
(up)g(to)g(speci\002ca-)63 5300 y(tion)f(2.0.)168 5362
y Fj(2)197 5394 y Fi(Mor)o(e)e(information)i(can)h(be)f(found)f(at)i
Fh(http://www.opengroup.org/press/7jun9)o(9_b.ht)o(m)1684
5622 y Fs(1)p eop
%%Page: 2 10
2 9 bop 221 282 a Fs(2)1931 b Fg(CHAPTER)22 b(1.)51 b(INTRODUCTION)221
539 y Fk(1.1.2)99 b(Multithreading)221 717 y Fs(omniORB)25
b(is)g(fully)h(multithr)n(eaded.)34 b(T)-8 b(o)25 b(achieve)g(low)g
(IIOP)g(call)i(over)n(head,)e(unnecessary)221 830 y(call-multiplexing)
31 b(is)f(eliminated.)47 b(At)29 b(any)g(time,)i(ther)n(e)d(is)h(at)g
(most)g(one)f(call)j(in-\003ight)f(in)221 943 y(each)22
b(communication)h(channel)f(between)e(two)h(addr)n(ess)f(spaces.)27
b(T)-8 b(o)20 b(do)h(so)g(without)f(limit-)221 1056 y(ing)26
b(the)f(level)h(of)g(concurr)n(ency)-10 b(,)26 b(new)f(channels)h
(connecting)f(the)g(two)g(addr)n(ess)g(spaces)g(ar)n(e)221
1169 y(cr)n(eated)g(on)h(demand)f(and)h(cached)g(when)f(ther)n(e)g(ar)n
(e)h(mor)n(e)g(concurr)n(ent)f(calls)i(in)f(pr)n(ogr)n(ess.)221
1282 y(Each)20 b(channel)h(is)e(served)g(by)g(a)i(dedicated)d(thr)n
(ead.)26 b(This)20 b(arrangement)f(pr)n(ovides)g(maximal)221
1395 y(concurr)n(ency)i(and)g(eliminates)g(any)g(thr)n(ead)g(switching)
f(in)i(either)e(of)h(the)f(addr)n(ess)g(spaces)g(to)221
1508 y(pr)n(ocess)28 b(a)i(call.)50 b(Furthermor)n(e,)28
b(to)h(maximise)h(the)f(thr)n(oughput)e(in)j(pr)n(ocessing)e(lar)n(ge)h
(call)221 1621 y(ar)n(guments,)j(lar)n(ge)f(data)g(elements)f(ar)n(e)h
(sent)f(as)h(soon)e(as)i(they)f(ar)n(e)h(pr)n(ocessed)e(while)i(the)221
1733 y(other)22 b(ar)n(guments)f(ar)n(e)i(being)g(marshalled.)221
1994 y Fk(1.1.3)99 b(Portability)221 2173 y Fs(At)31
b(A)-7 b(T&T)31 b(Laboratories,)i(the)e(ability)i(to)e(tar)n(get)g(a)h
(single)g(sour)n(ce)f(tr)n(ee)f(to)h(multiple)h(plat-)221
2285 y(forms)24 b(is)g(very)f(important.)31 b(This)24
b(is)g(dif)n(\002cult)h(to)e(achieve)i(if)g(the)e(IDL)g(to)h(C++)g
(mapping)g(for)221 2398 y(these)d(platforms)h(ar)n(e)g(dif)n(fer)n
(ent.)28 b(W)-8 b(e)22 b(avoid)g(this)g(pr)n(oblem)h(by)f(making)g(sur)
n(e)g(that)g(only)g(one)221 2511 y(IDL)g(to)g(C++)h(mapping)g(is)f
(used.)27 b(W)-8 b(e)21 b(r)o(un)i(several)f(\003avours)g(of)h(Unix,)f
(W)-5 b(indows)22 b(NT)-7 b(,)21 b(W)-5 b(in-)221 2624
y(dows)29 b(95)i(and)f(our)f(in-house)g(developed)f(systems)f(for)j
(our)g(own)f(har)n(dwar)n(e.)50 b(omniORB)221 2737 y(has)33
b(been)g(ported)e(to)h(all)j(these)c(platforms.)59 b
Fn(The)33 b(IDL)f(to)h(C++)g(mapping)f(for)i(all)g(these)221
2850 y(targets)25 b(is)e(the)g(same)p Fs(.)362 2964 y(omniORB)f(uses)e
(r)n(eal)i(C++)h(exceptions)d(and)h(nested)f(classes.)27
b(W)-8 b(e)20 b(keep)g(to)h(the)g(CORBA)221 3077 y(speci\002cation's)26
b(standar)n(d)f(mapping)h(as)g(much)g(as)g(possible)f(and)h(do)f(not)g
(use)g(the)g(alterna-)221 3190 y(tive)e(mappings)f(for)h(C++)g
(dialects.)28 b(The)22 b(only)g(exception)f(is)i(the)f(mapping)h(of)f
Fn(modules)p Fs(.)362 3303 y(Starting)f(with)f(2.6.0,)i(the)f(code)f
(generated)e(by)j(the)f(IDL)h(compiler)g(of)g(omniORB)g(can)h(be)221
3416 y(compiled)j(using)e Fn(C++)i(classes)i Fs(or)d
Fn(namespaces)i Fs(to)e(r)n(epr)n(esent)e(IDL)i Fn(modules)g
Fs(depending)221 3529 y(on)e(the)g(availability)k(of)d(namespace)f
(support)f(in)i(the)f(compiler)-7 b(.)362 3643 y(omniORB)34
b(r)n(elies)g(on)g(the)f(native)h(thr)n(ead)f(libraries)i(to)f(pr)n
(ovide)f(the)g(multithr)n(eading)221 3756 y(capability)-10
b(.)48 b(A)28 b(small)i(class)f(library)h(\(omnithr)n(ead)f([Ric96b)r
(]\))g(is)g(used)e(to)h(encapsulate)g(the)221 3869 y(\(possibly)20
b(dif)n(fer)n(ent\))g(APIs)e(of)i(the)g(native)g(thr)n(ead)f
(libraries.)28 b(In)20 b(application)h(code,)e(it)h(is)g(r)n(ec-)221
3982 y(ommended)j(but)i(not)f(mandatory)g(to)g(use)f(this)i(class)g
(library)g(for)g(thr)n(ead)f(management.)34 b(It)221
4095 y(should)22 b(be)h(easy)g(to)f(port)g(omnithr)n(ead)h(to)f(any)h
(platform)h(that)f(either)f(supports)e(the)j(POSIX)221
4208 y(thr)n(ead)f(standar)n(d)g(or)h(has)f(a)h(thr)n(ead)g(package)f
(that)g(supports)e(similar)k(capabilities.)221 4468 y
Fk(1.1.4)99 b(Missing)26 b(features)221 4647 y Fs(omniORB)f(is)g(not)f
(\(yet\))g(a)h(complete)f(implementation)h(of)g(the)f(CORBA)h(2.3)g
(cor)n(e.)34 b(The)24 b(fol-)221 4760 y(lowing)f(is)f(a)i(list)e(of)h
(the)f(missing)g(featur)n(es.)358 4977 y Fp(\017)45 b
Fs(omniORB)24 b(does)e(not)g(have)i(its)f(own)g(Interface)g(Repository)
-10 b(.)27 b(However)-7 b(,)22 b(it)i(can)g(act)g(as)448
5090 y(a)g(client)f(to)f(an)h(IR.)358 5281 y Fp(\017)45
b Fs(The)21 b(IDL)g(types)f(wchar)-7 b(,)22 b(wstring,)f(\002xed,)f
(and)i(valuetype)e(ar)n(e)i(not)f(supported)d(in)k(this)448
5394 y(r)n(elease.)p eop
%%Page: 3 11
3 10 bop 63 282 a Fg(1.2.)51 b(SETTING)21 b(UP)h(YOUR)h(ENVIRONMENT)
1497 b Fs(3)199 539 y Fp(\017)46 b Fs(The)22 b Ff(PortableServer)o(::C)
o(ur)o(re)o(nt)16 b Fs(interface)23 b(is)g(not)f(yet)f(supported.)199
715 y Fp(\017)46 b Fs(The)34 b(DSI)h(interface)h(has)f(changed)g
(signi\002cantly)-10 b(.)65 b(Old)36 b(code)f(will)h(have)g(to)e(be)h
(r)n(e-)290 827 y(written)g(to)h(the)f(new)h(interface.)69
b(Ther)n(e)35 b(is)h(no)g(support)e(for)j(using)e(the)h(DSI)g(with)290
940 y(the)e(BOA.)h(This)g(part)g(of)g(the)f(ORB)h(is)h(incomplete,)h
(since)e(it)h(depends)c(in)k(part)f(on)290 1053 y Ff(PortableServer:)o
(:C)o(ur)o(re)o(nt)o Fs(.)22 b(See)d(chapter)h(12)h(for)g(a)g(way)f(to)
g(workar)n(ound)f(this)290 1166 y(pr)n(oblem)k(for)f(now)-8
b(.)204 1344 y(These)31 b(featur)n(es)h(may)h(be)g(implemented)f(in)h
(the)f(short)g(to)g(medium)h(term.)58 b(It)32 b(is)h(best)63
1457 y(to)38 b(check)h(out)f(the)h(latest)f(status)g(on)h(the)f
(omniORB)i(home)e(page)h(\()p Ff(http://www.uk.)63 1570
y(research.att.c)o(om)o(/o)o(mni)o(OR)o(B/)o Fs(\).)63
1862 y Fq(1.2)119 b(Setting)29 b(Up)h(Y)-9 b(our)30 b(Environment)63
2073 y Fs(At)23 b(A)-7 b(T&T)23 b(Laboratories)g(Cambridge,)h(you)f
(should)g(use)g(the)g(OMNI)g(Development)g(Envi-)63 2186
y(r)n(onment)i(\(ODE\))i([Ric96a)r(])f(and)g(the)g(OMNI)f(tr)n(ee)h
(version)f(5.0)i(or)e(above)i(to)e(compile)i(your)63
2299 y(pr)n(ograms.)f(If)20 b(this)g(is)g(the)g(case,)g(ther)n(e)g(is)g
(no)g(extra)f(setup)g(you)g(have)i(to)e(do)h(other)f(than)h(those)63
2412 y(described)h(in)i(the)f(ODE)h(documentation.)204
2525 y(If)g(you)e(ar)n(e)j(r)o(unning)e(omniORB)h(at)g(other)f(sites,)f
(you)h(\(or)h(your)e(system)g(administrator\))63 2638
y(should)g(install)j(omniORB)f(by)f(following)h(the)f(instr)o(uctions)g
(in)h(the)f(installation)h(notes.)199 2815 y Fp(\017)46
b Fs(On)18 b(Unix)g(platforms,)h(the)e(omniORB)h(r)o(untime)g(looks)f
(for)h(the)f(envir)n(onment)h(variable)290 2928 y Ff(OMNIORB_CONFIG)p
Fs(.)i(If)f(this)g(variable)i(is)e(de\002ned,)f(it)h(contains)g(the)f
(pathname)h(of)g(the)290 3041 y(omniORB)25 b(con\002guration)g(\002le.)
35 b(If)26 b(the)e(variable)j(is)f(not)e(set,)g(omniORB)i(will)g(use)e
(the)290 3154 y(compiled-in)f(pathname)g(to)f(locate)h(the)e(\002le.)
199 3330 y Fp(\017)46 b Fs(On)19 b(ARM/A)-7 b(TMos,)17
b(the)h(omniORB)g(r)o(untime)h(looks)e(for)h(con\002guration)g
(information)290 3443 y(in)23 b(the)f(\002le)h Ff(omniORB.cfg)p
Fs(.)199 3619 y Fp(\017)46 b Fs(On)29 b(W)-5 b(in32)29
b(platforms)g(\(W)-5 b(indows)27 b(NT)-7 b(,)28 b(2000,)j(95,)g(98\),)g
(omniORB)d(\002rst)g(checks)f(the)290 3732 y(envir)n(onment)c(variable)
i Ff(OMNIORB_CONFIG)18 b Fs(to)k(obtain)i(the)f(pathname)g(of)h(the)e
(con-)290 3845 y(\002guration)i(\002le.)35 b(If)24 b(this)h(is)g(not)f
(set,)g(it)h(then)f(attempts)f(to)h(obtain)h(con\002guration)f(data)290
3958 y(in)i(the)f(system)f(r)n(egistry)-10 b(.)37 b(It)25
b(sear)n(ches)g(for)h(the)f(data)h(under)f(the)g(key)f
Ff(HKEY_LOCAL_)290 4071 y(MACHINE\\SOFTWAR)o(E\\)o(OR)o(L\\)o(om)o(niO)
o(RB)o(\\2)o(.0)o Fs(.)204 4248 y(The)f(con\002guration)g(\002le)g(is)h
(used)e(to)h(obtain)h(an)g(object)g(r)n(efer)n(ence)e(for)i(the)f
(Naming)h(Ser)n(-)63 4361 y(vice,)19 b(via)g(either)e(a)h
(stringi\002ed)e(IOR)i(or)f(an)h(Inter)n(operable)f(Naming)h(Service)f
(URI.)g(The)g(entry)63 4474 y(in)23 b(the)f(con\002guration)g(\002le)g
(should)g(be)g(speci\002ed)g(in)h(the)f(form:)226 4652
y Ff(ORBInitRef)50 b(NameService=<UR)o(I)f(for)k(the)g(Naming)f
(Service>)204 4829 y Fs(The)23 b(easiest)g(way)i(of)f(specifying)f(the)
h(Naming)g(Service)h(is)f(with)g(a)h Ff(corbaname:)20
b Fs(URI,)63 4942 y(as)i(described)g(in)h(section)f(4.1.2.)204
5055 y(Comments)g(in)h(the)f(con\002guration)g(\002le)g(should)g(be)h
(pr)n(e\002xed)e(with)h(a)h(`)p Ff(#)p Fs(')g(character)-7
b(.)204 5168 y(On)24 b(W)-5 b(in32)25 b(platforms,)f(the)f(naming)i
(service)e(r)n(efer)n(ence)h(can)g(be)g(placed)g(in)g(the)f(system)63
5281 y(r)n(egistry)-10 b(,)16 b(in)i(the)e(\(string\))h(value)h
Ff(ORBInitRef)p Fs(,)13 b(under)j(the)h(key)f Ff(HKEY_LOCAL_MAC)o(HI)o
(NE)o(\\)63 5394 y(SOFTWARE\\ORL\\o)o(mn)o(iO)o(RB\\)o(2.)o(0)p
Fs(.)p eop
%%Page: 4 12
4 11 bop 221 282 a Fs(4)1931 b Fg(CHAPTER)22 b(1.)51
b(INTRODUCTION)221 539 y Fk(1.2.1)99 b(Deprecated)24
b(con\002guration)i(\002le)f(entries)221 720 y Ff(ORBInitRef)k
Fs(is)34 b(new)g(with)f(omniORB)h(3.0.)62 b(The)33 b(omniORB)h(2)g
(formats)g(ar)n(e)g(still)h(sup-)221 833 y(ported,)21
b(so)g(you)h(can)i(specify)e(the)f(Naming)i(Service)g(IOR)g(using)f(a)h
(line)g(of)f(the)g(form:)385 1058 y Ff(NAMESERVICE)49
b(<IOR)k(for)g(the)g(Naming)f(Service>)362 1282 y Fs(Since)24
b(2.6.0,)f(two)g(other)f(entries)f(have)j(been)e(supported,)f(but)h(ar)
n(e)i(now)f(made)g(obsolete)221 1395 y(by)g(the)f(Inter)n(operable)f
(Naming)i(Service)f(URIs:)385 1620 y Ff(ORBInitialHost)48
b(<hostname)i(string>)385 1733 y(ORBInitialPort)e(<port)k(number)g
(\(1-65535\)>)362 1956 y Fs(The)19 b(corr)n(esponding)e(entries)h
(under)h(the)f(W)-5 b(in32)21 b(system)c(r)n(egistry)h(ar)n(e)i(the)f
(keys)e(named)221 2069 y Ff(ORBInitialHost)g Fs(and)22
b Ff(ORBInitialPort)p Fs(.)362 2184 y(The)i(two)f(entries)g(pr)n(ovide)
h(information)g(to)g(the)f(ORB)h(to)g(locate)g(a)h(\(pr)n(oprietary\))e
(boot-)221 2297 y(strap)30 b(service)f(at)i(r)o(untime.)50
b(The)29 b(bootstrap)g(service)h(is)g(able)h(to)f(r)n(eturn)f(the)g
(initial)j(object)221 2410 y(r)n(efer)n(ence)22 b(for)h(the)f(Naming)g
(Service)h(and)g(others.)221 2722 y Fq(1.3)119 b(Platform)29
b(speci\002c)h(variables)221 2937 y Fs(T)-8 b(o)27 b(compile)g(omniORB)
h(pr)n(ograms)e(corr)n(ectly)-10 b(,)28 b(several)f(C++)i(pr)n(epr)n
(ocessor)24 b(de\002nes)i Fn(must)221 3050 y Fs(be)d(speci\002ed)e(to)h
(identify)g(the)g(tar)n(get)g(platform.)p 221 3287 3849
4 v 219 3400 4 113 v 271 3366 a(Platform)p 1187 3400
V 615 w(CPP)h(de\002nes)p 4068 3400 V 221 3404 3849 4
v 219 3517 4 113 v 271 3483 a(Sun)f(Solaris)h(2.5)p 1187
3517 V 383 w Ff(__sparc__)160 b(__sunos__)214 b(__OSVERSION__=5)p
4068 3517 V 219 3630 V 271 3596 a Fs(Digital)24 b(Unix)f(3.2)p
1187 3630 V 336 w Ff(__alpha__)160 b(__osf1__)269 b(__OSVERSION__=3)p
4068 3630 V 219 3742 V 271 3709 a Fs(HPUX)22 b(10.x)p
1187 3742 V 522 w Ff(__hppa__)215 b(__hpux__)269 b(__OSVERSION__=1)o(0)
p 4068 3742 V 219 3855 V 271 3821 a Fs(HPUX)22 b(1)-5
b(1.x)p 1187 3855 V 527 w Ff(__hppa__)215 b(__hpux__)269
b(__OSVERSION__=1)o(1)p 4068 3855 V 219 3968 V 271 3934
a Fs(IBM)22 b(AIX)g(4.x)p 1187 3968 V 472 w Ff(__aix__)270
b(__powerpc__)104 b(__OSVERSION__=4)p 4068 3968 V 219
4081 V 271 4047 a Fs(Linux)22 b(2.0)i(\(x86\))p 1187
4081 V 374 w Ff(__x86__)270 b(__linux__)214 b(__OSVERSION__=2)p
4068 4081 V 219 4194 V 271 4160 a Fs(Linux)22 b(2.0)i(\(alpha\))p
1187 4194 V 287 w Ff(__alpha__)160 b(__linux__)214 b(__OSVERSION__=2)p
4068 4194 V 219 4307 V 271 4273 a Fs(Linux)22 b(2.0)i(\(powerpc\))p
1187 4307 V 155 w Ff(__powerpc__)50 b(__linux__)214 b(__OSVERSION__=2)p
4068 4307 V 219 4420 V 271 4386 a Fs(W)-5 b(indows/NT)21
b(3.5)p 1187 4420 V 260 w Ff(__x86__)270 b(__NT__)379
b(__OSVERSION__=3)102 b(__WIN32__)p 4068 4420 V 219 4533
V 271 4499 a Fs(W)-5 b(indows/NT)21 b(4.0)p 1187 4533
V 260 w Ff(__x86__)270 b(__NT__)379 b(__OSVERSION__=4)102
b(__WIN32__)p 4068 4533 V 219 4646 V 271 4612 a Fs(W)-5
b(indows/95)p 1187 4646 V 436 w Ff(__x86__)270 b(__WIN32__)p
4068 4646 V 219 4759 V 271 4725 a Fs(OpenVMS)22 b(6.x)g(\(alpha\))p
1187 4759 V 101 w Ff(__alpha__)160 b(__vms)434 b(__OSVERSION__=6)p
4068 4759 V 219 4872 V 271 4838 a Fs(OpenVMS)22 b(6.x)g(\(vax\))p
1187 4872 V 182 w Ff(__vax__)270 b(__vms)434 b(__OSVERSION__=6)p
4068 4872 V 219 4984 V 271 4951 a Fs(SGI)22 b(Irix)h(6.x)p
1187 4984 V 519 w Ff(__mips__)215 b(__irix__)269 b(__OSVERSION__=6)p
4068 4984 V 219 5097 V 271 5063 a Fs(Reliant)23 b(Unix)g(5.43)p
1187 5097 V 281 w Ff(__mips__)215 b(__SINIX__)f(__OSVERSION__=5)p
4068 5097 V 219 5210 V 271 5176 a Fs(A)-7 b(TMos)22 b(4.0)p
1187 5210 V 537 w Ff(__arm__)270 b(__atmos__)214 b(__OSVERSION__=4)p
4068 5210 V 219 5323 V 271 5289 a Fs(NextStep)20 b(3.x)p
1187 5323 V 458 w Ff(__m68k__)215 b(__nextstep__)49 b(__OSVERSION__=3)p
4068 5323 V 219 5436 V 271 5402 a Fs(Unixwar)n(e)23 b(7)p
1187 5436 V 503 w Ff(__x86__)270 b(__uw7__)324 b(__OSVERSION__=5)p
4068 5436 V 221 5439 3849 4 v eop
%%Page: 5 13
5 12 bop 63 282 a Fg(1.3.)51 b(PLA)-7 b(TFORM)22 b(SPECIFIC)f(V)-10
b(ARIABLES)1607 b Fs(5)204 539 y(The)22 b(pr)n(epr)n(ocessor)e
(de\002nes)h(for)h(new)g(platform)h(ports)e(not)h(listed)g(above)g(can)
i(be)e(found)63 652 y(in)k(the)g(corr)n(esponding)e(platform)i
(con\002guration)g(\002les.)38 b(For)26 b(instance,)g(the)g(platform)g
(con-)63 764 y(\002guration)21 b(\002le)i(for)f(Sun)g(Solaris)g(2.6)h
(is)g(in)g Ff(mk/platforms/s)o(un)o(4_)o(sos)o(V_)o(5.)o(6.)o(mk)o
Fs(.)f(The)63 877 y(pr)n(epr)n(ocessor)37 b(de\002nes)g(to)i(identify)g
(a)h(platform)g(ar)n(e)f(in)h(the)f(make)g(variable)j
Ff(IMPORT_)63 990 y(CPPFLAGS)p Fs(.)204 1103 y(In)26
b(a)h(single)f(sour)n(ce)f(multi-tar)n(get)i(envir)n(onment,)f(you)g
(can)h(put)f(the)f(pr)n(epr)n(ocessor)f(de-)63 1216 y(\002nes)e(as)h
(the)f(command-line)j(ar)n(guments)d(for)h(the)f(compiler)-7
b(.)30 b(Alternately)-10 b(,)22 b(you)g(could)h(cr)n(e-)63
1329 y(ate)c(a)i(sitedef.h)d(\002le)i(in)h(the)e(same)h(dir)n(ectory)f
(as)h Ff(omniORB3/CORBA.)o(h)p Fs(.)h(W)-7 b(rite)20
b(into)f(the)g(\002le)63 1442 y(the)i(appr)n(opriate)h(set)g(of)h(pr)n
(epr)n(ocessor)d(de\002nes)h(and)h(add)204 1591 y Fe(#include)48
b(<omniORB3)n(/sitedef)o(.h>)63 1754 y Fs(at)22 b(the)g(beginning)h(of)
f Ff(omniORB3/CORBA_)o(sy)o(sde)o(p.)o(h)p Fs(.)p eop
%%Page: 6 14
6 13 bop 221 282 a Fs(6)1931 b Fg(CHAPTER)22 b(1.)51
b(INTRODUCTION)p eop
%%Page: 7 15
7 14 bop 63 1172 a Fm(Chapter)44 b(2)63 1597 y Fo(The)52
b(Basics)63 2052 y Fs(In)31 b(this)h(chapter)-7 b(,)34
b(we)e(go)f(thr)n(ough)g(thr)n(ee)g(examples)g(to)h(illustrate)g(the)f
(practical)j(steps)c(to)63 2165 y(use)i(omniORB.)g(By)g(going)g(thr)n
(ough)g(the)g(sour)n(ce)g(code)g(of)h(each)g(example,)i(the)d
(essential)63 2278 y(concepts)d(and)j(APIs)e(ar)n(e)h(intr)n(oduced.)52
b(If)31 b(you)g(have)g(no)g(pr)n(evious)f(experience)g(with)h(us-)63
2391 y(ing)e(CORBA,)f(you)h(should)f(study)f(this)h(chapter)h(in)g
(detail.)48 b(Ther)n(e)28 b(ar)n(e)h(pointers)e(to)i(other)63
2504 y(essential)21 b(documents)g(you)h(should)g(be)g(familiar)k(with.)
204 2627 y(If)c(you)f(have)h(experience)e(with)i(using)f(other)g(ORBs,)
g(you)g(should)g(still)h(go)f(thr)n(ough)g(this)63 2740
y(chapter)34 b(because)h(it)g(pr)n(ovides)f(important)h(information)g
(about)g(the)f(featur)n(es)h(and)g(APIs)63 2853 y(that)25
b(ar)n(e)i(necessarily)e(omniORB)h(speci\002c.)38 b(Now)25
b(that)h(omniORB)g(supports)d(the)j(Portable)63 2966
y(Object)d(Adapter)-7 b(,)21 b(ther)n(e)h(ar)n(e)h(very)f(few)g
(omniORB)h(speci\002c)g(details.)63 3327 y Fq(2.1)119
b(The)29 b(Echo)i(Object)e(Example)63 3559 y Fs(Our)f(example)f(is)h
(an)g(object)g(which)g(has)g(only)f(one)g(method.)41
b(The)27 b(method)g(simply)g(echos)63 3672 y(the)21 b(ar)n(gument)i
(string.)k(W)-8 b(e)21 b(have)i(to:)176 3936 y(1.)46
b(de\002ne)21 b(the)h(object)g(interface)h(in)g(IDL;)176
4165 y(2.)46 b(use)22 b(the)f(IDL)i(compiler)g(to)f(generate)e(the)i
(stub)g(code)2162 4132 y Fl(1)2199 4165 y Fs(;)176 4394
y(3.)46 b(pr)n(ovide)22 b(the)g Fr(servant)i Fs(object)f
(implementation;)176 4622 y(4.)46 b(write)22 b(the)g(client)h(code.)204
4886 y(The)33 b(sour)n(ce)h(code)f(of)h(this)g(example)g(is)g(included)
g(in)g(the)f(last)i(section)e(of)h(this)g(chap-)63 4999
y(ter)-7 b(.)56 b(A)32 b(make\002le)g(written)f(to)h(be)g(used)f(under)
g(the)h(OMNI)g(Development)f(Envir)n(onment)63 5112 y(\(ODE\))23
b([Ric96a)r(])g(is)g(also)g(included.)p 63 5215 1316
4 v 168 5271 a Fj(1)197 5302 y Fi(The)h(stub)h(code)e(is)h(the)h(C++)f
(code)g(that)i(pr)o(ovides)c(the)i(object)h(mapping)g(as)f(de\002ned)f
(in)i(the)g(CORBA)e(2.3)63 5394 y(speci\002cation.)1684
5622 y Fs(7)p eop
%%Page: 8 16
8 15 bop 221 282 a Fs(8)2138 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)221 539 y Fq(2.2)119 b(Specifying)30
b(the)g(Echo)g(interface)e(in)i(IDL)221 750 y Fs(W)-8
b(e)22 b(de\002ne)f(an)i(object)g(interface,)f(called)i
Ff(Echo)p Fs(,)c(as)j(follows:)362 886 y Fe(interface)48
b(Echo)h({)562 985 y(string)f(echoString)n(\(in)i(string)e(mesg\);)362
1085 y(};)362 1234 y Fs(If)18 b(you)g(ar)n(e)g(new)g(to)f(IDL,)h(you)f
(can)i(learn)g(about)f(its)g(syntax)f(in)i(Chapter)f(3)g(of)h(the)e
(CORBA)221 1347 y(speci\002cation)31 b(2.3)g([OMG99)r(].)51
b(For)29 b(the)h(moment,)h(you)f(only)g(need)f(to)g(know)h(that)g(the)f
(in-)221 1460 y(terface)f(consists)e(of)i(a)g(single)f(operation,)h
Ff(echoString\(\))p Fs(,)23 b(which)28 b(takes)f(a)h(string)f(as)h(an)
221 1573 y(ar)n(gument)22 b(and)h(r)n(eturns)e(a)j(copy)d(of)i(the)f
(same)g(string.)362 1686 y(The)33 b(interface)h(is)f(written)g(in)g(a)h
(\002le,)i(called)f Ff(echo.idl)p Fs(.)56 b(It)33 b(is)h(part)f(of)g
(the)g(CORBA)221 1799 y(standar)n(d)c(that)g(all)h(IDL)f(\002les)g
(should)f(have)h(the)g(extension)e(`)p Ff(.idl)p Fs(',)i(although)g
(omniORB)221 1912 y(does)34 b(not)g(enfor)n(ce)h(this.)65
b(If)35 b(you)f(ar)n(e)i(using)e(ODE,)h(the)g(IDL)f(\002les)h(should)f
(be)h(placed)h(in)221 2025 y(the)30 b Ff(idl)e Fs(dir)n(ectory)i(of)g
(your)f(export)f(tr)n(ee.)50 b(This)30 b(is)g(done)f(so)h(that)f(the)h
(stub)f(code)h(will)h(be)221 2138 y(generated)21 b(automatically)j(and)
e(kept)g(up-to-date)f(with)h(your)g(IDL)g(\002le.)362
2251 y(For)d(simplicity)-10 b(,)20 b(the)f(interface)g(is)h(de\002ned)d
(in)j(the)e(global)i(IDL)f(namespace.)27 b(Y)-8 b(ou)18
b(should)221 2363 y(avoid)k(this)e(practice)i(for)f(the)f(sake)g(of)h
(object)g(r)n(eusability)-10 b(.)27 b(If)21 b(every)f(CORBA)h
(developer)f(de-)221 2476 y(\002nes)e(their)g(interfaces)g(in)g(the)g
(global)h(IDL)f(namespace,)h(ther)n(e)e(is)i(a)g(danger)e(of)h(name)h
(clashes)221 2589 y(between)32 b(two)g(independently)f(de\002ned)g
(interfaces.)59 b(Ther)n(efor)n(e,)35 b(it)e(is)h(better)d(to)i
(qualify)221 2702 y(your)27 b(interfaces)h(by)h(de\002ning)e(them)h
(inside)g Ff(module)d Fs(names.)45 b(Of)29 b(course,)f(this)g(does)f
(not)221 2815 y(eliminate)k(the)f(chance)h(of)f(a)h(name)g(clash)g
(unless)e(some)g(form)i(of)f(naming)h(convention)f(is)221
2928 y(agr)n(eed)22 b(globally)-10 b(.)28 b(Nevertheless,)20
b(a)j(well-chosen)f(module)g(name)h(can)h(help)e(a)h(lot.)221
3220 y Fq(2.3)119 b(Generating)29 b(the)g(C++)i(stubs)221
3431 y Fs(Fr)n(om)g(the)f(IDL)g(\002le,)i(we)f(use)e(the)h(IDL)g
(compiler)i(to)e(pr)n(oduce)f(the)h(C++)h(mapping)g(of)g(the)221
3544 y(interface.)54 b(The)31 b(IDL)g(compiler)g(for)g(omniORB)h(is)f
(called)h(omniidl.)55 b(Given)32 b(the)e(IDL)h(\002le,)221
3657 y(omniidl)36 b(pr)n(oduces)e(two)g(stub)h(\002les:)53
b(a)36 b(C++)g(header)e(\002le)h(and)h(a)f(C++)h(sour)n(ce)f(\002le.)66
b(For)221 3769 y(example,)22 b(fr)n(om)i(the)d(\002le)i
Ff(echo.idl)p Fs(,)c(the)j(following)h(\002les)f(ar)n(e)h(pr)n(oduced:)
358 3942 y Fp(\017)45 b Ff(echo.hh)358 4086 y Fp(\017)g
Ff(echoSK.cc)221 4258 y Fs(omniidl)20 b(must)f(be)h(invoked)e(with)i
(the)e Ff(-bcxx)g Fs(ar)n(gument)h(to)f(tell)i(it)g(to)f(generate)e
(C++)j(stubs.)221 4371 y(The)i(following)h(command)g(line)g(generates)e
(the)g(stubs)h(for)g Ff(echo.idl)p Fs(:)362 4507 y Fe(omniidl)49
b(-bcxx)g(echo.idl)221 4657 y Fs(If)26 b(you)e(ar)n(e)i(using)f(our)g
(make)h(envir)n(onment)f(\(ODE\),)h(you)e(don't)h(need)f(to)h(invoke)g
(omniidl)221 4769 y(explicitly)-10 b(.)28 b(In)23 b(the)f(example)g
(\002le)h Ff(dir.mk)p Fs(,)c(we)k(have)g(the)e(following)i(line:)362
4906 y Fe(CORBA_INTERFACES)47 b(=)j(echo)221 5055 y Fs(That)28
b(is)h(all)g(we)f(need)f(to)h(instr)o(uct)g(ODE)g(to)g(generate)e(the)i
(stubs.)43 b(Remember)-7 b(,)29 b(you)f(won't)221 5168
y(\002nd)18 b(the)g(stubs)g(in)h(your)f(working)f(dir)n(ectory)h
(because)g(all)i(stubs)e(ar)n(e)h(written)f(into)g(the)g
Ff(stub)221 5281 y Fs(dir)n(ectory)k(at)h(the)e(top)h(level)h(of)g
(your)e(build)j(tr)n(ee.)362 5394 y(The)e(full)i(ar)n(guments)e(to)g
(omniidl)h(ar)n(e)g(detailed)f(in)h(chapter)f(5.)p eop
%%Page: 9 17
9 16 bop 63 282 a Fg(2.4.)51 b(OBJECT)23 b(REFERENCES)c(AND)k(SER)-5
b(V)-10 b(ANTS)1389 b Fs(9)63 539 y Fq(2.4)119 b(Object)29
b(References)f(and)i(Servants)63 751 y Fs(W)-8 b(e)22
b(contact)h(a)g(CORBA)g(object)f(thr)n(ough)g(an)h Fr(object)h(r)n
(efer)n(ence)p Fs(.)31 b(The)23 b(actual)h(implementation)63
864 y(of)e(a)h(CORBA)g(object)g(is)f(termed)f(a)j Fr(servant)p
Fs(.)204 978 y(Object)31 b(r)n(efer)n(ences)e(and)i(servants)e(ar)n(e)i
(quite)f(separate)f(entities,)i(and)g(it)f(is)h(important)63
1090 y(not)e(to)h(confuse)f(the)h(two.)50 b(Client)31
b(code)e(deals)h(pur)n(ely)g(with)g(object)g(r)n(efer)n(ences,)h(so)f
(ther)n(e)63 1203 y(can)23 b(be)g(no)g(confusion;)g(object)f
(implementation)h(code)g(must)f(deal)h(with)g(both)f(object)h(r)n(efer)
n(-)63 1316 y(ences)j(and)h(servants.)39 b(omniORB)28
b(3)f(uses)f(distinct)g(C++)i(types)d(for)i(object)g(r)n(efer)n(ences)f
(and)63 1429 y(servants,)f(so)g(the)g(compiler)h(will)h(complain)f(if)h
(you)e(use)f(a)j(servant)e(when)g(an)h(object)f(r)n(efer)n(-)63
1542 y(ence)d(is)g(expected,)f(or)h(vice-versa.)p 63
1650 3289 17 v 1529 1754 a Fn(W)-7 b(arning)199 1904
y Fs(omniORB)22 b(2)g Fr(did)h(not)f Fs(use)e(distinct)i(types)d(for)j
(object)f(r)n(efer)n(ences)g(and)h(servants,)e(and)199
2017 y(often)31 b(accepted)f(a)i(pointer)e(to)h(a)h(servant)f(when)g
(the)f(CORBA)h(speci\002cation)h(says)199 2130 y(it)27
b(should)f(only)g(accept)h(an)h(object)e(r)n(efer)n(ence.)40
b(If)27 b(you)f(have)h(code)f(which)i(r)n(elies)f(on)199
2243 y(this,)34 b(it)e(will)i(not)e(compile)g(with)g(omniORB)h(3,)i
(even)c(under)g(omniORB)i(3's)f(BOA)199 2356 y(compatibility)24
b(mode.)p 63 2440 V 63 2745 a Fq(2.5)119 b(A)30 b(Quick)f(T)-13
b(our)29 b(of)h(the)g(C++)h(stubs)63 2957 y Fs(The)g(C++)i(stubs)f
(conform)g(to)g(the)g(mapping)g(de\002ned)f(in)h(the)g(CORBA)g(2.3)h
(speci\002cation)63 3070 y(\(chapter)28 b(23\).)48 b(It)28
b(is)h(important)f(to)g(understand)f(the)h(mapping)g(befor)n(e)h(you)f
(start)g(writing)63 3183 y(any)i(serious)f(CORBA)h(applications.)52
b(Befor)n(e)29 b(going)h(any)g(further)-7 b(,)31 b(it)g(is)f(worth)g
(knowing)63 3296 y(what)22 b(the)g(mapping)h(looks)e(like.)204
3410 y(For)33 b(the)g(example)h(interface)h Ff(Echo)p
Fs(,)g(the)e(C++)i(mapping)f(for)g(its)g(object)g(r)n(efer)n(ence)f(is)
63 3523 y Ff(Echo_ptr)p Fs(.)45 b(The)28 b(type)g(is)i(de\002ned)e(in)i
Ff(echo.hh)p Fs(.)45 b(The)29 b(r)n(elevant)h(section)e(of)i(the)f
(code)f(is)63 3636 y(r)n(epr)n(oduced)j(below)-8 b(.)57
b(The)32 b(stub)g(code)g(pr)n(oduced)f(by)i(other)e(ORBs)h(will)i(be)f
(functionally)63 3748 y(equivalent)22 b(to)g(omniORB's,)h(but)f(will)i
(almost)f(certainly)g(look)f(very)g(dif)n(fer)n(ent.)204
3899 y Fe(class)49 b(Echo)o(;)204 3999 y(class)g(_objref_Echo)m(;)204
4099 y(class)g(_impl_Echo)n(;)204 4198 y(typedef)f(_objref_Echo)n(*)i
(Echo_ptr)n(;)204 4397 y(class)f(Echo)g({)204 4497 y(public)o(:)303
4597 y Fd(//)h(Declarations)d(for)j(this)f(interface)f(type)o(.)303
4696 y Fe(typedef)h(Echo_ptr)f(_ptr_type)o(;)303 4796
y(typedef)h(Echo_var)f(_var_type)o(;)303 4995 y(static)h(_ptr_type)f
(_duplicate)n(\(_ptr_type)o(\);)303 5095 y(static)h(_ptr_type)f
(_narrow)o(\(CORBA)o(::)o(Object_ptr)o(\);)303 5194 y(static)h
(_ptr_type)f(_nil\(\);)303 5394 y Fd(//)i(...)f(methods)g(generated)f
(for)h(internal)f(use)p eop
%%Page: 10 18
10 17 bop 221 282 a Fs(10)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)362 539 y Fe(};)362 738 y(class)49
b(_objref_Echo)f(:)462 837 y(public)h(virtual)f(CORBA)o(::Object)o(,)h
(public)g(virtual)g(omniObjRef)e({)362 937 y(public)o(:)462
1037 y(char)i(*)h(echoString)n(\(const)e(char*)h(mesg\);)462
1236 y Fd(//)g(...)h(methods)e(generated)g(for)i(internal)e(use)362
1336 y Fe(};)362 1488 y Fs(In)22 b(a)g(compliant)h(application,)g(the)e
(operations)f(de\002ned)g(in)i(an)g(object)g(interface)g(should)221
1601 y Fn(only)j Fs(be)h(invoked)g(via)h(an)g(object)f(r)n(efer)n
(ence.)37 b(This)26 b(is)h(done)d(by)j(using)e(arr)n(ow)h(\(`)p
Ff(->)p Fs('\))h(on)f(an)221 1714 y(object)g(r)n(efer)n(ence.)36
b(For)25 b(example,)h(the)f(call)j(to)d(the)g(operation)g
Ff(echoString\(\))20 b Fs(would)25 b(be)221 1827 y(written)d(as)h
Ff(obj->echoStrin)o(g\()o(me)o(sg)o(\))p Fs(.)362 1940
y(It)28 b(should)g(be)h(noted)e(that)i(the)f(concr)n(ete)g(type)f(of)i
(an)g(object)g(r)n(efer)n(ence)f(is)h(opaque,)g(i.e.)221
2053 y(you)18 b(must)g(not)g(make)h(any)g(assumption)f(about)g(how)h
(an)g(object)f(r)n(efer)n(ence)h(is)f(implemented.)221
2166 y(In)28 b(our)f(example,)i(even)e(though)f Ff(Echo_ptr)f
Fs(is)j(implemented)e(as)i(a)h(pointer)d(to)i(the)f(class)221
2279 y Ff(_objref_Echo)p Fs(,)18 b(it)24 b(should)f(not)f(be)i(used)e
(as)h(a)i(C++)f(pointer)-7 b(,)22 b(i.e.)31 b(conversion)23
b(to)f Ff(void*)p Fs(,)221 2392 y(arithmetic)28 b(operations,)f(and)h
(r)n(elational)h(operations,)e(including)h(test)e(for)h(equality)h
(using)221 2505 y Ff(operator==)18 b Fs(must)k(not)g(be)h(performed)e
(on)h(the)g(type.)362 2617 y(In)j(addition)f(to)g(class)h
Ff(_objref_Echo)p Fs(,)20 b(the)k(mapping)h(de\002nes)e(thr)n(ee)g
(static)i(member)221 2730 y(functions)d(in)i(the)d(class)i
Ff(Echo)p Fs(:)k Ff(_nil\(\))p Fs(,)19 b Ff(_duplicate\(\))p
Fs(,)e(and)23 b Ff(_narrow\(\))p Fs(.)362 2843 y(The)28
b Ff(_nil\(\))e Fs(function)j(r)n(eturns)e(a)i(nil)h(object)e(r)n(efer)
n(ence)g(of)h(the)f(Echo)g(interface.)46 b(The)221 2956
y(following)23 b(call)i(is)d(guaranteed)f(to)h(r)n(eturn)g(TRUE:)362
3096 y Fe(CORBA)o(::Boolean)48 b(true_result)g(=)i(CORBA)o(::is_nil)n
(\(Echo::)o(_nil)o(\(\)\);)362 3248 y Fs(Remember)-7
b(,)21 b Ff(CORBA::is_nil\()o(\))15 b Fs(is)21 b(the)f(only)g
(compliant)i(way)f(to)f(check)g(if)i(an)f(object)221
3361 y(r)n(efer)n(ence)h(is)h(nil.)29 b(Y)-8 b(ou)21
b(should)h(not)g(use)f(the)h(equality)h Ff(operator==)p
Fs(.)362 3474 y(The)32 b Ff(_duplicate\(\))c Fs(function)33
b(r)n(eturns)e(a)j(new)e(object)g(r)n(efer)n(ence)g(of)h(the)f
Ff(Echo)f Fs(in-)221 3587 y(terface.)38 b(The)25 b(new)g(object)h(r)n
(efer)n(ence)f(can)i(be)f(used)e(inter)n(changeably)j(with)e(the)h(old)
f(object)221 3700 y(r)n(efer)n(ence)d(to)g(perform)g(an)h(operation)f
(on)g(the)g(same)g(object.)362 3813 y(All)g(CORBA)f(objects)g(inherit)g
(fr)n(om)h(the)e(generic)h(object)g Ff(CORBA::Object)p
Fs(.)g Ff(CORBA::)221 3926 y(Object_ptr)32 b Fs(is)37
b(the)f(object)h(r)n(efer)n(ence)f(type)f(for)i Ff(CORBA::Object)p
Fs(.)65 b(Any)36 b Ff(_ptr)f Fs(ob-)221 4039 y(ject)29
b(r)n(efer)n(ence)g(is)g(ther)n(efor)n(e)e(conceptually)i(inherited)f
(fr)n(om)i Ff(CORBA::Object_p)o(tr)o Fs(.)41 b(In)221
4152 y(other)23 b(wor)n(ds,)h(an)h(object)f(r)n(efer)n(ence)g(such)h
(as)f Ff(Echo_ptr)d Fs(can)26 b(be)e(used)f(in)i(places)g(wher)n(e)e(a)
221 4265 y Ff(CORBA::Object_p)o(tr)16 b Fs(is)23 b(expected.)362
4378 y(The)35 b Ff(_narrow\(\))c Fs(function)36 b(takes)e(an)i(ar)n
(gument)f(of)h(type)e Ff(CORBA::Object_)o(pt)o(r)221
4490 y Fs(and)d(r)n(eturns)e(a)i(new)f(object)g(r)n(efer)n(ence)g(of)h
(the)e Ff(Echo)g Fs(interface.)52 b(If)30 b(the)g(actual)i(\(r)o
(untime\))221 4603 y(type)25 b(of)i(the)f(ar)n(gument)h(object)f(r)n
(efer)n(ence)g(can)i(be)f(widened)e(to)h Ff(Echo_ptr)p
Fs(,)e Ff(_narrow\(\))221 4716 y Fs(will)k(r)n(eturn)d(a)h(valid)i
(object)e(r)n(efer)n(ence.)37 b(Otherwise)25 b(it)i(will)g(r)n(eturn)e
(a)i(nil)g(object)f(r)n(efer)n(ence.)221 4829 y(Note)e(that)i
Ff(_narrow\(\))21 b Fs(performs)k(an)h(implicit)h(duplication)f(of)g
(the)f(object)g(r)n(efer)n(ence,)h(so)221 4942 y(the)e(r)n(esult)g
(must)h(be)f(r)n(eleased.)34 b(Note)23 b(also)i(that)g
Ff(_narrow\(\))c Fs(may)k(involve)h(a)f(r)n(emote)f(call)221
5055 y(to)f(check)g(the)f(type)g(of)h(the)g(object,)g(so)f(it)i(may)f
(thr)n(ow)g(CORBA)g(system)e(exceptions)h(such)h(as)221
5168 y Ff(COMM_FAILURE)p Fs(.)362 5281 y(T)-8 b(o)30
b(indicate)g(that)g(an)h(object)f(r)n(efer)n(ence)g(will)i(no)e(longer)
f(be)h(accessed,)h(you)f(must)f(call)221 5394 y(the)22
b Ff(CORBA::release\()o(\))16 b Fs(operation.)27 b(Its)22
b(signatur)n(e)g(is)g(as)h(follows:)p eop
%%Page: 11 19
11 18 bop 63 282 a Fg(2.5.)51 b(A)22 b(QUICK)h(T)n(OUR)g(OF)g(THE)e
(C++)j(STUBS)1486 b Fs(1)-5 b(1)204 539 y Fe(class)49
b(CORBA)g({)303 638 y(static)g(void)g(release)o(\(CORBA)o(::)o
(Object_ptr)f(obj\);)303 738 y(...)i Fd(//)f(other)g(methods)204
837 y Fe(};)204 999 y Fs(Once)22 b(you)g(have)g(called)h
Ff(CORBA::release\(\))15 b Fs(on)22 b(an)h(object)f(r)n(efer)n(ence,)f
(you)h(should)63 1112 y(no)31 b(longer)f(use)h(that)g(r)n(efer)n(ence.)
54 b(This)31 b(is)h(because)f(the)f(associated)h(r)n(esour)n(ces)f(may)
i(have)63 1225 y(been)i(deallocated.)64 b(Notice)34 b(that)h(we)f(ar)n
(e)h(r)n(eferring)g(to)f(the)g(r)n(esour)n(ces)f(associated)i(with)63
1338 y(the)c(object)h(r)n(efer)n(ence)f(and)h Fn(not)g(the)g(servant)h
(object)p Fs(.)57 b(Servant)31 b(objects)h(ar)n(e)g(not)f(af)n(fected)
63 1451 y(by)d(the)g(lifetimes)h(of)g(object)g(r)n(efer)n(ences.)45
b(In)28 b(particular)-7 b(,)32 b(servants)27 b(ar)n(e)j(not)e(deleted)e
(when)63 1564 y(all)j(r)n(efer)n(ences)d(to)h(them)g(have)h(been)e(r)n
(eleased\227CORBA)h(does)f(not)g(perform)h(distributed)63
1677 y(garbage)22 b(collection.)204 1789 y(As)31 b(described)f(above,)
35 b(the)c(equality)g Ff(operator==)d Fs(should)i(not)h(be)h(used)e(on)
i(object)63 1902 y(r)n(efer)n(ences.)60 b(T)-8 b(o)33
b(test)f(if)j(two)e(object)g(r)n(efer)n(ences)g(ar)n(e)h(equivalent,)j
(the)c(member)g(function)63 2015 y Ff(_is_equivalent)o(\(\))19
b Fs(of)25 b(the)f(generic)h(object)g Ff(CORBA::Object)19
b Fs(can)26 b(be)f(used.)34 b(Her)n(e)24 b(is)63 2128
y(an)f(example)f(of)h(its)f(usage:)204 2277 y Fe(Echo_ptr)48
b(A;)204 2376 y(...)597 b Fd(//)49 b(initialise)f(A)i(to)f(a)h(valid)f
(object)g(reference)204 2476 y Fe(Echo_ptr)f(B)i(=)f(A;)204
2575 y(CORBA)o(::)o(Boolean)g(true_result)f(=)h(A->_is_equivalent)m
(\(B\);)204 2675 y Fd(//)g(Note)o(:)h(the)f(above)g(call)g(is)h
(guaranteed)e(to)h(be)h(TRUE)204 2837 y Fs(Y)-8 b(ou)26
b(have)i(now)e(been)h(intr)n(oduced)f(to)h(most)f(of)i(the)e
(operations)g(that)h(can)h(be)f(invoked)63 2950 y(via)i
Ff(Echo_ptr)p Fs(.)42 b(The)27 b(generic)h(object)g Ff(CORBA::Object)23
b Fs(pr)n(ovides)k(a)i(few)f(mor)n(e)g(opera-)63 3062
y(tions)21 b(and)h(all)i(of)e(them)f(can)i(be)f(invoked)g(via)h
Ff(Echo_ptr)p Fs(.)h(These)d(operations)f(deal)i(mainly)63
3175 y(with)c(CORBA)-7 b('s)18 b(dynamic)h(interfaces.)26
b(Y)-8 b(ou)17 b(do)h(not)g(have)g(to)g(understand)e(them)i(in)h(or)n
(der)e(to)63 3288 y(use)23 b(the)h(C++)h(mapping)f(pr)n(ovided)f(via)j
(the)e(stubs.)31 b(For)24 b(details,)g(please)g(r)n(ead)g(the)g(CORBA)
63 3401 y(speci\002cation)e([OMG99)r(],)h(chapter)f(23.)204
3514 y(Since)i(object)f(r)n(efer)n(ences)g(must)g(be)g(r)n(eleased)g
(explicitly)-10 b(,)24 b(their)f(usage)g(is)g(pr)n(one)g(to)g(err)n(or)
63 3627 y(and)j(can)g(lead)g(to)f(memory)h(leakage.)37
b(The)25 b(mapping)h(de\002nes)e(the)h Fr(object)i(r)n(efer)n(ence)i
(variable)63 3740 y Fs(type)21 b(to)h(make)g(life)i(easier)-7
b(.)27 b(In)c(our)f(example,)g(the)g(variable)i(type)e
Ff(Echo_var)d Fs(is)j(de\002ned)3243 3707 y Fl(2)3279
3740 y Fs(.)204 3853 y(The)i Ff(Echo_var)d Fs(is)k(mor)n(e)f
(convenient)g(to)h(use)e(because)i(it)g(will)h(automatically)g(r)n
(elease)63 3966 y(its)34 b(object)h(r)n(efer)n(ence)f(when)g(it)h(is)g
(deallocated)g(or)f(when)g(assigned)g(a)h(new)g(object)f(r)n(efer)n(-)
63 4079 y(ence.)74 b(For)37 b(many)i(operations,)h(mixing)f(data)f(of)g
(type)f Ff(Echo_var)e Fs(and)j Ff(Echo_ptr)c Fs(is)63
4192 y(possible)27 b(without)g(any)i(explicit)f(operations)f(or)h
(castings)2158 4159 y Fl(3)2195 4192 y Fs(.)44 b(For)28
b(instance,)h(the)f(operation)63 4304 y Ff(echoString\(\))23
b Fs(can)30 b(be)e(called)i(using)e(the)g(arr)n(ow)h(\(`)p
Ff(->)p Fs('\))g(on)g(a)g Ff(Echo_var)p Fs(,)e(as)i(one)f(can)63
4417 y(do)22 b(with)g(a)h Ff(Echo_ptr)p Fs(.)204 4530
y(The)f(usage)f(of)i Ff(Echo_var)c Fs(is)k(illustrated)f(below:)204
4679 y Fe(Echo_var)48 b(a;)204 4778 y(Echo_ptr)g(p)i(=)f(...)h
Fd(//)f(somehow)g(obtain)f(an)i(object)e(reference)p
63 4938 1316 4 v 168 4994 a Fj(2)197 5026 y Fi(In)d(omniORB,)e(all)h
(object)g(r)o(efer)o(ence)e(variable)i(types)g(ar)o(e)f(instantiated)i
(fr)o(om)e(the)i(template)f(type)63 5117 y Fh(_CORBA_ObjRef_Var)p
Fi(.)168 5179 y Fj(3)197 5211 y Fi(However)-6 b(,)54
b(the)47 b(implementation)h(of)e(the)i(type)e(conversion)h(operator)f
(between)h Fh(Echo_var)f Fi(and)63 5302 y Fh(Echo_ptr)25
b Fi(varies)h(slightly)f(among)i(dif)o(fer)o(ent)e(C++)i(compilers;)i
(you)d(may)g(need)h(to)f(do)h(an)g(explicit)f(cast)h(if)63
5394 y(the)19 b(compiler)e(complains)i(about)g(the)h(conversion)e
(being)h(ambiguous.)p eop
%%Page: 12 20
12 19 bop 221 282 a Fs(12)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)362 539 y Fe(a)50 b(=)g(p)o(;)548 b
Fd(//)50 b(a)f(assumes)g(ownership)f(of)h(p,)h(must)f(not)g(use)g(p)h
(any)f(more)362 738 y Fe(Echo_var)g(b)g(=)h(a;)99 b Fd(//)50
b(implicit)e(_duplicate)362 937 y Fe(p)i(=)g(...)497
b Fd(//)50 b(somehow)e(obtain)h(another)f(object)h(reference)362
1136 y Fe(a)h(=)g(Echo)o(::)o(_duplicate)o(\()o(p\);)249
b Fd(//)49 b(release)g(old)g(object)g(reference)1807
1236 y(//)g(a)h(now)f(holds)g(a)h(copy)f(of)g(p.)221
1624 y Fk(2.5.1)99 b(Servant)25 b(Object)g(Implementation)221
1822 y Fs(Befor)n(e)19 b(the)f(Portable)i(Object)g(Adapter)e(\(POA\))i
(speci\002cation,)g(many)g(of)f(the)g(details)g(of)h(how)221
1935 y(servant)29 b(objects)h(should)e(be)i(implemented)f(and)g(r)n
(egister)n(ed)f(with)i(the)f(system)f(wer)n(e)h(un-)221
2048 y(speci\002ed,)21 b(so)g(server)n(-side)g(code)g(was)h(not)g
(portable)f(between)g(ORBs.)27 b(The)21 b(POA)h(speci\002ca-)221
2160 y(tion)27 b(r)n(ecti\002es)f(that.)40 b(omniORB)27
b(3)g(still)h(supports)c(the)i(old)h(omniORB)g(2.x)g(BOA)f(mapping,)221
2273 y(but)g(you)f(should)g(always)h(use)f(the)g(POA)h(mapping)g(for)g
(new)f(code.)37 b(BOA)26 b(code)f(and)h(POA)221 2386
y(code)k(can)h(coexist)f(within)h(a)g(single)f(pr)n(ogram.)51
b(See)29 b(section)h(3.2)h(for)g(details)f(of)h(the)e(BOA)221
2499 y(compatibility)-10 b(,)24 b(and)e(pr)n(oblems)h(you)e(may)i
(encounter)-7 b(.)362 2622 y(For)22 b(each)g(object)h(interface,)f(a)h
Fr(skeleton)h Fs(class)f(is)f(generated.)k(In)c(our)f(example,)h(the)g
(POA)221 2735 y(speci\002cation)29 b(says)g(that)f(the)h(skeleton)e
(class)i(for)g(interface)g Ff(Echo)f Fs(is)h(named)g
Ff(POA_Echo)p Fs(.)221 2848 y(A)22 b(servant)f(implementation)h(can)h
(be)e(written)g(by)h(cr)n(eating)g(an)g(implementation)g(class)g(that)
221 2961 y(derives)g(fr)n(om)h(the)f(skeleton)e(class.)362
3084 y(The)29 b(skeleton)e(class)i Ff(POA_Echo)d Fs(is)j(de\002ned)e
(in)j Ff(echo.hh)p Fs(.)44 b(The)28 b(r)n(elevant)i(section)e(of)221
3197 y(the)22 b(code)g(is)h(r)n(epr)n(oduced)d(below)-8
b(.)362 3367 y Fe(class)49 b(_impl_Echo)f(:)462 3467
y(public)h(virtual)f(omniServant)362 3566 y({)362 3666
y(public)o(:)462 3766 y(virtual)g(char)h(*)h(echoString)n(\(const)f
(char)o(*)100 b(mesg)o(\))50 b(=)f(0;)462 3865 y Fd(//)g(...)362
3965 y Fe(};)362 4164 y(class)g(POA_Echo)f(:)462 4264
y(public)h(virtual)f(_impl_Echo)n(,)462 4363 y(public)h(virtual)f
(PortableServer)n(::)o(ServantBase)362 4463 y({)362 4563
y(public)o(:)462 4662 y(Echo_ptr)g(_this)o(\(\);)462
4762 y Fd(//)h(...)362 4861 y Fe(};)362 5055 y Fs(The)29
b(code)f(fragment)h(shows)e(the)i(only)f(member)h(functions)g(that)g
(can)h(be)f(used)e(in)j(the)221 5168 y(object)h(implementation)g(code.)
53 b(Other)31 b(member)g(functions)g(ar)n(e)h(generated)d(for)i
(internal)221 5281 y(use)21 b(only)-10 b(.)28 b(As)21
b(with)h(the)g(code)f(generated)f(for)i(object)g(r)n(efer)n(ences,)f
(other)g(POA-based)h(ORBs)221 5394 y(will)i(generate)d(code)h(which)h
(looks)e(dif)n(fer)n(ent,)i(but)f(is)h(functionally)g(equivalent)g(to)f
(this.)p eop
%%Page: 13 21
13 20 bop 63 282 a Fg(2.6.)51 b(WRITING)21 b(THE)h(SER)-5
b(V)-10 b(ANT)20 b(IMPLEMENT)-7 b(A)g(TION)1077 b Fs(13)63
539 y Fc(echoString\(\))290 652 y Fs(It)36 b(is)h(thr)n(ough)f(this)h
(abstract)g(function)g(that)g(an)g(implementation)g(class)g(pr)n
(ovides)290 764 y(the)26 b(implementation)i(of)f(the)f
Ff(echoString\(\))c Fs(operation.)41 b(Notice)26 b(that)h(its)g(signa-)
290 877 y(tur)n(e)e(is)g(the)f(same)h(as)h(the)e Ff(echoString\(\))c
Fs(function)25 b(that)g(can)h(be)f(invoked)g(via)h(the)290
990 y Ff(Echo_ptr)19 b Fs(object)j(r)n(efer)n(ence.)63
1189 y Fc(_this\(\))290 1302 y Fs(This)30 b(function)g(r)n(eturns)e(an)
j(object)f(r)n(efer)n(ence)f(for)h(the)f(tar)n(get)g(object,)i(pr)n
(ovided)e(the)290 1415 y(POA)19 b(policies)h(permit)f(it.)27
b(The)18 b(r)n(eturned)g(value)i(must)f(be)g(deallocated)g(via)i
Ff(CORBA::)290 1528 y(release\(\))p Fs(.)j(See)d(section)h(2.8)h(for)g
(an)g(example)g(of)f(how)g(this)h(function)f(is)h(used.)63
1844 y Fq(2.6)119 b(W)-9 b(riting)29 b(the)g(servant)h(implementation)
63 2061 y Fs(Y)-8 b(ou)22 b(de\002ne)f(an)j(implementation)f(class)h
(to)e(pr)n(ovide)h(the)f(servant)h(implementation.)29
b(Ther)n(e)63 2174 y(is)23 b(little)h(constraint)f(on)g(how)g(you)f
(design)g(your)h(implementation)g(class)h(except)e(that)h(it)h(has)63
2287 y(to)c(inherit)h(fr)n(om)g(the)g(stubs')f(skeleton)f(class)i(and)g
(to)f(implement)h(all)h(the)f(abstract)g(functions)63
2400 y(de\002ned)28 b(in)j(the)e(skeleton)g(class.)51
b(Each)31 b(of)f(these)f(abstract)h(functions)g(corr)n(esponds)e(to)i
(an)63 2513 y(operation)e(of)h(the)f(interface.)47 b(They)28
b(ar)n(e)h(the)f(hooks)g(for)h(the)f(ORB)h(to)f(perform)g(upcalls)i(to)
63 2626 y(your)21 b(implementation.)204 2742 y(Her)n(e)h(is)g(a)h
(simple)g(implementation)g(of)f(the)g(Echo)g(object.)204
2897 y Fe(class)49 b(Echo_i)f(:)i(public)f(POA_Echo)n(,)951
2996 y(public)g(PortableServer)m(::RefCountServantBase)204
3096 y({)204 3196 y(public)o(:)303 3295 y(inline)g(Echo_i)o(\(\))g({})
303 3395 y(virtual)g(~Echo_i)o(\(\))g({})303 3494 y(virtual)g(char)o(*)
h(echoString)n(\(const)f(char)o(*)h(mesg)o(\);)204 3594
y(};)204 3793 y(char)o(*)g(Echo_i)o(::)o(echoString)n(\(const)f(char)o
(*)h(mesg)o(\))204 3893 y({)303 3993 y(return)f(CORBA)o(::string_dup)n
(\(mesg)o(\);)204 4092 y(})204 4264 y Fs(Ther)n(e)22
b(ar)n(e)h(four)f(points)f(to)h(note)g(her)n(e:)63 4490
y Fn(Storage)h(Responsibilities)290 4603 y Fs(A)39 b(string,)k(which)d
(is)g(used)e(both)h(as)h(an)g(in)g(ar)n(gument)f(and)h(the)e(r)n(eturn)
h(value)i(of)290 4716 y Ff(echoString\(\))p Fs(,)16 b(is)22
b(a)g(variable)i(size)e(data)g(type.)k(Other)21 b(examples)g(of)h
(variable)h(size)290 4829 y(data)g(types)e(include)i(sequences,)e(type)
g(`any',)j(etc.)29 b(For)22 b(these)f(data)i(types,)e(you)h(must)290
4942 y(be)g(clear)g(about)g(whose)e(r)n(esponsibility)h(it)h(is)g(to)f
(allocate)i(and)e(r)n(elease)g(the)g(associated)290 5055
y(storage.)47 b(As)29 b(a)h(r)o(ule)g(of)g(thumb,)h(the)e(client)h
(\(or)f(the)g(caller)i(to)e(the)g(implementation)290
5168 y(functions\))f(owns)e(the)h(storage)f(of)i(all)h(IN)e(ar)n
(guments,)h(the)f(object)h(implementation)290 5281 y(\(or)c(the)f
(callee\))i(must)f(copy)f(the)g(data)h(if)h(it)f(wants)g(to)f(r)n
(etain)h(a)h(copy)-10 b(.)31 b(For)23 b(OUT)h(ar)n(gu-)290
5394 y(ments)c(and)g(r)n(eturn)g(values,)h(the)f(object)g
(implementation)h(allocates)g(the)f(storage)f(and)p eop
%%Page: 14 22
14 21 bop 221 282 a Fs(14)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)448 539 y Fs(passes)h(the)h(ownership)f(to)h(the)f
(client.)34 b(The)24 b(client)h(must)e(r)n(elease)h(the)g(storage)f
(when)448 652 y(the)g(variables)i(will)g(no)f(longer)e(be)i(used.)29
b(For)23 b(details,)h(please)f(r)n(efer)g(section)g(23.22)i(of)448
764 y(the)d(CORBA)h(2.3)g(speci\002cation.)221 955 y
Fn(Multi-threading)448 1068 y Fs(As)f(omniORB)f(is)h(fully)h(multithr)n
(eaded,)d(multiple)i(thr)n(eads)f(may)h(perform)f(the)g(same)448
1180 y(upcall)j(to)e(your)f(implementation)i(concurr)n(ently)-10
b(.)27 b(It)21 b(is)i(up)f(to)g(your)f(implementation)448
1293 y(to)27 b(synchr)n(onise)f(the)h(thr)n(eads')f(accesses)g(to)h
(shar)n(ed)g(data.)41 b(In)27 b(our)g(simple)g(example,)448
1406 y(we)c(have)g(no)f(shar)n(ed)g(data)h(to)f(pr)n(otect)f(so)h(no)g
(thr)n(ead)g(synchr)n(onisation)g(is)h(necessary)-10
b(.)448 1558 y(Alternatively)g(,)22 b(you)e(can)j(cr)n(eate)e(a)h(POA)g
(which)g(has)g(the)f Ff(SINGLE_THREAD_)o(MO)o(DE)o(L)448
1671 y Fs(Thr)n(ead)31 b(Policy)-10 b(.)54 b(This)31
b(guarantees)e(that)i(all)i(calls)f(to)f(that)g(POA)g(ar)n(e)h(pr)n
(ocessed)d(se-)448 1784 y(quentially)-10 b(.)221 1974
y Fn(Reference)25 b(Counting)448 2087 y Fs(As)30 b(well)g(as)h
(inheriting)e(fr)n(om)i(the)e(Echo)h(skeleton)e(class,)k(the)e(servant)
f(class)i(is)f(also)448 2200 y(derived)i(fr)n(om)h Ff(PortableServer)o
(::)o(Ref)o(Co)o(un)o(tS)o(er)o(van)o(tB)o(as)o(e)26
b Fs(which,)35 b(as)e(the)448 2313 y(name)h(suggests,)f(is)g(a)h(mixin)
h(class)f(which)g(pr)n(ovides)e(r)n(efer)n(ence)h(counting)g(for)g(the)
448 2426 y(servant)23 b(object.)29 b(This)23 b(means)g(that)g(an)g
Ff(Echo_i)e Fs(instance)i(will)h(be)f(deleted)e(when)h(no)448
2539 y(mor)n(e)h(r)n(efer)n(ences)f(to)h(it)g(ar)n(e)h(held)e(by)h
(application)h(code)f(or)g(the)f(POA)h(itself.)29 b(Not)22
b(that)448 2651 y(this)27 b(is)g(totally)g(separate)f(fr)n(om)i(the)e
(r)n(efer)n(ence)h(counting)f(which)i(is)f(associated)f(with)448
2764 y(object)32 b(r)n(efer)n(ences\227a)f(servant)h(object)g(is)g
Fr(never)h Fs(deleted)d(due)g(to)i(a)g(CORBA)g(object)448
2877 y(r)n(efer)n(ence)22 b(being)h(r)n(eleased.)221
3068 y Fn(Instantiation)448 3180 y Fs(Servants)k(which)g(derive)f(fr)n
(om)i Ff(PortableServer)o(::R)o(ef)o(Co)o(un)o(tS)o(erv)o(an)o(tB)o(as)
o(e)448 3293 y Fs(must)i(not)g(be)g(instantiated)g(as)g(automatic)h
(variables)h(\(i.e.)e(on)g(the)g(stack\).)51 b(Instead,)448
3406 y(you)22 b(should)g(always)g(instantiate)h(them)f(using)g(the)f
Ff(new)h Fs(operator)-7 b(,)21 b(i.e.)h(their)g(storage)448
3519 y(is)f(allocated)h(on)e(the)g(heap.)27 b(Otherwise,)20
b(the)g(POA)h(may)g(attempt)f(to)g(delete)f(an)i(object)448
3632 y(on)i(the)f(stack.)221 3935 y Fq(2.7)119 b(W)-9
b(riting)29 b(the)h(client)221 4147 y Fs(Her)n(e)22 b(is)h(an)g
(example)f(of)h(how)f(an)h Ff(Echo_ptr)c Fs(object)k(r)n(efer)n(ence)f
(is)g(used.)254 4298 y Fj(1)83 b Fe(void)254 4397 y Fj(2)g
Fe(hello)o(\(CORBA)o(::Object_ptr)48 b(obj)o(\))254 4497
y Fj(3)83 b Fe({)254 4597 y Fj(4)183 b Fe(Echo_var)48
b(e)i(=)f(Echo::)o(_narrow)o(\(obj)o(\);)254 4696 y Fj(5)254
4796 y(6)183 b Fe(if)49 b(\(CORBA)o(::is_nil)o(\(e)o(\)\))h({)254
4896 y Fj(7)283 b Fe(cerr)49 b(<<)g("cannot)g(invoke)f(on)i(a)f(nil)h
(object)e(reference)o(.\\)o(n")254 4995 y Fj(8)532 b
Fe(<<)49 b(endl)o(;)254 5095 y Fj(9)283 b Fe(return)n(;)229
5194 y Fj(10)183 b Fe(})232 5294 y Fj(1)m(1)229 5394
y(12)g Fe(CORBA)o(::String_var)48 b(src)h(=)g(\(const)g(char)o(*\))h
("Hello)o(!")o(;)p eop
%%Page: 15 23
15 22 bop 63 282 a Fg(2.8.)51 b(EXAMPLE)21 b(1)i(\227)f(COLOCA)-7
b(TED)24 b(CLIENT)d(AND)i(IMPLEMENT)-7 b(A)g(TION)323
b Fs(15)71 539 y Fj(13)182 b Fe(CORBA)o(::String_var)48
b(dest)o(;)71 638 y Fj(14)71 738 y(15)182 b Fe(dest)49
b(=)h(e->echoString)n(\(src)o(\);)71 837 y Fj(16)71 937
y(17)182 b Fe(cerr)49 b(<<)h("I)f(said,\\"")g(<<)g(src)g(<<)h("\\".")71
1037 y Fj(18)431 b Fe(<<)50 b(")g(The)f(Object)g(said)o(,\\"")g(<<)g
(dest)g(<<"\\"")g(<<)g(endl;)71 1136 y Fj(19)83 b Fe(})204
1313 y Fs(Brie\003y)-10 b(,)37 b(the)c(function)i Ff(hello\(\))d
Fs(accepts)i(a)i(generic)e(object)g(r)n(efer)n(ence.)64
b(The)34 b(object)63 1426 y(r)n(efer)n(ence)k(\()p Ff(obj)p
Fs(\))f(is)i(narr)n(owed)f(to)g Ff(Echo_ptr)p Fs(.)72
b(If)39 b(the)e(object)i(r)n(efer)n(ence)f(r)n(eturned)f(by)63
1539 y Ff(Echo::_narrow\()o(\))22 b Fs(is)27 b(not)g(nil,)j(the)d
(operation)g Ff(echoString\(\))22 b Fs(is)28 b(invoked.)42
b(Finally)-10 b(,)63 1652 y(both)21 b(the)f(ar)n(gument)h(to)g(and)h
(the)e(r)n(eturn)h(value)h(of)g Ff(echoString\(\))16
b Fs(ar)n(e)22 b(printed)e(to)h Ff(cerr)p Fs(.)204 1769
y(The)28 b(example)i(also)f(illustrates)g(how)g Ff(T_var)e
Fs(types)g(ar)n(e)j(used.)47 b(As)28 b(it)i(was)f(explained)63
1882 y(in)34 b(the)f(pr)n(evious)g(section,)i Ff(T_var)d
Fs(types)g(take)h(car)n(e)h(of)g(storage)e(allocation)j(and)f(r)n
(elease)63 1995 y(automatically)25 b(when)e(variables)j(of)d(the)g
(type)g(ar)n(e)h(assigned)e(to)h(or)h(when)f(the)g(variables)i(go)63
2108 y(out)c(of)i(scope.)204 2226 y(In)28 b(line)h(4,)i(the)d(variable)
j Ff(e)d Fs(takes)g(over)g(the)g(storage)f(r)n(esponsibility)i(of)f
(the)g(object)h(r)n(ef-)63 2339 y(er)n(ence)j(r)n(eturned)g(by)i
Ff(Echo::_narrow\()o(\))p Fs(.)54 b(The)33 b(object)g(r)n(efer)n(ence)g
(is)h(r)n(eleased)e(by)h(the)63 2451 y(destr)o(uctor)25
b(of)i Ff(e)p Fs(.)42 b(It)27 b(is)h(called)g(automatically)h(when)e
(the)g(function)g(r)n(eturns.)41 b(Lines)27 b(6)h(and)63
2564 y(15)23 b(show)e(how)h(a)h Ff(Echo_var)c Fs(variable)24
b(is)f(used.)j(As)c(said)g(earlier)-7 b(,)23 b Ff(Echo_var)c
Fs(type)h(can)k(be)63 2677 y(used)d(inter)n(changeably)i(with)f
Ff(Echo_ptr)d Fs(type.)204 2795 y(The)25 b(ar)n(gument)g(and)g(the)g(r)
n(eturn)f(value)j(of)e Ff(echoString\(\))20 b Fs(ar)n(e)26
b(stor)n(ed)e(in)i Ff(CORBA::)63 2908 y(String_var)f
Fs(variables)32 b Ff(src)d Fs(and)h Ff(dest)f Fs(r)n(espectively)-10
b(.)49 b(The)29 b(strings)g(managed)h(by)g(the)63 3021
y(variables)g(ar)n(e)f(deallocated)g(by)g(the)f(destr)o(uctor)f(of)h
Ff(CORBA::String_va)o(r)p Fs(.)40 b(It)29 b(is)g(called)63
3134 y(automatically)20 b(when)e(the)f(variable)k(goes)c(out)g(of)i
(scope)e(\(as)i(the)f(function)g(r)n(eturns\).)26 b(Line)18
b(15)63 3246 y(shows)25 b(how)h Ff(CORBA::String_v)o(ar)20
b Fs(variables)28 b(ar)n(e)f(used.)39 b(They)25 b(can)j(be)f(used)e(in)
i(place)63 3359 y(of)34 b(a)g(string)g(\(for)g(which)g(the)g(mapping)g
(is)g Ff(char*)p Fs(\))1951 3326 y Fl(4)1986 3359 y Fs(.)63
b(As)33 b(used)g(in)h(line)h(12,)i(assigning)d(a)63 3472
y(constant)20 b(string)f(\()p Ff(const)53 b(char*)p Fs(\))19
b(to)h(a)h Ff(CORBA::String_va)o(r)15 b Fs(causes)20
b(the)g(string)f(to)i(be)63 3585 y(copied.)26 b(On)21
b(the)e(other)g(hand,)i(assigning)e(a)i Ff(char*)d Fs(to)i(a)h
Ff(CORBA::String_)o(va)o(r)p Fs(,)15 b(as)20 b(used)63
3698 y(in)j(line)g(15,)g(causes)f(the)g(latter)g(to)g(assume)g(the)g
(ownership)f(of)i(the)f(string)2654 3665 y Fl(5)2690
3698 y Fs(.)204 3816 y(Under)i(the)i(C++)g(mapping,)h
Ff(T_var)d Fs(types)g(ar)n(e)i(pr)n(ovided)f(for)h(all)h(the)e
(non-basic)i(data)63 3929 y(types.)57 b(It)32 b(is)i(obvious)f(that)f
(one)h(should)f(use)g(automatic)i(variables)h(whenever)c(possible)63
4042 y(both)g(to)g(avoid)h(memory)f(leak)g(and)h(to)f(maximise)h
(performance.)54 b(However)-7 b(,)33 b(when)d(one)63
4154 y(has)23 b(to)g(allocate)i(data)f(items)f(on)g(the)g(heap,)g(it)h
(is)g(a)g(good)e(practice)i(to)f(use)f(the)h Ff(T_var)f
Fs(types)63 4267 y(to)g(manage)h(the)e(heap)i(storage.)63
4595 y Fq(2.8)119 b(Example)29 b(1)h(\227)f(Colocated)i(Client)e(and)h
(Implementation)63 4815 y Fs(Having)23 b(intr)n(oduced)e(the)h(client)g
(and)h(the)f(object)g(implementation,)g(we)g(can)h(now)f(describe)63
4928 y(how)d(to)g(link)i(up)e(the)g(two)g(via)i(the)e(ORB)h(and)g(POA.)
g(In)f(this)h(section,)f(we)h(describe)f(an)h(exam-)63
5041 y(ple)h(in)h(which)g(both)f(the)g(client)h(and)g(the)f(object)g
(implementation)h(ar)n(e)g(in)g(the)e(same)i(addr)n(ess)p
63 5121 1316 4 v 168 5177 a Fj(4)197 5209 y Fi(A)d(conversion)f
(operator)g(of)g Fh(CORBA::String_var)e Fi(converts)j(a)g
Fh(CORBA::String_var)d Fi(to)j(a)g Fh(char*)p Fi(.)168
5271 y Fj(5)197 5302 y Fi(Please)k(r)o(efer)f(to)i(the)g(CORBA)f
(speci\002cation)i(section)e(23.7)i(for)e(the)h(details)f(of)g(the)i
(String_var)f(mapping.)63 5394 y(Other)18 b Fh(T_var)g
Fi(types)g(ar)o(e)g(also)g(cover)o(ed)g(in)g(chapter)i(23.)p
eop
%%Page: 16 24
16 23 bop 221 282 a Fs(16)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)221 539 y Fs(space.)53 b(In)31 b(the)f(next)g(two)g
(sections,)i(we)f(shall)h(describe)e(the)g(case)h(wher)n(e)g(the)f(two)
g(ar)n(e)i(in)221 652 y(dif)n(fer)n(ent)23 b(addr)n(ess)e(spaces.)362
768 y(The)h(code)g(for)h(this)f(example)g(is)h(r)n(epr)n(oduced)e
(below:)254 924 y Fj(1)83 b Fe(int)254 1024 y Fj(2)g
Fe(main\()o(int)50 b(argc)o(,)f(char)h(**)o(argv)o(\))254
1124 y Fj(3)83 b Fe({)254 1223 y Fj(4)183 b Fe(CORBA)o(::ORB_ptr)48
b(orb)h(=)h(CORBA)o(::ORB_init)n(\(argc)o(,argv)o(,"omniORB3)n("\);)254
1323 y Fj(5)254 1422 y(6)183 b Fe(CORBA)o(::Object_var)346
b(obj)50 b(=)f(orb->)o(resolve_initial_references)l(\()o("RootPOA)o
("\);)254 1522 y Fj(7)183 b Fe(PortableServer)m(::POA_var)48
b(poa)i(=)f(PortableServer)n(::)o(POA::)o(_narrow)o(\(obj)o(\);)254
1622 y Fj(8)254 1721 y(9)183 b Fe(Echo_i)49 b(*)o(myecho)g(=)h(new)f
(Echo_i)o(\(\);)229 1821 y Fj(10)183 b Fe(PortableServer)m
(::ObjectId_var)48 b(myechoid)g(=)h(poa->activate_object)m(\(myecho)n
(\);)232 1921 y Fj(1)m(1)229 2020 y(12)183 b Fe(Echo_var)48
b(myechoref)g(=)i(myecho)o(->_this)o(\(\);)229 2120 y
Fj(13)183 b Fe(myecho)o(->)o(_remove_ref)n(\(\);)229
2219 y Fj(14)229 2319 y(15)g Fe(PortableServer)m(::POAManager_var)47
b(pman)i(=)h(poa)o(->the_POAManager)m(\(\);)229 2419
y Fj(16)183 b Fe(pman)o(->activate)n(\(\);)229 2518 y
Fj(17)229 2618 y(18)g Fe(hello)o(\(myechoref)n(\);)229
2718 y Fj(19)229 2817 y(20)g Fe(orb)o(->destroy)o(\(\);)229
2917 y Fj(21)g Fe(return)49 b(0;)229 3016 y Fj(22)83
b Fe(})362 3190 y Fs(The)39 b(example)h(illustrates)f(several)g
(important)g(interactions)h(among)f(the)g(ORB,)g(the)221
3303 y(POA,)23 b(the)f(servant,)f(and)i(the)f(client.)28
b(Her)n(e)22 b(ar)n(e)h(the)f(details:)221 3579 y Fk(2.8.1)99
b(ORB)25 b(initialisation)221 3763 y Fn(Line)e(4)448
3876 y Fs(The)33 b(ORB)g(is)g(initialised)h(by)e(calling)j(the)d
Ff(CORBA::ORB_init\()o(\))27 b Fs(function.)59 b(The)448
3988 y(function)21 b(uses)e(the)g(3r)n(d)i(ar)n(gument)f(to)g
(determine)e(which)j(ORB)f(should)g(be)g(r)n(eturned.)448
4101 y(T)-8 b(o)24 b(use)f(omniORB)i(3,)g(this)f(ar)n(gument)g(must)g
(either)f(be)h(`omniORB3')i(or)e(NULL.)e(If)j(it)448
4214 y(is)30 b(NULL,)e(ther)n(e)h(must)h(be)f(an)i(ar)n(gument,)g
(-ORBid)f(`omniORB3',)i(in)f Ff(argv)3226 4181 y Fl(6)3261
4214 y Fs(.)50 b(Like)448 4327 y(all)40 b(command-line)f(ar)n(guments)f
(understood)d(by)j(the)f(ORB,)h(it)g(will)i(be)e(r)n(emoved)448
4440 y(fr)n(om)30 b Ff(argv)d Fs(when)h Ff(CORBA::ORB_init\()o(\))23
b Fs(r)n(eturns.)45 b(Ther)n(efor)n(e,)29 b(an)h(application)448
4553 y(is)j(not)e(r)n(equir)n(ed)h(to)f(handle)h(any)h(command-line)g
(ar)n(guments)e(it)i(does)d(not)i(under)n(-)448 4666
y(stand.)71 b(If)37 b(the)f(ORB)h(identi\002er)f(is)i(not)e
(`omniORB3',)42 b(the)36 b(initialisation)j(will)f(fail)448
4779 y(and)33 b(a)f(nil)h Ff(ORB_ptr)c Fs(will)34 b(be)e(r)n(eturned.)
55 b(If)32 b(supplied,)h(omniORB)f(also)g(r)n(eads)g(the)448
4892 y(con\002guration)h(\002le)h Ff(omniORB.cfg)p Fs(.)55
b(Among)32 b(other)g(things,)j(the)e(\002le)g(pr)n(ovides)f(a)448
5005 y(list)27 b(of)g(initial)i(object)e(r)n(efer)n(ences.)39
b(One)27 b(example)g(of)f(these)g(object)g(r)n(efer)n(ences)g(is)h(the)
448 5118 y(Naming)j(service.)46 b(Its)27 b(use)h(will)i(be)f(discussed)
e(in)i(section)f(2.10.1.)48 b(If)29 b(any)f(err)n(or)h(oc-)448
5230 y(curs)37 b(during)e(the)h(pr)n(ocessing)f(of)h(the)g
(con\002guration)f(\002le,)40 b(the)c(system)e(exception)p
221 5306 1316 4 v 327 5362 a Fj(6)356 5394 y Fi(For)17
b(backwar)o(ds)h(compatibility)-8 b(,)18 b(the)i(ORB)e(identi\002er)g
(`omniORB2')f(is)i(also)f(accepted.)p eop
%%Page: 17 25
17 24 bop 63 282 a Fg(2.8.)51 b(EXAMPLE)21 b(1)i(\227)f(COLOCA)-7
b(TED)24 b(CLIENT)d(AND)i(IMPLEMENT)-7 b(A)g(TION)323
b Fs(17)290 539 y Ff(CORBA::INITIALI)o(ZE)16 b Fs(is)23
b(raised.)63 817 y Fk(2.8.2)99 b(Obtaining)25 b(the)g(Root)g(POA)63
1002 y Fn(Lines)e(6\2267)290 1115 y Fs(T)-8 b(o)21 b(activate)h(our)g
(servant)f(object)g(and)h(make)f(it)h(available)j(to)c(clients,)h(we)f
(must)g(r)n(egis-)290 1228 y(ter)g(it)i(with)f(a)h(POA.)f(In)g(this)g
(example,)g(we)g(use)f(the)g Fr(Root)i(POA)p Fs(,)e(rather)h(than)g(cr)
n(eating)290 1341 y(any)28 b(child)i(POAs.)45 b(The)28
b(Root)f(POA)i(is)g(found)f(with)g Ff(orb->resolve_in)o(it)o(ia)o(l_)
290 1453 y(references\(\))p Fs(,)22 b(which)27 b(r)n(eturns)e(a)i
(plain)g Ff(CORBA::Object)p Fs(.)33 b(In)26 b(line)h(7,)h(we)e(nar)n(-)
290 1566 y(r)n(ow)c(the)g(r)n(efer)n(ence)g(to)g(the)g(right)g(type)f
(for)i(a)g(POA.)290 1724 y(A)31 b(POA)-7 b('s)32 b(behaviour)f(is)h
(governed)d(by)i(its)h Fr(policies)p Fs(.)56 b(The)30
b(Root)g(POA)i(has)f(suitable)290 1837 y(policies)c(for)f(many)h
(simple)g(servers,)e(and)i(closely)f(matches)g(the)g(`policies')i(used)
d(by)290 1950 y(omniORB)h(2's)h(BOA.)f(See)f(Chapter)h(1)-5
b(1)27 b(of)f(the)g(CORBA)g(2.3)h(speci\002cation[OMG99)r(])290
2063 y(for)22 b(details)h(of)f(all)j(the)c(POA)i(policies)g(which)g(ar)
n(e)g(available.)63 2342 y Fk(2.8.3)99 b(Object)25 b(initialisation)63
2526 y Fn(Line)d(9)290 2639 y Fs(An)g(instance)h(of)f(the)g(Echo)g
(object)h(is)g(initialised)g(using)f(the)g Ff(new)f Fs(operator)-7
b(.)63 2842 y Fn(Line)22 b(10)290 2955 y Fs(The)36 b(servant)g(object)g
(is)g(activated)i(in)e(the)g(Root)f(POA)i(using)f Ff(poa->activate_)290
3068 y(object\(\))p Fs(,)22 b(which)j(r)n(eturns)f(an)h(object)g
(identi\002er)f(\(of)h(type)f Ff(PortableServer)o(::)290
3181 y(ObjectId*)p Fs(\).)h(The)e(object)g(id)g(must)f(be)h(passed)f
(back)h(to)g(various)g(POA)g(operations.)290 3294 y(The)j(caller)i(is)e
(r)n(esponsible)g(for)g(fr)n(eeing)g(the)g(object)g(id,)i(so)e(it)g(is)
h(assigned)e(to)h(a)h Ff(_var)290 3407 y Fs(type.)63
3610 y Fn(Line)22 b(12)290 3723 y Fs(The)h(object)h(r)n(efer)n(ence)f
(is)h(obtained)f(fr)n(om)i(the)e(servant)g(object)h(by)f(calling)j
Ff(_this\(\))p Fs(.)290 3836 y(Like)h(all)i(object)f(r)n(efer)n(ences,)
f(the)g(r)n(eturn)g(value)i(of)e Ff(_this\(\))e Fs(must)i(be)h(r)n
(eleased)f(by)290 3949 y Ff(CORBA::release\()o(\))19
b Fs(when)24 b(it)i(is)f(no)g(longer)f(needed.)33 b(In)25
b(this)g(case,)g(we)g(assign)f(it)290 4062 y(to)e(a)h
Ff(_var)e Fs(type,)g(so)h(the)g(r)n(elease)g(is)g(implicit)j(at)e(the)e
(end)h(of)h(the)f(function.)290 4220 y(One)30 b(of)g(the)f(important)g
(characteristics)i(of)f(an)g(object)g(r)n(efer)n(ence)f(is)h(that)g(it)
g(is)g(com-)290 4332 y(pletely)20 b(location)i(transpar)n(ent.)k(A)21
b(client)h(can)g(invoke)e(on)h(the)f(object)h(using)g(its)g(object)290
4445 y(r)n(efer)n(ence)k(without)g(any)h(need)e(to)i(know)f(whether)f
(the)h(servant)g(object)h(is)g(colocated)290 4558 y(in)d(the)f(same)g
(addr)n(ess)g(space)g(or)g(is)h(in)g(a)g(dif)n(fer)n(ent)g(addr)n(ess)e
(space.)290 4716 y(In)27 b(the)g(case)h(of)f(colocated)h(client)g(and)f
(servant,)h(omniORB)g(is)g(able)g(to)f(short-cir)n(cuit)290
4829 y(the)35 b(client)i(calls)h(so)d(they)g(do)g(not)h(involve)h(IIOP)
-12 b(.)36 b(The)f(calls)j(still)f(go)e(thr)n(ough)g(the)290
4942 y(POA,)22 b(however)-7 b(,)20 b(so)h(the)g(various)i(POA)f
(policies)f(af)n(fect)i(local)h(calls)f(in)f(the)f(same)h(way)290
5055 y(as)k(r)n(emote)f(ones.)36 b(This)25 b(optimisation)h(is)g
(applicable)h(not)e(only)h(to)f(object)h(r)n(efer)n(ences)290
5168 y(r)n(eturned)k(by)i Ff(_this\(\))p Fs(,)f(but)g(to)h(any)f
(object)h(r)n(efer)n(ences)f(that)g(ar)n(e)i(passed)d(ar)n(ound)290
5281 y(within)18 b(the)f(same)h(addr)n(ess)e(space)i(or)f(r)n(eceived)h
(fr)n(om)g(other)f(addr)n(ess)f(spaces)i(via)h(IIOP)290
5394 y(calls.)p eop
%%Page: 18 26
18 25 bop 221 282 a Fs(18)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)221 539 y Fn(Line)h(13)448 652 y Fs(The)f(server)f
(code)g(r)n(eleases)g(the)g(r)n(efer)n(ence)h(it)g(holds)f(to)h(the)f
(servant)h(object.)27 b(The)21 b(only)448 764 y(r)n(efer)n(ence)30
b(to)f(that)h(object)g(is)g(now)g(held)f(by)h(the)f(POA)i(\(it)f
(gained)g(the)f(r)n(efer)n(ence)g(on)448 877 y(the)d(call)i(to)d
Ff(activate_object)o(\(\))p Fs(\),)c(so)k(when)g(the)h(object)g(is)g
(deactivated)g(\(or)g(the)448 990 y(POA)20 b(is)f(destr)n(oyed\),)e
(the)h(servant)g(object)h(will)i(be)e(deleted)e(automatically)-10
b(.)28 b(After)18 b(this)448 1103 y(point,)k(the)g(code)g(must)g(no)g
(longer)g(use)f(the)h Ff(myecho)e Fs(pointer)-7 b(.)221
1371 y Fk(2.8.4)99 b(Activating)26 b(the)f(POA)221 1553
y Fn(Lines)e(15\22616)448 1665 y Fs(POAs)32 b(ar)n(e)g(initially)i(in)e
(the)f Fr(holding)j Fs(state,)e(meaning)g(that)g(incoming)g(r)n
(equests)e(ar)n(e)448 1778 y(blocked.)d(Lines)20 b(15)i(and)f(16)h
(acquir)n(e)g(a)g(r)n(efer)n(ence)e(to)h(the)f(POA)-7
b('s)21 b(POA)g(manager)-7 b(,)22 b(and)448 1891 y(use)f(it)h(to)f(put)
f(the)h(POA)h(into)f(the)g Fr(active)i Fs(state.)j(Incoming)c(r)n
(equests)d(ar)n(e)j(now)f(served.)221 2159 y Fk(2.8.5)99
b(Performing)24 b(a)h(call)221 2341 y Fn(Line)e(18)448
2454 y Fs(At)k(long)g(last,)h(we)e(can)i(call)h Ff(hello\(\))24
b Fs(with)i(this)h(object)g(r)n(efer)n(ence.)40 b(The)26
b(ar)n(gument)448 2567 y(is)d(widened)e(implicitly)k(to)d(the)f
(generic)h(object)h(r)n(efer)n(ence)f Ff(CORBA::Object_p)o(tr)o
Fs(.)221 2835 y Fk(2.8.6)99 b(ORB)25 b(destruction)221
3016 y Fn(Line)e(20)448 3129 y Fs(Shutdown)k(the)h(ORB)h(permanently)
-10 b(.)45 b(This)29 b(call)i(causes)d(the)g(ORB)g(to)h(r)n(elease)f
(all)i(its)448 3242 y(r)n(esour)n(ces,)37 b(e.g.)e(internal)g(thr)n
(eads,)j(and)d(also)h(to)f(deactivate)g(any)h(servant)f(objects)448
3355 y(which)h(ar)n(e)f(curr)n(ently)g(active.)66 b(When)34
b(it)h(deactivates)g(the)f Ff(Echo_i)e Fs(instance,)38
b(the)448 3468 y(object's)23 b(r)n(efer)n(ence)f(count)g(dr)n(ops)f(to)
h(zer)n(o,)g(so)g(the)g(object)h(is)f(deleted.)448 3622
y(This)h(call)h(is)e(particularly)i(important)e(when)g(writing)g(a)h
(CORBA)f(DLL)g(on)g(W)-5 b(indows)448 3735 y(NT)25 b(that)f(is)h(to)f
(be)h(used)e(fr)n(om)i(ActiveX.)g(If)f(this)h(call)h(is)f(absent,)g
(the)f(application)i(will)448 3848 y(hang)d(when)f(the)g(CORBA)g(DLL)h
(is)f(unloaded.)221 4160 y Fq(2.9)119 b(Example)30 b(2)f(\227)h(Dif)n
(ferent)d(Address)i(Spaces)221 4375 y Fs(In)h(this)h(example,)h(the)e
(client)h(and)g(the)e(object)i(implementation)g(r)n(eside)e(in)i(two)f
(dif)n(fer)n(ent)221 4488 y(addr)n(ess)20 b(spaces.)26
b(The)21 b(code)f(of)i(this)f(example)g(is)g(almost)g(the)g(same)g(as)g
(the)g(pr)n(evious)f(exam-)221 4601 y(ple.)27 b(The)19
b(only)h(dif)n(fer)n(ence)h(is)f(the)f(extra)h(work)f(which)i(needs)d
(to)i(be)g(done)f(to)g(pass)h(the)f(object)221 4714 y(r)n(efer)n(ence)j
(fr)n(om)h(the)f(object)h(implementation)f(to)g(the)g(client.)362
4829 y(The)e(simplest)f(\(and)h(quite)f(primitive\))i(way)f(to)g(pass)f
(an)h(object)g(r)n(efer)n(ence)g(between)e(two)221 4942
y(addr)n(ess)i(spaces)h(is)g(to)g(pr)n(oduce)g(a)h Fr(stringi\002ed)h
Fs(version)e(of)h(the)e(object)i(r)n(efer)n(ence)e(and)i(to)f(pass)221
5055 y(this)j(string)f(to)g(the)h(client)g(as)g(a)h(command-line)g(ar)n
(gument.)32 b(The)23 b(string)g(is)h(then)f(converted)221
5168 y(by)e(the)f(client)h(into)f(a)i(pr)n(oper)d(object)h(r)n(efer)n
(ence.)27 b(This)20 b(method)g(is)h(used)e(in)i(this)f(example.)27
b(In)221 5281 y(the)g(next)g(example,)i(we)f(shall)h(intr)n(oduce)e(a)h
(better)f(way)h(of)g(passing)f(the)g(object)h(r)n(efer)n(ence)221
5394 y(using)22 b(the)g(CORBA)h(Naming)g(Service.)p eop
%%Page: 19 27
19 26 bop 63 282 a Fg(2.9.)51 b(EXAMPLE)21 b(2)i(\227)f(DIFFERENT)e
(ADDRESS)i(SP)-8 b(ACES)1060 b Fs(19)63 539 y Fk(2.9.1)99
b(Object)19 b(Implementation:)27 b(Generating)18 b(a)h(Stringi\002ed)g
(Object)g(Reference)63 716 y Fs(The)g Ff(main\(\))f Fs(function)i(of)h
(the)e(server)g(side)h(is)g(r)n(epr)n(oduced)f(below)-8
b(.)27 b(The)19 b(full)j(listing)e(\()p Ff(eg2_)63 829
y(impl.cc)p Fs(\))f(can)24 b(be)e(found)g(at)h(the)f(end)g(of)g(this)h
(chapter)-7 b(.)96 978 y Fj(1)83 b Fe(int)49 b(main)o(\(int)g(argc,)g
(char**)g(argv)o(\))96 1078 y Fj(2)83 b Fe({)96 1178
y Fj(3)182 b Fe(CORBA)o(::ORB_var)49 b(orb)g(=)h(CORBA)o(::)o(ORB_init)
o(\(argc)o(,)f(argv,)g("omniORB3)o(")o(\);)96 1277 y
Fj(4)96 1377 y(5)182 b Fe(CORBA)o(::Object_var)347 b(obj)49
b(=)h(orb)o(->resolve_initial_references)-5 b(\("RootPOA)n("\);)96
1476 y Fj(6)182 b Fe(PortableServer)n(::)o(POA_var)49
b(poa)g(=)h(PortableServer)m(::POA)o(::_narrow)o(\()o(obj\);)96
1576 y Fj(7)96 1676 y(8)182 b Fe(Echo_i)o(*)50 b(myecho)f(=)g(new)h
(Echo_i)n(\(\);)96 1775 y Fj(9)71 1875 y(10)182 b Fe(PortableServer)n
(::)o(ObjectId_var)48 b(myechoid)g(=)i(poa)o(->activate_object)m
(\(myecho)o(\);)74 1975 y Fj(1)m(1)71 2074 y(12)182 b
Fe(obj)50 b(=)f(myecho)o(->_this)o(\(\);)71 2174 y Fj(13)182
b Fe(CORBA)o(::String_var)48 b(sior)o(\(orb->)o(object_to_string)m
(\(obj)o(\)\);)71 2273 y Fj(14)182 b Fe(cerr)49 b(<<)h("'")f(<<)h(\()o
(char*\))o(sior)f(<<)h("'")f(<<)h(endl)o(;)71 2373 y
Fj(15)71 2473 y(16)182 b Fe(myecho)o(->_remove_ref)n(\(\);)71
2572 y Fj(17)71 2672 y(18)g Fe(PortableServer)n(::)o(POAManager_var)48
b(pman)h(=)g(poa->)o(the_POAManager)n(\(\);)71 2772 y
Fj(19)182 b Fe(pman->)o(activate)o(\(\);)71 2871 y Fj(20)71
2971 y(21)g Fe(orb->)o(run\(\);)71 3070 y Fj(22)g Fe(orb->)o(destroy)o
(\(\);)71 3170 y Fj(23)g Fe(return)49 b(0;)71 3270 y
Fj(24)83 b Fe(})204 3433 y Fs(The)26 b(stringi\002ed)f(object)i(r)n
(efer)n(ence)f(is)h(obtained)f(by)h(calling)i(the)d(ORB's)g
Ff(object_to_)63 3546 y(string\(\))h Fs(function)32 b(\(line)f(13\).)55
b(This)31 b(r)n(esults)f(in)i(a)f(string)g(starting)f(with)h(the)f
(signatur)n(e)63 3659 y(`IOR:')18 b(and)g(followed)f(by)h(some)f
(hexadecimal)i(digits.)25 b(All)19 b(CORBA)f(2)g(compliant)h(ORBs)e(ar)
n(e)63 3772 y(able)h(to)f(convert)g(the)g(string)g(into)g(its)g
(internal)h(r)n(epr)n(esentation)e(of)i(a)g(so-called)g(Inter)n
(operable)63 3884 y(Object)33 b(Refer)n(ence)e(\(IOR\).)i(The)f(IOR)h
(contains)f(the)g(location)i(information)f(and)g(a)g(key)e(to)63
3997 y(uniquely)c(identify)g(the)g(object)h(implementation)g(in)g(its)g
(own)f(addr)n(ess)f(space)2879 3964 y Fl(7)2916 3997
y Fs(.)44 b(Fr)n(om)27 b(the)63 4110 y(IOR,)22 b(an)h(object)f(r)n
(efer)n(ence)g(can)i(be)e(constr)o(ucted.)63 4366 y Fk(2.9.2)99
b(Client:)30 b(Using)c(a)e(Stringi\002ed)h(Object)g(Reference)63
4543 y Fs(The)18 b(stringi\002ed)f(object)i(r)n(efer)n(ence)f(is)h
(passed)e(to)i(the)f(client)h(as)g(a)g(command-line)h(ar)n(gument.)63
4656 y(The)29 b(client)i(uses)d(the)i(ORB's)g Ff(string_to_obje)o(ct)o
(\(\))24 b Fs(function)30 b(to)f(convert)h(the)f(string)63
4769 y(into)20 b(a)h(generic)f(object)g(r)n(efer)n(ence)g(\()p
Ff(CORBA::Object_pt)o(r)p Fs(\).)h(The)f(r)n(elevant)h(section)f(of)g
(the)63 4882 y(code)k(is)g(r)n(epr)n(oduced)f(below)-8
b(.)34 b(The)24 b(full)i(listing)f(\()p Ff(eg2_clt.cc)p
Fs(\))20 b(can)26 b(be)f(found)f(at)h(the)e(end)63 4995
y(of)f(this)h(chapter)-7 b(.)204 5144 y Fe(try)49 b({)303
5244 y(CORBA)o(::Object_var)f(obj)h(=)h(orb)o(->string_to_object)m
(\(argv)o([1]\);)p 63 5306 1316 4 v 168 5362 a Fj(7)197
5394 y Fi(Notice)19 b(that)h(the)f(object)h(key)d(is)i(not)g(globally)e
(unique)i(acr)o(oss)f(addr)o(ess)e(spaces.)p eop
%%Page: 20 28
20 27 bop 221 282 a Fs(20)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)462 539 y Fe(hello)o(\(obj)o(\);)362
638 y(})362 738 y(catch)o(\(CORBA)o(::COMM_FAILURE)n(&)49
b(ex\))h({)462 837 y(...)f Fd(//)h(code)f(to)g(handle)g(communication)e
(failure)362 937 y Fe(})221 1306 y Fk(2.9.3)99 b(Catching)25
b(System)g(Exceptions)221 1499 y Fs(When)j(omniORB)g(detects)e(an)i
(err)n(or)g(condition,)g(it)h(may)f(raise)g(a)h(system)d(exception.)43
b(The)221 1612 y(CORBA)22 b(speci\002cation)h(de\002nes)d(a)j(series)e
(of)h(exceptions)f(covering)h(most)f(of)i(the)e(err)n(or)h(con-)221
1725 y(ditions)37 b(that)h(an)h(ORB)e(may)i(encounter)-7
b(.)72 b(The)37 b(client)i(may)f(choose)f(to)g(catch)i(these)d(ex-)221
1838 y(ceptions)28 b(and)h(r)n(ecover)g(fr)n(om)h(the)e(err)n(or)h
(condition)2089 1805 y Fl(8)2126 1838 y Fs(.)47 b(For)29
b(instance,)h(the)e(code)h(fragment,)221 1951 y(shown)d(in)i(section)e
(2.9.2,)j(catches)e(the)g Ff(COMM_FAILURE)21 b Fs(system)26
b(exception)g(which)h(indi-)221 2064 y(cates)19 b(that)g(communication)
i(with)e(the)f(object)h(implementation)g(in)h(another)f(addr)n(ess)e
(space)221 2177 y(has)23 b(failed.)362 2298 y(All)32
b(system)c(exceptions)h(inherit)i(fr)n(om)g Ff(CORBA::SystemEx)o(ce)o
(pt)o(io)o(n)p Fs(.)46 b(W)-5 b(ith)30 b(com-)221 2411
y(pilers)23 b(that)f(pr)n(operly)g(support)e(R)m(TTI)1564
2378 y Fl(9)1600 2411 y Fs(,)j(a)g(single)g(catch)g(of)g
Ff(CORBA::SystemEx)o(ce)o(pt)o(io)o(n)221 2524 y Fs(will)h(catch)g(all)
g(the)d(dif)n(fer)n(ent)i(system)e(exceptions)g(thr)n(own)h(by)g
(omniORB.)362 2644 y(When)k(omniORB)h(detects)e(an)i(internal)g(err)n
(or)g(that)f(is)h(most)f(likely)h(to)f(be)h(caused)f(by)g(a)221
2757 y(bug)i(in)g(the)e(r)o(untime,)j(it)f(raises)f(the)g(exception)f
Ff(omniORB::fatalE)o(xc)o(ept)o(io)o(n)p Fs(.)37 b(When)221
2870 y(this)32 b(exception)f(is)i(raised,)h(it)e(is)h(not)f(sensible)f
(to)h(pr)n(oceed)f(with)h(any)h(operation)e(that)h(in-)221
2983 y(volves)18 b(the)g(ORB's)f(r)o(untime.)27 b(It)17
b(is)h(best)g(to)f(exit)h(the)f(pr)n(ogram)h(immediately)-10
b(.)27 b(The)17 b(exception)221 3096 y(str)o(uctur)n(e)g(carried)h(by)g
Ff(omniORB::fatalE)o(xc)o(ept)o(io)o(n)12 b Fs(contains)18
b(the)f(exact)h(location)h(\(the)221 3209 y(\002le)29
b(name)g(and)f(the)g(line)h(number\))g(wher)n(e)f(the)g(exception)f(is)
i(raised.)45 b(If)29 b(this)f(occurs,)i(you)221 3322
y(ar)n(e)23 b(str)n(ongly)e(encouraged)g(to)h(\002le)h(a)g(bug)g(r)n
(eport)e(and)i(point)f(out)f(the)h(location.)221 3626
y Fk(2.9.4)99 b(Lifetime)24 b(of)h(a)g(CORBA)g(object)221
3819 y Fs(CORBA)h(objects)e(ar)n(e)i(either)f Fr(transient)h
Fs(or)g Fr(persistent)p Fs(.)38 b(The)25 b(majority)h(ar)n(e)g
(transient,)e(mean-)221 3931 y(ing)19 b(that)g(the)f(lifetime)i(of)f
(the)f(CORBA)h(object)g(\(as)h(contacted)e(thr)n(ough)g(an)i(object)e
(r)n(efer)n(ence\))221 4044 y(is)27 b(the)f(same)g(as)h(the)f(lifetime)
h(of)g(its)f(servant)g(object.)40 b(Persistent)24 b(objects)i(can)i
(live)f(beyond)221 4157 y(the)33 b(destr)o(uction)f(of)i(their)g
(servant)f(object,)j(the)d(POA)h(they)f(wer)n(e)g(cr)n(eated)g(in,)k
(and)d(even)221 4270 y(their)24 b(pr)n(ocess.)33 b(Persistent)23
b(objects)h(ar)n(e,)h(of)g(course,)f(only)g(contactable)h(when)f(their)
h(associ-)221 4383 y(ated)17 b(servants)g(ar)n(e)h(active,)h(or)e(can)i
(be)e(activated)h(by)g(their)f(POA)h(with)f(a)h(servant)g(manager)3417
4350 y Fl(10)3487 4383 y Fs(.)221 4496 y(A)28 b(r)n(efer)n(ence)f(to)h
(a)g(persistent)e(object)i(can)h(be)f(published,)g(and)g(will)h(r)n
(emain)g(valid)h(even)d(if)221 4609 y(the)22 b(server)g(pr)n(ocess)f
(is)i(r)n(estarted.)362 4730 y(A)f(POA)-7 b('s)22 b(Lifespan)f(Policy)h
(determines)e(whether)g(objects)h(cr)n(eated)g(within)h(it)g(ar)n(e)g
(tran-)221 4843 y(sient)g(or)g(persistent.)k(The)21 b(Root)h(POA)h(has)
f(the)g Ff(TRANSIENT)d Fs(policy)-10 b(.)p 221 4936 1316
4 v 327 4992 a Fj(8)356 5024 y Fi(If)21 b(a)g(system)f(exception)g(is)g
(not)i(caught,)g(the)f(C++)h(r)o(untime)f(will)f(call)h(the)h
Fh(terminate\(\))d Fi(function.)30 b(This)221 5115 y(function)d(is)f
(defaulted)f(to)i(abort)f(the)h(whole)f(pr)o(ocess)f(and)h(on)h(some)e
(systems)g(will)h(cause)g(a)h(cor)o(e)e(\002le)h(to)g(be)221
5206 y(pr)o(oduced.)327 5268 y Fj(9)356 5300 y Fi(Run)19
b(T)l(ime)f(T)-7 b(ype)18 b(Identi\002cation)302 5362
y Fj(10)356 5394 y Fi(The)g(POA)h(itself)f(can)i(be)e(activated)i(on)f
(demand)g(with)g(an)h(adapter)e(activator)-6 b(.)p eop
%%Page: 21 29
21 28 bop 63 282 a Fg(2.10.)51 b(EXAMPLE)21 b(3)i(\227)g(USING)f(THE)f
(NAMING)h(SER)-5 b(VICE)988 b Fs(21)204 539 y(An)32 b(alternative)h(to)
f(cr)n(eating)h(persistent)d(objects)i(is)g(to)g(r)n(egister)f(object)i
(r)n(efer)n(ences)e(in)63 652 y(a)26 b Fr(naming)g(service)i
Fs(and)d(bind)h(them)g(to)f(\002xed)g(pathnames.)36 b(Clients)26
b(can)h(bind)f(to)f(the)g(object)63 764 y(implementations)17
b(at)h(r)o(untime)f(by)h(asking)f(the)g(naming)h(service)f(to)g(r)n
(esolve)g(the)g(pathnames)63 877 y(to)33 b(the)g(object)g(r)n(efer)n
(ences.)60 b(CORBA)34 b(de\002nes)e(a)i(standar)n(d)f(naming)i
(service,)h(which)e(is)g(a)63 990 y(component)25 b(of)i(the)f(Common)h
(Object)h(Services)e(\(COS\))i([OMG98)r(],)g(that)f(can)g(be)g(used)f
(for)63 1103 y(this)17 b(purpose.)24 b(The)16 b(next)h(section)f
(describes)g(an)i(example)f(of)h(how)f(to)f(use)h(the)f(COS)i(Naming)63
1216 y(Service.)63 1529 y Fq(2.10)118 b(Example)30 b(3)f(\227)h(Using)g
(the)g(Naming)g(Service)63 1745 y Fs(In)d(this)h(example,)h(the)f
(object)g(implementation)g(uses)f(the)g(Naming)h(Service)h([OMG98)r(])f
(to)63 1857 y(pass)h(on)g(the)g(object)h(r)n(efer)n(ence)f(to)g(the)h
(client.)50 b(This)29 b(method)g(is)h(far)g(mor)n(e)g(practical)i(than)
63 1970 y(using)h(stringi\002ed)f(object)h(r)n(efer)n(ences.)60
b(The)33 b(full)i(listing)f(of)f(the)g(object)h(implementation)63
2083 y(\()p Ff(eg3_impl.cc)p Fs(\))14 b(and)k(the)g(client)h(\()p
Ff(eg3_clt.cc)p Fs(\))c(can)k(be)g(found)f(at)h(the)e(end)h(of)h(this)f
(chap-)63 2196 y(ter)-7 b(.)204 2311 y(The)29 b(names)h(used)f(by)h
(the)g(Naming)g(service)g(consist)f(of)i(a)f(sequence)f(of)h
Fr(name)g(compo-)63 2424 y(nents)p Fs(.)36 b(Each)26
b(name)f(component)g(has)g(an)h Fr(id)g Fs(and)f(a)h
Fr(kind)h Fs(\002eld,)e(both)g(of)g(which)h(ar)n(e)g(strings.)63
2537 y(All)g(name)f(components)f(except)g(the)g(last)h(one)g(ar)n(e)g
(bound)g(to)f(a)i(naming)g(context.)34 b(A)26 b(nam-)63
2650 y(ing)h(context)f(is)i(analogous)f(to)g(a)h(dir)n(ectory)e(in)i(a)
h(\002ling)e(system:)36 b(it)28 b(can)g(contain)g(names)g(of)63
2763 y(object)d(r)n(efer)n(ences)f(or)h(other)f(naming)h(contexts.)34
b(The)25 b(last)g(name)h(component)d(is)j(bound)e(to)63
2876 y(an)f(object)f(r)n(efer)n(ence.)204 2991 y(Sequences)h(of)i(name)
g(components)f(can)i(be)f(r)n(epr)n(esented)d(as)j(a)h(\003at)f
(string,)g(using)f(`.')36 b(to)63 3104 y(separate)29
b(the)g(id)h(and)h(kind)f(\002elds,)h(and)f(`/')h(to)e(separate)g(name)
i(components)d(fr)n(om)j(each)63 3217 y(other)276 3184
y Fl(1)l(1)341 3217 y Fs(.)e(In)22 b(our)h(example,)f(the)g(Echo)h
(object)f(r)n(efer)n(ence)g(is)h(bound)g(to)f(the)g(stringi\002ed)f
(name)63 3330 y(`)p Ff(test.my_context)o(/E)o(ch)o(o.)o(Ob)o(jec)o(t)p
Fs('.)204 3445 y(The)26 b(kind)h(\002eld)g(is)g(intended)f(to)g
(describe)h(the)f(name)i(in)f(a)h(syntax-independent)c(way)-10
b(.)63 3558 y(The)24 b(naming)j(service)e(does)f(not)h(interpr)n(et,)f
(assign,)i(or)f(manage)h(these)d(values.)37 b(However)-7
b(,)63 3671 y(both)20 b(the)h(name)g(and)g(the)f(kind)h(attribute)f
(must)h(match)h(for)f(a)g(name)g(lookup)f(to)h(succeed.)26
b(In)63 3784 y(this)f(example,)g(the)f(kind)h(values)h(for)f
Ff(test)e Fs(and)i Ff(Echo)f Fs(ar)n(e)i(chosen)e(to)g(be)h(`)p
Ff(my_context)p Fs(')63 3897 y(and)i(`)p Ff(Object)p
Fs(')d(r)n(espectively)-10 b(.)40 b(This)27 b(is)g(an)g(arbitrary)h
(choice)f(as)g(ther)n(e)f(is)h(no)g(standar)n(dised)63
4010 y(set)21 b(of)i(kind)f(values.)63 4279 y Fk(2.10.1)98
b(Obtaining)26 b(the)e(Root)i(Context)f(Object)g(Reference)63
4460 y Fs(The)c(initial)j(contact)f(with)f(the)f(Naming)i(Service)f
(can)h(be)g(established)e(via)j(the)d Fr(r)n(oot)j Fs(context.)63
4573 y(The)33 b(object)g(r)n(efer)n(ence)g(to)g(the)g(r)n(oot)g
(context)g(is)g(pr)n(ovided)g(by)h(the)f(ORB)g(and)h(can)h(be)e(ob-)63
4686 y(tained)25 b(by)h(calling)i Ff(resolve_initia)o(l_)o(re)o(fer)o
(en)o(ce)o(s\()o(\))p Fs(.)k(The)25 b(following)h(code)f(frag-)63
4799 y(ment)d(shows)f(how)h(it)h(is)g(used:)204 4953
y Fe(CORBA)o(::)o(ORB_ptr)49 b(orb)g(=)h(CORBA)o(::ORB_init)n(\(argc)o
(,argv)o(,"omniORB3)n("\);)p 63 5123 1316 4 v 146 5179
a Fj(1)m(1)197 5211 y Fi(Ther)o(e)25 b(ar)o(e)h(escaping)f(r)o(ules)h
(to)g(cope)g(with)h(id)e(and)i(kind)e(\002elds)g(which)j(contain)f(`.')
45 b(and)26 b(`/')g(characters.)63 5302 y(See)20 b(chapter)h(4)g(of)f
(this)g(manual,)i(and)f(chapter)g(3)g(of)f(the)h(CORBA)f(services)f
(speci\002cation,)i(as)f(updated)g(for)g(the)63 5394
y(Inter)o(operable)e(Naming)g(Service)h([OMG00].)p eop
%%Page: 22 30
22 29 bop 221 282 a Fs(22)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)362 539 y Fe(CORBA)o(::Object_var)48
b(initServ)n(;)362 638 y(initServ)h(=)g(orb->)o
(resolve_initial_references)-5 b(\("NameService)n("\);)362
837 y(CosNaming)o(::)o(NamingContext_var)47 b(rootContext)n(;)362
937 y(rootContext)h(=)i(CosNaming)n(::NamingContext)m(::_narrow)o(\()o
(initServ)o(\);)362 1106 y Fs(Remember)-7 b(,)19 b(omniORB)g(constr)o
(ucts)e(its)i(internal)g(list)g(of)g(initial)i(r)n(efer)n(ences)c(at)i
(initialisa-)221 1219 y(tion)25 b(time)g(using)g(the)g(information)h
(pr)n(ovided)e(in)i(the)e(con\002guration)h(\002le)g
Ff(omniORB.cfg)p Fs(,)221 1332 y(or)38 b(given)f(on)h(the)f(command)h
(line.)73 b(If)38 b(this)g(\002le)f(is)h(not)f(pr)n(esent,)j(the)d
(internal)h(list)g(will)221 1445 y(be)30 b(empty)f(and)h
Ff(resolve_initia)o(l_)o(re)o(fe)o(ren)o(ce)o(s\()o(\))24
b Fs(will)31 b(raise)f(a)g Ff(CORBA::ORB::)221 1558 y(InvalidName)18
b Fs(exception.)221 1826 y Fk(2.10.2)99 b(The)25 b(Naming)g(Service)g
(Interface)221 2007 y Fs(It)h(is)h(beyond)e(the)h(scope)g(of)h(this)f
(chapter)g(to)g(describe)g(in)i(detail)f(the)f(Naming)h(Service)f(in-)
221 2120 y(terface.)49 b(Y)-8 b(ou)29 b(should)g(consult)g(the)g(CORBA)
h(services)f(speci\002cation)h([OMG98)r(])g(\(chapter)221
2233 y(3\).)g(The)22 b(code)h(listed)f(in)h Ff(eg3_impl.cc)c
Fs(and)k Ff(eg3_clt.cc)18 b Fs(ar)n(e)24 b(good)d(examples)i(of)g(how)
221 2346 y(the)f(service)g(can)i(be)e(used.)27 b(Please)22
b(spend)f(time)h(to)g(study)f(the)h(examples)g(car)n(efully)-10
b(.)221 2657 y Fq(2.1)l(1)118 b(Example)30 b(4)g(\227)f(Using)h(tie)g
(implementation)f(templates)221 2873 y Fs(Since)i(2.6.0,)h(omniORB)f
(has)f(supported)d Fr(tie)32 b Fs(implementation)e(templates)f(as)i(an)
f(alterna-)221 2986 y(tive)e(way)f(of)h(pr)n(oviding)f(servant)g
(classes.)42 b(If)27 b(you)g(use)f(the)h Ff(-Wbtp)e Fs(option)i(to)g
(omniidl,)i(it)221 3099 y(generates)17 b(an)i(extra)f(template)g(class)
h(for)g(each)g(interface.)27 b(This)18 b(template)g(class)h(can)h(be)e
(used)221 3211 y(to)k(tie)h(a)g(C++)g(class)g(to)f(the)g(skeleton)e
(class)k(of)e(the)g(interface.)362 3326 y(The)e(sour)n(ce)g(code)f(in)i
Ff(eg3_tieimpl.cc)14 b Fs(at)20 b(the)g(end)f(of)i(this)f(chapter)g
(illustrates)g(how)221 3439 y(the)h(template)f(class)i(can)g(be)g
(used.)k(The)20 b(code)h(is)g(almost)h(identical)g(to)f
Ff(eg3_impl.cc)16 b Fs(with)221 3552 y(only)22 b(a)i(few)e(changes.)362
3667 y(Firstly)-10 b(,)22 b(the)f(servant)h(class)h Ff(Echo_i)d
Fs(does)h(not)h(inherit)h(fr)n(om)g(any)f(stub)g(classes.)28
b(This)22 b(is)221 3780 y(the)c(main)j(bene\002t)d(of)h(using)f(the)g
(template)h(class)g(because)g(ther)n(e)f(ar)n(e)h(applications)h(in)f
(which)221 3893 y(it)k(is)g(dif)n(\002cult)g(to)f(r)n(equir)n(e)h
(every)e(servant)i(class)g(to)f(derive)g(fr)n(om)h(CORBA)g(classes.)362
4008 y(Secondly)-10 b(,)38 b(the)e(instantiation)g(of)h(a)f(CORBA)h
(object)f(now)f(involves)i(cr)n(eating)g(an)f(in-)221
4121 y(stance)d(of)h(the)f(implementation)h(class)g Fr(and)g
Fs(an)g(instance)g(of)f(the)g(template.)60 b(Her)n(e)33
b(is)h(the)221 4234 y(r)n(elevant)23 b(code)f(fragment:)362
4388 y Fe(class)49 b(Echo_i)g({)g(...)h(};)362 4587 y(Echo_i)f(*myimpl)
f(=)i(new)f(Echo_i)o(\(\);)362 4687 y(POA_Echo_tie)n(<Echo_i)o(>)g
(myecho)o(\(myimpl)o(\);)362 4886 y(PortableServer)n(::)o(ObjectId_var)
f(myechoid)g(=)i(poa)o(->activate_object)m(\(&myecho)o(\);)362
5055 y Fs(For)22 b(interface)h Ff(Echo)p Fs(,)d(the)i(name)h(of)g(its)f
(tie)g(implementation)h(template)e(is)i Ff(POA_Echo_)221
5168 y(tie)p Fs(.)30 b(The)23 b(template)h(parameter)f(is)h(the)f
(servant)g(class)h(that)g(contains)g(an)g(implementation)221
5281 y(of)i(each)f(of)h(the)e(operations)g(de\002ned)g(in)h(the)g
(interface.)36 b(As)25 b(used)f(above,)i(the)f(tie)g(template)221
5394 y(takes)30 b(ownership)f(of)i(the)g Ff(Echo_i)d
Fs(instance,)33 b(and)e(deletes)e(it)i(when)f(the)g(tie)h(object)g
(goes)p eop
%%Page: 23 31
23 30 bop 63 282 a Fg(2.1)-5 b(1.)51 b(EXAMPLE)21 b(4)i(\227)g(USING)f
(TIE)f(IMPLEMENT)-7 b(A)g(TION)20 b(TEMPLA)-7 b(TES)444
b Fs(23)63 539 y(out)26 b(of)h(scope.)41 b(The)26 b(tie)h(constr)o
(uctor)f(has)i(an)f(optional)h(boolean)f(ar)n(gument)g(\(defaulted)f
(to)63 652 y(tr)o(ue\))j(which)h(indicates)f(whether)f(or)i(not)e(it)i
(should)f(delete)f(the)g(servant)h(object.)49 b(For)28
b(full)63 764 y(details)e(of)g(using)g(tie)g(templates,)g(see)f
(section)g(23.36.7)j(of)f(the)e(CORBA)h(2.3)h(C++)h(mapping)63
877 y(speci\002cation)22 b([OMG99)r(].)p eop
%%Page: 24 32
24 31 bop 221 282 a Fs(24)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)221 539 y Fq(2.12)119 b(Source)30 b(Listings)221
770 y Fk(2.12.1)99 b(eg1.cc)362 1010 y Fd(//)50 b(eg1)o(.cc)f(-)h(This)
f(is)h(the)f(source)g(code)g(of)g(example)g(1)g(used)g(in)h(Chapter)e
(2)362 1110 y(//)498 b("The)49 b(Basics)o(")h(of)f(the)g(omniORB)g
(user)g(guide)o(.)362 1209 y(//)362 1309 y(//)498 b(In)49
b(this)h(example)n(,)g(both)f(the)g(object)g(implementation)e(and)i
(the)362 1409 y(//)498 b(client)49 b(are)g(in)g(the)h(same)f(process)n
(.)362 1508 y(//)362 1608 y(//)h(Usage)o(:)f(eg1)362
1708 y(//)362 1907 y Fe(#include)g(<)o(iostream)o(.h>)362
2006 y(#include)g(<)o(echo.)o(hh>)362 2206 y Fd(//)h(This)f(is)g(the)g
(object)g(implementation)n(.)362 2405 y Fe(class)g(Echo_i)g(:)g(public)
g(POA_Echo)o(,)1109 2505 y(public)g(PortableServer)n(::)o
(RefCountServantBase)362 2604 y({)362 2704 y(public)o(:)462
2803 y(inline)g(Echo_i)n(\(\))h({})462 2903 y(virtual)e(~Echo_i)o(\(\))
i({})462 3003 y(virtual)e(char*)h(echoString)n(\(const)g(char)o(*)h
(mesg)o(\);)362 3102 y(};)362 3302 y(char*)f(Echo_i)o(::echoString)n
(\(const)g(char)o(*)g(mesg\))362 3401 y({)462 3501 y(return)g(CORBA)o
(::)o(string_dup)n(\(mesg\);)362 3600 y(})362 3800 y
Fd(/////////////////////////////////////)o(/////)o(//////)o(/////)o
(/////)o(//////)o(/////)o(/)362 3899 y(//)h(This)f(function)f(acts)h
(as)h(a)f(client)g(to)g(the)h(object)o(.)362 4099 y Fe(static)f(void)g
(hello)o(\(Echo_ptr)f(e\))362 4198 y({)462 4298 y(if\()h(CORBA)o
(::is_nil)o(\(e)o(\))h(\))g({)562 4397 y(cerr)f(<<)g("hello)o(:)h(The)f
(object)g(reference)f(is)h(nil!\\)o(n")h(<<)f(endl)o(;)562
4497 y(return)n(;)462 4597 y(})462 4796 y(CORBA)o(::String_var)f(src)h
(=)g(\(const)g(char)o(*\))h("Hello)o(!")o(;)462 4896
y Fd(//)f(String)g(literals)f(are)i(\()o(char*\))f(rather)g(than)g
(\(const)g(char)o(*\))g(on)h(some)462 4995 y(//)f(old)h(compilers)n(.)
99 b(Thus)49 b(it)h(is)f(essential)f(to)i(cast)f(to)g(\(const)g(char)o
(*\))462 5095 y(//)g(here)g(to)h(ensure)f(that)g(the)g(string)g(is)g
(copied)o(,)h(so)f(that)g(the)462 5194 y(//)g(CORBA)o(::String_var)f
(does)h(not)g(attempt)g(to)g('delete)o(')h(the)f(string)462
5294 y(//)g(literal)o(.)p eop
%%Page: 25 33
25 32 bop 63 282 a Fg(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Fs(25)303 539 y Fe(CORBA)o(::String_var)48 b(dest)h(=)h(e->)o
(echoString)n(\(src\);)303 738 y(cerr)f(<<)h("I)f(said,)g(\\"")h(<<)f
(\(char)o(*\)src)g(<<)g("\\".")g(<<)h(endl)552 837 y(<<)g("The)f(Echo)g
(object)g(replied)n(,)h(\\"")f(<<)h(\(char)o(*\))o(dest)g(<<)o("\\".")f
(<<)g(endl;)204 937 y(})204 1136 y Fd
(//////////////////////////////////)o(//////)o(/////)o(/////)o(//////)o
(/////)o(/////)o(////)204 1336 y Fe(int)g(main)o(\(int)g(argc,)g
(char**)g(argv)o(\))204 1435 y({)303 1535 y(try)h({)403
1634 y Fd(//)f(Initialise)f(the)i(ORB)o(.)403 1734 y
Fe(CORBA)o(::ORB_var)e(orb)i(=)f(CORBA)o(::ORB_init)n(\(argc)o(,)h
(argv)o(,)g("omniORB3)n("\);)403 1933 y Fd(//)f(Obtain)g(a)h(reference)
e(to)h(the)h(root)f(POA)o(.)403 2033 y Fe(CORBA)o(::Object_var)f(obj)h
(=)h(orb)o(->resolve_initial_references)-5 b(\(")o(RootPOA)o("\);)403
2133 y(PortableServer)m(::POA_var)49 b(poa)g(=)g(PortableServer)n(::)o
(POA::_narrow)n(\(obj)o(\);)403 2332 y Fd(//)g(We)h(allocate)e(the)i
(object)e(on)i(the)f(heap)o(.)100 b(Since)48 b(this)i(is)f(a)h
(reference)403 2431 y(//)f(counted)g(object)o(,)h(it)f(will)g(be)g
(deleted)g(by)g(the)h(POA)f(when)g(it)g(is)h(no)403 2531
y(//)f(longer)g(needed)o(.)403 2631 y Fe(Echo_i)o(*)h(myecho)e(=)i(new)
f(Echo_i)o(\(\);)403 2830 y Fd(//)g(Activate)g(the)g(object)o(.)99
b(This)49 b(tells)g(the)h(POA)f(that)g(this)g(object)g(is)403
2930 y(//)g(ready)g(to)h(accept)f(requests)n(.)403 3029
y Fe(PortableServer)m(::ObjectId_var)f(myechoid)g(=)i(poa)o
(->activate_object)m(\(myecho)o(\);)403 3229 y Fd(//)f(Obtain)g(a)h
(reference)e(to)h(the)h(object)o(.)403 3328 y Fe(Echo_var)e(myechoref)h
(=)g(myecho)o(->_this)o(\(\);)403 3527 y Fd(//)g(Decrement)g(the)g
(reference)f(count)h(of)g(the)h(object)e(implementation)n(,)h(so)403
3627 y(//)g(that)h(it)f(will)g(be)h(properly)e(cleaned)g(up)i(when)f
(the)g(POA)g(has)h(determined)403 3727 y(//)f(that)h(it)f(is)g(no)h
(longer)f(needed)n(.)403 3826 y Fe(myecho)o(->_remove_ref)n(\(\);)403
4026 y Fd(//)g(Obtain)g(a)h(POAManager)n(,)g(and)f(tell)g(the)g(POA)g
(to)h(start)f(accepting)403 4125 y(//)g(requests)g(on)g(its)h(objects)n
(.)403 4225 y Fe(PortableServer)m(::POAManager_var)d(pman)i(=)h(poa)o
(->the_POAManager)m(\(\);)403 4324 y(pman)o(->activate)n(\(\);)403
4524 y Fd(//)f(Do)h(the)f(client)o(-side)g(call)o(.)403
4623 y Fe(hello)o(\(myechoref)n(\);)403 4823 y Fd(//)g(Clean)g(up)h
(all)f(the)g(resources)o(.)403 4922 y Fe(orb)o(->destroy)o(\(\);)303
5022 y(})303 5121 y(catch)o(\(CORBA)o(::COMM_FAILURE)n(&)g(ex\))h({)403
5221 y(cerr)f(<<)h(")o(Caught)f(system)g(exception)f(COMM_FAILURE)f(--)
j(unable)f(to)g(contact)g(the)g(")652 5321 y(<<)h(")o(object)o(.")g(<<)
f(endl)o(;)p eop
%%Page: 26 34
26 33 bop 221 282 a Fs(26)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)462 539 y Fe(})462 638 y(catch)o(\(CORBA)o(::)o
(SystemException)n(&\))49 b({)562 738 y(cerr)g(<<)g("Caught)g(CORBA)o
(::)o(SystemException)m(.")h(<<)f(endl;)462 837 y(})462
937 y(catch)o(\(CORBA)o(::)o(Exception)o(&\))g({)562
1037 y(cerr)g(<<)g("Caught)g(CORBA)o(::)o(Exception)o(.")g(<<)g(endl;)
462 1136 y(})462 1236 y(catch)o(\(omniORB)n(::fatalException)n(&)g
(fe\))g({)562 1336 y(cerr)g(<<)g("Caught)g(omniORB)n(::fatalException)m
(:")h(<<)f(endl)o(;)562 1435 y(cerr)g(<<)g(")99 b(file:)49
b(")h(<<)f(fe.file)o(\(\))h(<<)f(endl)o(;)562 1535 y(cerr)g(<<)g(")99
b(line:)49 b(")h(<<)f(fe.line)o(\(\))h(<<)f(endl)o(;)562
1634 y(cerr)g(<<)g(")99 b(mesg:)49 b(")h(<<)f(fe.errmsg)o(\(\))g(<<)h
(endl)o(;)462 1734 y(})462 1834 y(catch)o(\(...\))f({)562
1933 y(cerr)g(<<)g("Caught)g(unknown)f(exception)n(.")i(<<)f(endl;)462
2033 y(})462 2232 y(return)g(0;)362 2332 y(})p eop
%%Page: 27 35
27 34 bop 63 282 a Fg(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Fs(27)63 539 y Fk(2.12.2)98 b(eg2_impl.cc)204 811 y
Fd(//)49 b(eg2_impl)o(.cc)g(-)h(This)f(is)g(the)g(source)g(code)g(of)h
(example)e(2)i(used)f(in)g(Chapter)g(2)204 911 y(//)747
b(")o(The)50 b(Basics)o(")f(of)h(the)f(omniORB)f(user)h(guide.)204
1010 y(//)204 1110 y(//)747 b(This)49 b(is)g(the)g(object)g
(implementation)m(.)204 1209 y(//)204 1309 y(//)g(Usage)o(:)h(eg2_impl)
204 1409 y(//)204 1508 y(//)398 b(On)49 b(startup)o(,)h(the)f(object)g
(reference)f(is)h(printed)g(to)g(cerr)g(as)h(a)204 1608
y(//)398 b(stringified)48 b(IOR)o(.)i(This)f(string)g(should)f(be)i
(used)f(as)g(the)g(argument)g(to)204 1708 y(//)398 b(eg2_clt)o(.)204
1807 y(//)204 2006 y Fe(#include)48 b(<iostream)n(.h>)204
2106 y(#include)g(<echo)o(.hh>)204 2305 y(class)h(Echo_i)f(:)i(public)f
(POA_Echo)n(,)951 2405 y(public)g(PortableServer)m
(::RefCountServantBase)204 2505 y({)204 2604 y(public)o(:)303
2704 y(inline)g(Echo_i)o(\(\))g({})303 2803 y(virtual)g(~Echo_i)o(\(\))
g({})303 2903 y(virtual)g(char)o(*)h(echoString)n(\(const)f(char)o(*)h
(mesg)o(\);)204 3003 y(};)204 3202 y(char)o(*)g(Echo_i)o(::)o
(echoString)n(\(const)f(char)o(*)h(mesg)o(\))204 3302
y({)303 3401 y(return)f(CORBA)o(::string_dup)n(\(mesg)o(\);)204
3501 y(})204 3700 y Fd(//////////////////////////////////)o(//////)o
(/////)o(/////)o(//////)o(/////)o(/////)o(////)204 3899
y Fe(int)g(main)o(\(int)g(argc,)g(char**)g(argv)o(\))204
3999 y({)303 4099 y(try)h({)403 4198 y(CORBA)o(::ORB_var)e(orb)i(=)f
(CORBA)o(::ORB_init)n(\(argc)o(,)h(argv)o(,)g("omniORB3)n("\);)403
4397 y(CORBA)o(::Object_var)e(obj)h(=)h(orb)o
(->resolve_initial_references)-5 b(\(")o(RootPOA)o("\);)403
4497 y(PortableServer)m(::POA_var)49 b(poa)g(=)g(PortableServer)n(::)o
(POA::_narrow)n(\(obj)o(\);)403 4696 y(Echo_i)o(*)h(myecho)e(=)i(new)f
(Echo_i)o(\(\);)403 4896 y(PortableServer)m(::ObjectId_var)f(myechoid)g
(=)i(poa)o(->activate_object)m(\(myecho)o(\);)403 5095
y Fd(//)f(Obtain)g(a)h(reference)e(to)h(the)h(object)o(,)f(and)g(print)
g(it)h(out)f(as)g(a)403 5194 y(//)g(stringified)f(IOR.)403
5294 y Fe(obj)h(=)h(myecho)o(->)o(_this\(\);)403 5394
y(CORBA)o(::String_var)e(sior)o(\(orb)o(->object_to_string)m(\(obj)o
(\)\);)p eop
%%Page: 28 36
28 35 bop 221 282 a Fs(28)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)562 539 y Fe(cerr)49 b(<<)g("'")g(<<)h(\(char)o(*\))o
(sior)g(<<)f("'")g(<<)h(endl)o(;)562 738 y(myecho)n(->_remove_ref)n
(\(\);)562 937 y(PortableServer)m(::POAManager_var)d(pman)i(=)g
(poa->the_POAManager)m(\(\);)562 1037 y(pman)o(->)o(activate)o(\(\);)
562 1236 y(orb)o(->run)o(\(\);)562 1336 y(orb)o(->destroy)n(\(\);)462
1435 y(})462 1535 y(catch)o(\(CORBA)o(::)o(SystemException)n(&\))g({)
562 1634 y(cerr)g(<<)g("Caught)g(CORBA)o(::)o(SystemException)m(.")h
(<<)f(endl;)462 1734 y(})462 1834 y(catch)o(\(CORBA)o(::)o(Exception)o
(&\))g({)562 1933 y(cerr)g(<<)g("Caught)g(CORBA)o(::)o(Exception)o(.")g
(<<)g(endl;)462 2033 y(})462 2133 y(catch)o(\(omniORB)n
(::fatalException)n(&)g(fe\))g({)562 2232 y(cerr)g(<<)g("Caught)g
(omniORB)n(::fatalException)m(:")h(<<)f(endl)o(;)562
2332 y(cerr)g(<<)g(")99 b(file:)49 b(")h(<<)f(fe.file)o(\(\))h(<<)f
(endl)o(;)562 2431 y(cerr)g(<<)g(")99 b(line:)49 b(")h(<<)f(fe.line)o
(\(\))h(<<)f(endl)o(;)562 2531 y(cerr)g(<<)g(")99 b(mesg:)49
b(")h(<<)f(fe.errmsg)o(\(\))g(<<)h(endl)o(;)462 2631
y(})462 2730 y(catch)o(\(...\))f({)562 2830 y(cerr)g(<<)g("Caught)g
(unknown)f(exception)n(.")i(<<)f(endl;)462 2930 y(})462
3029 y(return)g(0;)362 3129 y(})p eop
%%Page: 29 37
29 36 bop 63 282 a Fg(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Fs(29)63 539 y Fk(2.12.3)98 b(eg2_clt.cc)204 811 y
Fd(//)49 b(eg2_clt)o(.cc)g(-)h(This)f(is)g(the)h(source)e(code)h(of)h
(example)e(2)i(used)f(in)g(Chapter)g(2)204 911 y(//)697
b("The)49 b(Basics)o(")g(of)h(the)f(omniORB)g(user)g(guide)o(.)204
1010 y(//)204 1110 y(//)697 b(This)49 b(is)g(the)h(client)n(.)g(The)f
(object)g(reference)f(is)i(given)e(as)i(a)204 1209 y(//)697
b(stringified)48 b(IOR)h(on)g(the)h(command)e(line)o(.)204
1309 y(//)204 1409 y(//)h(Usage)o(:)h(eg2_clt)e(<object)h(reference)n
(>)204 1508 y(//)204 1708 y Fe(#include)f(<iostream)n(.h>)204
1807 y(#include)g(<echo)o(.hh>)204 2006 y(static)g(void)i(hello)o(\()o
(Echo_ptr)f(e\))204 2106 y({)303 2206 y(CORBA)o(::String_var)f(src)99
b(=)50 b(\(const)e(char*\))h("Hello)o(!";)303 2305 y(CORBA)o
(::String_var)f(dest)h(=)h(e->)o(echoString)n(\(src\);)303
2505 y(cerr)f(<<)h("I)f(said,)g(\\"")h(<<)f(\(char)o(*\)src)g(<<)g
("\\".")g(<<)h(endl)552 2604 y(<<)g("The)f(Echo)g(object)g(replied)n(,)
h(\\"")f(<<)h(\(char)o(*\))o(dest)g(<<)o("\\".")f(<<)g(endl;)204
2704 y(})204 2903 y Fd(//////////////////////////////////)o(//////)o
(/////)o(/////)o(//////)o(/////)o(/////)o(////)204 3102
y Fe(int)g(main)o(\(int)g(argc,)g(char**)g(argv)o(\))204
3202 y({)303 3302 y(try)h({)403 3401 y(CORBA)o(::ORB_var)e(orb)i(=)f
(CORBA)o(::ORB_init)n(\(argc)o(,)h(argv)o(,)g("omniORB3)n("\);)403
3600 y(if\()f(argc)g(!=)h(2)f(\))h({)503 3700 y(cerr)f(<<)g("usage)o(:)
100 b(eg2_clt)48 b(<object)h(reference)n(>")g(<<)h(endl)o(;)503
3800 y(return)e(1;)403 3899 y(})403 4099 y(CORBA)o(::Object_var)g(obj)h
(=)h(orb)o(->string_to_object)m(\()o(argv[1]\);)403 4198
y(Echo_var)e(echoref)h(=)h(Echo)o(::)o(_narrow)o(\(obj)o(\);)403
4298 y(if\()f(CORBA)o(::is_nil)o(\(echoref)n(\))h(\))g({)503
4397 y(cerr)f(<<)g("Can)o('t)h(narrow)f(reference)f(to)h(type)g(Echo)g
(\(or)h(it)f(was)g(nil\).")g(<<)g(endl;)503 4497 y(return)f(1;)403
4597 y(})403 4696 y(hello)o(\(echoref)o(\);)403 4896
y(orb)o(->destroy)o(\(\);)303 4995 y(})303 5095 y(catch)o(\(CORBA)o
(::COMM_FAILURE)n(&)h(ex\))h({)403 5194 y(cerr)f(<<)h(")o(Caught)f
(system)g(exception)f(COMM_FAILURE)f(--)j(unable)f(to)g(contact)g(the)g
(")652 5294 y(<<)h(")o(object)o(.")g(<<)f(endl)o(;)303
5394 y(})p eop
%%Page: 30 38
30 37 bop 221 282 a Fs(30)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)462 539 y Fe(catch)o(\(CORBA)o(::)o(SystemException)n
(&\))49 b({)562 638 y(cerr)g(<<)g("Caught)g(a)g(CORBA)o
(::SystemException)m(.")h(<<)f(endl)o(;)462 738 y(})462
837 y(catch)o(\(CORBA)o(::)o(Exception)o(&\))g({)562
937 y(cerr)g(<<)g("Caught)g(CORBA)o(::)o(Exception)o(.")g(<<)g(endl;)
462 1037 y(})462 1136 y(catch)o(\(omniORB)n(::fatalException)n(&)g
(fe\))g({)562 1236 y(cerr)g(<<)g("Caught)g(omniORB)n(::fatalException)m
(:")h(<<)f(endl)o(;)562 1336 y(cerr)g(<<)g(")99 b(file:)49
b(")h(<<)f(fe.file)o(\(\))h(<<)f(endl)o(;)562 1435 y(cerr)g(<<)g(")99
b(line:)49 b(")h(<<)f(fe.line)o(\(\))h(<<)f(endl)o(;)562
1535 y(cerr)g(<<)g(")99 b(mesg:)49 b(")h(<<)f(fe.errmsg)o(\(\))g(<<)h
(endl)o(;)462 1634 y(})462 1734 y(catch)o(\(...\))f({)562
1834 y(cerr)g(<<)g("Caught)g(unknown)f(exception)n(.")i(<<)f(endl;)462
1933 y(})462 2033 y(return)g(0;)362 2133 y(})p eop
%%Page: 31 39
31 38 bop 63 282 a Fg(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Fs(31)63 539 y Fk(2.12.4)98 b(eg3_impl.cc)204 811 y
Fd(//)49 b(eg3_impl)o(.cc)g(-)h(This)f(is)g(the)g(source)g(code)g(of)h
(example)e(3)i(used)f(in)g(Chapter)g(2)204 911 y(//)747
b(")o(The)50 b(Basics)o(")f(of)h(the)f(omniORB)f(user)h(guide.)204
1010 y(//)204 1110 y(//)747 b(This)49 b(is)g(the)g(object)g
(implementation)m(.)204 1209 y(//)204 1309 y(//)g(Usage)o(:)h(eg3_impl)
204 1409 y(//)204 1508 y(//)398 b(On)49 b(startup)o(,)h(the)f(object)g
(reference)f(is)h(registered)f(with)h(the)204 1608 y(//)398
b(COS)49 b(naming)g(service)o(.)g(The)g(client)g(uses)g(the)g(naming)g
(service)g(to)204 1708 y(//)398 b(locate)49 b(this)g(object)o(.)204
1807 y(//)204 1907 y(//)398 b(The)49 b(name)g(which)g(the)g(object)g
(is)h(bound)e(to)i(is)f(as)h(follows)n(:)204 2006 y(//)697
b(root)99 b([context)n(])204 2106 y(//)747 b(|)204 2206
y(//)697 b(test)99 b([context)n(])50 b(kind)f([my_context)n(])204
2305 y(//)747 b(|)204 2405 y(//)697 b(Echo)99 b([object)n(])h(kind)49
b([Object)o(])204 2505 y(//)204 2704 y Fe(#include)f(<iostream)n(.h>)
204 2803 y(#include)g(<echo)o(.hh>)204 3102 y(static)g(CORBA::)o
(Boolean)h(bindObjectToName)m(\(CORBA)o(::)o(ORB_ptr)o(,)h(CORBA)o(::)o
(Object_ptr)n(\);)204 3302 y(class)f(Echo_i)f(:)i(public)f(POA_Echo)n
(,)951 3401 y(public)g(PortableServer)m(::RefCountServantBase)204
3501 y({)204 3600 y(public)o(:)303 3700 y(inline)g(Echo_i)o(\(\))g({})
303 3800 y(virtual)g(~Echo_i)o(\(\))g({})303 3899 y(virtual)g(char)o(*)
h(echoString)n(\(const)f(char)o(*)h(mesg)o(\);)204 3999
y(};)204 4198 y(char)o(*)g(Echo_i)o(::)o(echoString)n(\(const)f(char)o
(*)h(mesg)o(\))204 4298 y({)303 4397 y(return)f(CORBA)o(::string_dup)n
(\(mesg)o(\);)204 4497 y(})204 4696 y Fd
(//////////////////////////////////)o(//////)o(/////)o(/////)o(//////)o
(/////)o(/////)o(////)204 4896 y Fe(int)204 4995 y(main)o(\(int)g(argc)
o(,)h(char)f(**argv)o(\))204 5095 y({)303 5194 y(try)h({)403
5294 y(CORBA)o(::ORB_var)e(orb)i(=)f(CORBA)o(::ORB_init)n(\(argc)o(,)h
(argv)o(,)g("omniORB3)n("\);)p eop
%%Page: 32 40
32 39 bop 221 282 a Fs(32)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)562 539 y Fe(CORBA)o(::)o(Object_var)48
b(obj)h(=)h(orb->)o(resolve_initial_references)-5 b(\("RootPOA)o(")o
(\);)562 638 y(PortableServer)m(::POA_var)48 b(poa)h(=)h
(PortableServer)m(::POA)o(::_narrow)o(\(obj)o(\);)562
837 y(Echo_i)n(*)g(myecho)f(=)g(new)h(Echo_i)o(\(\);)562
1037 y(PortableServer)m(::ObjectId_var)d(myechoid)h(=)i(poa->)o
(activate_object)m(\(myecho)o(\);)562 1236 y Fd(//)f(Obtain)g(a)g
(reference)f(to)i(the)f(object)o(,)h(and)f(register)f(it)i(in)562
1336 y(//)f(the)g(naming)g(service)o(.)562 1435 y Fe(obj)g(=)g(myecho)o
(->_this)o(\(\);)562 1535 y(if)o(\()h(!bindObjectToName)m(\()o(orb,)g
(obj)o(\))g(\))661 1634 y(return)f(1;)562 1834 y(myecho)n
(->_remove_ref)n(\(\);)562 2033 y(PortableServer)m(::POAManager_var)e
(pman)i(=)g(poa->the_POAManager)m(\(\);)562 2133 y(pman)o(->)o
(activate)o(\(\);)562 2332 y(orb)o(->run)o(\(\);)562
2431 y(orb)o(->destroy)n(\(\);)462 2531 y(})462 2631
y(catch)o(\(CORBA)o(::)o(SystemException)n(&\))g({)562
2730 y(cerr)g(<<)g("Caught)g(CORBA)o(::)o(SystemException)m(.")h(<<)f
(endl;)462 2830 y(})462 2930 y(catch)o(\(CORBA)o(::)o(Exception)o(&\))g
({)562 3029 y(cerr)g(<<)g("Caught)g(CORBA)o(::)o(Exception)o(.")g(<<)g
(endl;)462 3129 y(})462 3229 y(catch)o(\(omniORB)n(::fatalException)n
(&)g(fe\))g({)562 3328 y(cerr)g(<<)g("Caught)g(omniORB)n
(::fatalException)m(:")h(<<)f(endl)o(;)562 3428 y(cerr)g(<<)g(")99
b(file:)49 b(")h(<<)f(fe.file)o(\(\))h(<<)f(endl)o(;)562
3527 y(cerr)g(<<)g(")99 b(line:)49 b(")h(<<)f(fe.line)o(\(\))h(<<)f
(endl)o(;)562 3627 y(cerr)g(<<)g(")99 b(mesg:)49 b(")h(<<)f(fe.errmsg)o
(\(\))g(<<)h(endl)o(;)462 3727 y(})462 3826 y(catch)o(\(...\))f({)562
3926 y(cerr)g(<<)g("Caught)g(unknown)f(exception)n(.")i(<<)f(endl;)462
4026 y(})462 4125 y(return)g(0;)362 4225 y(})362 4424
y Fd(/////////////////////////////////////)o(/////)o(//////)o(/////)o
(/////)o(//////)o(/////)o(/)362 4623 y Fe(static)g(CORBA)o(::Boolean)
362 4723 y(bindObjectToName)m(\(CORBA)o(::ORB_ptr)f(orb,)h(CORBA)o
(::Object_ptr)f(objref)o(\))362 4823 y({)462 4922 y(CosNaming)n
(::NamingContext_var)f(rootContext)m(;)462 5121 y(try)i({)562
5221 y Fd(//)g(Obtain)g(a)g(reference)f(to)i(the)f(root)g(context)g(of)
g(the)g(Name)g(service)o(:)562 5321 y Fe(CORBA)o(::)o(Object_var)f
(obj;)p eop
%%Page: 33 41
33 40 bop 63 282 a Fg(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Fs(33)403 539 y Fe(obj)49 b(=)h(orb)o(->resolve_initial_references)-5
b(\("NameService)n("\);)403 738 y Fd(//)49 b(Narrow)g(the)g(reference)g
(returned)n(.)403 837 y Fe(rootContext)f(=)h(CosNaming)o(::)o
(NamingContext)n(::_narrow)n(\(obj\);)403 937 y(if\()g(CORBA)o
(::is_nil)o(\(rootContext)n(\))g(\))h({)503 1037 y(cerr)f(<<)g("Failed)
g(to)g(narrow)g(the)g(root)g(naming)g(context)o(.")g(<<)g(endl;)503
1136 y(return)f(0;)403 1236 y(})303 1336 y(})303 1435
y(catch)o(\(CORBA)o(::ORB)o(::InvalidName)n(&)i(ex)o(\))g({)403
1535 y Fd(//)f(This)h(should)e(not)i(happen)n(!)403 1634
y Fe(cerr)f(<<)h(")o(Service)f(required)f(is)i(invalid)e([does)h(not)g
(exist)o(].")h(<<)f(endl)o(;)403 1734 y(return)g(0;)303
1834 y(})303 2033 y(try)h({)403 2133 y Fd(//)f(Bind)h(a)f(context)g
(called)f("test)o(")i(to)g(the)f(root)g(context)o(:)403
2332 y Fe(CosNaming)n(::Name)g(contextName)n(;)403 2431
y(contextName)n(.length)o(\(1\);)403 2531 y(contextName)n([0].)o(id)149
b(=)50 b(\(const)f(char)o(*\))g("test)o(";)349 b Fd(//)49
b(string)g(copied)403 2631 y Fe(contextName)n([0].)o(kind)g(=)h
(\(const)f(char)o(*\))g("my_context)n(";)h Fd(//)f(string)g(copied)403
2730 y(//)g(Note)h(on)f(kind)o(:)h(The)f(kind)g(field)g(is)h(used)f(to)
g(indicate)f(the)i(type)403 2830 y(//)f(of)h(the)f(object)o(.)h(This)f
(is)g(to)h(avoid)f(conventions)e(such)i(as)h(that)f(used)403
2930 y(//)g(by)h(files)f(\(name)o(.type)g(--)g(e.g.)g(test.)o(ps)h(=)f
(postscript)f(etc.\))403 3129 y Fe(CosNaming)n(::NamingContext_var)f
(testContext)n(;)403 3229 y(try)i({)503 3328 y Fd(//)g(Bind)g(the)g
(context)g(to)g(root.)503 3428 y Fe(testContext)e(=)j(rootContext)n
(->bind_new_context)m(\()o(contextName)n(\);)403 3527
y(})403 3627 y(catch)o(\(CosNaming)n(::NamingContext)m(::AlreadyBound)n
(&)f(ex\))h({)503 3727 y Fd(//)f(If)h(the)f(context)f(already)h(exists)
o(,)g(this)g(exception)g(will)g(be)g(raised)o(.)503 3826
y(//)g(In)h(this)f(case)o(,)h(just)f(resolve)f(the)h(name)g(and)h
(assign)e(testContext)503 3926 y(//)h(to)h(the)f(object)g(returned)n(:)
503 4026 y Fe(CORBA)o(::)o(Object_var)f(obj;)503 4125
y(obj)h(=)h(rootContext)n(->)o(resolve)o(\(contextName)n(\);)503
4225 y(testContext)d(=)j(CosNaming)n(::NamingContext)n(::)o(_narrow)o
(\(obj)o(\);)503 4324 y(if)o(\()g(CORBA)o(::is_nil)o(\()o(testContext)n
(\))g(\))g({)602 4424 y(cerr)f(<<)h("Failed)e(to)i(narrow)e(naming)h
(context)o(.")g(<<)h(endl)o(;)602 4524 y(return)f(0;)503
4623 y(})403 4723 y(})403 4922 y Fd(//)g(Bind)h(objref)e(with)h(name)g
(Echo)g(to)h(the)f(testContext)n(:)403 5022 y Fe(CosNaming)n(::Name)g
(objectName)n(;)403 5121 y(objectName)n(.length)o(\(1\);)403
5221 y(objectName)n([0].)o(id)150 b(=)49 b(\(const)g(char)o(*\))h(")o
(Echo")o(;)150 b Fd(//)49 b(string)g(copied)403 5321
y Fe(objectName)n([0].)o(kind)h(=)f(\(const)g(char)o(*\))h(")o(Object)o
(";)g Fd(//)f(string)g(copied)p eop
%%Page: 34 42
34 41 bop 221 282 a Fs(34)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)562 638 y Fe(try)49 b({)661 738 y(testContext)n
(->bind)o(\(objectName)n(,)h(objref)n(\);)562 837 y(})562
937 y(catch)o(\()o(CosNaming)o(::)o(NamingContext)n(::AlreadyBound)m(&)
g(ex\))f({)661 1037 y(testContext)n(->rebind)o(\()o(objectName)o(,)g
(objref)o(\);)562 1136 y(})562 1236 y Fd(//)g(Note)o(:)h(Using)f
(rebind)o(\(\))g(will)g(overwrite)f(any)i(Object)e(previously)562
1336 y(//)348 b(bound)49 b(to)g(/test)o(/Echo)g(with)g(obj.)562
1435 y(//)348 b(Alternatively)m(,)50 b(bind)o(\(\))g(can)f(be)g(used,)g
(which)g(will)g(raise)g(a)562 1535 y(//)348 b(CosNaming)n
(::NamingContext)m(::AlreadyBound)48 b(exception)g(if)562
1634 y(//)348 b(the)49 b(name)g(supplied)g(is)g(already)f(bound)h(to)h
(an)f(object)o(.)562 1834 y(//)g(Amendment)n(:)h(When)f(using)g
(OrbixNames)n(,)h(it)f(is)h(necessary)e(to)h(first)562
1933 y(//)g(try)g(bind)g(and)h(then)f(rebind)o(,)g(as)h(rebind)e(on)i
(it)o('s)g(own)f(will)g(throw)562 2033 y(//)g(a)h(NotFoundexception)c
(if)k(the)f(Name)g(has)g(not)h(already)e(been)h(bound)o(.)562
2133 y(//)g([This)g(is)g(incorrect)f(behaviour)h(--)g(it)g(should)g
(just)g(bind)o(].)462 2232 y Fe(})462 2332 y(catch)o(\(CORBA)o(::)o
(COMM_FAILURE)n(&)h(ex\))f({)562 2431 y(cerr)g(<<)g("Caught)g(system)f
(exception)g(COMM_FAILURE)g(--)h(unable)g(to)h(")811
2531 y(<<)f("contact)f(the)i(naming)e(service)o(.")h(<<)h(endl)o(;)562
2631 y(return)e(0;)462 2730 y(})462 2830 y(catch)o(\(CORBA)o(::)o
(SystemException)n(&\))h({)562 2930 y(cerr)g(<<)g("Caught)g(a)g(CORBA)o
(::SystemException)e(while)i(using)g(the)g(")811 3029
y(<<)g("naming)g(service)n(.")h(<<)f(endl)o(;)562 3129
y(return)f(0;)462 3229 y(})462 3328 y(return)h(1;)362
3428 y(})p eop
%%Page: 35 43
35 42 bop 63 282 a Fg(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Fs(35)63 539 y Fk(2.12.5)98 b(eg3_clt.cc)204 811 y
Fd(//)49 b(eg3_clt)o(.cc)g(-)h(This)f(is)g(the)h(source)e(code)h(of)h
(example)e(3)i(used)f(in)g(Chapter)g(2)204 911 y(//)697
b("The)49 b(Basics)o(")g(of)h(the)f(omniORB)g(user)g(guide)o(.)204
1010 y(//)204 1110 y(//)697 b(This)49 b(is)g(the)h(client)n(.)g(It)g
(uses)f(the)g(COSS)g(naming)g(service)204 1209 y(//)697
b(to)49 b(obtain)g(the)g(object)g(reference)n(.)204 1309
y(//)204 1409 y(//)g(Usage)o(:)h(eg3_clt)204 1508 y(//)204
1608 y(//)204 1708 y(//)398 b(On)49 b(startup)o(,)h(the)f(client)g
(lookup)f(the)i(object)e(reference)g(from)h(the)204 1807
y(//)398 b(COS)49 b(naming)g(service)o(.)204 1907 y(//)204
2006 y(//)398 b(The)49 b(name)g(which)g(the)g(object)g(is)h(bound)e(to)
i(is)f(as)h(follows)n(:)204 2106 y(//)697 b(root)99 b([context)n(])204
2206 y(//)747 b(|)204 2305 y(//)697 b(text)99 b([context)n(])50
b(kind)f([my_context)n(])204 2405 y(//)747 b(|)204 2505
y(//)697 b(Echo)99 b([object)n(])h(kind)49 b([Object)o(])204
2604 y(//)204 2803 y Fe(#include)f(<iostream)n(.h>)204
2903 y(#include)g(<echo)o(.hh>)204 3102 y(static)g(CORBA::)o
(Object_ptr)g(getObjectReference)m(\(CORBA)o(::)o(ORB_ptr)h(orb)o(\);)
204 3302 y(static)f(void)i(hello)o(\()o(Echo_ptr)f(e\))204
3401 y({)303 3501 y(if\()h(CORBA)o(::)o(is_nil)o(\(e\))g(\))f({)403
3600 y(cerr)g(<<)h(")o(hello)o(:)g(The)f(object)g(reference)f(is)i(nil)
o(!\\n)o(")g(<<)g(endl)o(;)403 3700 y(return)o(;)303
3800 y(})303 3999 y(CORBA)o(::String_var)e(src)99 b(=)50
b(\(const)e(char*\))h("Hello)o(!";)303 4099 y(CORBA)o(::String_var)f
(dest)h(=)h(e->)o(echoString)n(\(src\);)303 4298 y(cerr)f(<<)h("I)f
(said,)g(\\"")h(<<)f(\(char)o(*\)src)g(<<)g("\\".")g(<<)h(endl)552
4397 y(<<)g("The)f(Echo)g(object)g(replied)n(,)h(\\"")f(<<)h(\(char)o
(*\))o(dest)g(<<)o("\\".")f(<<)g(endl;)204 4497 y(})204
4696 y Fd(//////////////////////////////////)o(//////)o(/////)o(/////)o
(//////)o(/////)o(/////)o(////)204 4896 y Fe(int)204
4995 y(main)g(\(int)g(argc)o(,)h(char)f(**argv)o(\))204
5095 y({)303 5194 y(try)h({)403 5294 y(CORBA)o(::ORB_var)e(orb)i(=)f
(CORBA)o(::ORB_init)n(\(argc)o(,)h(argv)o(,)g("omniORB3)n("\);)p
eop
%%Page: 36 44
36 43 bop 221 282 a Fs(36)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)562 539 y Fe(CORBA)o(::)o(Object_var)48
b(obj)h(=)h(getObjectReference)m(\(orb)o(\);)562 738
y(Echo_var)e(echoref)g(=)i(Echo)o(::_narrow)o(\()o(obj\);)562
837 y(hello)o(\()o(echoref)o(\);)562 1037 y(orb)o(->destroy)n(\(\);)462
1136 y(})462 1236 y(catch)o(\(CORBA)o(::)o(COMM_FAILURE)n(&)g(ex\))f({)
562 1336 y(cerr)g(<<)g("Caught)g(system)f(exception)g(COMM_FAILURE)g
(--)h(unable)g(to)h(")811 1435 y(<<)f("contact)f(the)i(object)o(.")f
(<<)g(endl;)462 1535 y(})462 1634 y(catch)o(\(CORBA)o(::)o
(SystemException)n(&\))g({)562 1734 y(cerr)g(<<)g("Caught)g(CORBA)o(::)
o(SystemException)m(.")h(<<)f(endl;)462 1834 y(})462
1933 y(catch)o(\(CORBA)o(::)o(Exception)o(&\))g({)562
2033 y(cerr)g(<<)g("Caught)g(CORBA)o(::)o(Exception)o(.")g(<<)g(endl;)
462 2133 y(})462 2232 y(catch)o(\(omniORB)n(::fatalException)n(&)g
(fe\))g({)562 2332 y(cerr)g(<<)g("Caught)g(omniORB)n(::fatalException)m
(:")h(<<)f(endl)o(;)562 2431 y(cerr)g(<<)g(")99 b(file:)49
b(")h(<<)f(fe.file)o(\(\))h(<<)f(endl)o(;)562 2531 y(cerr)g(<<)g(")99
b(line:)49 b(")h(<<)f(fe.line)o(\(\))h(<<)f(endl)o(;)562
2631 y(cerr)g(<<)g(")99 b(mesg:)49 b(")h(<<)f(fe.errmsg)o(\(\))g(<<)h
(endl)o(;)462 2730 y(})462 2830 y(catch)o(\(...\))f({)562
2930 y(cerr)g(<<)g("Caught)g(unknown)f(exception)n(.")i(<<)f(endl;)462
3029 y(})462 3129 y(return)g(0;)362 3229 y(})362 3428
y Fd(/////////////////////////////////////)o(/////)o(//////)o(/////)o
(/////)o(//////)o(/////)o(/)362 3627 y Fe(static)g(CORBA)o
(::Object_ptr)362 3727 y(getObjectReference)m(\(CORBA)o(::)o(ORB_ptr)g
(orb)o(\))362 3826 y({)462 3926 y(CosNaming)n(::NamingContext_var)e
(rootContext)m(;)462 4125 y(try)i({)562 4225 y Fd(//)g(Obtain)g(a)g
(reference)f(to)i(the)f(root)g(context)g(of)g(the)g(Name)g(service)o(:)
562 4324 y Fe(CORBA)o(::)o(Object_var)f(obj;)562 4424
y(obj)h(=)g(orb->)o(resolve_initial_references)l(\()o("NameService)n
("\);)562 4623 y Fd(//)g(Narrow)g(the)g(reference)f(returned)o(.)562
4723 y Fe(rootContext)f(=)j(CosNaming)n(::NamingContext)m(::_narrow)o
(\(obj)o(\);)562 4823 y(if)o(\()g(CORBA)o(::)o(is_nil)o(\(rootContext)n
(\))g(\))f({)661 4922 y(cerr)g(<<)h(")o(Failed)f(to)h(narrow)e(the)i
(root)f(naming)f(context)o(.")h(<<)h(endl)o(;)661 5022
y(return)f(CORBA)o(::Object)n(::_nil)o(\(\);)562 5121
y(})462 5221 y(})462 5321 y(catch)o(\(CORBA)o(::)o(ORB::InvalidName)n
(&)g(ex\))g({)p eop
%%Page: 37 45
37 44 bop 63 282 a Fg(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Fs(37)403 539 y Fd(//)49 b(This)h(should)e(not)i(happen)n(!)403
638 y Fe(cerr)f(<<)h(")o(Service)f(required)f(is)i(invalid)e([does)h
(not)g(exist)o(].")h(<<)f(endl)o(;)403 738 y(return)g(CORBA)o(::)o
(Object)o(::_nil)o(\(\);)303 837 y(})303 1037 y Fd(//)h(Create)f(a)g
(name)g(object)o(,)h(containing)e(the)h(name)g(test)o(/context)o(:)303
1136 y Fe(CosNaming)o(::)o(Name)g(name;)303 1236 y(name.)o(length)o
(\(2\);)303 1435 y(name[0].)o(id)149 b(=)50 b(\()o(const)f(char*\))g
("test)o(";)348 b Fd(//)50 b(string)f(copied)303 1535
y Fe(name[0].)o(kind)g(=)h(\()o(const)f(char*\))g("my_context)n(";)g
Fd(//)h(string)f(copied)303 1634 y Fe(name[1].)o(id)149
b(=)50 b(\()o(const)f(char*\))g("Echo)o(";)303 1734 y(name[1].)o(kind)g
(=)h(\()o(const)f(char*\))g("Object)o(";)303 1834 y Fd(//)h(Note)f(on)g
(kind:)g(The)h(kind)f(field)f(is)i(used)f(to)g(indicate)g(the)g(type)
303 1933 y(//)h(of)f(the)h(object)n(.)g(This)f(is)h(to)f(avoid)g
(conventions)f(such)h(as)g(that)g(used)303 2033 y(//)h(by)f(files)g
(\(name)o(.type)g(--)h(e)o(.g.)g(test)o(.ps)f(=)h(postscript)e(etc)o
(.\))303 2232 y Fe(try)i({)403 2332 y Fd(//)f(Resolve)g(the)g(name)g
(to)h(an)f(object)g(reference)n(.)403 2431 y Fe(return)g(rootContext)n
(->)o(resolve)o(\(name)o(\);)303 2531 y(})303 2631 y(catch)o
(\(CosNaming)o(::)o(NamingContext)n(::)o(NotFound)o(&)h(ex)o(\))g({)403
2730 y Fd(//)f(This)h(exception)e(is)h(thrown)g(if)g(any)h(of)f(the)g
(components)f(of)i(the)403 2830 y(//)f(path)h([)o(contexts)f(or)g(the)g
(object)o(])h(aren)o('t)g(found)o(:)403 2930 y Fe(cerr)f(<<)h(")o
(Context)f(not)g(found)o(.")h(<<)f(endl)o(;)303 3029
y(})303 3129 y(catch)o(\(CORBA)o(::COMM_FAILURE)n(&)g(ex\))h({)403
3229 y(cerr)f(<<)h(")o(Caught)f(system)g(exception)f(COMM_FAILURE)f(--)
j(unable)f(to)g(")652 3328 y(<<)h(")o(contact)f(the)g(naming)g(service)
o(.")g(<<)g(endl;)303 3428 y(})303 3527 y(catch)o(\(CORBA)o
(::SystemException)m(&\))h({)403 3627 y(cerr)f(<<)h(")o(Caught)f(a)h
(CORBA)o(::)o(SystemException)d(while)i(using)g(the)g(")652
3727 y(<<)h(")o(naming)f(service)o(.")g(<<)h(endl)o(;)303
3826 y(})303 3926 y(return)f(CORBA)o(::Object)o(::)o(_nil\(\);)204
4026 y(})p eop
%%Page: 38 46
38 45 bop 221 282 a Fs(38)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)221 539 y Fk(2.12.6)99 b(eg3_tieimpl.cc)362
811 y Fd(//)50 b(eg3_tieimpl)n(.)o(cc)g(-)g(This)f(example)f(is)i
(similar)e(to)i(eg3_impl)n(.cc)f(except)g(that)362 911
y(//)897 b(the)49 b(tie)g(implementation)e(skeleton)i(is)g(used)o(.)362
1010 y(//)362 1110 y(//)747 b(This)49 b(is)h(the)f(object)g
(implementation)m(.)362 1209 y(//)362 1309 y(//)h(Usage)o(:)f
(eg3_tieimpl)362 1409 y(//)362 1508 y(//)398 b(On)50
b(startup)o(,)f(the)g(object)g(reference)f(is)i(registered)e(with)h
(the)362 1608 y(//)398 b(COS)50 b(naming)e(service)o(.)i(The)f(client)g
(uses)g(the)g(naming)g(service)f(to)362 1708 y(//)398
b(locate)49 b(this)g(object)o(.)362 1807 y(//)362 1907
y(//)398 b(The)50 b(name)f(which)g(the)g(object)g(is)g(bound)g(to)g(is)
h(as)f(follows)o(:)362 2006 y(//)697 b(root)99 b([context)o(])362
2106 y(//)747 b(|)362 2206 y(//)697 b(test)99 b([context)o(])49
b(kind)g([my_context)n(])362 2305 y(//)747 b(|)362 2405
y(//)697 b(Echo)99 b([object)o(])g(kind)49 b([Object)o(])362
2505 y(//)362 2704 y Fe(#include)g(<)o(iostream)o(.h>)362
2803 y(#include)g(<)o(echo.)o(hh>)362 3003 y(static)g(CORBA)o
(::Boolean)f(bindObjectToName)m(\(CORBA)o(::ORB_ptr)n(,CORBA)o
(::Object_ptr)n(\);)362 3202 y Fd(//)i(This)f(is)g(the)g(object)g
(implementation)n(.)99 b(Notice)49 b(that)g(it)g(does)g(not)362
3302 y(//)h(inherit)e(from)h(any)h(stub)f(class)o(.)362
3501 y Fe(class)g(Echo_i)g({)362 3600 y(public)o(:)462
3700 y(inline)g(Echo_i)n(\(\))h({})462 3800 y(inline)f(~)o(Echo_i)o
(\(\))h({})462 3899 y(virtual)e(char*)h(echoString)n(\(const)g(char)o
(*)h(mesg)o(\);)362 3999 y(};)362 4198 y(char*)f(Echo_i)o(::echoString)
n(\(const)g(char)o(*)g(mesg\))362 4298 y({)462 4397 y(return)g(CORBA)o
(::)o(string_dup)n(\(mesg\);)362 4497 y(})362 4696 y
Fd(/////////////////////////////////////)o(/////)o(//////)o(/////)o
(/////)o(//////)o(/////)o(/)362 4896 y Fe(int)h(main)o(\(int)f(argc)o
(,)h(char)o(**)f(argv\))362 4995 y({)462 5095 y(try)g({)562
5194 y(CORBA)o(::)o(ORB_var)g(orb)g(=)h(CORBA)o(::)o(ORB_init)o(\(argc)
o(,)g(argv)o(,)f("omniORB3)o("\);)562 5394 y(CORBA)o(::)o(Object_var)f
(obj)h(=)h(orb->)o(resolve_initial_references)-5 b(\("RootPOA)o(")o
(\);)p eop
%%Page: 39 47
39 46 bop 63 282 a Fg(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Fs(39)403 539 y Fe(PortableServer)m(::POA_var)49 b(poa)g(=)g
(PortableServer)n(::)o(POA::_narrow)n(\(obj)o(\);)403
738 y Fd(//)g(Note)h(that)f(the)g(<myecho)o(>)g(object)g(is)g
(constructed)f(on)i(the)f(stack)g(here)o(.)403 837 y(//)g(This)h(is)f
(because)g(tie)g(implementations)e(do)i(not)g(inherit)g(from)g(the)403
937 y(//)g(PortableServer)n(::RefCountServantBase)d(mixin)j(class)g(--)
g(and)g(so)h(are)403 1037 y(//)f(not)h(automatically)d(deleted)i(by)g
(the)g(POA.)403 1136 y(//)99 b(However)o(,)50 b(it)f(will)g(delete)g
(its)g(implementation)e(\(myimpl)o(\))j(when)f(it)403
1236 y(//)g(it)h(itself)f(destroyed)f(\(when)h(it)g(goes)g(out)g(of)h
(scope)o(\).)99 b(It)50 b(is)403 1336 y(//)f(essential)g(however)f(to)i
(ensure)e(that)h(such)g(objects)g(are)g(not)g(deleted)403
1435 y(//)g(whilst)g(still)g(activated)n(.)403 1535 y
Fe(Echo_i)o(*)h(myimpl)e(=)i(new)f(Echo_i)o(\(\);)403
1634 y(POA_Echo_tie)n(<Echo_i)o(>)g(myecho)o(\(myimpl)o(\);)403
1834 y(PortableServer)m(::ObjectId_var)f(myechoid)g(=)i(poa)o
(->activate_object)m(\(&)o(myecho)o(\);)403 2033 y Fd(//)f(Obtain)g(a)h
(reference)e(to)h(the)h(object)o(,)f(and)g(register)g(it)g(in)403
2133 y(//)g(the)h(naming)e(service)o(.)403 2232 y Fe(obj)h(=)h(myecho)o
(._this)o(\(\);)403 2332 y(if\()f(!bindObjectToName)m(\(orb)o(,)h(obj)o
(\))g(\))503 2431 y(return)e(1;)403 2631 y(PortableServer)m
(::POAManager_var)f(pman)i(=)h(poa)o(->the_POAManager)m(\(\);)403
2730 y(pman)o(->activate)n(\(\);)403 2930 y(orb)o(->run\(\);)403
3029 y(orb)o(->destroy)o(\(\);)303 3129 y(})303 3229
y(catch)o(\(CORBA)o(::SystemException)m(&\))g({)403 3328
y(cerr)f(<<)h(")o(Caught)f(CORBA)o(::SystemException)m(.")g(<<)h(endl)o
(;)303 3428 y(})303 3527 y(catch)o(\(CORBA)o(::Exception)n(&\))g({)403
3627 y(cerr)f(<<)h(")o(Caught)f(CORBA)o(::Exception)n(.")h(<<)f(endl)o
(;)303 3727 y(})303 3826 y(catch)o(\(omniORB)o(::fatalException)m(&)h
(fe)o(\))g({)403 3926 y(cerr)f(<<)h(")o(Caught)f(omniORB)o(::)o
(fatalException)n(:")g(<<)h(endl)o(;)403 4026 y(cerr)f(<<)h(")99
b(file)o(:)50 b(")g(<<)f(fe.)o(file\(\))g(<<)h(endl)o(;)403
4125 y(cerr)f(<<)h(")99 b(line)o(:)50 b(")g(<<)f(fe.)o(line\(\))g(<<)h
(endl)o(;)403 4225 y(cerr)f(<<)h(")99 b(mesg)o(:)50 b(")g(<<)f(fe.)o
(errmsg)o(\(\))h(<<)f(endl)o(;)303 4324 y(})303 4424
y(catch)o(\(...\))g({)403 4524 y(cerr)g(<<)h(")o(Caught)f(unknown)g
(exception)n(.")g(<<)h(endl)o(;)303 4623 y(})303 4723
y(return)f(0;)204 4823 y(})204 5022 y Fd
(//////////////////////////////////)o(//////)o(/////)o(/////)o(//////)o
(/////)o(/////)o(////)204 5221 y Fe(static)f(CORBA::)o(Boolean)204
5321 y(bindObjectToName)m(\(CORBA)o(::)o(ORB_ptr)h(orb)o(,)h(CORBA)o
(::Object_ptr)e(objref)n(\))p eop
%%Page: 40 48
40 47 bop 221 282 a Fs(40)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)362 539 y Fe({)462 638 y(CosNaming)n
(::NamingContext_var)47 b(rootContext)m(;)462 837 y(try)i({)562
937 y Fd(//)g(Obtain)g(a)g(reference)f(to)i(the)f(root)g(context)g(of)g
(the)g(Name)g(service)o(:)562 1037 y Fe(CORBA)o(::)o(Object_var)f(obj;)
562 1136 y(obj)h(=)g(orb->)o(resolve_initial_references)l(\()o
("NameService)n("\);)562 1336 y Fd(//)g(Narrow)g(the)g(reference)f
(returned)o(.)562 1435 y Fe(rootContext)f(=)j(CosNaming)n
(::NamingContext)m(::_narrow)o(\(obj)o(\);)562 1535 y(if)o(\()g(CORBA)o
(::)o(is_nil)o(\(rootContext)n(\))g(\))f({)661 1634 y(cerr)g(<<)h(")o
(Failed)f(to)h(narrow)e(the)i(root)f(naming)f(context)o(.")h(<<)h(endl)
o(;)661 1734 y(return)f(0;)562 1834 y(})462 1933 y(})462
2033 y(catch)o(\(CORBA)o(::)o(ORB::InvalidName)n(&)g(ex\))g({)562
2133 y Fd(//)g(This)g(should)g(not)g(happen)o(!)562 2232
y Fe(cerr)g(<<)g("Service)f(required)h(is)g(invalid)g([)o(does)h(not)f
(exist)o(].")g(<<)h(endl)o(;)562 2332 y(return)e(0;)462
2431 y(})462 2631 y(try)h({)562 2730 y Fd(//)g(Bind)g(a)h(context)e
(called)h("test)o(")h(to)f(the)g(root)g(context)o(:)562
2930 y Fe(CosNaming)n(::)o(Name)h(contextName)n(;)562
3029 y(contextName)m(.length)o(\(1\);)562 3129 y(contextName)m([0].id)
149 b(=)49 b(\(const)g(char)o(*\))h("test)o(";)348 b
Fd(//)50 b(string)e(copied)562 3229 y Fe(contextName)m([0].kind)h(=)g
(\(const)g(char)o(*\))h("my_context)n(";)f Fd(//)h(string)e(copied)562
3328 y(//)h(Note)g(on)g(kind:)g(The)h(kind)f(field)g(is)g(used)g(to)h
(indicate)e(the)h(type)562 3428 y(//)g(of)g(the)h(object)o(.)f(This)g
(is)h(to)f(avoid)g(conventions)f(such)h(as)g(that)g(used)562
3527 y(//)g(by)g(files)g(\(name)o(.type)g(--)h(e.)o(g.)g(test)o(.ps)f
(=)h(postscript)e(etc)o(.\))562 3727 y Fe(CosNaming)n(::)o
(NamingContext_var)f(testContext)n(;)562 3826 y(try)i({)661
3926 y Fd(//)h(Bind)f(the)g(context)f(to)i(root)o(.)661
4026 y Fe(testContext)e(=)i(rootContext)n(->)o(bind_new_context)m
(\(contextName)n(\);)562 4125 y(})562 4225 y(catch)o(\()o(CosNaming)o
(::)o(NamingContext)n(::AlreadyBound)m(&)g(ex\))f({)661
4324 y Fd(//)h(If)f(the)g(context)g(already)f(exists)o(,)i(this)f
(exception)f(will)h(be)h(raised)n(.)661 4424 y(//)g(In)f(this)g(case)o
(,)h(just)f(resolve)g(the)g(name)g(and)g(assign)g(testContext)661
4524 y(//)h(to)f(the)g(object)g(returned)o(:)661 4623
y Fe(CORBA)o(::Object_var)f(obj)o(;)661 4723 y(obj)h(=)h(rootContext)n
(->resolve)n(\(contextName)n(\);)661 4823 y(testContext)e(=)i
(CosNaming)n(::NamingContext)m(::_narrow)n(\(obj\);)661
4922 y(if\()f(CORBA)o(::is_nil)o(\(testContext)n(\))g(\))h({)761
5022 y(cerr)f(<<)g("Failed)g(to)g(narrow)g(naming)g(context)n(.")h(<<)f
(endl)o(;)761 5121 y(return)f(0;)661 5221 y(})562 5321
y(})p eop
%%Page: 41 49
41 48 bop 63 282 a Fg(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Fs(41)403 638 y Fd(//)49 b(Bind)h(objref)e(with)h(name)g(Echo)g(to)h
(the)f(testContext)n(:)403 738 y Fe(CosNaming)n(::Name)g(objectName)n
(;)403 837 y(objectName)n(.length)o(\(1\);)403 937 y(objectName)n([0].)
o(id)150 b(=)49 b(\(const)g(char)o(*\))h(")o(Echo")o(;)150
b Fd(//)49 b(string)g(copied)403 1037 y Fe(objectName)n([0].)o(kind)h
(=)f(\(const)g(char)o(*\))h(")o(Object)o(";)g Fd(//)f(string)g(copied)
403 1236 y Fe(try)g({)503 1336 y(testContext)n(->)o(bind\()o
(objectName)n(,)h(objref)o(\);)403 1435 y(})403 1535
y(catch)o(\(CosNaming)n(::NamingContext)m(::AlreadyBound)n(&)f(ex\))h
({)503 1634 y(testContext)n(->)o(rebind)o(\(objectName)n(,)g(objref)o
(\);)403 1734 y(})403 1834 y Fd(//)f(Note:)g(Using)g(rebind)o(\(\))h
(will)f(overwrite)f(any)h(Object)g(previously)403 1933
y(//)348 b(bound)49 b(to)h(/test)o(/Echo)f(with)g(obj)o(.)403
2033 y(//)348 b(Alternatively)n(,)50 b(bind)o(\(\))f(can)h(be)f(used)o
(,)h(which)f(will)g(raise)g(a)403 2133 y(//)348 b(CosNaming)o(::)o
(NamingContext)n(::AlreadyBound)47 b(exception)h(if)403
2232 y(//)348 b(the)50 b(name)f(supplied)f(is)h(already)g(bound)g(to)g
(an)h(object)o(.)403 2431 y(//)f(Amendment)o(:)g(When)h(using)e
(OrbixNames)o(,)h(it)h(is)f(necessary)f(to)i(first)403
2531 y(//)f(try)h(bind)f(and)g(then)g(rebind)o(,)h(as)f(rebind)g(on)g
(it's)g(own)h(will)f(throw)403 2631 y(//)g(a)h(NotFoundexception)d(if)i
(the)g(Name)h(has)f(not)g(already)g(been)g(bound)o(.)403
2730 y(//)g([This)g(is)h(incorrect)e(behaviour)g(--)i(it)f(should)g
(just)g(bind)o(].)303 2830 y Fe(})303 2930 y(catch)o(\(CORBA)o
(::COMM_FAILURE)n(&)g(ex\))h({)403 3029 y(cerr)f(<<)h(")o(Caught)f
(system)g(exception)f(COMM_FAILURE)f(--)j(unable)f(to)g(")652
3129 y(<<)h(")o(contact)f(the)g(naming)g(service)o(.")g(<<)g(endl;)403
3229 y(return)g(0;)303 3328 y(})303 3428 y(catch)o(\(CORBA)o
(::SystemException)m(&\))h({)403 3527 y(cerr)f(<<)h(")o(Caught)f(a)h
(CORBA)o(::)o(SystemException)d(while)i(using)g(the)g(")652
3627 y(<<)h(")o(naming)f(service)o(.")g(<<)h(endl)o(;)403
3727 y(return)f(0;)303 3826 y(})303 3926 y(return)g(1;)204
4026 y(})p eop
%%Page: 42 50
42 49 bop 221 282 a Fs(42)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)221 539 y Fk(2.12.7)99 b(dir)-5 b(.mk)362
911 y Fe(CXXSRCS)49 b(=)g(eg1.cc)g(eg2_impl.cc)f(eg2_clt.cc)g
(eg3_impl.cc)g(eg3_clt.cc)362 1110 y(DIR_CPPFLAGS)g(=)h
($\(CORBA_CPPFLAGS)n(\))362 1309 y(CORBA_INTERFACES)e(=)j(echo)362
1508 y(ifdef)f(OSF1)362 1608 y(ifeq)g(\($\(notdir)f($\(CXX\)\),)o(cxx)o
(\))362 1708 y(NoTieExample)g(=)h(1)362 1807 y(endif)362
1907 y(endif)362 2106 y(ifndef)g(NoTieExample)362 2206
y Fd(#)h(-Wbtp)f(tells)g(the)g(compiler)f(to)i(generate)e(tie)h
(implementation)e(template)362 2305 y Fe(OMNIORB_IDL)h(+=)h(-Wbtp)362
2405 y(eg3_tieimpl)f(=)i($)o(\(patsubst)f(\045)o(,$\(BinPattern)n
(\),eg3_tieimpl)n(\))362 2505 y(endif)362 2704 y(eg1)398
b(=)50 b($\()o(patsubst)f(\045,)o($\(BinPattern)n(\),eg1)o(\))362
2803 y(eg2_impl)148 b(=)50 b($\()o(patsubst)f(\045,)o($\(BinPattern)n
(\),eg2_impl)n(\))362 2903 y(eg2_clt)198 b(=)50 b($\()o(patsubst)f
(\045,)o($\(BinPattern)n(\),eg2_clt)o(\))362 3003 y(eg3_impl)148
b(=)50 b($\()o(patsubst)f(\045,)o($\(BinPattern)n(\),eg3_impl)n(\))362
3102 y(eg3_clt)198 b(=)50 b($\()o(patsubst)f(\045,)o($\(BinPattern)n
(\),eg3_clt)o(\))362 3302 y(all::)g($\(eg1)o(\))h($\()o(eg2_impl)o(\))g
($)o(\(eg2_clt)o(\))99 b($\(eg3_impl)o(\))49 b($\(eg3_clt)n(\))h
($\(eg3_tieimpl)n(\))362 3501 y(clean)o(::)761 3600 y($\()o(RM\))g($)o
(\(eg1\))f($\(eg2_impl)o(\))g($\(eg2_clt)n(\))h($\(eg3_impl)n(\))g($\()
o(eg3_clt)o(\))g(\\)1159 3700 y($\(eg3_tieimpl)n(\))362
3899 y(export)o(::)g($)o(\(eg1\))f($\(eg2_impl)n(\))h($\(eg2_clt)n(\))g
($\(eg3_impl)n(\))g($\()o(eg3_clt)o(\))g($\()o(eg3_tieimpl)n(\))761
3999 y(@\()o(module)o(="echoexamples)n(";)f($\(ExportExecutable)m(\)\))
362 4198 y($\(eg1)o(\):)h(eg1.o)f($)o(\(CORBA_STATIC_STUB_OBJS)l(\))h
($\()o(CORBA_LIB_DEPEND)m(\))761 4298 y(@\()o(libs=)o
("$\(CORBA_LIB_NODYN)m(\)";)f($\(CXXExecutable)n(\)\))362
4497 y($\(eg2_impl)n(\):)h(eg2_impl.o)e($\()o(CORBA_STATIC_STUB_OBJS)l
(\))i($\(CORBA_LIB_DEPEND)m(\))761 4597 y(@\()o(libs=)o
("$\(CORBA_LIB_NODYN)m(\)";)f($\(CXXExecutable)n(\)\))362
4796 y($\(eg2_clt)o(\):)g(eg2_clt.o)f($\(CORBA_STATIC_STUB_OBJS)l(\))h
($\(CORBA_LIB_DEPEND)m(\))761 4896 y(@\()o(libs=)o("$\(CORBA_LIB_NODYN)
m(\)";)g($\(CXXExecutable)n(\)\))362 5095 y($\(eg3_impl)n(\):)h
(eg3_impl.o)e($\()o(CORBA_STATIC_STUB_OBJS)l(\))i($\(CORBA_LIB_DEPEND)m
(\))761 5194 y(@\()o(libs=)o("$\(CORBA_LIB_NODYN)m(\)";)f
($\(CXXExecutable)n(\)\))362 5394 y($\(eg3_clt)o(\):)g(eg3_clt.o)f
($\(CORBA_STATIC_STUB_OBJS)l(\))h($\(CORBA_LIB_DEPEND)m(\))p
eop
%%Page: 43 51
43 50 bop 63 282 a Fg(2.12.)51 b(SOURCE)23 b(LISTINGS)2157
b Fs(43)602 539 y Fe(@\(libs)o(="$\()o(CORBA_LIB_NODYN)n(\)")o(;)50
b($\(CXXExecutable)m(\)\))204 738 y(ifndef)e(NoTieExample)204
837 y($\()o(eg3_tieimpl)n(\):)i(eg3_tieimpl.o)d
($\(CORBA_STATIC_STUB_OBJS)l(\))i($\(CORBA_LIB_DEPEND)m(\))602
937 y(@\(libs)o(="$\()o(CORBA_LIB_NODYN)n(\)")o(;)h($\(CXXExecutable)m
(\)\))204 1037 y(endif)p eop
%%Page: 44 52
44 51 bop 221 282 a Fs(44)2093 b Fg(CHAPTER)21 b(2.)51
b(THE)22 b(BASICS)p eop
%%Page: 45 53
45 52 bop 63 1166 a Fm(Chapter)44 b(3)63 1585 y Fo(C++)52
b(language)g(mapping)63 2048 y Fs(Now)29 b(that)i(you)f(ar)n(e)h
(familiar)i(with)e(the)f(basics,)j(it)e(is)f(important)h(to)f
(familiarise)j(yourself)63 2161 y(with)e(the)g(standar)n(d)g(IDL)g(to)f
(C++)j(language)e(mapping.)54 b(The)31 b(mapping)g(is)h(described)e(in)
63 2274 y(detail)22 b(in)h([OMG99)r(].)28 b(If)22 b(you)f(have)i(not)e
(done)g(so,)h(you)f(should)g(obtain)i(a)g(copy)e(of)h(the)g(docu-)63
2387 y(ment)g(and)g(use)g(that)g(as)h(the)f(pr)n(ogramming)h(guide)e
(to)h(omniORB.)204 2504 y(The)h(speci\002cation)g(is)h(not)f(an)h(easy)
f(r)n(ead.)30 b(The)23 b(alternative)h(is)g(to)f(use)g(one)f(of)i(the)f
(books)63 2617 y(on)32 b(CORBA)g(pr)n(ogramming)g(that)g(has)g(begun)g
(to)g(appear)-7 b(.)56 b(For)32 b(instance,)i(Henning)e(and)63
2730 y(V)-5 b(inoski's)24 b(`Advanced)h(CORBA)h(Pr)n(ogramming)f(with)g
(C++')i([HV99])f(includes)f(many)h(ex-)63 2843 y(ample)d(code)f(bits)g
(to)g(illustrate)h(how)f(to)g(use)g(the)f(CORBA)i(2.3)g(C++)h(mapping.)
63 3168 y Fq(3.1)119 b(Incompatibilities)28 b(with)h(pre-2.8.0)g
(releases)63 3387 y Fs(Befor)n(e)k(2.8.0,)k(omniORB)d(implemented)f
(the)g(CORBA)h(2.0)h(C++)g(mapping.)62 b(Fr)n(om)34 b(2.8.0)63
3500 y(onwar)n(ds,)21 b(the)g(mapping)i(has)f(been)g(updated)e(to)i
(CORBA)g(2.3.)28 b(Unfortunately)-10 b(,)21 b(to)h(comply)63
3613 y(with)29 b(the)g(CORBA)g(2.3)h(speci\002cation,)h(it)f(has)f
(been)g(necessary)f(to)h(change)g(the)g(semantics)63
3726 y(of)k(a)h(few)e(APIs)g(in)i(a)g(way)f(that)g(is)g(incompatible)h
(with)f(older)g(omniORB)g(r)n(eleases.)58 b(The)63 3839
y(incompatible)23 b(changes)f(ar)n(e)h(limited)h(to:)176
4073 y(1.)46 b(The)22 b(mapping)g(for)h(some)f(out)g(and)g(inout)g(ar)n
(gument)h(types)d(is)j(dif)n(fer)n(ent.)176 4278 y(2.)46
b(The)24 b(extraction)h(of)g(string,)g(object)g(r)n(efer)n(ence)f(and)h
(typecode)e(fr)n(om)j(an)f(Any)g(has)g(dif-)290 4391
y(fer)n(ent)d(ownership)f(r)o(ules.)176 4595 y(3.)46
b(the)29 b(DII)h(interface)g(now)f(defaults)g(to)g(r)n(eporting)g(a)h
(system)e(exception)h(by)h(raising)g(a)290 4708 y(C++)23
b(exception,)e(instead)h(of)h(r)n(eturning)f(the)f(exception)h(as)g(an)
i(envir)n(onment)e(value.)204 4942 y(The)i(changes)h(ar)n(e)h(minor)f
(and)h(r)n(equir)n(e)f(minimal)j(changes)c(to)h(the)g(application)h
(sour)n(ce)63 5055 y(code.)38 b(The)26 b(C++)i(compiler)e(will)i
(complain)g(about)f(the)e(\002rst)h(change.)39 b Fn(However)-5
b(,)28 b(it)f(is)g(not)63 5168 y(possible)h(to)f(detect)i(the)f(old)f
(usage)g(for)h(changes)g(2)g(and)f(3)h(at)g(compile)g(time.)43
b(In)28 b(partic-)63 5281 y(ular)-5 b(,)26 b(unmodi\002ed)d(code)i
(that)h(uses)g(the)f(af)n(fected)j(Any)c(extraction)k(operators)e(will)
f(most)63 5394 y(certainly)f(cause)g(runtime)f(errors)h(to)f(occur)-5
b(.)1662 5622 y Fs(45)p eop
%%Page: 46 54
46 53 bop 221 282 a Fs(46)1420 b Fg(CHAPTER)21 b(3.)51
b(C++)24 b(LANGUAGE)d(MAPPING)362 539 y Fs(T)-8 b(o)29
b(smooth)f(the)h(transition)g(fr)n(om)h(the)e(old)h(usage)g(to)f(the)h
(new)-8 b(,)30 b(an)g(omniORB)f(con\002g-)221 652 y(uration)23
b(variable)h Ff(omniORB::omniORB)o(_2)o(7_)o(Co)o(mp)o(ati)o(bl)o(eA)o
(ny)o(Ex)o(tra)o(ct)o(io)o(n)17 b Fs(can)23 b(be)221
764 y(set)k(to)g(r)n(evert)h(the)f(any)h(extraction)f(operators)f(to)h
(the)h(old)f(semantics.)44 b(Mor)n(e)27 b(information)221
877 y(can)d(be)e(found)g(in)h(chapter)f(9.)221 1171 y
Fq(3.2)119 b(BOA)29 b(compatibility)221 1382 y Fs(If)g(you)f(use)g(the)
g Ff(-WbBOA)f Fs(option)h(to)g(omniidl,)j(it)e(will)i(generate)c
(skeleton)g(code)h(with)h(the)221 1494 y(same)18 b(interface)f(as)h
(the)f(old)g(omniORB)h(2)g(BOA)f(mapping,)i(as)e(well)h(as)g(code)f(to)
g(be)g(used)f(with)221 1607 y(the)27 b(POA.)g(Note)f(that)h(since)h
(the)e(major)i(pr)n(oblem)g(with)f(the)g(BOA)g(speci\002cation)h(was)f
(that)221 1720 y(server)d(code)f(was)i(not)f(portable)g(between)f
(ORBs,)h(it)g(is)h(unlikely)f(that)h(omniORB)f(3's)h(BOA)221
1833 y(compatibility)30 b(will)g(help)e(you)g(much)h(if)g(you)f(ar)n(e)
h(moving)g(fr)n(om)g(a)g(dif)n(fer)n(ent)g(BOA-based)221
1946 y(ORB.)362 2059 y(The)e(BOA)g(compatibility)i(permits)d(the)g
(majority)i(of)f(BOA)g(code)g(to)f(compile)i(without)221
2172 y(dif)n(\002culty)-10 b(.)36 b(However)-7 b(,)24
b(ther)n(e)g(ar)n(e)i(a)g(number)f(of)g(constr)o(ucts)f(which)h(r)n
(elied)g(on)g(omniORB)g(2)221 2285 y(implementation)e(details)f(which)h
(no)f(longer)g(work.)358 2466 y Fp(\017)45 b Fs(omniORB)23
b(2)h(did)e(not)g(use)g(distinct)g(types)f(for)i(object)f(r)n(efer)n
(ences)g(and)h(servants,)e(and)448 2579 y(often)27 b(accepted)g(a)i
(pointer)e(to)g(a)h(servant)g(when)f(the)g(CORBA)h(speci\002cation)g
(says)f(it)448 2691 y(should)33 b(only)f(accept)h(an)h(object)f(r)n
(efer)n(ence.)59 b(Such)33 b(code)f(will)i(not)f(compile)g(under)448
2804 y(omniORB)23 b(3.)358 2981 y Fp(\017)45 b Fs(The)30
b(r)n(everse)f(is)h(tr)o(ue)f(for)h Ff(BOA::obj_is_rea)o(dy)o(\(\))o
Fs(.)45 b(It)29 b(now)g(only)h(works)f(when)448 3094
y(passed)c(a)h(pointer)f(to)h(a)g(servant)g(object,)g(not)f(an)i
(object)f(r)n(efer)n(ence.)37 b(The)26 b(mor)n(e)f(com-)448
3207 y(monly)18 b(used)f(mechanism)h(of)g(calling)i Ff
(_obj_is_ready\(b)o(oa)o(\))12 b Fs(on)17 b(the)g(servant)h(ob-)448
3320 y(ject)23 b(still)g(works)e(as)i(expected.)358 3497
y Fp(\017)45 b Fs(It)26 b(used)f(to)g(be)h(the)f(case)h(that)g(the)g
(skeleton)e(class)i(for)g(interface)g Ff(I)g Fs(\()p
Ff(_sk_I)p Fs(\))f(was)h(de-)448 3610 y(rived)k(fr)n(om)h(class)f
Ff(I)p Fs(.)g(This)g(meant)g(that)f(the)h(names)f(of)h(any)g(types)f
(declar)n(ed)g(in)i(the)448 3723 y(interface)d(wer)n(e)e(available)31
b(in)c(the)g(scope)f(of)h(the)f(skeleton)g(class.)42
b(This)27 b(is)g(no)g(longer)448 3836 y(tr)o(ue.)h(If)22
b(you)g(have)h(an)g(interface:)448 3975 y Fe(interface)49
b(I)g({)548 4074 y(struct)g(S)g({)648 4174 y(long)g(a,)o(b;)548
4274 y(};)548 4373 y(S)h(op)o(\(\);)448 4473 y(};)448
4657 y Fs(then)22 b(wher)n(e)g(befor)n(e)g(the)g(implementation)h(code)
e(might)i(have)g(been:)448 4796 y Fe(class)49 b(I_impl)g(:)h(public)e
(virtual)h(_sk_I)g({)548 4896 y(S)h(op)o(\(\);)99 b Fd(//)50
b(_sk_I)f(is)g(derived)g(from)g(I)448 4995 y Fe(};)448
5095 y(I::S)g(I_impl)o(::op\(\))g({)548 5194 y(S)h(ret)o(;)548
5294 y Fd(//)f(...)448 5394 y Fe(})p eop
%%Page: 47 55
47 54 bop 63 282 a Fg(3.2.)51 b(BOA)22 b(COMP)-8 b(A)h(TIBILITY)2081
b Fs(47)290 539 y(it)23 b(is)f(now)h(necessary)e(to)h(fully)h(qualify)h
(all)g(uses)d(of)h Ff(S)p Fs(:)290 688 y Fe(class)49
b(I_impl)g(:)g(public)g(virtual)f(_sk_I)h({)390 788 y(I)o(::S)h(op)o
(\(\);)g Fd(//)f(_sk_I)g(is)g(not)h(derived)e(from)h(I)290
887 y Fe(};)290 987 y(I::)o(S)h(I_impl)o(::op)o(\(\))g({)390
1087 y(I)o(::S)g(ret)o(;)390 1186 y Fd(//)f(...)290 1286
y Fe(})199 1523 y Fp(\017)d Fs(The)30 b(pr)n(oprietary)g(omniORB)g(2)i
(LifeCycle)f(extensions)d(ar)n(e)j(no)g(longer)f(supported.)290
1636 y(All)h(of)g(the)f(facilities)j(it)d(of)n(fer)n(ed)h(can)g(be)g
(implemented)f(with)g(the)g(POA)h(interfaces,)290 1749
y(and)23 b(the)f Ff(omniORB::LOCATI)o(ON)o(_FO)o(RW)o(AR)o(D)17
b Fs(exception)22 b(\(see)g(section)g(6.13\).)30 b(Code)290
1862 y(which)23 b(used)e(the)h(old)g(interfaces)h(will)h(have)f(to)f
(be)g(r)n(ewritten.)p eop
%%Page: 48 56
48 55 bop 221 282 a Fs(48)1420 b Fg(CHAPTER)21 b(3.)51
b(C++)24 b(LANGUAGE)d(MAPPING)p eop
%%Page: 49 57
49 56 bop 63 1161 a Fm(Chapter)44 b(4)63 1576 y Fo(Interoperable)53
b(Naming)f(Service)63 2035 y Fs(omniORB)27 b(3)h(supports)d(the)i
(Inter)n(operable)f(Naming)i(Service)f(\(INS\),)g(which)h(will)g(be)g
(part)63 2148 y(of)f(CORBA)h(2.4.)44 b(The)27 b(following)h(is)g(a)g
(summary)g(of)g(the)f(new)g(facilities)j(described)c(in)i(the)63
2261 y(INS)21 b(edited)g(chapters)h(document)f([OMG00)r(].)63
2557 y Fq(4.1)119 b(Object)29 b(URIs)63 2768 y Fs(As)22
b(well)i(as)f(accepting)g(IOR-format)h(strings,)e Ff(ORB::string_to)o
(_ob)o(je)o(ct)o(\(\))17 b Fs(now)22 b(also)63 2881 y(supports)29
b(two)h(new)h(Uniform)h(Resour)n(ce)e(Identi\002er)g(\(URI\))h
([BLFIM98])h(formats,)h(which)63 2994 y(can)25 b(be)g(used)f(to)g
(specify)h(objects)f(in)i(a)f(convenient)g(human-r)n(eadable)h(form.)35
b(The)24 b(existing)63 3107 y(IOR-format)f(strings)e(ar)n(e)i(now)f
(also)h(consider)n(ed)e(URIs.)63 3359 y Fk(4.1.1)99 b(corbaloc)63
3536 y Ff(corbaloc)21 b Fs(URIs)j(allow)i(you)e(to)g(specify)h(object)f
(r)n(efer)n(ences)g(which)i(can)g(be)e(contacted)h(by)63
3649 y(IIOP)-12 b(,)33 b(or)h(found)f(thr)n(ough)g Ff(ORB::resolve_in)o
(it)o(ia)o(l_)o(ref)o(er)o(en)o(ce)o(s\()o(\))p Fs(.)56
b(T)-8 b(o)33 b(specify)63 3762 y(an)23 b(IIOP)f(object)h(r)n(efer)n
(ence,)e(you)h(use)g(a)h(URI)f(of)g(the)g(form:)290 3958
y Ff(corbaloc:iiop:)p Fs(<)p Fr(host)p Fs(>)p Ff(:)p
Fs(<)p Fr(port)p Fs(>)p Ff(/)p Fs(<)p Fr(object)e(key)p
Fs(>)63 4155 y(for)i(example:)290 4352 y Ff(corbaloc:iiop:m)o(yh)o(os)o
(t.)o(ex)o(amp)o(le)o(.c)o(om)o(:1)o(234)o(/M)o(yO)o(bj)o(ec)o(tKe)o(y)
63 4549 y Fs(which)36 b(speci\002es)f(an)h(object)g(with)g(key)e
(`MyObjectKey')i(within)g(a)h(pr)n(ocess)d(r)o(unning)i(on)63
4662 y(myhost.example.com)d(listening)h(on)h(port)e(1234.)67
b(Object)35 b(keys)e(containing)j(non-ASCII)63 4774 y(characters)22
b(can)i(use)e(the)f(standar)n(d)h(URI)g(\045)h(escapes:)290
4971 y Ff(corbaloc:iiop:m)o(yh)o(os)o(t.)o(ex)o(amp)o(le)o(.c)o(om)o
(:1)o(234)o(/M)o(y\045)o(ef)o(Ob)o(jec)o(tK)o(ey)63 5168
y Fs(denotes)d(an)j(object)f(key)g(with)g(the)g(value)h(239)h(\(hex)f
(ef\))g(in)g(the)f(thir)n(d)g(octet.)204 5281 y(The)h(pr)n(otocol)g
(name)g(`)p Ff(iiop)p Fs(')g(can)h(be)g(abbr)n(eviated)g(to)f(the)g
(empty)f(string,)h(so)f(the)h(origi-)63 5394 y(nal)g(URI)f(can)h(be)g
(written:)1662 5622 y(49)p eop
%%Page: 50 58
50 57 bop 221 282 a Fs(50)1033 b Fg(CHAPTER)21 b(4.)51
b(INTEROPERABLE)19 b(NAMING)j(SER)-5 b(VICE)448 539 y
Ff(corbaloc::myhost)o(.e)o(xa)o(mp)o(le.)o(co)o(m:)o(12)o(34)o(/My)o
(Ob)o(je)o(ct)o(Ke)o(y)221 746 y Fs(The)19 b(IANA)f(has)i(assigned)e
(port)h(number)g(2809)1895 713 y Fl(1)1954 746 y Fs(for)h(use)e(by)i
Ff(corbaloc)p Fs(,)c(so)j(if)i(the)d(server)h(is)221
859 y(listening)j(on)g(that)g(port,)f(you)g(can)i(leave)g(the)e(port)g
(number)h(out.)27 b(The)21 b(following)i(two)e(URIs)221
972 y(r)n(efer)h(to)g(the)g(same)h(object:)448 1179 y
Ff(corbaloc::myhost)o(.e)o(xa)o(mp)o(le.)o(co)o(m:)o(28)o(09)o(/My)o
(Ob)o(je)o(ct)o(Ke)o(y)448 1292 y(corbaloc::myhost)o(.e)o(xa)o(mp)o
(le.)o(co)o(m/)o(My)o(Ob)o(jec)o(tK)o(ey)221 1499 y Fs(Y)-8
b(ou)17 b(can)h(specify)f(an)h(object)f(which)h(is)g(available)j(at)c
(mor)n(e)h(than)f(one)g(location)h(by)g(separating)221
1612 y(the)k(locations)h(with)f(commas:)448 1820 y Ff(corbaloc::myhost)
o(.e)o(xa)o(mp)o(le.)o(co)o(m,)s(:l)o(oca)o(lh)o(os)o(t:)o(12)o(34/)o
(My)o(Ob)o(je)o(ct)o(Key)221 2027 y Fs(Note)37 b(that)h(you)f(must)g(r)
n(estate)g(the)h(pr)n(otocol)f(for)h(each)h(addr)n(ess,)h(hence)e(the)f
(`)p Ff(:)p Fs(')h(befor)n(e)221 2140 y(`)p Ff(localhost)p
Fs('.)25 b(It)d(could)g(equally)h(have)g(been)f(written)g(`)p
Ff(iiop:localhost)o Fs('.)362 2253 y(Y)-8 b(ou)17 b(can)h(also)g
(specify)f(an)g(IIOP)h(version)f(number)-7 b(,)18 b(although)f(omniORB)
g(only)h(supports)221 2366 y(IIOP)23 b(1.0)g(at)g(pr)n(esent:)448
2573 y Ff(corbaloc::1.2@my)o(ho)o(st)o(.e)o(xam)o(pl)o(e.)o(co)o(m/)o
(MyO)o(bj)o(ec)o(tK)o(ey)221 2894 y Fs(Alternatively)-10
b(,)31 b(to)e(use)g Ff(resolve_initia)o(l_r)o(ef)o(er)o(en)o(ce)o
(s\(\))o Fs(,)c(you)k(use)g(a)h(URI)f(of)h(the)221 3006
y(form:)448 3214 y Ff(corbaloc:rir:/Na)o(me)o(Se)o(rv)o(ice)221
3468 y Fk(4.1.2)99 b(corbaname)221 3645 y Ff(corbaname)24
b Fs(URIs)j(cause)h Ff(string_to_objec)o(t\()o(\))22
b Fs(to)28 b(look-up)f(a)h(name)h(in)f(a)h(CORBA)221
3758 y(Naming)23 b(service.)28 b(They)21 b(ar)n(e)i(an)g(extension)e
(of)i(the)e Ff(corbaloc)f Fs(syntax:)448 3965 y Ff(corbaname:)p
Fs(<)p Fr(corbaloc)h(location)p Fs(>)p Ff(/)p Fs(<)p
Fr(object)k(key)p Fs(>)p Ff(#)p Fs(<)p Fr(stringi\002ed)h(name)p
Fs(>)221 4172 y(for)d(example:)448 4380 y Ff(corbaname::myhos)o(t/)o
(Na)o(me)o(Ser)o(vi)o(ce)o(#p)o(ro)o(jec)o(t/)o(ex)o(am)o(pl)o(e/e)o
(ch)o(o.)o(ob)o(j)448 4493 y(corbaname:rir:/N)o(am)o(eS)o(er)o(vic)o
(e#)o(pr)o(oj)o(ec)o(t/e)o(xa)o(mp)o(le)o(/e)o(cho)o(.o)o(bj)221
4700 y Fs(Note)e(that)h(the)f(object)h(found)g(with)g(the)f
Ff(corbaloc)p Fs(-style)d(portion)j(must)h(be)g(of)g(type)f
Ff(Cos-)221 4813 y(Naming::NamingC)o(on)o(tex)o(t)p Fs(,)27
b(or)32 b(something)e(derived)g(fr)n(om)j(it.)55 b(If)31
b(the)g(object)h(key)e(\(or)221 4926 y Ff(rir)22 b Fs(name\))h(is)f(`)p
Ff(NameService)p Fs(',)c(it)23 b(can)h(be)e(left)h(out:)448
5133 y Ff(corbaname::myhos)o(t#)o(pr)o(oj)o(ect)o(/e)o(xa)o(mp)o(le)o
(/ec)o(ho)o(.o)o(bj)448 5246 y(corbaname:rir:#p)o(ro)o(je)o(ct)o(/ex)o
(am)o(pl)o(e/)o(ec)o(ho.)o(ob)o(j)p 221 5306 1316 4 v
327 5362 a Fj(1)356 5394 y Fi(Not)c(2089)h(as)e(printed)h(in)f
([OMG00]!)p eop
%%Page: 51 59
51 58 bop 63 282 a Fg(4.2.)51 b(CONFIGURING)22 b(RESOL)-8
b(VE_INITIAL_REFERE)o(NCES)887 b Fs(51)63 539 y(The)19
b(stringi\002ed)f(name)i(portion)f(can)h(also)g(be)g(left)g(out,)f(in)h
(which)g(case)g(the)f(URI)g(denotes)e(the)63 652 y Ff(CosNaming::Nam)o
(in)o(gC)o(ont)o(ex)o(t)f Fs(which)24 b(would)e(have)h(been)f(used)f
(for)h(a)i(look-up:)290 846 y Ff(corbaname::myho)o(st)o(.e)o(xa)o(mp)o
(le.)o(co)o(m)290 959 y(corbaname:rir:)63 1154 y Fs(The)19
b(\002rst)h(of)g(these)f(examples)h(is)g(the)g(easiest)f(way)h(of)g
(specifying)g(the)g(location)h(of)f(a)h(naming)63 1267
y(service.)63 1562 y Fq(4.2)119 b(Con\002guring)31 b
(resolve_initial_references)63 1773 y Fs(The)20 b(INS)h(adds)f(two)h
(new)g(command)h(line)g(ar)n(guments)e(which)i(pr)n(ovide)f(a)h
(portable)f(way)h(of)63 1886 y(con\002guring)f Ff(ORB::resolve_ini)o
(ti)o(al)o(_r)o(efe)o(re)o(nc)o(es)o(\(\))o Fs(:)63 2138
y Fk(4.2.1)99 b(ORBInitRef)63 2315 y Ff(-ORBInitRef)28
b Fs(takes)33 b(an)h(ar)n(gument)g(of)f(the)g(form)h(<)p
Fr(ObjectId)p Fs(>)p Ff(=)p Fs(<)p Fr(ObjectURI)r Fs(>.)63
b(So,)36 b(for)63 2428 y(example,)22 b(with)g(command)i(line)f(ar)n
(guments)e(of:)290 2622 y Ff(-ORBInitRef)49 b(NameService=corb)o(an)o
(am)o(e:)o(:my)o(ho)o(st)o(.e)o(xa)o(mpl)o(e.)o(co)o(m)63
2817 y(resolve_initia)o(l_)o(re)o(fer)o(en)o(ce)o(s\()o("N)o(ame)o(Se)o
(rv)o(ic)o(e")o(\))25 b Fs(will)32 b(r)n(eturn)e(a)i(r)n(efer)n(ence)e
(to)63 2930 y(the)h(object)i(with)f(key)f(`NameService')i(available)j
(on)c(myhost.example.com,)h(port)e(2809.)63 3043 y(Since)22
b(IOR-format)h(strings)f(ar)n(e)h(consider)n(ed)e(URIs,)g(you)h(can)h
(also)g(say)f(things)g(like:)290 3238 y Ff(-ORBInitRef)49
b(NameService=IOR:)o(00)o(ff)o(..)o(.)63 3489 y Fk(4.2.2)99
b(ORBDefaultInitRef)63 3666 y Ff(-ORBDefaultIni)o(tR)o(ef)26
b Fs(pr)n(ovides)32 b(a)h(pr)n(e\002x)f(string)f(which)j(is)e(used)f
(to)h(r)n(esolve)g(other)n(-)63 3779 y(wise)f(unknown)f(names.)55
b(When)31 b Ff(resolve_initial)o(_r)o(ef)o(ere)o(nc)o(es)o(\(\))25
b Fs(is)32 b(unable)g(to)63 3892 y(r)n(esolve)i(a)h(name)g(which)g(has)
f(been)g(speci\002cally)i(con\002gur)n(ed)d(\(with)i
Ff(-ORBInitRef)p Fs(\),)d(it)63 4005 y(constr)o(ucts)d(a)j(string)e
(consisting)g(of)g(the)h(default)f(pr)n(e\002x,)i(a)g(`)p
Ff(/)p Fs(')f(character)-7 b(,)33 b(and)e(the)f(name)63
4118 y(r)n(equested.)24 b(The)c(string)g(is)h(then)f(fed)g(to)h
Ff(string_to_obje)o(ct)o(\(\))o Fs(.)h(So,)e(for)h(example,)g(with)63
4231 y(a)i(command)g(line)g(of:)290 4426 y Ff(-ORBDefaultInit)o(Re)o(f)
48 b(corbaloc::myhos)o(t.e)o(xa)o(mp)o(le)o(.c)o(om)63
4620 y Fs(a)19 b(call)h(to)e Ff(resolve_initial)o(_re)o(fe)o(re)o(nc)o
(es)o(\("M)o(yS)o(er)o(vi)o(ce)o("\))12 b Fs(will)20
b(r)n(eturn)e(the)g(object)63 4733 y(r)n(efer)n(ence)k(denoted)e(by)i
(`)p Ff(corbaloc::myhost)o(.e)o(xa)o(mpl)o(e.)o(co)o(m/)o(My)o(Ser)o
(vi)o(ce)o Fs('.)204 4846 y(Similarly)-10 b(,)37 b(a)d
Ff(corbaname)29 b Fs(pr)n(e\002x)k(can)h(be)f(used)f(to)h(cause)g
(look-ups)f(in)h(the)g(naming)63 4959 y(service.)40 b(Note,)26
b(however)-7 b(,)27 b(that)g(since)g(a)g(`)p Ff(/)p Fs(')g(character)h
(is)f(always)g(added)f(to)g(the)g(pr)n(e\002x,)h(it)63
5072 y(is)h(impossible)f(to)g(specify)h(a)g(look-up)f(in)h(the)f(r)n
(oot)g(context)g(of)g(the)g(naming)i(service\227you)63
5185 y(have)23 b(to)f(use)f(a)i(sub-context,)e(like:)290
5379 y Ff(-ORBDefaultInit)o(Re)o(f)48 b(corbaname::myho)o(st.)o(ex)o
(am)o(pl)o(e.)o(com)o(#s)o(er)o(vi)o(ce)o(s)p eop
%%Page: 52 60
52 59 bop 221 282 a Fs(52)1033 b Fg(CHAPTER)21 b(4.)51
b(INTEROPERABLE)19 b(NAMING)j(SER)-5 b(VICE)221 539 y
Fk(4.2.3)99 b(omniORB)25 b(con\002guration)h(\002le)221
716 y Fs(As)h(an)h(extension)e(to)h(the)f(standar)n(d)h(facilities)i
(of)f(the)f(INS,)f(omniORB)h(supports)e(con\002gu-)221
829 y(ration)h(\002le)g(entries)e(named)i Ff(ORBInitRef)21
b Fs(and)26 b Ff(ORBDefaultInitR)o(ef)o Fs(.)32 b(The)25
b(syntax)g(is)221 942 y(identical)f(to)e(the)g(command)h(line)g(ar)n
(guments.)k Ff(omniORB.cfg)17 b Fs(might)23 b(contain:)448
1156 y Ff(ORBInitRef)50 b(NameService=corb)o(an)o(am)o(e:)o(:my)o(ho)o
(st)o(.e)o(xa)o(mpl)o(e.)o(co)o(m)448 1269 y(ORBDefaultInitRe)o(f)e
(corbaname:rir:#)o(ser)o(vi)o(ce)o(s)221 1526 y Fk(4.2.4)99
b(Resolution)26 b(order)221 1704 y Fs(W)-5 b(ith)21 b(all)i(these)d
(options)f(for)i(specifying)g(object)g(r)n(efer)n(ences)f(to)h(be)g(r)n
(eturned)e(by)j Ff(resolve_)221 1817 y(initial_referen)o(ce)o(s\(\))o
Fs(,)k(it)31 b(is)f(important)g(to)g(understand)e(the)i(or)n(der)f(in)i
(which)g(the)221 1930 y(options)20 b(ar)n(e)i(tried.)27
b(The)21 b(r)n(esolution)f(or)n(der)-7 b(,)21 b(as)h(r)n(equir)n(ed)f
(by)g(the)g(CORBA)h(speci\002cation,)f(is:)335 2144 y(1.)45
b(Check)23 b(for)g(special)g(names)f(such)h(as)f(`)p
Ff(RootPOA)p Fs(')2194 2111 y Fl(2)2229 2144 y Fs(.)335
2333 y(2.)45 b(Resolve)22 b(with)h(an)g Ff(-ORBInitRef)17
b Fs(ar)n(gument.)335 2522 y(3.)45 b(Resolve)22 b(with)h(the)e
Ff(-ORBDefaultInitR)o(ef)16 b Fs(pr)n(e\002x,)22 b(if)h(pr)n(esent.)335
2711 y(4.)45 b(Resolve)22 b(with)h(an)h Ff(ORBInitRef)18
b Fs(\(or)23 b(old-style)f Ff(NAMESERVICE)p Fs(\))c(entry)k(in)i(the)e
(con-)448 2824 y(\002guration)h(\002le.)335 3013 y(5.)45
b(Resolve)37 b(with)h(the)e Ff(ORBDefaultInitRe)o(f)c
Fs(entry)k(in)i(the)f(con\002guration)g(\002le,)k(if)448
3126 y(pr)n(esent.)335 3315 y(6.)k(Resolve)22 b(with)h(the)e(depr)n
(ecated)g Ff(ORBInitialHost)16 b Fs(boot)22 b(agent.)221
3529 y(This)17 b(or)n(der)f(mostly)h(has)g(the)g(expected)e
(consequences\227in)g(particular)k(that)e(command)h(line)221
3642 y(ar)n(guments)h(override)h(entries)f(in)h(the)g(con\002guration)f
(\002le.)27 b(However)-7 b(,)20 b(you)f(must)h(be)g(car)n(eful)221
3755 y(with)h(the)f(default)g(pr)n(e\002xes.)26 b(Suppose)19
b(you)h(have)h(con\002gur)n(ed)e(a)j(`)p Ff(NameService)p
Fs(')16 b(entry)k(in)221 3868 y(the)i(con\002guration)g(\002le,)g(and)h
(you)f(specify)g(a)h(default)f(pr)n(e\002x)h(on)f(the)g(command)h(line)
g(with:)448 4082 y Ff(-ORBDefaultInitR)o(ef)48 b(corbaname:rir:)o(#se)o
(rv)o(ic)o(es)221 4297 y Fs(expecting)33 b(unknown)h(services)g(to)f
(be)i(looked)e(up)h(in)h(the)f(con\002gur)n(ed)f(naming)i(service.)221
4410 y(Now)-8 b(,)17 b(step)f(3)h(above)h(means)f(that)g
Ff(resolve_initia)o(l_)o(ref)o(er)o(en)o(ce)o(s\()o("My)o(Se)o(rv)o(ic)
o(e")o(\))221 4523 y Fs(should)22 b(be)g(pr)n(ocessed)f(with)h(the)g
(steps:)335 4737 y(1.)45 b(Constr)o(uct)24 b(the)f(URI)h(`)p
Ff(corbaname:rir:#)o(se)o(rv)o(ic)o(es)o(/My)o(Se)o(rv)o(ic)o(e)p
Fs(')18 b(and)25 b(give)f(it)448 4850 y(to)e Ff(string_to_object)o
(\(\))o Fs(.)335 5039 y(2.)45 b(Resolve)22 b(the)g(\002rst)g(part)g(of)
h(the)e Ff(corbaname)e Fs(URI)j(by)g(calling)448 5152
y Ff(resolve_initial_)o(re)o(fe)o(re)o(nce)o(s\()o("N)o(am)o(eS)o(erv)o
(ic)o(e")o(\))p Fs(.)p 221 5215 1316 4 v 327 5271 a Fj(2)356
5302 y Fi(In)e(fact,)g(a)g(strict)g(r)o(eading)e(of)h(the)h
(speci\002cation)g(says)f(that)j(it)d(should)g(be)h(possible)e(to)i
(override)e(`)p Fh(RootPOA)p Fi(')221 5394 y(etc.)h(with)g
Fh(-ORBInitRef)p Fi(,)e(but)i(since)g(POAs)f(ar)o(e)g(locality)g
(constrained)h(that)h(is)e(ridiculous.)p eop
%%Page: 53 61
53 60 bop 63 282 a Fg(4.3.)51 b(OMNINAMES)2410 b Fs(53)176
539 y(3.)46 b(Constr)o(uct)18 b(the)f(URI)h(`)p Ff(corbaname:rir:#)o
(se)o(rvi)o(ce)o(s/)o(Na)o(me)o(Ser)o(vi)o(ce)o Fs(')13
b(and)19 b(give)290 652 y(it)k(to)f Ff(string_to_obje)o(ct)o(\(\))p
Fs(.)176 838 y(4.)46 b(Resolve)21 b(the)h(\002rst)g(part)g(of)h(the)f
Ff(corbaname)d Fs(URI)i(by)i(calling)290 951 y Ff(resolve_initial)o(_r)
o(ef)o(er)o(en)o(ces)o(\(")o(Na)o(me)o(Se)o(rvi)o(ce)o("\))o
Fs(.)176 1137 y(5.)46 b(.)14 b(.)g(.)35 b(and)22 b(so)g(on)h(for)f
(ever.)14 b(.)g(.)63 1346 y(omniORB)22 b(detects)e(loops)g(like)i(this)
g(and)g(thr)n(ows)f(either)g Ff(CORBA::ORB::Inv)o(al)o(id)o(Na)o(me)63
1459 y Fs(if)d(the)g(loop)f(started)f(with)i(a)h(call)h(to)d
Ff(resolve_initial)o(_r)o(ef)o(er)o(enc)o(es)o(\(\))o
Fs(,)c(or)18 b Ff(CORBA::)63 1572 y(BAD_PARAM)h Fs(if)k(it)h(started)d
(with)i(a)g(call)i(to)e Ff(string_to_obje)o(ct)o(\(\))p
Fs(.)g(T)-8 b(o)22 b(avoid)h(the)f(pr)n(ob-)63 1685 y(lem)h(you)g(must)
f(either)h(specify)f(the)h Ff(NameService)18 b Fs(r)n(efer)n(ence)23
b(on)g(the)f(command)i(line,)g(or)63 1798 y(put)d(the)h
Ff(DefaultInitRef)17 b Fs(in)23 b(the)f(con\002guration)g(\002le.)63
2096 y Fq(4.3)119 b(omniNames)63 2310 y Fk(4.3.1)99 b(NamingContextExt)
63 2487 y Fs(omniNames)22 b(now)g(supports)e(the)i Ff(CosNaming::Nami)o
(ng)o(Co)o(nt)o(ext)o(Ex)o(t)16 b Fs(interface:)204 2635
y Fe(module)48 b(CosNaming)h({)303 2735 y(interface)g(NamingContextExt)
d(:)k(NamingContext)d({)403 2835 y(typedef)i(string)f(StringName)n(;)
403 2934 y(typedef)h(string)f(Address)o(;)403 3034 y(typedef)h(string)f
(URLString)o(;)403 3233 y(StringName)98 b(to_string)n(\(in)49
b(Name)g(n\))399 b(raises)n(\(InvalidName)n(\);)403 3333
y(Name)f(to_name)98 b(\(in)49 b(StringName)f(sn\))i(raises)n
(\(InvalidName)n(\);)403 3532 y(exception)e(InvalidAddress)f({};)403
3731 y(URLString)148 b(to_url)o(\(in)49 b(Address)f(addr,)h(in)h
(StringName)e(sn)o(\))503 3831 y(raises)o(\()o(InvalidAddress)n(,)h
(InvalidName)n(\);)403 4030 y(Object)298 b(resolve_str)n(\(in)49
b(StringName)f(n\))503 4130 y(raises)o(\()o(NotFound)o(,)i
(CannotProceed)m(,)g(InvalidName)n(,)f(AlreadyBound)n(\);)303
4229 y(};)204 4329 y(};)204 4490 y Ff(to_string\(\))25
b Fs(and)30 b Ff(to_name\(\))c Fs(convert)j(fr)n(om)i
Ff(CosNaming::Nam)o(e)24 b Fs(sequences)63 4603 y(to)g(\003attened)g
(strings)g(and)i(vice-versa.)36 b(Note)24 b(that)h(calling)i(these)d
(operations)g(involves)h(r)n(e-)63 4716 y(mote)32 b(calls)j(to)d(the)g
(naming)i(service,)i(so)c(they)g(ar)n(e)h(not)g(particularly)h(ef)n
(\002cient.)60 b(Y)-8 b(ou)32 b(can)63 4829 y(use)h(the)h(omniORB)g
(speci\002c)h(local)h Ff(omniURI::nameTo)o(St)o(ri)o(ng)o(\(\))28
b Fs(and)35 b Ff(omniURI::)63 4942 y(stringToName\(\))16
b Fs(functions)22 b(instead.)204 5055 y(A)27 b Ff(CosNaming::Name)21
b Fs(is)28 b(stringi\002ed)f(by)h(separating)f(name)h(components)e
(with)h(`)p Ff(/)p Fs(')63 5168 y(characters.)38 b(The)25
b Ff(kind)g Fs(and)h Ff(id)f Fs(\002elds)g(of)h(each)h(component)e(ar)n
(e)h(separated)f(by)h(`)p Ff(.)p Fs(')38 b(char)n(-)63
5281 y(acters.)45 b(If)29 b(the)e Ff(kind)g Fs(\002eld)i(is)f(empty)-10
b(,)29 b(the)f(r)n(epr)n(esentation)e(has)j(no)f(trailing)i(`)p
Ff(.)p Fs(';)h(if)f(the)d Ff(id)63 5394 y Fs(is)j(empty)-10
b(,)31 b(the)f(r)n(epr)n(esentation)f(starts)h(with)g(a)h(`)p
Ff(.)p Fs(')53 b(character;)35 b(if)c(both)g Ff(id)f
Fs(and)g Ff(kind)f Fs(ar)n(e)p eop
%%Page: 54 62
54 61 bop 221 282 a Fs(54)1033 b Fg(CHAPTER)21 b(4.)51
b(INTEROPERABLE)19 b(NAMING)j(SER)-5 b(VICE)221 539 y
Fs(empty)-10 b(,)19 b(the)f(r)n(epr)n(esentation)g(is)i(just)f(a)h(`)p
Ff(.)p Fs('.)27 b(The)18 b(backslash)j(`)p Ff(\\)p Fs(')e(is)h(used)e
(to)h(escape)g(the)f(mean-)221 652 y(ing)23 b(of)f(`)p
Ff(/)p Fs(',)h(`)p Ff(.)p Fs(')28 b(and)23 b(`)p Ff(\\)p
Fs(')g(itself.)362 768 y Ff(to_url\(\))31 b Fs(takes)i(a)i
Ff(corbaloc)c Fs(style)i(addr)n(ess)g(and)h(key)g(string)f(\(but)h
(without)g(the)221 881 y Ff(corbaloc:)24 b Fs(part\),)30
b(and)e(a)h(stringi\002ed)e(name,)i(and)f(r)n(eturns)f(a)i
Ff(corbaname)24 b Fs(URI)k(\(incor)n(-)221 993 y(r)n(ectly)h(called)h
(a)f(URL\))g(string,)g(having)h(pr)n(operly)d(escaped)h(any)h(invalid)i
(characters.)47 b(The)221 1106 y(speci\002cation)26 b(does)e(not)h
(make)h(it)g(clear)h(whether)d(or)i(not)f(the)g(addr)n(ess)f(string)h
(should)g(also)221 1219 y(be)c(escaped)e(by)i(the)f(operation;)g
(omniORB)h(does)e(not)h(escape)g(it.)27 b(For)20 b(this)h(r)n(eason,)f
(it)h(is)g(best)221 1332 y(to)e(avoid)h(calling)h Ff(to_url\(\))16
b Fs(if)k(the)e(addr)n(ess)g(part)h(contains)h(escapable)f(characters.)
27 b(omni-)221 1445 y(ORB)c(pr)n(ovides)e(the)h(equivalent)h(local)h
(function)f Ff(omniURI::addrA)o(nd)o(Nam)o(eT)o(oU)o(RI)o(\(\))o
Fs(.)362 1561 y Ff(resolve_str\(\))12 b Fs(is)18 b(equivalent)f(to)g
(calling)i Ff(to_name\(\))14 b Fs(followed)j(by)g(the)g(inherited)221
1674 y Ff(resolve\(\))22 b Fs(operation.)38 b(Ther)n(e)26
b(ar)n(e)g(no)g(string-based)f(equivalents)h(of)h(the)e(various)i(bind)
221 1787 y(operations.)221 2062 y Fk(4.3.2)99 b(Use)24
b(with)i(corbaname)221 2245 y Fs(T)-8 b(o)25 b(make)h(it)g(easy)g(to)f
(use)g(omniNames)h(with)g Ff(corbaname)c Fs(URIs,)j(it)i(now)e(starts)g
(with)h(the)221 2358 y(default)36 b(port)f(of)h(2809,)41
b(and)36 b(an)h(object)e(key)g(of)h(`)p Ff(NameService)p
Fs(')c(for)k(the)f(r)n(oot)g(naming)221 2471 y(context.)40
b(This)27 b(is)g(only)g(possible)f(when)h(it)g(is)g(started)f(`fr)n
(esh',)i(rather)e(than)h(with)g(a)h(log)f(\002le)221
2584 y(fr)n(om)c(an)g(older)f(omniNames)h(version.)362
2700 y(If)k(you)f(have)i(a)f(pr)n(evious)g(omniNames)g(log,)g
(con\002gur)n(ed)f(to)g(r)o(un)h(on)g(a)g(dif)n(fer)n(ent)g(port,)221
2813 y(and)18 b(with)h(a)g(dif)n(fer)n(ent)f(object)g(key)f(for)h(its)g
(r)n(oot)g(context,)g(all)h(is)g(not)e(lost.)26 b(If)18
b(the)g(r)n(oot)f(context's)221 2926 y(object)h(key)f(is)i(not)f(`)p
Ff(NameService)p Fs(',)c(omniNames)k(cr)n(eates)g(a)h(forwar)n(ding)f
(agent)g(with)g(that)221 3039 y(key)-10 b(.)45 b(Ef)n(fectively)-10
b(,)30 b(this)e(means)h(that)f(ther)n(e)g(ar)n(e)h(two)f(object)g(keys)
f(which)j(r)n(efer)e(to)g(the)g(r)n(oot)221 3152 y(context\227`)p
Ff(NameService)p Fs(')17 b(and)23 b(whatever)e(the)h(original)i(key)d
(was.)362 3268 y(For)f(the)g(port)g(number)-7 b(,)21
b(ther)n(e)f(ar)n(e)h(two)f(options.)26 b(The)20 b(\002rst)g(is)h(to)f
(r)o(un)h(omniNames)f(with)221 3381 y(a)j(command)h(line)f(ar)n(gument)
f(like:)448 3609 y Ff(omniNames)51 b(-logdir)g(/the/log/dir)e
(-ORBpoa_iiop_por)o(t)f(2809)221 3838 y Fs(This)28 b(causes)g(it)h(to)f
(listen)g(on)h(both)f(port)f(2809)k Fr(and)e Fs(whatever)f(port)f(it)i
(listened)e(on)i(befor)n(e.)221 3951 y(The)18 b(disadvantage)h(with)f
(this)h(is)g(that)g(the)f(IORs)g(to)g(all)j(naming)e(contexts)e(now)i
(contain)g(two)221 4064 y(IIOP)24 b(pr)n(o\002les,)f(one)g(for)h(each)g
(port,)f(which,)h(amongst)f(other)g(things,)f(incr)n(eases)i(the)f
(size)h(of)221 4177 y(the)e(omniNames)g(log.)362 4293
y(The)g(second)f(option)h(is)h(to)f(use)f(omniMapper)-7
b(,)23 b(as)f(described)g(below)-8 b(.)221 4612 y Fq(4.4)119
b(omniMapper)221 4829 y Fs(omniMapper)30 b(is)g(a)h(simple)f(daemon)g
(which)g(listens)g(on)g(port)f(2809)j(\(or)e(any)g(other)f(port\),)221
4942 y(and)17 b(r)n(edir)n(ects)g(IIOP)g(r)n(equests)e(for)i
(con\002gur)n(ed)f(object)h(keys)e(to)i(associated)f(persistent)f
(IORs.)221 5055 y(It)30 b(can)h(be)f(used)f(to)h(make)g(a)h(naming)g
(service)f(\(even)g(an)h(old)f(non-INS)f(awar)n(e)i(version)f(of)221
5168 y(omniNames)f(or)g(other)e(ORB's)i(naming)h(service\))f(appear)g
(on)f(port)g(2809)j(with)e(the)f(object)221 5281 y(key)19
b(`)p Ff(NameService)p Fs('.)k(The)c(same)h(goes)f(for)h(any)g(other)f
(service)h(you)g(may)g(wish)g(to)g(specify)-10 b(,)221
5394 y(such)23 b(as)f(an)h(interface)g(r)n(epository)-10
b(.)26 b(omniMapper)c(is)h(started)e(with)h(a)h(command)h(line)f(of:)p
eop
%%Page: 55 63
55 62 bop 63 282 a Fg(4.5.)51 b(CREA)-7 b(TING)22 b(OBJECTS)g(WITH)g
(SIMPLE)f(OBJECT)i(KEYS)893 b Fs(55)290 539 y Ff(omniMapper)50
b([-port)i Fs(<)p Fr(port)p Fs(>)p Ff(])j([-config)c
Fs(<)p Fr(con\002g)24 b(\002le)p Fs(>)p Ff(])54 b([-v])63
751 y Fs(The)26 b Ff(-port)g Fs(option)g(allows)i(you)f(to)f(choose)h
(a)h(port)e(other)g(than)i(2809)h(to)e(listen)g(on)3097
718 y Fl(3)3134 751 y Fs(.)42 b(The)63 864 y Ff(-config)19
b Fs(option)j(speci\002es)f(a)j(location)f(for)g(the)f(con\002guration)
g(\002le.)28 b(The)22 b(default)g(name)h(is)63 977 y
Ff(/etc/omniMappe)o(r.)o(cf)o(g)p Fs(,)k(or)j Ff(C:\\omniMapper.)o(cfg)
24 b Fs(on)30 b(W)-5 b(indows.)51 b(omniMapper)63 1090
y(does)22 b(not)h(normally)i(print)e(anything;)h(the)f
Ff(-v)g Fs(option)g(makes)h(it)g(verbose)f(so)g(it)h(prints)f(con-)63
1203 y(\002guration)k(information)h(and)f(a)h(r)n(ecor)n(d)g(of)f(the)g
(r)n(edir)n(ections)g(it)g(makes,)h(to)f(standar)n(d)g(out-)63
1316 y(put.)204 1429 y(The)e(con\002guration)h(\002le)g(is)g(very)g
(simple.)38 b(Each)27 b(line)f(contains)g(a)h(string)e(to)h(be)g(used)e
(as)63 1542 y(an)e(object)h(key)-10 b(,)20 b(some)i(white)g(space,)f
(and)i(an)f(IOR)h(\(or)f(any)g(valid)i(URI\))e(that)g(it)g(will)i(r)n
(edir)n(ect)63 1654 y(that)c(object)h(key)e(to.)27 b(Comments)20
b(should)g(be)g(pr)n(e\002xed)g(with)h(a)g(`)p Ff(#)p
Fs(')g(character)-7 b(.)28 b(For)20 b(example:)290 1867
y Ff(#)54 b(Example)d(omniMapper.cfg)290 1980 y(NameService)486
b(IOR:000f...)290 2093 y(InterfaceReposi)o(to)o(ry)48
b(IOR:0100...)204 2305 y Fs(omniMapper)25 b(can)i(either)d(be)i(r)o(un)
g(on)f(a)h(single)g(machine,)h(in)f(much)g(the)f(same)h(way)f(as)63
2418 y(omniNames,)f(or)g(it)g(can)h(be)g(r)o(un)f(on)g
Fr(every)i Fs(machine,)g(with)e(a)h(common)f(con\002guration)g(\002le.)
63 2531 y(That)e(way)-10 b(,)22 b(each)h(machine's)h(omniORB)e
(con\002guration)g(\002le)h(could)g(contain)g(the)f(line:)290
2744 y Ff(ORBDefaultInitR)o(ef)48 b(corbaloc::loca)o(lh)o(ost)63
3042 y Fq(4.5)119 b(Creating)29 b(objects)h(with)f(simple)h(object)g
(keys)63 3253 y Fs(In)k(normal)g(use,)i(omniORB)f(cr)n(eates)e(object)h
(keys)f(containing)h(various)h(information)g(in-)63 3366
y(cluding)24 b(POA)h(names)f(and)g(various)g(non-ASCII)g(characters.)33
b(Since)24 b(object)g(keys)f(ar)n(e)h(sup-)63 3479 y(posed)c(to)h(be)h
(opaque,)f(this)g(is)h(not)f(usually)h(a)h(pr)n(oblem.)28
b(The)21 b(INS)g(br)n(eaks)g(this)h(opacity)g(and)63
3592 y(r)n(equir)n(es)g(servers)f(to)h(cr)n(eate)g(objects)g(with)h
(human-friendly)g(keys.)204 3705 y(If)33 b(you)e(wish)i(to)f(make)h
(your)e(objects)h(available)k(with)d(human-friendly)g(URIs,)h(ther)n(e)
63 3818 y(ar)n(e)21 b(two)f(options.)25 b(The)20 b(\002rst)g(is)h(to)f
(use)g(omniMapper)g(as)h(described)e(above,)i(in)h(conjunction)63
3931 y(with)28 b(a)h Ff(PERSISTENT)23 b Fs(POA.)29 b(The)e(second)g(is)
h(to)g(cr)n(eate)g(objects)g(with)g(the)g(r)n(equir)n(ed)f(keys)63
4044 y(yourself.)35 b(Y)-8 b(ou)25 b(do)g(this)g(with)h(a)g(special)g
(POA)g(with)g(the)f(name)h(`)p Ff(omniINSPOA)p Fs(',)21
b(acquir)n(ed)63 4157 y(fr)n(om)e Ff(resolve_initia)o(l_)o(re)o(fer)o
(en)o(ce)o(s\()o(\))p Fs(.)h(This)f(POA)f(has)h(the)e
Ff(USER_ID)f Fs(and)i Ff(PER-)63 4269 y(SISTENT)25 b
Fs(policies,)k(and)f(the)f(special)i(pr)n(operty)d(that)i(the)f(object)
h(keys)e(it)j(cr)n(eates)e(contain)63 4382 y(only)e(the)g(object)g(ids)
h(given)f(to)g(the)g(POA,)g(and)h(no)f(other)g(data.)37
b(It)25 b(is)h(a)g(normal)g(POA)g(in)g(all)63 4495 y(other)d(r)n
(espects,)h(so)g(you)g(can)i(activate/deactivate)g(it,)f(cr)n(eate)g
(childr)n(en,)h(and)f(so)f(on,)h(in)g(the)63 4608 y(usual)d(way)-10
b(.)p 63 5306 1316 4 v 168 5362 a Fj(3)197 5394 y Fi(Y)j(ou)19
b(can)g(also)g(play)f(the)h Fh(-ORBpoa_iiop_port)d Fi(trick)i(to)h
(make)f(it)h(listen)f(on)h(mor)o(e)f(than)i(one)f(port.)p
eop
%%Page: 56 64
56 63 bop 221 282 a Fs(56)1033 b Fg(CHAPTER)21 b(4.)51
b(INTEROPERABLE)19 b(NAMING)j(SER)-5 b(VICE)p eop
%%Page: 57 65
57 64 bop 63 1164 a Fm(Chapter)44 b(5)63 1581 y Fo(The)52
b(IDL)g(compiler)63 2042 y Fs(omniORB)21 b(3)h(has)g(a)g(brand)g(new)f
(IDL)g(compiler)-7 b(,)22 b(named)g(omniidl.)28 b(It)21
b(consists)f(of)i(a)g(generic)63 2155 y(fr)n(ont-end)31
b(parser)h(written)f(in)i(C++,)j(and)d(a)g(number)f(of)h(back-ends)f
(written)f(in)i(Python.)63 2268 y(omniidl)28 b(is)f(very)g(strict)g
(about)g(IDL)g(validity)-10 b(,)30 b(so)c(you)h(may)h(\002nd)e(that)i
(it)f(r)n(eports)f(err)n(ors)g(in)63 2381 y(IDL)c(which)h(compiles)g
(\002ne)f(with)g(earlier)h(versions)f(of)h(omniORB,)f(and)h(with)f
(other)g(ORBs.)204 2496 y(The)g(general)g(form)h(of)f(an)h(omniidl)h
(command)f(line)g(is:)290 2720 y Ff(omniidl)51 b Fs([)p
Fr(options)p Fs(])57 b Ff(-b)p Fs(<)p Fr(back-end)p Fs(>)e([)p
Fr(back-end)19 b(options)p Fs(])57 b(<)p Fr(\002le)18
b(1)p Fs(>)55 b(<)p Fr(\002le)18 b(2)p Fs(>)55 b(.)14
b(.)g(.)63 3033 y Fq(5.1)119 b(Common)31 b(options)63
3248 y Fs(The)22 b(following)g(options)g(ar)n(e)h(common)f(to)g(all)j
(back-ends:)63 3474 y Ff(-D)p Fr(name)p Fs([)p Ff(=)p
Fr(value)p Fs(])68 b(De\002ne)22 b Fr(name)h Fs(for)f(the)g(pr)n(epr)n
(ocessor)-7 b(.)63 3587 y Ff(-U)p Fr(name)379 b Fs(Unde\002ne)21
b Fr(name)i Fs(for)f(the)g(pr)n(epr)n(ocessor)-7 b(.)63
3700 y Ff(-I)p Fr(dir)471 b Fs(Include)22 b Fr(dir)i
Fs(in)f(the)f(pr)n(epr)n(ocessor)e(sear)n(ch)j(path.)63
3813 y Ff(-E)576 b Fs(Only)23 b(r)o(un)g(the)f(pr)n(epr)n(ocessor)-7
b(,)20 b(sending)h(its)h(output)f(to)h(stdout.)63 3926
y Ff(-Y)p Fr(cmd)423 b Fs(Use)22 b Fr(cmd)g Fs(as)h(the)f(pr)n(epr)n
(ocessor)-7 b(,)20 b(rather)i(than)h(the)f(normal)h(C)g(pr)n(epr)n
(ocessor)-7 b(.)63 4039 y Ff(-N)576 b Fs(Do)23 b(not)f(r)o(un)g(the)g
(pr)n(epr)n(ocessor)-7 b(.)63 4152 y Ff(-T)576 b Fs(Use)22
b(a)h(temporary)e(\002le,)h(not)g(a)i(pipe,)d(for)i(pr)n(epr)n(ocessor)
d(output.)63 4265 y Ff(-Wp)p Fr(ar)n(g)p Fs([,)p Fr(ar)n(g)p
Fs(.)14 b(.)g(.)g(])91 b(Send)21 b(ar)n(guments)h(to)g(the)g(pr)n(epr)n
(ocessor)-7 b(.)63 4378 y Ff(-b)p Fr(back-end)256 b Fs(Run)22
b(the)g(speci\002ed)f(back-end.)28 b(For)22 b(the)g(C++)h(ORB,)f(use)g
Ff(-bcxx)p Fs(.)63 4490 y Ff(-Wb)p Fr(ar)n(g)p Fs([,)p
Fr(ar)n(g)p Fs(.)14 b(.)g(.)g(])91 b(Send)21 b(ar)n(guments)h(to)g(the)
g(back-end.)63 4603 y Ff(-nf)521 b Fs(Do)23 b(not)f(warn)g(about)h(unr)
n(esolved)e(forwar)n(d)i(declarations.)63 4716 y Ff(-k)576
b Fs(Keep)21 b(comments)h(after)h(declarations,)f(to)g(be)h(used)e(by)i
(some)e(back-ends.)63 4829 y Ff(-K)576 b Fs(Keep)21 b(comments)h(befor)
n(e)h(declarations,)f(to)g(be)h(used)e(by)h(some)g(back-ends.)63
4942 y Ff(-C)p Fr(dir)471 b Fs(Change)23 b(dir)n(ectory)e(to)h
Fr(dir)i Fs(befor)n(e)e(writing)h(output)e(\002les.)63
5055 y Ff(-d)576 b Fs(Dump)23 b(the)f(parsed)f(IDL)h(then)g(exit,)g
(without)g(r)o(unning)g(a)h(back-end.)63 5168 y Ff(-p)p
Fr(dir)471 b Fs(Use)22 b Fr(dir)h Fs(as)g(a)g(path)g(to)f(\002nd)g
(omniidl)h(back-ends.)63 5281 y Ff(-V)576 b Fs(Print)23
b(version)f(information)h(then)f(exit.)63 5394 y Ff(-u)576
b Fs(Print)23 b(usage)e(information.)1662 5622 y(57)p
eop
%%Page: 58 66
58 65 bop 221 282 a Fs(58)1751 b Fg(CHAPTER)22 b(5.)51
b(THE)21 b(IDL)i(COMPILER)221 539 y Ff(-v)577 b Fs(V)-10
b(erbose:)25 b(trace)e(compilation)h(stages.)221 874
y(Most)e(of)g(these)f(options)g(ar)n(e)i(self)g(explanatory)-10
b(,)21 b(but)i(some)f(ar)n(e)h(not)e(so)h(obvious.)221
1140 y Fk(5.1.1)99 b(Preprocessor)25 b(interactions)221
1321 y Fs(IDL)18 b(is)h(pr)n(ocessed)d(by)j(the)f(C)h(pr)n(epr)n
(ocessor)d(befor)n(e)i(omniidl)i(parses)d(it.)27 b(Unlike)18
b(the)g(old)g(IDL)221 1434 y(compiler)-7 b(,)40 b(which)c(used)f(dif)n
(fer)n(ent)g(C)i(pr)n(epr)n(ocessors)c(on)j(dif)n(fer)n(ent)f
(platforms,)k(omniidl)221 1547 y(always)32 b(uses)d(the)i(GNU)g(C)g(pr)
n(epr)n(ocessor)e(\(which)j(it)g(builds)f(with)g(the)g(name)g
(omnicpp\).)221 1660 y(The)23 b Ff(-D)p Fs(,)g Ff(-U)p
Fs(,)f(and)i Ff(-I)f Fs(options)f(ar)n(e)i(just)f(sent)f(to)h(the)g(pr)
n(epr)n(ocessor)-7 b(.)29 b(Note)22 b(that)i(the)e(curr)n(ent)221
1773 y(dir)n(ectory)j(is)h(not)f(on)g(the)g(include)h(sear)n(ch)g(path)
f(by)h(default\227use)e(`)p Ff(-I.)p Fs(')h(for)h(that.)37
b(The)25 b Ff(-Y)221 1886 y Fs(option)19 b(can)h(be)g(used)e(to)h
(specify)g(a)h(dif)n(fer)n(ent)f(pr)n(epr)n(ocessor)f(to)h(omnicpp.)26
b(Bewar)n(e)19 b(that)h(line)221 1998 y(dir)n(ectives)j(inserted)d(by)j
(other)e(pr)n(epr)n(ocessors)f(ar)n(e)j(likely)g(to)f(confuse)g
(omniidl.)221 2262 y Fn(5.1.1.1)92 b(W)m(indows)21 b(9x)221
2443 y Fs(The)h(output)f(fr)n(om)j(the)d(C)j(pr)n(epr)n(ocessor)c(is)j
(normally)h(fed)e(to)g(the)g(omniidl)h(parser)f(thr)n(ough)221
2555 y(a)j(pipe.)32 b(On)25 b(some)e(W)-5 b(indows)24
b(98)h(machines)g(\(but)f(not)g(all!\))35 b(the)24 b(pipe)f(does)g(not)
h(work,)f(and)221 2668 y(the)k(pr)n(epr)n(ocessor)d(output)i(is)h
(echoed)f(to)h(the)f(scr)n(een.)41 b(When)26 b(this)h(happens,)g(the)f
(omniidl)221 2781 y(parser)20 b(sees)g(an)h(empty)f(\002le,)h(and)g(pr)
n(oduces)f(useless)f(stub)h(\002les)h(with)g(strange)f(long)g(names.)
221 2894 y(T)-8 b(o)28 b(avoid)i(the)f(pr)n(oblem,)i(use)d(the)g(`)p
Ff(-T)p Fs(')h(option)f(to)h(cr)n(eate)g(a)h(temporary)e(\002le)h
(between)f(the)221 3007 y(two)22 b(stages.)221 3274 y
Fk(5.1.2)99 b(Forward-declared)24 b(interfaces)221 3454
y Fs(If)f(you)f(have)h(an)g(IDL)f(\002le)h(like:)362
3608 y Fe(interface)48 b(I;)362 3707 y(interface)g(J)i({)462
3807 y(attribute)e(I)i(the_I)o(;)362 3907 y(};)221 4075
y Fs(then)22 b(omniidl)h(will)h(normally)g(issue)d(a)i(warning:)321
4286 y Fe(test.idl:1:)48 b(Warning:)g(Forward)g(declared)h(interface)f
(`::I')h(was)g(never)321 4385 y(fully)g(defined)221 4608
y Fs(It)24 b(is)h(illegal)h(to)e(declar)n(e)h(such)f(IDL)g(in)h
(isolation,)h(but)e(it)h Fr(is)g Fs(valid)h(to)e(de\002ne)f(interface)i
Ff(I)f Fs(in)h(a)221 4721 y(separate)i(\002le.)44 b(If)29
b(you)e(have)h(a)h(lot)f(of)g(IDL)g(with)g(this)g(sort)f(of)h(constr)o
(uct,)g(you)f(will)j(dr)n(own)221 4833 y(under)22 b(the)f(warning)i
(messages.)j(Use)c(the)f Ff(-nf)h Fs(option)f(to)h(suppr)n(ess)f(them.)
221 5100 y Fk(5.1.3)99 b(Comments)221 5281 y Fs(By)17
b(default,)i(omniidl)g(discar)n(ds)f(comments)f(in)i(the)e(input)h
(IDL.)f(However)-7 b(,)18 b(with)g(the)f Ff(-k)g Fs(and)221
5394 y Ff(-K)i Fs(options,)g(it)h(pr)n(eserves)e(the)h(comments)h(for)g
(use)f(by)g(the)h(back-ends.)26 b(The)19 b(C++)i(back-end)p
eop
%%Page: 59 67
59 66 bop 63 282 a Fg(5.2.)51 b(C++)23 b(BACK-END)f(OPTIONS)1895
b Fs(59)63 539 y(ignor)n(es)24 b(this)g(information,)i(but)f(it)g(is)g
(r)n(elatively)h(easy)e(to)h(write)f(new)h(back-ends)f(which)i
Fr(do)63 652 y Fs(make)c(use)g(of)g(comments.)204 766
y(The)h(two)g(dif)n(fer)n(ent)h(options)e(r)n(elate)i(to)f(how)g
(comments)h(ar)n(e)g(attached)f(to)h(declarations)63
879 y(within)f(the)e(IDL.)h(Given)i(IDL)e(like:)204 1031
y Fe(interface)48 b(I)i({)303 1130 y(void)f(op1\(\);)303
1230 y Fd(//)h(A)f(comment)303 1329 y Fe(void)g(op2\(\);)204
1429 y(};)63 1596 y Fs(the)21 b Ff(-k)h Fs(\003ag)h(will)h(attach)f
(the)f(comment)h(to)f Ff(op1\(\))p Fs(;)e(the)i Ff(-K)f
Fs(\003ag)i(will)h(attach)f(it)g(to)f Ff(op2\(\))p Fs(.)63
1902 y Fq(5.2)119 b(C++)31 b(back-end)e(options)63 2116
y Fs(When)24 b(you)f(specify)h(the)g(C++)h(back-end)g(\(with)f
Ff(-bcxx)p Fs(\),)f(the)h(following)h Ff(-Wb)e Fs(options)g(ar)n(e)63
2229 y(available.)43 b(Note)25 b(that)i(the)f Ff(-Wb)f
Fs(options)g(must)i(be)f(speci\002ed)g Fr(after)i Fs(the)e
Ff(-bcxx)f Fs(option,)h(so)63 2341 y(omniidl)d(knows)e(which)i
(back-end)g(to)f(give)h(the)f(ar)n(guments)f(to.)63 2562
y Ff(-Wbh=)p Fr(suf\002x)516 b Fs(Use)22 b Fr(suf\002x)h
Fs(for)g(generated)d(header)i(\002les.)27 b(Default)c(`)p
Ff(.hh)p Fs('.)63 2675 y Ff(-Wbs=)p Fr(suf\002x)516 b
Fs(Use)22 b Fr(suf\002x)h Fs(for)g(generated)d(stub)i(\002les.)27
b(Default)d(`)p Ff(SK.cc)p Fs(.')63 2787 y Ff(-Wbd=)p
Fr(suf\002x)516 b Fs(Use)22 b Fr(suf\002x)h Fs(for)g(generated)d
(dynamic)j(\002les.)28 b(Default)23 b(`)p Ff(DynSK.cc)p
Fs(.')63 2900 y Ff(-Wba)775 b Fs(Generate)22 b(stubs)f(for)i(T)-8
b(ypeCode)20 b(and)j(Any)-10 b(.)63 3013 y Ff(-Wbtp)720
b Fs(Generate)22 b(`tie')h(implementation)f(skeletons.)63
3126 y Ff(-Wbtf)720 b Fs(Generate)22 b(\003attened)f(`tie')i
(implementation)f(skeletons.)63 3239 y Ff(-Wbsplice-modu)o(le)o(s)62
b Fs(Splice)23 b(together)d(multiply-opened)h(modules)h(into)g(one.)63
3352 y Ff(-Wbexample)445 b Fs(Generate)22 b(example)g(implementation)h
(code.)63 3465 y Ff(-WbF)775 b Fs(Generate)22 b(code)g(fragments)f
(\(for)i(experts)e(only\).)63 3578 y Ff(-WbBOA)665 b
Fs(Generate)22 b(BOA)g(compatible)i(skeletons.)63 3691
y Ff(-Wbold)665 b Fs(Generate)22 b(old)g(CORBA)h(2.1)g(signatur)n(es)f
(for)g(skeletons.)63 3804 y Ff(-Wbold_prefix)280 b Fs(Map)23
b(C++)g(r)n(eserved)e(wor)n(ds)h(with)g(pr)n(e\002x)g(`)p
Ff(_)p Fs(')h(rather)f(than)h(`)p Ff(_cxx_)p Fs('.)63
3917 y Ff(-Wbkeep_inc_pa)o(th)116 b Fs(Pr)n(eserve)21
b(IDL)i(`)p Ff(#include)p Fs(')c(paths)j(in)h(generated)e(`)p
Ff(#include)p Fs(')e(dir)n(ectives.)63 4030 y Ff(-Wbuse_quotes)280
b Fs(Use)22 b(quotes)e(in)k(`)p Ff(#include)p Fs(')19
b(dir)n(ectives)k(\(e.g.)e Ff("foo")g Fs(rather)h(than)g
Ff(<foo>)p Fs(.\))63 4361 y(Again,)g(most)g(of)h(these)e(ar)n(e)i
(self-explanatory)-10 b(.)63 4624 y Fk(5.2.1)99 b(Module)24
b(splicing)63 4803 y Fs(On)f(C++)h(compilers)f(without)f(namespace)h
(support,)e(IDL)i(modules)f(map)i(to)e(C++)i(classes,)63
4916 y(and)g(so)g(cannot)g(be)g(r)n(eopened.)31 b(For)24
b(some)f(IDL,)h(it)h(is)f(possible)g(to)g(`splice')h(r)n(eopened)d
(mod-)63 5029 y(ules)33 b(on)g(to)g(the)g(\002rst)f(occurr)n(ence)i(of)
g(the)e(module,)k(so)d(all)i(module)e(de\002nitions)f(ar)n(e)i(in)g(a)
63 5142 y(single)22 b(class.)28 b(It)22 b(is)h(possible)f(in)h(this)f
(sort)f(of)i(situation:)204 5294 y Fe(module)48 b(M1)i({)303
5394 y(interface)f(I)g({};)p eop
%%Page: 60 68
60 67 bop 221 282 a Fs(60)1751 b Fg(CHAPTER)22 b(5.)51
b(THE)21 b(IDL)i(COMPILER)362 539 y Fe(};)362 638 y(module)49
b(M2)g({)462 738 y(interface)f(J)i({)562 837 y(attribute)e(M1)o(::I)i
(ok)o(;)462 937 y(};)362 1037 y(};)362 1136 y(module)f(M1)g({)462
1236 y(interface)f(K)i({)562 1336 y(attribute)e(I)h(still_ok)o(;)462
1435 y(};)362 1535 y(};)221 1707 y Fs(but)23 b(not)f(if)h(ther)n(e)f
(ar)n(e)h(cr)n(oss-module)e(dependencies:)362 1863 y
Fe(module)49 b(M1)g({)462 1963 y(interface)f(I)i({};)362
2063 y(};)362 2162 y(module)f(M2)g({)462 2262 y(interface)f(J)i({)562
2362 y(attribute)e(M1)o(::I)i(ok)o(;)462 2461 y(};)362
2561 y(};)362 2660 y(module)f(M1)g({)462 2760 y(interface)f(K)i({)562
2860 y(attribute)e(M2)o(::J)i(oh_dear)n(;)462 2959 y(};)362
3059 y(};)221 3232 y Fs(In)24 b(both)g(of)g(these)f(cases,)h(the)f
Ff(-Wbsplice-module)o(s)18 b Fs(option)24 b(causes)f(omniidl)i(to)f
(put)g(all)221 3344 y(of)33 b(the)g(de\002nitions)f(for)h(module)f
Ff(M1)h Fs(into)g(a)g(single)g(C++)h(class.)60 b(For)32
b(the)g(\002rst)h(case,)i(this)221 3457 y(will)23 b(work)e(\002ne.)27
b(For)21 b(the)g(second)g(case,)g(class)i Ff(M1::K)c
Fs(will)k(contain)g(a)f(r)n(efer)n(ence)f(to)g Ff(M2::J)p
Fs(,)221 3570 y(which)i(has)g(not)f(yet)f(been)h(de\002ned;)f(the)h
(C++)h(compiler)g(will)h(complain.)221 3845 y Fk(5.2.2)99
b(Flattened)25 b(tie)g(classes)221 4029 y Fs(Another)i(pr)n(oblem)h
(with)g(mapping)g(IDL)f(modules)g(to)h(C++)g(classes)g(arises)g(with)f
(tie)h(tem-)221 4142 y(plates.)51 b(The)30 b(C++)i(mapping)e(says)g
(that)g(for)h(the)f(interface)h Ff(M::I)p Fs(,)d(the)i(C++)h(tie)g
(template)221 4255 y(class)f(should)e(be)h(named)g Ff(POA_M::I_tie)p
Fs(.)42 b(However)-7 b(,)30 b(since)f(template)f(classes)h(cannot)221
4367 y(be)c(declar)n(ed)f(inside)g(other)f(classes,)h(this)h(naming)g
(scheme)e(cannot)i(be)f(used)f(with)i(compil-)221 4480
y(ers)d(without)g(namespace)g(support.)362 4597 y(The)d(standar)n(d)f
(solution)h(is)g(to)g(pr)n(oduce)f(`\003attened')g(tie)h(class)h
(names,)f(using)g(the)f Ff(-Wbtf)221 4709 y Fs(command)31
b(line)g(ar)n(gument.)52 b(W)-5 b(ith)30 b(that)h(\003ag,)h(the)e
(template)g(class)h(is)g(declar)n(ed)f(at)h(global)221
4822 y(scope)20 b(with)g(the)g(name)h Ff(POA_M_I_tie)p
Fs(.)h(i.e.)e(all)i(occurr)n(ences)f(of)f(`)p Ff(::)p
Fs(')27 b(ar)n(e)21 b(r)n(eplaced)g(by)f(`)p Ff(_)p Fs('.)221
5097 y Fk(5.2.3)99 b(Generating)25 b(example)e(implementations)221
5281 y Fs(If)17 b(you)g(use)f(the)g Ff(-Wbexample)d Fs(\003ag,)18
b(omniidl)g(will)h(generate)c(an)j(example)f(implementation)221
5394 y(\002le)26 b(as)f(well)h(as)f(the)g(stubs)f(and)h(skeletons.)33
b(For)25 b(IDL)g(\002le)g Ff(foo.idl)p Fs(,)e(the)h(example)h(code)g
(is)p eop
%%Page: 61 69
61 68 bop 63 282 a Fg(5.3.)51 b(EXAMPLES)2522 b Fs(61)63
539 y(written)32 b(to)g Ff(foo_i.cc)p Fs(.)56 b(The)32
b(example)h(\002le)g(contains)g(class)h(and)f(method)f(declarations)63
652 y(for)e(the)f(operations)g(of)h(all)i(interfaces)e(in)g(the)g(IDL)g
(\002le,)i(along)e(with)g(a)h Ff(main\(\))c Fs(function)63
764 y(which)36 b(cr)n(eates)g(an)g(instance)g(of)h(each)f(object.)68
b(Y)-8 b(ou)35 b(still)i(have)f(to)g(\002ll)h(in)f(the)g(operation)63
877 y(implementations,)21 b(of)i(course.)63 1176 y Fq(5.3)119
b(Examples)63 1387 y Fs(Generate)21 b(the)h(C++)h(headers)f(and)g
(stubs)g(for)g(a)i(\002le)e Ff(a.idl)p Fs(:)290 1599
y Ff(omniidl)51 b(-bcxx)i(a.idl)63 1812 y Fs(Generate)21
b(with)i(Any)f(support:)290 2025 y Ff(omniidl)51 b(-bcxx)i(-Wba)f
(a.idl)63 2237 y Fs(Compile)23 b(two)f(\002les)g(with)g(Any)g(support:)
290 2450 y Ff(omniidl)51 b(-bcxx)i(-Wba)f(a.idl)h(b.idl)63
2662 y Fs(As)31 b(above,)j(but)d(also)h(generate)e(Python)g(stubs)h
(for)h(the)f(\002les)g(\(assuming)g(omniORBpy)g(is)63
2775 y(installed\):)290 2988 y Ff(omniidl)51 b(-bcxx)i(-Wba)f(-bpython)
f(a.idl)h(b.idl)63 3200 y Fs(Just)22 b(check)g(the)g(IDL)g(\002les)g
(for)h(validity)-10 b(,)23 b(generating)e(no)i(output:)290
3413 y Ff(omniidl)51 b(a.idl)i(b.idl)p eop
%%Page: 62 70
62 69 bop 221 282 a Fs(62)1751 b Fg(CHAPTER)22 b(5.)51
b(THE)21 b(IDL)i(COMPILER)p eop
%%Page: 63 71
63 70 bop 63 1163 a Fm(Chapter)44 b(6)63 1579 y Fo(The)52
b(omniORB)f(API)63 2025 y Fs(In)23 b(this)f(chapter)-7
b(,)23 b(we)g(intr)n(oduce)f(the)h(omniORB)g(API.)g(The)f(purpose)f(of)
i(this)g(API)g(is)g(to)g(pr)n(o-)63 2138 y(vide)35 b(access)g(points)f
(to)g(omniORB)i(speci\002c)f(functionality)g(that)g(is)g(not)g(cover)n
(ed)f(by)h(the)63 2251 y(CORBA)23 b(speci\002cation.)30
b(Obviously)-10 b(,)23 b(if)h(you)f(use)f(this)h(API)g(in)g(your)g
(application,)h(that)f(part)63 2364 y(of)d(your)f(code)h(is)g(not)g
(going)f(to)h(be)g(portable)g(to)g(r)o(un)g(unchanged)f(on)h(other)f
(vendors')g(ORBs.)63 2477 y(T)-8 b(o)24 b(make)h(it)g(easier)g(to)g
(identify)f(omniORB)i(dependent)c(code,)j(this)f(API)h(is)g(de\002ned)f
(under)63 2590 y(the)d(name)i(space)g(`)p Ff(omniORB)p
Fs(')1137 2557 y Fl(1)1171 2590 y Fs(.)63 2897 y Fq(6.1)119
b(ORB)29 b(initialisation)g(options)63 3111 y Ff(CORBA::ORB_ini)o(t\()o
(\))17 b Fs(accepts)22 b(the)g(following)h(standar)n(d)f(command-line)i
(ar)n(guments:)63 3331 y Ff(-ORBid)51 b(omniORB3)1367
b Fs(The)22 b(identi\002er)f(must)h(be)h(`omniORB3'.)63
3444 y Ff(-ORBInitRef)49 b Fs(<)p Fr(ObjectId)p Fs(>=<)p
Fr(ObjectURI)r Fs(>)540 b(See)21 b(section)h(4.2.)63
3557 y Ff(-ORBDefaultIni)o(tR)o(ef)48 b Fs(<)p Fr(Default)24
b(URI)r Fs(>)577 b(See)21 b(section)h(4.2.)63 3776 y(and)g(the)g
(following)h(omniORB-speci\002c)g(ar)n(guments:)63 3997
y Ff(-ORBtraceLevel)48 b Fs(<)p Fr(level)p Fs(>)1095
b(See)21 b(section)h(6.3.)63 4110 y Ff(-ORBtraceInvoc)o(at)o(io)o(ns)
1091 b Fs(See)21 b(section)h(6.3.)63 4223 y Ff(-ORBstrictIIOP)1418
b Fs(See)21 b(section)h(6.9.)63 4336 y Ff(-ORBtcAliasExp)o(an)o(d)48
b Fs(<)p Fr(0)24 b(or)f(1)p Fs(>)885 b(See)21 b(section)h(9.2.)63
4449 y Ff(-ORBgiopMaxMsg)o(Si)o(ze)48 b Fs(<)p Fr(size)24
b(in)f(bytes)p Fs(>)597 b(See)21 b(section)h(6.5.)63
4562 y Ff(-ORBobjectTabl)o(eS)o(iz)o(e)49 b Fs(<)p Fr(number)22
b(of)h(entries)p Fs(>)346 b(See)21 b(section)h(6.6.)63
4674 y Ff(-ORBserverName)48 b Fs(<)p Fr(string)p Fs(>)1039
b(See)21 b(section)h(6.4.)63 4787 y Ff(-ORBno_bootstr)o(ap)o(_a)o(gen)o
(t)982 b Fs(See)21 b(section)h(6.8.)63 4900 y Ff(-ORBdiiThrowsS)o(ys)o
(Ex)o(cep)o(ti)o(on)o(s)48 b Fs(<)p Fr(0)24 b(or)f(1)p
Fs(>)394 b(See)21 b(section)h(1)-5 b(1.4.)63 5013 y Ff(-ORBabortOnInt)o
(er)o(na)o(lEr)o(ro)o(r)48 b Fs(<)p Fr(0)24 b(or)f(1)p
Fs(>)503 b(See)21 b(section)h(6.1)-5 b(1.)63 5126 y Ff(-ORBverifyObje)o
(ct)o(Ex)o(ist)o(sA)o(nd)o(Ty)o(pe)48 b Fs(<)p Fr(0)23
b(or)h(1)p Fs(>)230 b(See)21 b(section)h(6.9.)63 5239
y Ff(-ORBinConScanP)o(er)o(io)o(d)49 b Fs(<)p Fr(0\226max)24
b(integer)p Fs(>)461 b(See)21 b(section)h(8.3.)p 63 5306
1316 4 v 168 5362 a Fj(1)197 5394 y Fh(omniORB)c Fi(is)g(a)h(class)f
(name)h(if)g(the)g(C++)g(compiler)f(does)f(not)i(support)f(the)i
Fh(namespace)d Fi(keywor)o(d.)1662 5622 y Fs(63)p eop
%%Page: 64 72
64 71 bop 221 282 a Fs(64)1779 b Fg(CHAPTER)22 b(6.)51
b(THE)22 b(OMNIORB)g(API)221 539 y Ff(-ORBoutConScanP)o(er)o(iod)48
b Fs(<)p Fr(0\226max)24 b(integer)p Fs(>)406 b(See)22
b(section)f(8.3.)221 652 y Ff(-ORBclientCallT)o(im)o(eOu)o(tP)o(er)o
(io)o(d)48 b Fs(<)p Fr(0\226max)25 b(integer)p Fs(>)f(See)e(section)f
(8.3.)221 764 y Ff(-ORBserverCallT)o(im)o(eOu)o(tP)o(er)o(io)o(d)48
b Fs(<)p Fr(0\226max)25 b(integer)p Fs(>)f(See)e(section)f(8.3.)221
877 y Ff(-ORBscanGranula)o(ri)o(ty)48 b Fs(<)p Fr(0\226max)24
b(integer)p Fs(>)461 b(See)22 b(section)f(8.3.)221 990
y Ff(-ORBlcdMode)1583 b Fs(See)22 b(section)f(6.9.)221
1103 y Ff(-ORBpoa_iiop_po)o(rt)48 b Fs(<)p Fr(port)24
b(no.)p Fs(>)808 b(See)22 b(section)f(6.2.)221 1216 y
Ff(-ORBpoa_iiop_na)o(me)o(_po)o(rt)48 b Fs(<)p Fr(hostname)p
Fs([)p Fr(:port)25 b(no.])p Fs(>)104 b(See)22 b(section)f(6.2.)221
1329 y Ff(-ORBhelp)1748 b Fs(Lists)22 b(all)i(ORB)e(command)h(line)g
(options.)221 1558 y(and)g(these)e(two)h(obsolete)f(omniORB-speci\002c)
h(ar)n(guments:)221 1789 y Ff(-ORBInitialHost)48 b Fs(<)p
Fr(string)p Fs(>)984 b(See)22 b(section)f(6.8.)221 1902
y Ff(-ORBInitialPort)48 b Fs(<)p Fr(1\22665535)p Fs(>])860
b(See)22 b(section)f(6.8.)221 2131 y(As)g(de\002ned)e(in)i(the)g(CORBA)
g(speci\002cation,)g(any)g(command-line)h(ar)n(guments)e(understood)221
2244 y(by)29 b(the)g(ORB)f(will)j(be)e(r)n(emoved)f(fr)n(om)i
Ff(argv)d Fs(when)i(the)f(initialisation)j(functions)e(r)n(eturn.)221
2357 y(Ther)n(efor)n(e,)d(an)h(application)h(is)f(not)f(r)n(equir)n(ed)
g(to)g(handle)g(any)h(command-line)h(ar)n(guments)221
2469 y(it)23 b(does)e(not)h(understand.)221 2788 y Fq(6.2)119
b(Hostname)30 b(and)g(port)221 3005 y Fs(Normally)-10
b(,)30 b(omniORB)e(lets)g(the)f(operating)g(system)f(pick)j(which)f
(port)g(number)g(it)g(should)221 3118 y(use)34 b(to)h(listen)g(for)g
(IIOP)g(calls.)68 b(Alternatively)-10 b(,)37 b(you)e(can)h(specify)f(a)
h(particular)g(port)e(us-)221 3231 y(ing)22 b Ff(-ORBpoa_iiop_po)o(rt)p
Fs(.)f(If)h(you)g(specify)f Ff(-ORBpoa_iiop_po)o(rt)16
b Fs(mor)n(e)22 b(than)g(once,)221 3344 y(omniORB)h(will)h(listen)e(on)
g(all)i(the)e(ports)f(you)h(specify)-10 b(.)362 3460
y(By)23 b(default,)h(the)f(ORB)g(can)i(work)d(out)h(the)g(IP)h(addr)n
(ess)e(of)i(the)f(host)f(machine.)32 b(This)24 b(ad-)221
3573 y(dr)n(ess)i(is)i(r)n(ecor)n(ded)f(in)h(the)f(object)g(r)n(efer)n
(ences)g(of)h(the)f(local)i(objects.)42 b(However)-7
b(,)28 b(when)f(the)221 3686 y(host)18 b(has)g(multiple)h(network)e
(interfaces)h(and)g(multiple)h(IP)f(addr)n(esses,)f(it)i(may)g(be)f
(desirable)221 3799 y(for)25 b(the)f(application)i(to)e(contr)n(ol)h
(what)f(addr)n(ess)g(the)g(ORB)g(should)g(use.)33 b(This)25
b(can)h(be)e(done)221 3912 y(by)c(de\002ning)f(the)g(envir)n(onment)h
(variable)i Ff(OMNIORB_USEHOS)o(TN)o(AME)13 b Fs(to)20
b(contain)g(the)f(pr)n(e-)221 4025 y(ferr)n(ed)g(host)f(name)h(or)g(IP)
g(addr)n(ess)f(in)i(dot-numeric)f(form.)27 b(Alternatively)-10
b(,)19 b(the)g(same)g(can)h(be)221 4138 y(achieved)i(using)f(the)g
Ff(-ORBpoa_iiop_na)o(me)o(_p)o(or)o(t)16 b Fs(option.)26
b(Y)-8 b(ou)21 b(can)h(optionally)g(spec-)221 4250 y(ify)k(a)g(port)f
(number)g(too.)36 b(Again,)27 b(you)d(can)j(specify)e(mor)n(e)g(than)h
(one)f(host)f(name)i(by)g(using)221 4363 y Ff(-ORBpoa_iiop_na)o(me)o
(_po)o(rt)16 b Fs(mor)n(e)22 b(than)h(once.)221 4682
y Fq(6.3)119 b(Run-time)30 b(T)-13 b(racing)29 b(and)h(Diagnostic)g
(Messages)221 4899 y Fs(omniORB)18 b(can)g(output)e(tracing)i(and)f
(diagnostic)g(messages)f(to)h(the)g(standar)n(d)g(err)n(or)f(str)n
(eam.)221 5012 y(T)-8 b(o)16 b(avoid)i(con\003icts)g(between)d
(old-style)h Ff(iostream.h)d Fs(and)k(new-style)e Ff(iostream)p
Fs(,)g(omni-)221 5125 y(ORB)28 b(uses)e(neither)-7 b(.)44
b(Some)27 b(or)h(all)h(of)f(these)e(messages)g(can)j(be)f(turned)f
(on/of)n(f)h(by)g(setting)221 5238 y(the)22 b(variable)j
Ff(omniORB::trace)o(Le)o(ve)o(l)p Fs(.)d(The)g(type)f(de\002nition)h
(of)g(the)g(variable)j(is:)362 5394 y Fe(CORBA)o(::ULong)49
b(omniORB)o(::)o(traceLevel)f(=)i(1;)f Fd(//)h(The)f(default)f(value)h
(is)h(1)p eop
%%Page: 65 73
65 72 bop 63 282 a Fg(6.4.)51 b(SER)-5 b(VER)21 b(NAME)2358
b Fs(65)63 539 y(At)22 b(the)g(moment,)f(the)h(following)h(trace)g
(levels)f(ar)n(e)h(de\002ned:)254 764 y(level)g(0)282
b(turn)22 b(of)n(f)h(all)h(tracing)f(and)g(informational)h(messages)254
877 y(level)f(1)282 b(informational)24 b(messages)c(only)254
990 y(level)j(2)282 b(the)21 b(above)i(plus)g(con\002guration)f
(information)254 1103 y(level)h(5)282 b(the)26 b(above)h(plus)f
(noti\002cations)h(when)f(server)g(thr)n(eads)795 1216
y(ar)n(e)18 b(cr)n(eated)g(or)g(communication)h(endpoints)d(ar)n(e)j
(shut-)795 1329 y(down)254 1442 y(level)k(10\22620)102
b(the)21 b(above)i(plus)g(execution)e(and)i(exception)e(traces)254
1555 y(level)i(25)237 b(the)21 b(above)i(plus)f(hex)f(dumps)h(of)g(all)
i(data)e(sent)f(and)i(r)n(e-)795 1668 y(ceived)f(by)h(the)e(ORB)i(via)h
(its)e(network)f(connections.)63 1889 y(The)f(variable)i(can)g(be)f
(changed)f(by)g(assignment)g(inside)g(your)g(applications.)28
b(It)20 b(can)i(also)f(be)63 2002 y(changed)i(by)h(specifying)f(the)g
(command-line)i(option:)30 b Ff(-ORBtraceLevel)48 b Fs(<)p
Fr(level)p Fs(>.)33 b(For)63 2114 y(instance:)63 2326
y Ff($)54 b(eg2_impl)d(-ORBtraceLevel)d(5)204 2537 y
Fs(New)21 b(in)h(omniORB)g(3,)g(you)f(can)i(also)f(trace)g(operation)e
(invocations)j(by)f(setting)e Ff(omni-)63 2650 y(ORB::traceInvo)o(ca)o
(ti)o(ons)g Fs(to)26 b(tr)o(ue,)h(or)g(with)g(the)f Ff(-ORBtraceInvoca)
o(ti)o(on)o(s)21 b Fs(com-)63 2763 y(mand)i(line)g(ar)n(gument.)63
3062 y Fq(6.4)119 b(Server)29 b(Name)63 3273 y Fs(Applications)f(can)g
(optionally)g(specify)f(a)i(name)f(to)f(identify)h(the)f(server)g(pr)n
(ocess.)42 b(At)27 b(the)63 3385 y(moment,)38 b(this)d(name)h(is)g
(only)f(used)f(by)i(the)f(host-based)f(access)i(contr)n(ol)f(module.)67
b(See)63 3498 y(section)17 b(8.5)i(for)f(details.)26
b(The)18 b(name)g(is)h(stor)n(ed)d(in)j(the)e(variable)j
Ff(omniORB::serverN)o(am)o(e)p Fs(.)204 3647 y Fe(CORBA)o(::)o
(String_var)48 b(omniORB)o(::serverName)n(;)63 3810 y
Fs(The)20 b(variable)i(can)g(be)f(changed)f(by)g(assignment)g(inside)g
(your)g(applications.)28 b(It)20 b(can)i(also)f(be)63
3923 y(changed)h(by)g(specifying)g(the)g(command-line)i(option:)j
Ff(-ORBserverName)48 b Fs(<)p Fr(string)p Fs(>.)63 4221
y Fq(6.5)119 b(GIOP)28 b(Message)i(Size)63 4432 y Fs(omniORB)c(sets)e
(a)j(limit)g(on)f(the)f(GIOP)h(message)f(size)h(that)g(can)g(be)g(sent)
f(or)h(r)n(eceived.)37 b(The)63 4545 y(value)23 b(can)g(be)g(obtained)f
(by)h(calling:)204 4694 y Fe(size_t)48 b(omniORB)o(::MaxMessageSize)m
(\(\);)63 4856 y Fs(and)22 b(can)i(be)e(changed)g(by:)204
5006 y Fe(void)49 b(omniORB)o(::)o(MaxMessageSize)n(\()o(size_t)g
(newvalue)o(\);)63 5168 y Fs(or)22 b(by)h(the)g(command-line)h(option)e
Ff(-ORBgiopMaxMsg)o(Siz)o(e)p Fs(.)h(The)f(exact)h(value)h(is)f(some-)
63 5281 y(what)30 b(arbitrary)-10 b(.)52 b(The)30 b(r)n(eason)g(such)h
(a)g(limit)h(exists)d(is)i(to)e(pr)n(ovide)i(some)e(way)i(to)f(pr)n
(otect)63 5394 y(the)f(server)h(side)g(fr)n(om)h(r)n(esour)n(ce)f
(exhaustion.)51 b(Think)30 b(about)g(the)g(case)h(when)f(the)g(server)p
eop
%%Page: 66 74
66 73 bop 221 282 a Fs(66)1779 b Fg(CHAPTER)22 b(6.)51
b(THE)22 b(OMNIORB)g(API)221 539 y Fs(r)n(eceives)f(a)h(r)n(ogue)e
(GIOP\(IIOP\))i(r)n(equest)e(message)f(that)i(contains)h(a)g(sequence)d
(length)h(\002eld)221 652 y(set)31 b(to)g(2)521 619 y
Fb(31)596 652 y Fs(.)55 b(W)-5 b(ith)32 b(a)g(r)n(easonable)g(message)e
(size)i(limit,)j(the)c(server)g(can)h(r)n(eject)g(this)f(r)n(ogue)221
764 y(message)21 b(straight)h(away)-10 b(.)221 1072 y
Fq(6.6)119 b(Object)29 b(table)g(size)221 1286 y Fs(omniORB)g(uses)e(a)
i(hash)f(table)h(to)f(stor)n(e)f(the)h(mapping)h(fr)n(om)g(object)f
(keys)f(to)h(servant)g(ob-)221 1399 y(jects.)35 b(Normally)-10
b(,)26 b(it)g(dynamically)h(r)n(e-sizes)e(the)f(hash)h(table)h(when)f
(it)g(becomes)g(too)f(full)i(or)221 1512 y(too)g(empty)-10
b(.)39 b(This)27 b(is)g(the)f(most)g(ef)n(\002cient)h(trade-of)n(f)g
(between)e(performance)i(and)g(memory)221 1625 y(usage.)38
b(However)-7 b(,)26 b(since)g(all)i(POA)f(operations)d(which)j(add)f
(or)g(r)n(emove)g(objects)g(fr)n(om)h(the)221 1737 y(table)22
b(can)h(\(very)e(occasionally\))j(cause)d(the)g(object)h(table)g(to)f
(r)n(esize,)h(the)f(time)h(spent)e(in)i(POA)221 1850
y(operations)f(is)i(much)g(less)f(pr)n(edictable)h(than)f(if)i(the)e
(table)h(size)f(was)h(\002xed.)362 1965 y(T)-8 b(o)20
b(pr)n(event)g(omniORB)h(fr)n(om)g(r)n(esizing)g(its)g(object)f(table,)
i(set)d(the)h(variable)j Ff(omniORB::)221 2078 y(objectTableSize)29
b Fs(to)34 b(the)g(number)h(of)h(hash)f(table)g(entries)f(you)g(r)n
(equir)n(e)i Fr(befor)n(e)h Fs(call-)221 2191 y(ing)24
b Ff(CORBA::ORB_ini)o(t\()o(\))p Fs(.)g(Alternatively)-10
b(,)23 b(use)g(the)g Ff(-ORBobjectTabl)o(eS)o(iz)o(e)18
b Fs(ar)n(gu-)221 2303 y(ment.)27 b(Note)20 b(that)g(omniORB)i(uses)d
(an)j(open)e(hash)h(table)h(so)e(you)g(can)i(have)g(any)f(number)g(of)
221 2416 y(objects)f(active,)i(no)f(matter)f(what)h(size)g(table)g(you)
f(specify)-10 b(.)27 b(If)21 b(you)f(have)h(many)g(mor)n(e)g(active)221
2529 y(objects)e(than)g(hash)h(table)f(entries,)g(object)g(look-up)f
(performance)h(will)i(become)e(linear)h(with)221 2642
y(the)i(number)g(of)h(objects.)221 2950 y Fq(6.7)119
b(POA)30 b(request)f(holding)h(timeout)221 3164 y Fs(POAs)h(can)h(be)f
(put)f(into)g(the)h Fr(holding)h Fs(state,)g(which)g(means)e(that)h
(incoming)h(r)n(equests)d(ar)n(e)221 3276 y(queued)i(until)i(the)f(POA)
h(is)f(set)g(to)g(a)h(dif)n(fer)n(ent)f(state.)57 b(Normally)-10
b(,)35 b(queued)c(r)n(equests)g(ar)n(e)221 3389 y(held)e(for)g(ever)g
(\(or)g(until)g(the)g(client)h(times)e(out)h(as)g(described)f(in)i
(section)e(8.3\).)49 b(If)29 b(you)f(set)221 3502 y Ff(omniORB::poaHol)
o(dR)o(equ)o(es)o(tT)o(im)o(eo)o(ut)g Fs(to)34 b(a)i(non-zer)n(o)e
(time)h(in)g(seconds,)h(held)e(r)n(e-)221 3615 y(quests)26
b(will)j(be)f(cancelled)h(after)f(that)g(time.)43 b(When)28
b(r)n(equests)d(ar)n(e)k(cancelled)f(in)h(this)e(way)-10
b(,)221 3728 y(the)22 b(caller)i(is)f(sent)e(a)i Ff(TRANSIENT)c
Fs(exception.)221 4036 y Fq(6.8)119 b(Obsolete)29 b(Initial)g(Object)g
(Reference)f(Bootstrapping)221 4249 y Fs(Starting)c(fr)n(om)g(2.6.0,)h
(but)f(superseded)d(by)j(the)f(Inter)n(operable)f(Naming)j(Service)f
(in)g(omni-)221 4362 y(ORB)30 b(3,)i(a)e(mechanism)h(is)e(available)k
(for)d(the)f(ORB)g(r)o(untime)h(to)f(obtain)i(the)e(initial)i(object)
221 4475 y(r)n(efer)n(ences)f(to)g(CORBA)h(services.)52
b(The)30 b(bootstrap)g(service)g(is)h(a)h(special)f(object)g(with)g
(the)221 4588 y(object)23 b(key)e(`INIT')h(and)g(the)g(following)h
(interface)1996 4555 y Fl(2)2034 4588 y Fs(:)462 4741
y Fd(//)49 b(IDL)462 4840 y Fe(module)g(CORBA)f({)562
4940 y(interface)g(InitialReferences)e({)661 5039 y(Object)j(get)o
(\(in)h(ORB)o(::ObjectId)e(id\);)661 5139 y Fd(//)i(returns)e(the)h
(initial)g(object)g(reference)f(of)h(the)g(service)661
5239 y(//)h(identified)e(by)h(<id)o(>.)h(For)f(example)g(the)g(id)g
(for)h(the)p 221 5306 1316 4 v 327 5362 a Fj(2)356 5394
y Fi(This)18 b(interface)h(was)g(\002rst)f(de\002ned)h(by)f(Sun's)h
(NEO)f(and)h(is)f(in)h(used)f(in)h(Sun's)g(JavaIDL.)p
eop
%%Page: 67 75
67 74 bop 63 282 a Fg(6.8.)51 b(OBSOLETE)21 b(INITIAL)f(OBJECT)j
(REFERENCE)d(BOOTSTRAPPING)459 b Fs(67)503 539 y Fd(//)49
b(Naming)g(service)f(is)i("NameService)n(".)503 738 y
Fe(ORB)o(::ObjectIdList)d(list\(\);)503 837 y Fd(//)i(returns)g(the)g
(list)g(of)g(service)g(ids)g(that)g(this)g(agent)g(knows)353
937 y Fe(};)254 1037 y(};)204 1185 y Fs(By)23 b(default,)i(all)h
(omniORB)e(servers)f(contain)i(an)g(instance)g(of)f(this)g(object)g
(and)h(ar)n(e)g(able)63 1298 y(to)h(r)n(espond)e(to)i(r)n(emote)g
(invocations.)40 b(T)-8 b(o)26 b(pr)n(event)g(the)g(ORB)g(fr)n(om)h
(instantiating)g(this)f(ob-)63 1411 y(ject,)c(the)g(command-line)i
(option)d Ff(-ORBno_bootstra)o(p_)o(age)o(nt)16 b Fs(should)22
b(be)g(speci\002ed.)204 1523 y(In)34 b(particular)-7
b(,)38 b(the)33 b(Naming)i(Service)f(omniNames)g(is)g(able)h(to)f(r)n
(espond)e(to)i(a)h(query)63 1636 y(thr)n(ough)25 b(this)h(interface)h
(and)g(r)n(eturn)f(the)f(object)i(r)n(efer)n(ence)f(of)h(its)f(r)n(oot)
g(context.)38 b(In)27 b(ef)n(fect,)63 1749 y(the)c(bootstrap)h(agent)f
(pr)n(ovides)h(a)h(level)g(of)g(indir)n(ection.)34 b(All)26
b(omniORB)e(clients)h(still)g(have)63 1862 y(to)33 b(be)g(supplied)g
(with)g(the)g(addr)n(ess)f(of)i(the)f(bootstrap)f(agent.)60
b(However)-7 b(,)35 b(the)e(informa-)63 1975 y(tion)f(is)h(much)g
(easier)g(to)f(specify)g(than)h(a)h(stringi\002ed)d(IOR!)i(Another)e
(advantage)i(of)g(this)63 2088 y(appr)n(oach)27 b(is)g(that)f(it)h(is)g
(completely)f(compatible)i(with)f(JavaIDL.)g(This)g(makes)f(it)h
(possible)63 2201 y(for)22 b(pr)n(ograms)g(written)g(for)g(JavaIDL)i
(to)e(shar)n(e)h(a)g(Naming)g(Service)f(with)h(omniORB.)204
2314 y(The)39 b(addr)n(ess)f(of)i(the)f(bootstrap)f(agent)h(is)h(given)
f(by)h(the)f Ff(ORBInitialHost)34 b Fs(and)63 2427 y
Ff(ORBInitialPort)16 b Fs(parameter)22 b(in)h(the)f(omniORB)h
(con\002guration)f(\002le)g(\(section)g(1.2\).)29 b(The)63
2540 y(parameters)g(can)i(also)g(be)f(speci\002ed)f(as)h(command-line)i
(options)d(\(section)h(6.1\).)51 b(The)30 b(pa-)63 2653
y(rameter)24 b Ff(ORBInitialPort)19 b Fs(is)25 b(optional.)36
b(If)25 b(it)g(is)h(not)e(speci\002ed,)g(port)h(number)g(900)h(will)63
2766 y(be)c(used.)204 2878 y(During)33 b(initialisation,)39
b(the)32 b(ORB)i(r)n(eads)f(the)g(parameters)f(in)i(the)f(omniORB)h
(con\002g-)63 2991 y(uration)h(\002le.)68 b(If)36 b(the)f(parameter)g
Ff(NAMESERVICE)c Fs(is)36 b(speci\002ed,)i(the)d(stringi\002ed)g(IOR)g
(is)63 3104 y(used)23 b(as)j(the)e(object)h(r)n(efer)n(ence)g(of)g(the)
g(r)n(oot)f(naming)i(context.)34 b(If)26 b(the)e(parameter)h(is)g
(absent)63 3217 y(and)k(the)g(parameter)f Ff(ORBInitialHost)23
b Fs(is)30 b(pr)n(esent,)f(the)f(ORB)i(contacts)f(the)f(bootstrap)63
3330 y(agent)g(at)i(the)e(addr)n(ess)g(speci\002ed)g(to)h(obtain)h(the)
f(r)n(oot)f(naming)i(context)e(when)h(the)g(appli-)63
3443 y(cation)20 b(calls)i Ff(resolve_initial)o(_r)o(ef)o(ere)o(nc)o
(es)o(\(\))o Fs(.)g(If)e(neither)f(is)h(pr)n(esent,)f
Ff(resolve_)63 3556 y(initial_refere)o(nc)o(es)o(\(\))28
b Fs(r)n(eturns)34 b(a)h(nil)h(object)e(r)n(efer)n(ence.)64
b(Finally)-10 b(,)38 b(the)c(command)63 3669 y(line)25
b(ar)n(gument)f Ff(-ORBInitialHost)18 b Fs(overrides)24
b(any)g(parameters)g(in)h(the)f(con\002guration)63 3782
y(\002le.)i(The)19 b(ORB)g(always)g(contacts)g(the)f(bootstrap)f(agent)
i(at)g(the)f(addr)n(ess)g(speci\002ed)g(to)g(obtain)63
3895 y(the)j(r)n(oot)h(naming)i(context.)204 4008 y(Now)e(we)g(ar)n(e)h
(r)n(eady)f(to)g(describe)g(a)h(simple)f(way)h(to)f(set)f(up)i
(omniNames.)176 4176 y(1.)46 b(Start)22 b(omniNames)g(for)h(the)f
(\002rst)g(time)g(on)g(a)i(machine)f(\(e.g.)k(wobble\):)290
4319 y Ff($)54 b(omniNames)c(-start)i(1234)176 4492 y
Fs(2.)46 b(Add)21 b(to)h(omniORB.cfg:)290 4635 y Ff(ORBInitialHost)48
b(wobble)290 4778 y(ORBInitialPort)g(1234)176 4951 y
Fs(3.)e(All)23 b(omniORB)g(applications)g(will)h(now)e(be)h(able)g(to)f
(contact)h(omniNames.)290 5094 y(Alternatively)-10 b(,)22
b(the)g(command)h(line)g(options)e(can)j(be)e(used,)f(for)i(example:)
290 5237 y Ff($)54 b(eg3_impl)d(-ORBInitialHost)d(wobble)j
(-ORBInitialPort)d(1234)53 b(&)290 5379 y($)h(eg3_clt)d
(-ORBInitialHost)d(wobble)k(-ORBInitialPort)c(1234)p
eop
%%Page: 68 76
68 75 bop 221 282 a Fs(68)1779 b Fg(CHAPTER)22 b(6.)51
b(THE)22 b(OMNIORB)g(API)221 539 y Fq(6.9)119 b(GIOP)29
b(Lowest)g(Common)j(Denominator)e(Mode)221 750 y Fs(Sometimes,)h(to)f
(cope)g(with)h(bugs)f(in)h(another)f(ORB,)g(it)h(is)g(necessary)e(to)h
(disable)h(various)221 862 y(GIOP)d(and)f(IIOP)g(featur)n(es)f(in)h(or)
n(der)f(to)h(achieve)h(inter)n(operability)-10 b(.)41
b(If)27 b(the)f(command)i(line)221 975 y(option)17 b
Ff(-ORBlcdMode)12 b Fs(is)18 b(pr)n(esent)e(or)h(the)g(function)g
Ff(omniORB::enable)o(Lc)o(dMo)o(de)o(\(\))11 b Fs(is)221
1088 y(called,)23 b(the)e(ORB)g(enters)f(the)h(so-called)h(`lowest)f
(common)g(denominator)g(mode'.)27 b(It)21 b(bends)221
1201 y(over)34 b(backwar)n(ds)g(to)g(cope)f(with)h(bugs)g(in)g(the)g
(ORB)g(at)g(the)f(other)g(end.)62 b(This)33 b(is)i(pur)n(ely)221
1314 y(a)c(transitional)f(measur)n(e.)50 b(The)29 b(long)h(term)g
(solution)f(is)h(to)f(r)n(eport)g(the)g(bugs)h(to)f(the)g(other)221
1427 y(vendors)21 b(and)i(ask)f(them)g(to)g(\002x)h(them)f(expediently)
-10 b(.)362 1540 y(In)35 b(some)f(\(sloppy\))h(IIOP)g(implementations,)
i(the)d(message)g(size)h(value)h(in)g(the)e(IIOP)221
1653 y(header)25 b(can)h(be)f(lar)n(ger)h(than)f(the)g(actual)i(body)d
(size,)i(i.e.)f(ther)n(e)f(is)i(garbage)f(at)h(the)e(end.)36
b(As)221 1766 y(the)30 b(spec)g(does)f(not)h(say)h(the)f(message)f
(size)i(must)f(match)h(the)f(body)g(size)h(exactly)-10
b(,)33 b(this)d(is)221 1879 y(not)d(a)i(clear)f(violation)h(of)f(the)f
(spec.)42 b(omniORB's)28 b(default)g(policy)g(is)g(to)f(expect)f
(incoming)221 1992 y(messages)j(to)i(be)g(formatted)f(pr)n(operly)-10
b(.)51 b(Any)30 b(messages)g(that)g(have)i(garbage)f(at)g(the)f(end)221
2104 y(will)24 b(be)f(r)n(ejected.)362 2217 y Ff(-ORBlcdMode)29
b Fs(and)34 b Ff(omniORB::enabl)o(eL)o(cd)o(Mo)o(de\()o(\))27
b Fs(set)33 b(omniORB)g(to)g(silently)221 2330 y(skip)25
b(the)g(unr)n(ead)g(part)g(of)g(such)g(invalid)j(messages.)34
b(Alternatively)-10 b(,)26 b(you)e(can)i(just)f(change)221
2443 y(this)18 b(policy)g(with)h(the)e Ff(-ORBstrictIIOP)48
b(0)18 b Fs(command)h(line,)g(or)f(by)g(setting)f Ff(omniORB::)221
2556 y(strictIIOP)g Fs(to)22 b(zer)n(o.)27 b(The)21 b(pr)n(oblem)h
(with)g(doing)e(this)i(is)g(that)f(the)g(header)g(message)f(size)221
2669 y(may)36 b(actually)h(be)e(garbage,)j(caused)d(by)g(a)h(bug)f(in)h
(the)f(sender)7 b('s)33 b(code.)65 b(The)34 b(r)n(eceiving)221
2782 y(thr)n(ead)24 b(may)h(block)g(for)n(ever)f(as)g(it)h(tries)e(to)h
(r)n(ead)g(mor)n(e)h(data)f(fr)n(om)h(the)f(connection.)32
b(In)24 b(this)221 2895 y(case)f(the)f(sender)e(won't)i(send)g(any)g
(mor)n(e)h(as)f(it)h(thinks)f(it)h(has)f(marshalled)i(in)f(all)h(the)e
(data.)362 3008 y(By)35 b(default,)j(omniORB)d(uses)f(the)g(GIOP)i
(LOCA)-7 b(TE_REQUEST)34 b(message)f(to)i(verify)221
3121 y(the)26 b(existence)f(of)i(an)g(object)f(prior)g(to)g(the)g
(\002rst)g(invocation.)40 b(If)27 b(another)e(vendor)7
b('s)26 b(ORB)g(is)221 3234 y(known)j(not)g(to)g(be)g(able)i(to)e
(handle)h(this)f(GIOP)h(message,)g(set)e(the)h(variable)j
Ff(omniORB::)221 3346 y(verifyObjectExi)o(st)o(sAn)o(dT)o(yp)o(e)26
b Fs(to)31 b(0)i(to)f(disable)g(this)g(featur)n(e,)i(and)e(hence)f
(achieve)221 3459 y(inter)n(operability)-10 b(.)26 b(The)18
b(command)g(line)h(option)e Ff(-ORBverifyObjec)o(tE)o(xi)o(sts)o(An)o
(dT)o(yp)o(e)221 3572 y Fs(has)23 b(the)f(same)g(ef)n(fect.)221
3868 y Fq(6.10)119 b(GIOP)29 b(Requesting)h(Principal)e(\002eld)221
4079 y Fs(In)22 b(versions)f(1.0)h(and)g(1.1)h(of)f(the)f(GIOP)h
(speci\002cation,)g(r)n(equest)f(messages)f(contain)i(a)g(`prin-)221
4192 y(cipal')h(\002eld)e(which)h(was)f(intended)f(to)h(identify)f(the)
h(client.)28 b(The)20 b(meaning)i(of)f(the)g(principal)221
4305 y(\002eld)28 b(was)g(never)g(speci\002ed,)g(and)h(its)f(use)f(is)h
(now)g(depr)n(ecated.)43 b(The)28 b(\002eld)g(is)g(not)g(pr)n(esent)221
4418 y(in)k(GIOP)f(1.2.)54 b(omniORB)31 b(normally)h(uses)e(the)g
(string)g(`)p Ff(nobody)p Fs(')f(in)j(the)e(principal)j(\002eld.)221
4531 y(However)-7 b(,)32 b(some)e(systems)e(\(e.g.)i(the)g(GNOME)h
(desktop)d(envir)n(onment\))j(use)f(the)g(princi-)221
4644 y(pal)21 b(\002eld)f(as)h(an)g(authentication)f(mechanism,)i(so)d
(omniORB)i(allows)g(you)e(to)h(con\002gur)n(e)g(the)221
4757 y(principal)k(by)f(setting)e(the)g Ff(OMNIORB_PRINCIPA)o(L)16
b Fs(envir)n(onment)23 b(variable.)221 5052 y Fq(6.1)l(1)118
b(T)-13 b(rapping)30 b(omniORB)g(Internal)e(Errors)362
5294 y Fe(class)49 b(fatalException)e({)362 5394 y(public)o(:)p
eop
%%Page: 69 77
69 76 bop 63 282 a Fg(6.12.)51 b(SYSTEM)21 b(EXCEPTION)h(HANDLERS)1528
b Fs(69)403 539 y Fe(const)49 b(char)g(*file)o(\(\))h(const)o(;)403
638 y(int)f(line\(\))g(const)o(;)403 738 y(const)g(char)g(*errmsg)o
(\(\))g(const)o(;)204 837 y(};)204 1017 y Fs(When)31
b(omniORB)h(detects)e(an)i(internal)g(pr)n(oblem)g(that)g(is)f(most)g
(likely)h(to)f(be)h(caused)63 1130 y(by)j(a)h(bug)g(in)g(the)f(r)o
(untime,)j(it)e(raises)f(the)g(exception)f Ff(omniORB::fatalE)o(xc)o
(ept)o(io)o(n)p Fs(.)63 1243 y(When)22 b(this)h(exception)f(is)h
(raised,)g(it)g(is)h(not)e(sensible)h(to)f(pr)n(oceed)g(with)h(any)h
(operation)e(that)63 1356 y(involves)g(the)g(ORB's)g(r)o(untime.)28
b(It)21 b(is)i(best)e(to)h(exit)g(the)f(pr)n(ogram)i(immediately)-10
b(.)28 b(The)21 b(excep-)63 1469 y(tion)c(str)o(uctur)n(e)g(carried)h
(by)f Ff(omniORB::fatalE)o(xce)o(pt)o(io)o(n)12 b Fs(contains)17
b(the)g(exact)h(location)63 1581 y(\(the)i(\002le)h(name)g(and)f(the)g
(line)i(number\))e(wher)n(e)g(the)g(exception)g(is)h(raised.)26
b(Y)-8 b(ou)20 b(ar)n(e)h(str)n(ongly)63 1694 y(encouraged)g(to)h
(\002le)g(a)i(bug)e(r)n(eport)f(and)i(point)f(out)g(the)g(location.)204
1813 y(It)29 b(may)h(help)f(to)g(cause)h(a)g(cor)n(e-dump)g(and)f(look)
g(at)h(the)f(stack)h(trace)f(to)g(locate)h(wher)n(e)63
1926 y(the)e(exception)h(was)g(thr)n(own.)48 b(This)30
b(can)g(be)f(done)g(by)g(setting)f(the)h(variable)j Ff(omniORB::)63
2039 y(abortOnInterna)o(lE)o(rr)o(or)15 b Fs(to)21 b(1.)28
b(The)21 b(variable)i(can)g(also)f(be)f(set)f(via)j(the)e(command)h
(line)63 2152 y(option)f Ff(-ORBabortOnInte)o(rna)o(lE)o(rr)o(or)o
Fs(.)63 2425 y Fq(6.12)118 b(System)31 b(Exception)f(Handlers)63
2647 y Fs(By)k(default,)k(all)f(system)c(exceptions)h(which)i(ar)n(e)g
(raised)e(during)h(an)h(operation)e(invoca-)63 2760 y(tion,)f(with)e
(the)g(exception)f(of)h Ff(CORBA::TRANSIENT)o Fs(,)25
b(ar)n(e)32 b(pr)n(opagated)e(to)h(the)g(applica-)63
2873 y(tion)22 b(code.)28 b(Some)22 b(applications)i(may)f(pr)n(efer)g
(to)f(trap)h(these)e(exceptions)g(within)i(the)f(pr)n(oxy)63
2986 y(objects)g(so)g(that)g(the)g(application)i(logic)f(does)e(not)h
(have)h(to)f(deal)h(with)f(the)g(err)n(or)g(condition.)63
3099 y(For)17 b(example,)i(when)e(a)i Ff(CORBA::COMM_FAI)o(LU)o(RE)12
b Fs(is)18 b(r)n(eceived,)h(an)f(application)i(may)e(just)63
3212 y(want)29 b(to)f(r)n(etry)h(the)f(invocation)i(until)g(it)f
(\002nally)h(succeeds.)46 b(This)29 b(appr)n(oach)h(is)f(useful)g(for)
63 3325 y(objects)22 b(that)g(ar)n(e)h(persistent)d(and)j(their)f
(operations)f(ar)n(e)i(idempotent.)204 3443 y(omniORB)k(pr)n(ovides)f
(a)i(set)d(of)i(functions)g(to)f(install)i(exception)e(handlers.)40
b(Once)28 b(they)63 3556 y(ar)n(e)22 b(installed,)h(pr)n(oxy)e(objects)
h(will)h(call)h(these)d(handlers)h(when)f(the)h(associated)f(system)g
(ex-)63 3669 y(ceptions)28 b(ar)n(e)i(raised)f(by)g(the)g(ORB)h(r)o
(untime.)48 b(Handlers)29 b(can)h(be)g(installed)f(for)h
Ff(CORBA::)63 3782 y(TRANSIENT)p Fs(,)j Ff(CORBA::COMM_FAIL)o(UR)o(E)f
Fs(and)38 b Ff(CORBA::SystemE)o(xce)o(pt)o(io)o(n)p Fs(.)68
b(This)63 3895 y(last)30 b(handler)g(covers)g(all)h(system)d
(exceptions)h(other)g(than)h(the)f(two)g(cover)n(ed)h(by)g(the)f
(\002rst)63 4008 y(two)24 b(handlers.)35 b(An)25 b(exception)f(handler)
h(can)h(be)f(installed)g(for)g(individual)i(pr)n(oxy)d(objects,)63
4121 y(or)e(it)h(can)g(be)g(installed)f(for)h(all)h(pr)n(oxy)e(objects)
g(in)h(the)f(addr)n(ess)f(space.)63 4410 y Fk(6.12.1)98
b(CORBA::TRANSIENT)25 b(handlers)63 4598 y Fs(When)36
b(a)i Ff(CORBA::TRANSIENT)31 b Fs(exception)36 b(is)h(raised)g(by)h
(the)e(ORB)i(r)o(untime,)i(the)d(de-)63 4711 y(fault)24
b(behaviour)g(of)f(the)g(pr)n(oxy)g(objects)g(is)g(to)g(r)n(etry)g
(inde\002nitely)f(until)i(the)f(operation)f(suc-)63 4824
y(ceeds.)j(Successive)19 b(r)n(etries)f(will)j(be)e(delayed)g(pr)n(ogr)
n(essively)e(by)j(multiples)f(of)h Ff(omniORB::)63 4937
y(defaultTransie)o(nt)o(Re)o(try)o(De)o(la)o(yI)o(nc)o(rem)o(en)o(t)p
Fs(.)47 b(The)30 b(delay)h(will)h(be)f(limited)h(to)e(the)63
5049 y(maximum)35 b(speci\002ed)e(by)h Ff(omniORB::defau)o(ltT)o(ra)o
(ns)o(ie)o(nt)o(Ret)o(ry)o(De)o(la)o(yM)o(axi)o(mu)o(m)p
Fs(.)63 5162 y(The)22 b(unit)g(of)h(both)f(values)h(ar)n(e)g(in)g
(seconds.)204 5281 y(The)k(ORB)h(r)o(untime)g(will)i(raise)e
Ff(CORBA::TRANSIEN)o(T)22 b Fs(under)27 b(the)h(following)g(condi-)63
5394 y(tions:)p eop
%%Page: 70 78
70 77 bop 221 282 a Fs(70)1779 b Fg(CHAPTER)22 b(6.)51
b(THE)22 b(OMNIORB)g(API)335 539 y Fs(1.)45 b(When)27
b(a)h Fr(cached)i Fs(network)25 b(connection)i(is)h(br)n(oken)f(while)h
(an)g(operation)e(invocation)448 652 y(is)c(in)g(pr)n(ogr)n(ess.)k(The)
21 b(ORB)g(will)i(try)e(to)g(open)g(a)h(new)f(connection)g(at)h(the)f
(next)f(invoca-)448 764 y(tion.)335 951 y(2.)45 b(When)21
b(the)f(pr)n(oxy)h(object)g(has)g(been)f(r)n(edir)n(ected)g(by)i(a)f
(location)h(forwar)n(d)f(message)f(by)448 1064 y(the)j(r)n(emote)f
(object)g(to)h(a)g(new)f(location)i(and)f(the)f(object)h(at)g(the)f
(new)g(location)i(cannot)448 1176 y(be)29 b(contacted.)47
b(In)28 b(addition)h(to)g(the)f Ff(CORBA::TRANSIE)o(NT)23
b Fs(exception,)29 b(the)f(pr)n(oxy)448 1289 y(object)23
b(also)g(r)n(esets)e(its)h(internal)h(state)f(so)g(that)g(the)g(next)g
(invocation)h(will)h(be)f(dir)n(ected)448 1402 y(at)g(the)f(original)i
(location)f(of)f(the)g(r)n(emote)g(object.)335 1588 y(3.)45
b(When)22 b(the)g(r)n(emote)g(object)g(r)n(eports)f Ff(CORBA::TRANSIEN)
o(T)p Fs(.)362 1797 y(Applications)i(can)g(override)f(the)f(default)i
(behaviour)g(by)f(installing)i(their)e(own)g(excep-)221
1910 y(tion)h(handler)-7 b(.)27 b(The)22 b(API)g(to)g(do)g(so)g(is)h
(summarised)f(below:)362 2058 y Fe(class)49 b(omniORB)g({)362
2157 y(public)o(:)362 2357 y(typedef)g(CORBA)o(::)o(Boolean)g
(\(*transientExceptionHandler_t)-5 b(\)\()o(void)o(*)50
b(cookie)o(,)2753 2456 y(CORBA)o(::ULong)f(n_retries)n(,)2753
2556 y(const)g(CORBA)o(::TRANSIENT)n(&)h(ex\);)362 2755
y(static)f(void)g(installTransientExceptionHandler)-6
b(\(void)o(*)50 b(cookie)o(,)2604 2855 y(transientExceptionHandler_t)45
b(fn)o(\);)362 3054 y(static)k(void)g(installTransientExceptionHandler)
-6 b(\(CORBA)o(::Object_ptr)48 b(obj)o(,)2604 3154 y(void)o(*)i(cookie)
o(,)2604 3253 y(transientExceptionHandler_t)45 b(fn)o(\);)362
3452 y(static)k(CORBA)o(::ULong)g(defaultTransientRetryDelayIncreme)o
(nt)-6 b(;)362 3552 y(static)49 b(CORBA)o(::ULong)g
(defaultTransientRetryDelayMaximum)-7 b(;)362 3652 y(})362
3813 y Fs(The)22 b(overloaded)g(function)h Ff(installTransien)o(tE)o
(xc)o(ep)o(ti)o(onH)o(an)o(dl)o(er)o(\(\))16 b Fs(can)24
b(be)221 3926 y(used)35 b(to)h(install)h(the)e(exception)g(handlers)h
(for)g Ff(CORBA::TRANSIENT)o Fs(.)30 b(T)-8 b(wo)36 b(forms)g(ar)n(e)
221 4039 y(available:)29 b(the)17 b(\002rst)h(form)g(installs)h(an)g
(exception)e(handler)h(for)g(all)i(object)e(r)n(efer)n(ences)f(except)
221 4152 y(for)33 b(those)e(which)j(have)f(an)g(exception)f(handler)h
(installed)g(by)f(the)h(second)e(form,)k(which)221 4265
y(takes)22 b(an)h(additional)g(ar)n(gument)f(to)h(identify)f(the)g(tar)
n(get)g(object)g(r)n(efer)n(ence.)28 b(The)21 b(ar)n(gument)221
4378 y Ff(cookie)d Fs(is)j(an)g(opaque)f(pointer)f(which)i(will)h(be)e
(passed)f(on)i(by)f(the)g(ORB)g(when)g(it)h(calls)h(the)221
4490 y(exception)g(handler)-7 b(.)362 4603 y(An)19 b(exception)e
(handler)i(will)g(be)g(called)h(by)e(pr)n(oxy)g(objects)g(with)h(thr)n
(ee)e(ar)n(guments.)26 b(The)221 4716 y Ff(cookie)35
b Fs(is)i(the)f(opaque)g(pointer)g(r)n(egister)n(ed)f(by)i
Ff(installTransie)o(nt)o(Exc)o(ep)o(ti)o(on)o(-)221 4829
y(Handler\(\))p Fs(.)65 b(The)36 b(ar)n(gument)g Ff(n_retries)c
Fs(is)37 b(the)e(number)i(of)f(times)g(the)g(pr)n(oxy)f(has)221
4942 y(called)30 b(this)e(handler)h(for)g(the)f(same)g(invocation.)47
b(The)28 b(ar)n(gument)h Ff(ex)f Fs(is)h(the)f(value)h(of)g(the)221
5055 y(exception)19 b(caught.)27 b(The)19 b(exception)f(handler)i(is)g
(expected)e(to)h(do)g(whatever)h(is)g(appr)n(opriate)221
5168 y(and)g(r)n(eturns)f(a)i(boolean)g(value.)27 b(If)21
b(the)e(r)n(eturn)g(value)i(is)g(TRUE\(1\),)f(the)g(pr)n(oxy)f(object)h
(r)n(etries)221 5281 y(the)i(operation.)29 b(If)23 b(the)f(r)n(eturn)g
(value)i(is)g(F)-7 b(ALSE\(0\),)22 b(the)g Ff(CORBA::TRANSIENT)16
b Fs(exception)221 5394 y(is)23 b(pr)n(opagated)e(into)h(the)g
(application)i(code.)p eop
%%Page: 71 79
71 78 bop 63 282 a Fg(6.12.)51 b(SYSTEM)21 b(EXCEPTION)h(HANDLERS)1528
b Fs(71)204 539 y(The)30 b(following)h(sample)g(code)f(installs)i(a)f
(simple)g(exception)f(handler)h(for)g(all)h(objects)63
652 y(and)22 b(for)h(a)g(speci\002c)g(object:)204 802
y Fe(CORBA)o(::)o(Boolean)49 b(my_transient_handler1)d(\(void)o(*)k
(cookie)n(,)2097 902 y(CORBA)o(::)o(ULong)f(retries)o(,)2097
1002 y(const)g(CORBA)o(::)o(TRANSIENT)o(&)g(ex\))204
1101 y({)353 1201 y(cerr)g(<<)h("transient)e(handler)g(1)i(called)o(.")
f(<<)h(endl)o(;)353 1300 y(return)f(1;)548 b Fd(//)49
b(retry)g(immediately)n(.)204 1400 y Fe(})204 1599 y(CORBA)o(::)o
(Boolean)g(my_transient_handler2)d(\(void)o(*)k(cookie)n(,)2097
1699 y(CORBA)o(::)o(ULong)f(retries)o(,)2097 1799 y(const)g(CORBA)o(::)
o(TRANSIENT)o(&)g(ex\))204 1898 y({)353 1998 y(cerr)g(<<)h("transient)e
(handler)g(2)i(called)o(.")f(<<)h(endl)o(;)353 2097 y(return)f(1;)548
b Fd(//)49 b(retry)g(immediately)n(.)204 2197 y Fe(})204
2496 y(static)f(Echo_ptr)h(myobj)o(;)204 2695 y(void)g(installhandlers)
m(\(\))204 2795 y({)353 2894 y(omniORB)o
(::installTransientExceptionHandler)-6 b(\(0,)o(my_transient_handler1)l
(\);)353 2994 y Fd(//)50 b(All)f(proxy)g(objects)f(will)h(call)g
(my_transient_handler1)d(from)j(now)h(on)o(.)353 3193
y Fe(omniORB)o(::installTransientExceptionHandler)-6
b(\()o(myobj)o(,0,my_transient_handler2)l(\);)353 3293
y Fd(//)50 b(The)f(proxy)g(object)g(of)g(myobj)g(will)g(call)g
(my_transient_handler2)d(from)j(now)g(on.)204 3393 y
Fe(})63 3703 y Fk(6.12.2)98 b(CORBA::COMM_F)-5 b(AILURE)63
3881 y Fs(When)28 b(the)g(ORB)g(r)o(untime)h(fails)h(to)e(establish)h
(a)g(network)e(connection)h(to)h(the)e(r)n(emote)h(ob-)63
3994 y(ject)g(and)g(none)f(of)h(the)f(conditions)g(listed)g(above)i
(for)f(raising)g(a)h Ff(CORBA::TRANSIE)o(NT)21 b Fs(is)63
4107 y(applicable,)j(it)f(raises)f(a)h Ff(CORBA::COMM_FAI)o(LU)o(RE)16
b Fs(exception.)204 4220 y(The)21 b(default)i(behaviour)f(of)h(the)e
(pr)n(oxy)h(objects)f(is)i(to)e(pr)n(opagate)h(this)g(exception)f(to)g
(the)63 4333 y(application.)61 b(Applications)34 b(can)g(override)f
(the)g(default)g(behaviour)h(by)g(installing)g(their)63
4446 y(own)22 b(exception)f(handlers.)27 b(The)22 b(API)g(to)g(do)g(so)
g(is)h(summarised)f(below:)204 4597 y Fe(class)49 b(omniORB)f({)204
4696 y(public)o(:)204 4896 y(typedef)g(CORBA)o(::Boolean)h(\(*)o
(commFailureExceptionHandler_t)-5 b(\)\()o(void*)49 b(cookie)o(,)2595
4995 y(CORBA)o(::ULong)f(n_retries)o(,)2595 5095 y(const)h(CORBA)o(::)o
(COMM_FAILURE)n(&)h(ex)o(\);)204 5294 y(static)e(void)i
(installCommFailureExceptionHandle)o(r)-6 b(\(void)o(*)50
b(cookie)o(,)2445 5394 y(commFailureExceptionHandler_t)45
b(fn)o(\);)p eop
%%Page: 72 80
72 79 bop 221 282 a Fs(72)1779 b Fg(CHAPTER)22 b(6.)51
b(THE)22 b(OMNIORB)g(API)362 638 y Fe(static)49 b(void)g
(installCommFailureExceptionHandler)-6 b(\(CORBA)o(::)o(Object_ptr)48
b(obj,)2604 738 y(void)o(*)i(cookie)o(,)2604 837 y
(commFailureExceptionHandler_t)2604 937 y(fn\);)362 1037
y(})362 1207 y Fs(The)22 b(functions)g(ar)n(e)h(equivalent)g(to)f
(their)g(counterparts)f(for)i Ff(CORBA::TRANSIE)o(NT)o
Fs(.)221 1478 y Fk(6.12.3)99 b(CORBA::SystemException)221
1660 y Fs(T)-8 b(o)24 b(r)n(eport)f(an)i(err)n(or)f(condition,)g(the)g
(ORB)g(r)o(untime)h(may)g(raise)f(other)f(system)g(exceptions.)221
1773 y(If)e(the)f(exception)g(is)h(neither)f Ff(CORBA::TRANISE)o(NT)14
b Fs(nor)21 b Ff(CORBA::COMM_FA)o(ILU)o(RE)o Fs(,)15
b(the)221 1886 y(default)27 b(behaviour)g(of)f(the)g(pr)n(oxy)g
(objects)g(is)g(to)g(pr)n(opagate)g(this)g(exception)f(to)h(the)g
(appli-)221 1999 y(cation.)60 b(Applications)33 b(can)h(override)f(the)
f(default)h(behaviour)h(by)f(installing)h(their)f(own)221
2112 y(exception)22 b(handlers.)27 b(The)22 b(API)g(to)g(do)f(so)h(is)h
(summarised)f(below:)362 2266 y Fe(class)49 b(omniORB)g({)362
2366 y(public)o(:)362 2565 y(typedef)g(CORBA)o(::)o(Boolean)g
(\(*systemExceptionHandler_t)-5 b(\)\(void)o(*)50 b(cookie)o(,)2554
2665 y(CORBA)o(::ULong)f(n_retries)n(,)2554 2764 y(const)g(CORBA)o
(::SystemException)m(&)h(ex)o(\);)362 2964 y(static)f(void)g
(installSystemExceptionHandler)-5 b(\()o(void*)49 b(cookie)o(,)2454
3063 y(systemExceptionHandler_t)d(fn)o(\);)362 3263 y(static)j(void)g
(installSystemExceptionHandler)-5 b(\()o(CORBA::)o(Object_ptr)48
b(obj,)2454 3362 y(void*)h(cookie)o(,)2454 3462 y
(systemExceptionHandler_t)d(fn)o(\);)362 3561 y(})362
3732 y Fs(The)22 b(functions)g(ar)n(e)h(equivalent)g(to)f(their)g
(counterparts)f(for)i Ff(CORBA::TRANSIE)o(NT)o Fs(.)221
4047 y Fq(6.13)119 b(Location)30 b(forwarding)221 4263
y Fs(Any)d(CORBA)h(operation)f(invocation)i(can)f(r)n(eturn)f(a)i
Ff(LOCATION_FORWA)o(RD)21 b Fs(message)27 b(to)221 4376
y(the)e(caller)-7 b(,)29 b(indicating)e(that)e(it)i(should)e(r)n(etry)g
(the)g(invocation)i(on)f(a)h(new)e(object)h(r)n(efer)n(ence.)221
4489 y(The)33 b(standar)n(d)h(allows)g(ServantManagers)f(to)g(trigger)f
Ff(LOCATION_FORWARD)o Fs(s)c(by)33 b(rais-)221 4601 y(ing)38
b(the)f Ff(PortableServer:)o(:F)o(or)o(wa)o(rd)o(Req)o(ue)o(st)31
b Fs(exception,)40 b(but)e(it)g(does)e(not)h(pr)n(o-)221
4714 y(vide)h(a)g(similar)h(mechanism)f(for)g(normal)g(servants.)71
b(omniORB)38 b(pr)n(ovides)f(the)f Ff(omni-)221 4827
y(ORB::LOCATION_F)o(OR)o(WAR)o(D)22 b Fs(exception)27
b(for)h(this)g(purpose.)42 b(It)28 b(can)h(be)f(thr)n(own)g(by)g(any)
221 4940 y(operation)22 b(implementation.)362 5095 y
Fe(class)49 b(LOCATION_FORWARD)e({)362 5194 y(public)o(:)462
5294 y(LOCATION_FORWARD)m(\(CORBA)o(::)o(Object_ptr)h(objref)o(\);)362
5394 y(};)p eop
%%Page: 73 81
73 80 bop 63 282 a Fg(6.13.)51 b(LOCA)-7 b(TION)23 b(FOR)m(W)-8
b(ARDING)1813 b Fs(73)63 539 y(The)22 b(exception)f(object)h(consumes)g
(the)g(object)g(r)n(efer)n(ence)g(it)h(is)g(passed.)p
eop
%%Page: 74 82
74 81 bop 221 282 a Fs(74)1779 b Fg(CHAPTER)22 b(6.)51
b(THE)22 b(OMNIORB)g(API)p eop
%%Page: 75 83
75 82 bop 63 1162 a Fm(Chapter)44 b(7)63 1578 y Fo(Interface)53
b(T)-19 b(ype)52 b(Checking)63 2037 y Fs(This)36 b(chapter)f(describes)
g(the)h(mechanism)h(used)e(by)h(omniORB)g(to)g(ensur)n(e)f(type)f
(safety)63 2150 y(when)21 b(object)i(r)n(efer)n(ences)e(ar)n(e)i
(exchanged)f(acr)n(oss)g(the)g(network.)k(This)c(mechanism)h(is)g(han-)
63 2263 y(dled)g(completely)g(within)i(the)e(ORB.)h(Ther)n(e)f(is)h(no)
g(pr)n(ogramming)g(interface)h(visible)g(at)f(the)63
2376 y(application)j(level.)37 b(However)-7 b(,)25 b(for)h(the)f(sake)g
(of)h(diagnosing)f(the)g(pr)n(oblem)h(when)f(ther)n(e)f(is)63
2489 y(a)j(type)f(violation,)j(it)f(is)f(useful)g(to)g(understand)e
(the)h(underlying)g(mechanism)i(in)g(or)n(der)e(to)63
2602 y(interpr)n(et)21 b(the)h(err)n(or)g(conditions)g(r)n(eported)e
(by)j(the)e(ORB.)63 2904 y Fq(7.1)119 b(Introduction)63
3116 y Fs(In)22 b(GIOP/IIOP)-12 b(,)22 b(an)h(object)f(r)n(efer)n(ence)
g(is)h(encoded)d(as)j(an)g(Inter)n(operable)e(Object)i(Refer)n(ence)63
3229 y(\(IOR\))i(when)e(it)i(is)f(sent)f(acr)n(oss)i(a)g(network)d
(connection.)33 b(The)23 b(IOR)i(contains)f(a)h(Repository)63
3342 y(ID)19 b(\(RepoId\))f(and)h(one)g(or)g(mor)n(e)g(communication)h
(pr)n(o\002les.)26 b(The)19 b(communication)h(pr)n(o\002les)63
3455 y(describe)i(wher)n(e)g(and)h(how)g(the)f(object)g(can)i(be)f
(contacted.)28 b(The)22 b(RepoId)f(is)i(a)h(string)e(which)63
3568 y(uniquely)g(identi\002es)f(the)h(IDL)g(interface)h(of)g(the)f
(object.)204 3682 y(Unless)30 b(the)g Ff(ID)g Fs(pragma)h(is)g
(speci\002ed)f(in)h(the)g(IDL,)f(the)g(ORB)h(generates)e(the)h(RepoId)
63 3795 y(string)d(in)i(the)f(so-called)g(OMG)i(IDL)e(Format)1705
3762 y Fl(1)1741 3795 y Fs(.)46 b(For)27 b(instance,)j(the)d(RepoId)f
(for)j(the)e Ff(Echo)63 3907 y Fs(interface)22 b(used)g(in)h(the)f
(examples)g(of)g(chapter)g(2)i(is)e Ff(IDL:Echo:1.0)p
Fs(.)204 4021 y(When)28 b(interface)i(inheritance)f(is)h(used)d(in)j
(the)e(IDL,)h(the)f(ORB)h(always)h(sends)d(the)i(Re-)63
4134 y(poId)21 b(of)h(the)g(most)g(derived)g(interface.)28
b(For)22 b(example:)353 4285 y Fd(//)50 b(IDL)353 4384
y Fe(interface)e(A)i({)453 4484 y(...)353 4583 y(};)353
4683 y(interface)e(B)i(:)g(A)f({)453 4783 y(...)353 4882
y(};)353 4982 y(interface)f(C)i({)503 5082 y(void)f(op)o(\(in)h(A)f
(arg\);)353 5181 y(};)p 63 5306 1316 4 v 168 5362 a Fj(1)197
5394 y Fi(For)18 b(further)g(details)g(of)g(the)i(r)o(epository)c(ID)i
(formats,)g(see)g(section)h(10.6)g(in)g(the)h(CORBA)e(2.3)h
(speci\002cation.)1662 5622 y Fs(75)p eop
%%Page: 76 84
76 83 bop 221 282 a Fs(76)1333 b Fg(CHAPTER)21 b(7.)51
b(INTERF)-7 b(ACE)21 b(TYPE)g(CHECKING)512 539 y Fd(//)49
b(C++)512 638 y Fe(C_ptr)g(server)n(;)512 738 y(B_ptr)g(objB)o(;)512
837 y(A_ptr)g(objA)g(=)g(objB;)512 937 y(server)o(->)o(op\(objA)o(\);)
99 b Fd(//)50 b(Send)f(B)g(as)h(A)362 1109 y Fs(In)29
b(the)f(example,)i(the)f(operation)f Ff(C::op\(\))e Fs(accepts)i(an)i
(object)f(r)n(efer)n(ence)f(of)h(type)f Ff(A)p Fs(.)221
1222 y(The)h(r)n(eal)i(type)d(of)h(the)g(r)n(efer)n(ence)g(passed)f(to)
h Ff(C::op\(\))e Fs(is)j Ff(B)p Fs(,)f(which)h(inherits)f(fr)n(om)h
Ff(A)p Fs(.)f(In)221 1335 y(this)22 b(case,)h(the)f(RepoId)e(of)j
Ff(B)p Fs(,)f(and)g(not)g(that)h(of)f Ff(A)p Fs(,)g(is)h(sent)e(acr)n
(oss)i(the)f(network.)362 1451 y(The)e(GIOP/IIOP)g(speci\002cation)h
(allows)f(an)h(ORB)f(to)g(send)f(a)i(null)g(string)e(in)i(the)e(RepoId)
221 1564 y(\002eld)k(of)g(an)g(IOR.)g(It)g(is)g(up)f(to)h(the)f(r)n
(eceiving)i(end)e(to)g(work)g(out)h(the)f(r)n(eal)i(type)d(of)i(the)f
(object.)221 1677 y(omniORB)31 b(never)g(sends)e(out)h(null)i(strings)e
(as)h(RepoId.)51 b(However)-7 b(,)32 b(it)g(may)f(r)n(eceive)g(null)221
1790 y(RepoId)23 b(fr)n(om)i(other)f(ORBs.)34 b(In)25
b(that)g(case,)g(it)g(will)h(use)e(the)h(mechanism)g(described)f(below)
221 1903 y(to)e(ensur)n(e)g(type)f(safety)-10 b(.)221
2221 y Fq(7.2)119 b(Basic)30 b(Interface)d(T)-11 b(ype)30
b(Checking)221 2438 y Fs(The)d(ORB)g(is)h(pr)n(ovided)f(with)g(the)g
(interface)g(information)i(by)e(the)g(stubs)f(via)j(the)e
Ff(proxy-)221 2551 y(ObjectFactory)20 b Fs(class.)39
b(For)26 b(an)g(interface)g Ff(A)p Fs(,)g(the)f(stub)h(of)g
Ff(A)g Fs(contains)g(a)g Ff(_pof_A)e Fs(class.)221 2664
y(This)g(class)h(is)f(derived)f(fr)n(om)i(the)f Ff(proxyObjectFac)o(to)
o(ry)18 b Fs(class.)33 b(The)23 b Ff(proxyObject-)221
2777 y(Factory)d Fs(is)i(an)i(abstract)f(class)g(which)g(contains)f(3)i
(functions)e(of)g(inter)n(est:)362 2933 y Fe(class)49
b(proxyObjectFactory)e({)362 3032 y(public)o(:)462 3232
y(const)i(char)g(*irRepoId)n(\(\))h(const)o(;)462 3431
y(virtual)e(CORBA)o(::Boolean)h(is_a)o(\(const)g(char)g(*)o
(base_repoId)n(\))h(const)f(=)h(0;)462 3630 y(virtual)e(CORBA)o
(::Object_ptr)g(newObjRef)n(\(const)h(char)o(*)h(mostDerivedTypeId)m(,)
2255 3730 y(IOP::)o(TaggedProfileList)m(*)g(profiles)n(,)2255
3829 y(omniIdentity)n(*)g(id)o(,)2255 3929 y(omniLocalIdentity)m(*)g
(lid)o(\))g(=)f(0;)362 4029 y(};)358 4313 y Fp(\017)c
Ff(irRepoId\(\))19 b Fs(r)n(eturns)i(the)h(RepoId)e(of)j(the)f
(interface.)358 4513 y Fp(\017)45 b Ff(is_a\(\))19 b
Fs(r)n(eturns)i(tr)o(ue\(1\))g(if)i(the)d(ar)n(gument)h(is)h(the)f
(RepoId)e(of)j(the)e(interface)i(itself)f(or)448 4626
y(it)i(is)g(that)f(of)h(its)f(base)h(interfaces.)358
4827 y Fp(\017)45 b Ff(newObjRef\(\))15 b Fs(r)n(eturns)j(an)i(object)g
(r)n(efer)n(ence)e(based)h(on)g(the)g(information)h(supplied)448
4940 y(in)k(the)d(ar)n(guments.)362 5168 y(A)h(single)g(instance)g(of)g
(every)f Ff(_pof_*)e Fs(is)j(instantiated)f(at)h(r)o(untime.)28
b(The)21 b(instances)h(ar)n(e)221 5281 y(enter)n(ed)h(into)h(a)h(list)g
(inside)f(the)g(ORB.)g(The)g(list)h(constitutes)e(all)j(the)e
(interface)g(information)221 5394 y(known)e(to)g(the)g(ORB.)p
eop
%%Page: 77 85
77 84 bop 63 282 a Fg(7.3.)51 b(INTERF)-7 b(ACE)20 b(INHERIT)-7
b(ANCE)1829 b Fs(77)204 539 y(When)27 b(the)g(ORB)h(r)n(eceives)g(an)g
(IOR)g(fr)n(om)h(the)e(network,)g(it)h(unmarshals)g(and)g(extracts)63
652 y(the)c(RepoId)g(fr)n(om)i(the)f(IOR.)g(At)g(this)g(point,)h(the)f
(ORB)g(has)h(two)e(pieces)h(of)h(information)g(in)63
764 y(hand:)176 954 y(1.)46 b(The)22 b(RepoId)e(of)j(the)f(object)g(r)n
(efer)n(ence)g(r)n(eceived)h(fr)n(om)g(the)f(network.)176
1134 y(2.)46 b(The)26 b(RepoId)e(the)i(ORB)h(is)g(expecting.)38
b(This)27 b(comes)f(fr)n(om)h(the)f(unmarshal)h(function)290
1247 y(that)22 b(tells)h(the)e(ORB)i(to)f(r)n(eceive)h(the)f(object)g
(r)n(efer)n(ence.)204 1437 y(Using)g(the)g(RepoId)e(r)n(eceived,)i(the)
g(ORB)h(sear)n(ches)f(its)g(pr)n(oxyObjectFactory)g(list)g(for)h(an)63
1549 y(exact)h(match.)34 b(If)25 b(ther)n(e)e(is)i(an)g(exact)f(match,)
i(all)g(is)e(well)h(because)f(the)g(r)o(untime)h(can)g(use)e(the)63
1662 y Ff(is_a\(\))i Fs(method)i(of)h(the)f(pr)n(oxyFactory)f(to)h
(check)h(if)h(the)e(expected)f(RepoId)f(is)j(the)g(same)63
1775 y(as)22 b(the)g(r)n(eceived)g(RepoId)e(or)i(if)h(it)f(is)h(one)e
(of)i(its)f(base)g(interfaces.)28 b(If)22 b(the)f(answer)h(is)g
(positive,)63 1888 y(the)h(IOR)h(passes)e(the)h(type)f(checking)i(test)
e(and)i(the)f(ORB)h(can)h(pr)n(oceed)d(to)i(cr)n(eate)f(an)i(object)63
2001 y(r)n(efer)n(ence)d(in)h(its)f(own)g(addr)n(ess)f(space)i(to)f(r)n
(epr)n(esent)e(the)i(IOR.)204 2114 y(However)-7 b(,)22
b(the)h(ORB)g(may)h(fail)h(to)e(\002nd)g(a)h(match)h(in)f(its)f(pr)n
(oxyObjectFactory)f(list.)31 b(This)63 2227 y(means)18
b(that)h(the)f(ORB)g(has)h(no)f(local)i(knowledge)d(of)h(the)g(RepoId.)
25 b(Ther)n(e)18 b(ar)n(e)h(thr)n(ee)e(possible)63 2340
y(causes:)176 2529 y(1.)46 b(The)22 b(r)n(emote)f(end)h(is)h(another)f
(ORB)g(and)h(it)g(sends)d(a)k(null)f(string)f(as)g(the)g(RepoId.)176
2709 y(2.)46 b(The)17 b(ORB)h(is)g(expecting)e(an)i(object)g(r)n(efer)n
(ence)f(of)h(interface)g(A.)f(The)h(r)n(emote)e(end)h(sends)290
2822 y(the)k(RepoId)f(of)i(B)g(which)h(is)f(an)h(interface)f(that)g
(inherits)f(fr)n(om)i(A.)f(The)f(stubs)g(of)h(A)g(ar)n(e)290
2935 y(linked)g(into)g(the)g(executable)h(but)f(the)g(stubs)f(of)i(B)f
(ar)n(e)h(not.)176 3115 y(3.)46 b(The)22 b(r)n(emote)f(end)h(has)h
(sent)e(a)i(duf)n(f)g(IOR.)204 3305 y(T)-8 b(o)25 b(handle)g(this)g
(situation,)h(the)f(ORB)h(must)f(\002nd)g(out)g(the)g(type)f
(information)i(dynami-)63 3418 y(cally)-10 b(.)29 b(This)22
b(is)h(explained)f(in)h(the)f(next)g(section.)63 3713
y Fq(7.3)119 b(Interface)27 b(Inheritance)63 3924 y Fs(When)f(the)g
(ORB)h(r)n(eceives)g(an)g(IOR)g(of)g(interface)h(type)d(B)i(when)f(it)h
(expects)f(the)g(type)f(to)i(be)63 4036 y(A,)d(it)h(must)f(\002nd)g
(out)g(if)i(B)e(inherits)g(fr)n(om)h(A.)g(When)f(the)f(ORB)i(has)g(no)f
(local)i(knowledge)d(of)63 4149 y(the)e(type)h(B,)g(it)g(must)g(work)g
(out)g(the)g(type)f(of)h(B)h(dynamically)-10 b(.)204
4262 y(The)23 b(CORBA)h(speci\002cation)g(de\002nes)e(an)i(Interface)f
(Repository)e(\(IR\))j(fr)n(om)h(which)f(IDL)63 4375
y(interfaces)g(can)h(be)g(queried)e(dynamically)-10 b(.)35
b(In)25 b(the)e(above)i(situation,)g(the)e(ORB)i(could)f(con-)63
4488 y(tact)g(the)g(IR)g(to)g(\002nd)g(out)g(the)f(type)g(of)i(B.)e
(However)-7 b(,)24 b(this)g(appr)n(oach)h(assumes)e(that)i(an)f(IR)g
(is)63 4601 y(always)e(available)j(and)d(contains)g(the)f(up-to-date)g
(information)i(of)f(all)h(the)e(interfaces)h(used)63
4714 y(in)h(the)f(domain.)28 b(This)22 b(assumption)g(may)h(not)f(be)g
(valid)i(in)f(many)g(applications.)204 4827 y(An)i(alternative)i(is)f
(to)f(use)g(the)g Ff(_is_a\(\))e Fs(operation)i(to)h(work)f(out)g(the)g
(actual)i(type)e(of)63 4940 y(an)20 b(object.)27 b(This)20
b(appr)n(oach)g(is)g(simpler)g(and)h(mor)n(e)e(r)n(obust)h(than)g(the)f
(pr)n(evious)h(one)f(because)63 5053 y(no)j(3r)n(d)h(party)f(is)h
(involved.)204 5194 y Fe(class)49 b(Object)o({)403 5294
y(CORBA)o(::Boolean)f(_is_a)o(\(const)h(char)o(*)h(type_id)o(\);)204
5394 y(};)p eop
%%Page: 78 86
78 85 bop 221 282 a Fs(78)1333 b Fg(CHAPTER)21 b(7.)51
b(INTERF)-7 b(ACE)21 b(TYPE)g(CHECKING)362 539 y Fs(The)k
Ff(_is_a\(\))d Fs(operation)j(is)g(part)g(of)h(the)f
Ff(CORBA::Object)19 b Fs(interface)26 b(and)f(must)g(be)221
652 y(implemented)j(by)g(every)g(object.)46 b(The)28
b(input)h(ar)n(gument)f(is)h(a)g(RepoId.)44 b(The)28
b(function)h(r)n(e-)221 764 y(turns)23 b(tr)o(ue\(1\))i(if)f(the)g
(object)g(is)g(r)n(eally)h(an)f(instance)g(of)g(that)g(type,)f
(including)i(if)g(that)e(type)g(is)221 877 y(a)g(base)g(type)e(of)i
(the)e(most)h(derived)g(type)f(of)i(that)f(object.)362
990 y(In)29 b(the)e(situation)i(above,)h(the)e(ORB)g(would)g(invoke)h
(the)e Ff(_is_a\(\))f Fs(operation)i(on)g(the)221 1103
y(object)18 b(and)h(ask)f(if)h(the)f(object)g(is)h(of)f(type)f(A)h
Fr(befor)n(e)j Fs(it)e(pr)n(ocesses)d(any)i(application)i(invocation)
221 1216 y(on)i(the)g(object.)362 1329 y(Notice)j(that)g(the)f
Ff(_is_a\(\))e Fs(call)27 b(is)e Fr(not)g Fs(performed)f(when)g(the)h
(IOR)g(is)g(unmarshalled.)221 1442 y(It)35 b(is)g(performed)e(just)h
(prior)h(to)f(the)h(\002rst)f(application)i(invocation)g(on)e(the)h
(object.)64 b(This)221 1555 y(leads)21 b(to)f(some)g(inter)n(esting)g
(failur)n(e)i(modes)d(if)j(B)f(r)n(eports)e(that)i(it)g(is)g(not)f(an)h
(A.)g(Consider)f(the)221 1668 y(following)j(example:)362
1812 y Fd(//)50 b(IDL)362 1912 y Fe(interface)e(A)i({)g(...)f(};)362
2012 y(interface)f(B)i(:)g(A)f({)h(...)f(};)362 2111
y(interface)f(D)i({)g(...)f(};)362 2211 y(interface)f(C)i({)462
2311 y(A)299 b(op1)o(\(\);)462 2410 y(Object)49 b(op2)o(\(\);)362
2510 y(};)254 2700 y Fj(1)83 b Fd(//)50 b(C++)254 2799
y Fj(2)83 b Fe(C_ptr)49 b(objC)o(;)254 2899 y Fj(3)83
b Fe(A_ptr)49 b(objA)o(;)254 2999 y Fj(4)83 b Fe(CORBA)o(::Object_ptr)
48 b(objR)o(;)254 3098 y Fj(5)254 3198 y(6)83 b Fe(objA)49
b(=)100 b(objC)o(->op1)o(\(\);)254 3298 y Fj(7)83 b Fe(\(void)o(\))50
b(objA)o(->_non_existent)m(\(\);)254 3397 y Fj(8)254
3497 y(9)83 b Fe(objR)49 b(=)100 b(objC)o(->op2)o(\(\);)229
3596 y Fj(10)83 b Fe(objA)49 b(=)100 b(A::)o(_narrow)o(\(objR)o(\);)221
3755 y Fs(If)23 b(the)f(stubs)f(of)i(A,B,C,D)f(ar)n(e)h(linked)f(into)g
(the)g(executable)g(and:)221 3953 y Fn(Case)i(1)46 b
Ff(C::op1\(\))31 b Fs(and)k Ff(C::op2\(\))c Fs(r)n(eturn)j(a)h(B.)f
(Lines)g(6\22610)j(complete)d(successfully)-10 b(.)448
4066 y(The)22 b(r)n(emote)g(object)g(is)h(only)f(contacted)g(at)h(line)
g(7.)221 4249 y Fn(Case)h(2)46 b Ff(C::op1\(\))31 b Fs(and)k
Ff(C::op2\(\))c Fs(r)n(eturn)j(a)h(D.)g(This)f(condition)h(only)f
(occurs)g(if)i(the)448 4362 y(r)o(untime)27 b(of)f(the)g(r)n(emote)f
(end)h(is)g(buggy)-10 b(.)39 b(The)25 b(ORB)i(raises)f(a)h
(CORBA::Marshal)f(ex-)448 4475 y(ception)j(at)g(line)g(1)h(because)e
(it)i(knows)d(it)i(has)g(r)n(eceived)g(an)g(interface)h(of)f(the)f(wr)n
(ong)448 4588 y(type.)221 4786 y(If)23 b(only)f(the)g(stubs)f(of)i(A)g
(ar)n(e)g(linked)f(into)g(the)g(executable)g(and:)221
4985 y Fn(Case)i(1)46 b Ff(C::op1\(\))31 b Fs(and)k Ff(C::op2\(\))c
Fs(r)n(eturn)j(a)h(B.)f(Lines)g(6\22610)j(complete)d(successfully)-10
b(.)448 5098 y(When)22 b(lines)h(7)g(and)g(10)h(ar)n(e)f(executed,)d
(the)i(object)g(is)h(contacted)f(to)g(ask)g(if)h(it)g(is)g(an)g(A.)221
5281 y Fn(Case)h(2)46 b Ff(C::op1\(\))31 b Fs(and)k Ff(C::op2\(\))c
Fs(r)n(eturn)j(a)h(D.)g(This)f(condition)h(only)f(occurs)g(if)i(the)448
5394 y(r)o(untime)31 b(of)g(the)f(r)n(emote)g(end)g(is)h(buggy)-10
b(.)52 b(Line)31 b(6)g(completes)f(and)h(no)f(exception)g(is)p
eop
%%Page: 79 87
79 86 bop 63 282 a Fg(7.3.)51 b(INTERF)-7 b(ACE)20 b(INHERIT)-7
b(ANCE)1829 b Fs(79)290 539 y(raised.)27 b(At)20 b(line)i(7,)g(the)e
(object)h(is)g(contacted)f(to)h(ask)g(if)g(it)h(is)f(an)h(A.)e(If)h
(the)g(answer)f(is)h(no,)290 652 y(a)27 b Ff(CORBA::INV_OBJ)o(REF)20
b Fs(exception)25 b(is)h(raised.)39 b(The)25 b(application)j(will)f
(also)g(see)e(a)290 764 y Ff(CORBA::INV_OBJR)o(EF)16
b Fs(at)23 b(line)g(10.)p eop
%%Page: 80 88
80 87 bop 221 282 a Fs(80)1333 b Fg(CHAPTER)21 b(7.)51
b(INTERF)-7 b(ACE)21 b(TYPE)g(CHECKING)p eop
%%Page: 81 89
81 88 bop 63 1177 a Fm(Chapter)44 b(8)63 1608 y Fo(Connection)51
b(Management)63 2082 y Fs(This)22 b(chapter)g(describes)g(how)g
(omniORB)g(manages)h(network)e(connections.)63 2477 y
Fq(8.1)119 b(Background)63 2720 y Fs(In)20 b(CORBA,)h(the)f(ORB)g(is)h
(the)f(`middlewar)n(e')h(that)g(allows)g(a)h(client)f(to)f(invoke)g(an)
i(operation)63 2833 y(on)27 b(an)g(object)g(without)f(r)n(egar)n(d)h
(to)g(its)g(implementation)g(or)g(location.)42 b(In)27
b(or)n(der)f(to)h(invoke)63 2946 y(an)d(operation)e(on)i(an)g(object,)f
(a)i(client)f(needs)e(to)h(`bind')h(to)f(the)g(object)h(by)f(acquiring)
i(its)e(ob-)63 3059 y(ject)29 b(r)n(efer)n(ence.)46 b(Such)30
b(a)f(r)n(efer)n(ence)g(may)g(be)g(obtained)g(as)g(the)g(r)n(esult)f
(of)h(an)h(operation)e(on)63 3172 y(another)18 b(object)i(\(such)f(as)h
(a)g(naming)h(service\))e(or)h(by)f(conversion)g(fr)n(om)h(a)h
(stringi\002ed)d(r)n(epr)n(e-)63 3285 y(sentation.)27
b(If)c(the)f(object)g(is)h(in)g(a)h(dif)n(fer)n(ent)e(addr)n(ess)g
(space,)g(the)g(binding)h(pr)n(ocess)e(involves)63 3398
y(the)27 b(ORB)h(building)g(a)h(pr)n(oxy)e(object)h(in)g(the)g
(client's)g(addr)n(ess)e(space.)44 b(The)27 b(ORB)h(arranges)63
3511 y(for)20 b(invocations)h(on)f(the)g(pr)n(oxy)g(object)g(to)g(be)h
(transpar)n(ently)e(mapped)h(to)g(equivalent)h(invo-)63
3623 y(cations)h(on)h(the)e(implementation)i(object.)204
3752 y(For)17 b(the)g(sake)f(of)i(inter)n(operability)-10
b(,)18 b(CORBA)g(mandates)f(that)h(all)h(ORBs)e(should)g(support)63
3865 y(IIOP)23 b(as)h(the)e(means)i(to)f(communicate)h(r)n(emote)f
(invocations)h(over)f(a)h(TCP/IP)f(connection.)63 3978
y(IIOP)33 b(is)h(asymmetric)h(with)e(r)n(espect)g(to)h(the)f(r)n(oles)g
(of)h(the)f(parties)h(at)g(the)f(two)g(ends)g(of)h(a)63
4091 y(connection.)27 b(At)22 b(one)f(end)h(is)g(the)g(client)h(which)g
(can)g(only)f(initiate)h(r)n(emote)f(invocations.)28
b(At)63 4204 y(the)21 b(other)h(end)g(is)g(the)g(server)g(which)h(can)g
(only)g(r)n(eceive)f(r)n(emote)g(invocations.)204 4332
y(Notice)34 b(that)h(in)h(CORBA,)f(as)g(in)h(most)e(distributed)g
(systems,)i(r)n(emote)e(bindings)h(ar)n(e)63 4445 y(established)23
b(implicitly)j(without)e(application)i(intervention.)32
b(This)24 b(pr)n(ovides)g(the)g(illusion)63 4558 y(that)34
b(all)j(objects)d(ar)n(e)i(local,)j(a)d(pr)n(operty)d(known)h(as)h
(`location)h(transpar)n(ency'.)65 b(CORBA)63 4671 y(does)20
b(not)h(specify)g(when)g(such)h(bindings)f(should)g(be)h(established)f
(or)g(how)g(they)g(should)g(be)63 4784 y(multiplexed)28
b(over)g(the)g(underlying)f(network)g(connections.)45
b(Instead,)29 b(ORBs)f(ar)n(e)h(fr)n(ee)f(to)63 4897
y(implement)22 b(implicit)j(binding)d(by)h(a)g(variety)g(of)f(means.)
204 5025 y(The)d(r)n(est)g(of)h(this)f(chapter)h(describes)f(how)g
(omniORB)h(manages)g(network)e(connections)63 5138 y(and)k(the)g(pr)n
(ogramming)h(interface)g(to)f(\002ne)g(tune)f(the)h(management)g
(policy)-10 b(.)1662 5622 y(81)p eop
%%Page: 82 90
82 89 bop 221 282 a Fs(82)1256 b Fg(CHAPTER)21 b(8.)51
b(CONNECTION)22 b(MANAGEMENT)221 539 y Fq(8.2)119 b(The)30
b(Model)221 758 y Fs(omniORB)e(is)g(designed)e(fr)n(om)i(the)f(gr)n
(ound)g(up)h(to)f(be)h(fully)g(multi-thr)n(eaded.)43
b(The)28 b(objec-)221 871 y(tive)e(is)h(to)e(maximise)i(the)e(degr)n
(ee)g(of)h(concurr)n(ency)f(and)h(at)h(the)e(same)h(time)g(eliminate)h
(any)221 984 y(unnecessary)k(thr)n(ead)h(over)n(head.)56
b(Another)31 b(objective)i(is)f(to)g(minimise)h(the)f(interfer)n(ence)
221 1097 y(by)27 b(the)f(activities)i(of)f(other)e(thr)n(eads)h(on)g
(the)g(pr)n(ogr)n(ess)f(of)i(a)h(r)n(emote)d(invocation.)42
b(In)26 b(other)221 1210 y(wor)n(ds,)i(thr)n(ead)e(`cr)n(oss-talk')i
(should)f(be)g(minimised)h(within)g(the)f(ORB.)g(T)-8
b(o)27 b(achieve)h(these)221 1323 y(objectives,)22 b(the)g(degr)n(ee)f
(of)h(multiplexing)h(at)g(every)f(level)h(is)f(kept)g(to)g(a)h
(minimum.)362 1440 y(On)33 b(the)e(client)h(side)f(of)h(a)h
(connection,)g(the)e(thr)n(ead)h(that)f(invokes)g(on)h(a)g(pr)n(oxy)f
(object)221 1553 y(drives)22 b(the)g(IIOP)g(pr)n(otocol)g(dir)n(ectly)h
(and)g(blocks)f(on)g(the)g(connection)g(to)g(r)n(eceive)h(the)f(r)n
(eply)-10 b(.)221 1666 y(On)26 b(the)e(server)g(side,)g(a)i(dedicated)d
(thr)n(ead)i(blocks)g(on)f(the)g(connection.)35 b(When)24
b(it)h(r)n(eceives)221 1779 y(a)c(r)n(equest,)e(it)i(performs)e(the)g
(up-call)j(to)e(the)g(object)g(and)g(sends)f(the)g(r)n(eply)h(when)g
(the)f(up-call)221 1892 y(r)n(eturns.)27 b(Ther)n(e)21
b(is)i(no)f(thr)n(ead)h(switching)f(along)h(the)e(call)k(chain.)362
2009 y(W)-5 b(ith)33 b(this)g(design,)h(ther)n(e)f(is)g(at)g(most)g
(one)f(call)j(in-\003ight)f(at)f(any)g(time)g(on)g(a)h(connec-)221
2122 y(tion.)53 b(If)31 b(ther)n(e)f(is)i(only)e(one)h(connection,)h
(concurr)n(ent)f(invocations)g(to)g(the)f(same)h(r)n(emote)221
2235 y(addr)n(ess)24 b(space)h(would)g(have)g(to)g(be)g(serialised.)35
b(T)-8 b(o)25 b(eliminate)h(this)f(limitation,)i(omniORB)221
2348 y(implements)g(a)i(dynamic)f(policy\227multiple)h(connections)d
(to)i(the)f(same)h(r)n(emote)e(addr)n(ess)221 2461 y(space)21
b(ar)n(e)g(cr)n(eated)g(on)f(demand)h(and)g(cached)g(when)f(ther)n(e)g
(ar)n(e)i(concurr)n(ent)e(invocations)i(in)221 2573 y(pr)n(ogr)n(ess.)
362 2691 y(T)-8 b(o)26 b(be)g(mor)n(e)g(pr)n(ecise,)g(a)h(network)d
(connection)i(to)f(another)h(addr)n(ess)f(space)g(is)i(only)f(es-)221
2804 y(tablished)f(when)g(a)h(r)n(emote)f(invocation)h(is)g(about)f(to)
g(be)g(made.)36 b(Ther)n(efor)n(e,)25 b(ther)n(e)f(may)i(be)221
2917 y(one)18 b(or)h(mor)n(e)f(object)h(r)n(efer)n(ences)e(in)j(one)e
(addr)n(ess)f(space)h(that)h(r)n(efer)f(to)g(objects)h(in)g(a)g(dif)n
(fer)n(ent)221 3029 y(addr)n(ess)h(space)g(but)h(unless)f(the)g
(application)j(invokes)d(on)g(these)g(objects,)g(no)h(network)e(con-)
221 3142 y(nection)i(is)g(made.)27 b(The)20 b(maximum)j(number)e(of)g
(connections)f(opened)f(to)h(another)g(addr)n(ess)221
3255 y(space)g(is)g(5)g(by)g(default.)27 b(Since)20 b(2.6.0,)h(this)e
(parameter)h(can)g(be)g(changed)f(by)h(setting)e(the)h(vari-)221
3368 y(able)24 b Ff(omniORB::maxTc)o(pC)o(on)o(nec)o(ti)o(on)o(Pe)o(rS)
o(erv)o(er)16 b Fr(befor)n(e)25 b Fs(calling)f Ff(ORB_init\(\))p
Fs(.)362 3485 y(It)33 b(is)h(wasteful)f(to)g(leave)h(a)g(connection)f
(open)f(when)h(it)g(has)h(been)f(left)g(unused)f(for)h(a)221
3598 y(considerable)23 b(time.)31 b(T)-8 b(oo)22 b(many)i(idle)f
(connections)g(could)g(block)h(out)e(new)h(connections)g(to)221
3711 y(a)32 b(server)e(when)g(it)h(r)o(uns)g(out)f(of)h(spar)n(e)g
(communication)h(channels.)54 b(For)30 b(example,)j(most)221
3824 y(Unix)27 b(platforms)f(have)g(a)h(limit)h(on)e(the)f(number)h(of)
h(\002le)f(handles)g(a)g(pr)n(ocess)f(can)i(open.)38
b(64)221 3937 y(is)23 b(the)f(usual)h(default)g(limit.)29
b(The)22 b(value)i(can)f(be)g(incr)n(eased)g(to)f(a)h(maximum)h(of)f(a)
g(thousand)221 4050 y(or)f(mor)n(e)h(by)f(changing)h(the)f(`ulimit')i
(in)f(the)f(shell.)221 4375 y Fq(8.3)119 b(Idle)29 b(Connection)i
(Shutdown)f(and)g(Remote)g(Call)g(T)-7 b(imeout)221 4595
y Fs(Inside)19 b(the)g(ORB,)g(a)h(thr)n(ead)f(is)h(dedicated)e(to)i
(scan)g(for)f(idle)h(connections.)26 b(The)19 b(thr)n(ead)g(looks)221
4708 y(after)k(both)f(the)g(outgoing)f(connections)g(and)i(the)f
(incoming)h(connections.)362 4825 y(When)33 b(a)h(connection)e(is)h
(idle)h(for)f(a)g(period)f(of)i(time,)h(the)e(connection)f(is)h
(shutdown.)221 4938 y(Similarly)-10 b(,)32 b(if)d(a)h(r)n(emote)d(call)
k(has)d(not)g(completed)g(within)h(a)g(de\002ned)e(period)g(of)i(time,)
h(the)221 5051 y(connection)22 b(is)h(shutdown)e(and)h(the)g(ORB)g
(will)i(r)n(eturn)e Ff(COMM_FAILURE)17 b Fs(to)22 b(the)g(client.)362
5168 y(How)d(often)g(the)h(internal)g(thr)n(ead)f(scans)h(the)f
(connections)g(is)h(determined)e(by)i(the)f(value)221
5281 y(of)j(the)f Fr(scan)h(granularity)p Fs(.)29 b(This)22
b(value)g(is)g(defaulted)f(to)g(5)h(seconds)e(and)h(can)i(be)e(changed)
g(us-)221 5394 y(ing)28 b(the)f(command-line)i(option)e
Ff(-ORBscanGranula)o(ri)o(ty)21 b Fs(or)28 b(using)f(the)g
Ff(omniORB::)p eop
%%Page: 83 91
83 90 bop 63 282 a Fg(8.4.)51 b(INTEROPERABILITY)18 b(CONSIDERA)-7
b(TIONS)1285 b Fs(83)63 539 y Ff(scanGranularit)o(y)19
b Fs(call.)36 b(Notice)25 b(that)f(this)h(value)h(determines)d(the)h
(pr)n(ecision)h(the)f(ORB)63 652 y(is)e(able)i(to)e(keep)f(to)h(the)g
(value)h(of)g(the)e(idle)i(connection)f(or)h(r)n(emote)e(call)k
(timeout.)204 770 y(How)h(long)g(the)g(ORB)g(will)i(wait)f(befor)n(e)f
(it)h(shuts)e(down)h(an)h(idle)g(connection)f(is)h(deter)n(-)63
883 y(mined)e(by)g(the)f(idleConnectionPeriods.)33 b(Ther)n(e)24
b(ar)n(e)i(separate)d(values)j(for)f(incoming)h(and)63
996 y(outgoing)j(connections.)51 b(The)30 b(default)h(values)g(ar)n(e)h
(180)g(and)f(120)h(seconds)d(for)i(incoming)63 1109 y(and)k(outgoing)e
(connections)h(r)n(espectively)-10 b(.)63 b(These)34
b(values)h(can)h(be)f(changed)f(using)g(the)63 1222 y(command-line)26
b(options)d Ff(-ORBinConScanP)o(eri)o(od)18 b Fs(and)25
b Ff(-ORBoutConScan)o(Per)o(io)o(d)p Fs(.)63 1334 y(They)20
b(can)i(also)f(be)g(contr)n(olled)g(by)g(the)f Ff(omniORB::idleCon)o
(ne)o(ct)o(io)o(nS)o(can)o(Pe)o(ri)o(od)o(\(\))63 1447
y Fs(call.)204 1566 y(Similarly)-10 b(,)34 b(how)c(long)h(the)f(ORB)h
(will)h(wait)f(for)g(a)g(r)n(emote)f(call)j(to)d(complete)g(is)h(deter)
n(-)63 1679 y(mined)18 b(by)g(the)f(parameter)h(clientCallT)-5
b(imeOutPeriod)19 b(for)f(the)f(client)i(side)e(and)i(the)e(server)n(-)
63 1792 y(CallT)-5 b(imeOutPer)n(oid)27 b(for)e(the)g(server)g(side.)36
b(By)25 b(default)h(calls)h(will)g(not)e(timeout)g(on)g(either)63
1905 y(the)c(client)j(or)e(server)f(side.)204 2023 y(The)26
b(timeouts)h(can)h(be)f(changed)g(using)g(the)f Ff(omniORB::callTi)o
(me)o(Out)o(Pe)o(ri)o(od)o(\(\))63 2136 y Fs(call,)34
b(or)c(with)h(the)f(command)h(line)h(options)d Ff(-ORBclientCallT)o(im)
o(eO)o(ut)o(Pe)o(rio)o(d)c Fs(and)63 2249 y Ff(-ORBserverCall)o(Ti)o
(me)o(Out)o(Pe)o(ri)o(od)o Fs(.)204 2367 y(The)d(APIs)f(ar)n(e)i
(documented)e(in)i Ff(include/omniORB)o(3/)o(om)o(ni)o(OR)o(B.h)o
Fs(.)204 2528 y Fe(class)49 b(omniORB)f({)204 2627 y(public)o(:)303
2827 y(static)h(void)g(scanGranularity)m(\(CORBA)o(::ULong)g(sec)o(\);)
303 3026 y(static)g(CORBA)o(::ULong)g(scanGranularity)m(\(\);)303
3225 y(enum)149 b(idleConnType)48 b({)h(idleIncoming)n(,)h
(idleOutgoing)d(};)303 3424 y(static)i(void)g(idleConnectionScanPeriod)
l(\(idleConnType)e(direction)n(,)j(CORBA)o(::ULong)f(sec)o(\);)303
3624 y(static)g(CORBA)o(::ULong)g(idleConnectionScanPeriod)-5
b(\(idleConnType)48 b(direction)n(\);)303 3823 y(enum)149
b(callTimeOutType)47 b({)j(clientSide)n(,)g(serverSide)d(};)303
4022 y(static)i(void)g(callTimeOutPeriod)m(\(callTimeOutType)e
(direction)n(,)j(CORBA)o(::)o(ULong)f(sec\);)303 4221
y(static)g(CORBA)o(::ULong)g(callTimeOutPeriod)m(\()o(callTimeOutType)e
(direction)o(\);)204 4321 y(};)204 4500 y Fs(The)22 b(scan)h(can)g(be)g
(disabled)f(completely)g(by)h(setting)e(the)g(scan)i(granularity)g(to)f
(0.)63 4833 y Fq(8.4)119 b(Interoperability)27 b(Considerations)63
5055 y Fs(The)k(IIOP)h(speci\002cation)g(allows)h(both)e(the)h(client)g
(and)h(the)e(server)g(to)h(shutdown)e(a)i(con-)63 5168
y(nection)27 b(unilaterally)-10 b(.)45 b(When)27 b(one)g(end)g(is)h
(about)g(to)g(shutdown)d(a)k(connection,)f(it)h(should)63
5281 y(send)18 b(a)j(closeConnection)d(message)h(to)g(the)g(other)g
(end.)26 b(It)19 b(should)g(also)h(make)g(sur)n(e)f(that)g(the)63
5394 y(message)i(will)j(r)n(each)f(the)f(other)f(end)h(befor)n(e)g(it)h
(pr)n(oceeds)e(to)h(shutdown)e(the)i(connection.)p eop
%%Page: 84 92
84 91 bop 221 282 a Fs(84)1256 b Fg(CHAPTER)21 b(8.)51
b(CONNECTION)22 b(MANAGEMENT)362 539 y Fs(The)36 b(client)g(should)g
(distinguish)f(between)f(an)j(or)n(derly)e(and)i(an)f(abnormal)i
(connec-)221 652 y(tion)24 b(shutdown.)30 b(When)23 b(a)i(client)f(r)n
(eceives)g(a)g(closeConnection)f(message)g(befor)n(e)h(the)f(con-)221
764 y(nection)28 b(is)h(closed,)f(the)g(condition)g(is)g(an)h(or)n
(derly)f(shutdown.)43 b(If)28 b(the)g(message)f(is)h(not)g(r)n(e-)221
877 y(ceived,)35 b(the)c(condition)h(is)g(an)h(abnormal)h(shutdown.)55
b(In)32 b(an)h(abnormal)g(shutdown,)g(the)221 990 y(ORB)d(should)g
(raise)g(a)h Ff(COMM_FAILURE)25 b Fs(exception)30 b(wher)n(eas)f(in)i
(an)g(or)n(derly)e(shutdown,)221 1103 y(the)20 b(ORB)g(should)f
Fr(not)i Fs(raise)f(an)h(exception)e(and)h(should)f(try)h(to)f(r)n
(e-establish)h(a)h(new)f(connec-)221 1216 y(tion)j(transpar)n(ently)-10
b(.)362 1330 y(omniORB)28 b(implements)e(these)f(semantics)i
(completely)-10 b(.)41 b(However)-7 b(,)27 b(it)g(is)g(known)f(that)221
1443 y(some)35 b(ORBs)g(ar)n(e)h(not)f(\(yet\))g(able)h(to)f
(distinguish)g(between)f(an)i(or)n(derly)e(and)i(an)g(abnor)n(-)221
1556 y(mal)h(shutdown.)63 b(Usually)35 b(this)g(is)g(manifested)f(as)h
(the)g(client)g(in)h(these)d(ORBs)i(seeing)e(a)221 1669
y Ff(COMM_FAILURE)23 b Fs(occasionally)30 b(when)e(connected)f(to)h(an)
h(omniORB)f(server)-7 b(.)45 b(The)28 b(work-)221 1782
y(ar)n(ound)23 b(is)h(either)e(to)h(catch)h(the)f(exception)f(in)i(the)
e(application)j(code)d(and)i(r)n(etry)-10 b(,)22 b(or)h(to)g(turn)221
1895 y(of)n(f)g(the)f(idle)h(connection)f(shutdown)f(inside)h(the)g
(omniORB)g(server)-7 b(.)221 2201 y Fq(8.5)119 b(Connection)31
b(Acceptance)221 2414 y Fs(omniORB)25 b(pr)n(ovides)g(the)f(hook)g(to)h
(implement)g(a)g(connection)g(acceptance)h(policy)-10
b(.)35 b(Inside)221 2527 y(the)g(ORB)g(r)o(untime,)j(a)e(thr)n(ead)f
(is)h(dedicated)e(to)h(r)n(eceive)h(new)f(connections.)65
b(When)35 b(the)221 2640 y(thr)n(ead)21 b(is)g(given)g(the)g(handle)g
(of)g(a)h(new)e(connection)h(by)g(the)f(operating)g(system,)g(it)h
(calls)i(the)221 2753 y(policy)f(module)f(to)g(decide)f(if)j(the)d
(connection)h(can)i(be)e(accepted.)27 b(If)21 b(the)g(answer)g(is)h
(yes,)e(the)221 2866 y(ORB)32 b(will)g(start)f(serving)g(r)n(equests)f
(coming)i(in)g(fr)n(om)g(that)f(connection.)54 b(Otherwise,)33
b(the)221 2979 y(connection)22 b(is)h(shutdown)e(immediately)-10
b(.)362 3093 y(Ther)n(e)27 b(can)h(be)f(a)h(number)f(of)g(policy)h
(module)e(implementations.)42 b(The)26 b(basic)j(one)d(is)h(a)221
3206 y(dummy)22 b(module)g(which)i(just)e(accepts)g(every)f
(connection.)362 3320 y(In)h(addition,)f(a)h(host-based)f(access)g
(contr)n(ol)h(module)f(is)h(available)j(on)d(Unix)f(platforms.)221
3433 y(The)33 b(module)g(uses)f(the)h(IP)g(addr)n(ess)f(of)h(the)g
(client)h(to)f(decide)g(if)h(the)f(connection)g(can)h(be)221
3546 y(accepted.)66 b(The)35 b(module)g(is)h(implemented)e(using)h
Fr(tcp_wrappers)40 b(7.6)p Fs(.)67 b(The)35 b(access)h(con-)221
3659 y(tr)n(ol)28 b(policy)g(can)h(be)f(de\002ned)e(as)i(r)o(ules)g(in)
g(two)f(access)h(contr)n(ol)g(\002les:)38 b Ff(hosts.allow)23
b Fs(and)221 3771 y Ff(hosts.deny)p Fs(.)52 b(The)32
b(syntax)f(of)i(the)e(r)o(ules)h(is)g(described)f(in)i(the)e(manual)j
(page)e Ff(hosts_)221 3884 y(access\(5\))24 b Fs(which)29
b(can)g(be)f(found)g(in)g(appendix)g(A.)44 b(The)27 b(syntax)h
(de\002nes)e(a)j(simple)f(ac-)221 3997 y(cess)23 b(contr)n(ol)g
(language)g(that)h(is)f(based)g(on)g(client)h(\(host)f(name/addr)n
(ess,)f(user)g(name\),)i(and)221 4110 y(server)i(\(pr)n(ocess)g(name,)i
(host)e(name/addr)n(ess\))g(patterns.)40 b(When)26 b(sear)n(ching)i
(for)f(a)g(match)221 4223 y(on)f(the)g(server)f(pr)n(ocess)g(name,)i
(the)e(ORB)h(uses)f(the)h(value)h(of)f Ff(omniORB::serve)o(rNa)o(me)o
Fs(.)221 4336 y Ff(ORB_init\(\))18 b Fs(uses)j(the)g(ar)n(gument)h
Ff(argv[0])d Fs(to)j(set)f(the)h(default)g(value)h(of)f(this)g
(variable.)221 4449 y(This)32 b(can)h(be)g(overridden)d(by)j(the)e
(application)j(with)e(the)f Ff(-ORBserverName)48 b Fs(<)p
Fr(string)p Fs(>)221 4562 y(command)23 b(line)g(ar)n(gument)362
4676 y(The)h(default)g(location)h(of)g(the)e(access)i(contr)n(ol)f
(\002les)g(is)g Ff(/etc)p Fs(.)32 b(This)24 b(can)h(be)g(overridden)221
4789 y(by)e(the)f(extra)g(options)f(in)i Ff(omniORB.cfg)p
Fs(.)g(For)f(instance:)221 4995 y Fe(#)50 b(omniORB)e(configuration)g
(file)h(-)g(extra)g(options)221 5194 y(GATEKEEPER_ALLOWFILE)146
b(/project/omni/var/hosts.allow)221 5394 y(GATEKEEPER_DENYFILE)196
b(/project/omni/var/hosts.deny)p eop
%%Page: 85 93
85 92 bop 63 282 a Fg(8.5.)51 b(CONNECTION)22 b(ACCEPT)-7
b(ANCE)1722 b Fs(85)204 751 y(As)17 b(each)i(policy)f(module)g(is)g
(implemented)f(as)i(a)f(separate)f(library)-10 b(,)20
b(the)e(choice)g(of)g(policy)63 864 y(module)34 b(is)h(determined)d(at)
j(pr)n(ogram)g(linkage)g(time.)64 b(For)34 b(instance,)k(if)d(the)f
(host-based)63 977 y(access)22 b(contr)n(ol)h(module)f(is)h(in)g(use:)
63 1176 y Fe(\045)49 b(eg1)h(-ORBtraceLevel)d(2)63 1276
y(omniORB)h(gateKeeper)g(is)i(tcpwrapGK)e(1.0)h(-)h(based)e(on)i
(tcp_wrappers_7.6)63 1375 y(I)f(said,"Hello!".)e(The)j(Object)e
(said,"Hello!")63 1588 y Fs(Wher)n(eas)22 b(if)h(the)f(dummy)g(module)g
(is)h(in)g(use:)63 1787 y Fe(\045)49 b(eg1)h(-ORBtraceLevel)d(2)63
1887 y(omniORB)h(gateKeeper)g(is)i(not)f(installed.)f(All)h(incoming)f
(are)i(accepted.)63 1986 y(I)f(said,"Hello!".)e(The)j(Object)e
(said,"Hello!")p eop
%%Page: 86 94
86 93 bop 221 282 a Fs(86)1256 b Fg(CHAPTER)21 b(8.)51
b(CONNECTION)22 b(MANAGEMENT)p eop
%%Page: 87 95
87 94 bop 63 1164 a Fm(Chapter)44 b(9)63 1581 y Fo(T)-19
b(ype)52 b(Any)f(and)i(T)-19 b(ypeCode)63 2042 y Fs(The)23
b(CORBA)g(speci\002cation)h(pr)n(ovides)f(for)g(a)i(type)d(that)h(can)i
(hold)e(the)g(value)h(of)g(any)g(OMG)63 2155 y(IDL)18
b(type.)24 b(This)18 b(type)f(is)h(known)g(as)g(type)f(Any)-10
b(.)25 b(The)18 b(OMG)h(also)f(speci\002es)f(a)i(pseudo-object,)63
2268 y(T)-8 b(ypeCode,)20 b(that)i(can)h(encode)f(a)h(description)e(of)
i(any)f(type)g(speci\002able)h(in)g(OMG)g(IDL.)204 2383
y(In)32 b(this)f(chapter)-7 b(,)34 b(an)f(example)f(demonstrating)e
(the)h(use)g(of)h(type)f(Any)g(is)i(pr)n(esented.)63
2496 y(This)18 b(is)g(followed)g(by)g(sections)f(describing)h(the)g
(behaviour)h(of)f(type)f(Any)h(and)g(T)-8 b(ypeCode)16
b(in)63 2609 y(omniORB.)23 b(For)g(further)f(information)i(on)g(type)e
(Any)-10 b(,)22 b(r)n(efer)h(to)g(the)g(C++)h(Mapping)f(section)63
2722 y(of)f(the)g(CORBA)h(2.3)g(speci\002cation)g([OMG99)r(],)g(and)g
(for)f(mor)n(e)h(information)g(on)f(T)-8 b(ypeCode,)63
2835 y(r)n(efer)22 b(to)g(the)g(Interface)g(Repository)e(chapter)i(in)h
(the)f(CORBA)h(cor)n(e)f(section)g(of)h(the)f(CORBA)63
2948 y(2.3)h(speci\002cation.)p 63 3057 3289 17 v 1529
3161 a Fn(W)-7 b(arning)199 3311 y Fs(Since)32 b(2.8.0,)k(omniORB)c
(has)h(been)e(updated)g(to)h(CORBA)g(2.3.)58 b(In)32
b(or)n(der)f(to)h(com-)199 3424 y(ply)37 b(with)h(the)f(2.3)h
(speci\002cation,)k(it)37 b(is)h(necessary)e(to)h(change)h(the)f
(semantics)g(of)199 3537 y Fr(the)c(extraction)h(of)f(string,)i(object)
e(r)n(efer)n(ence)i(and)d(typecode)j(fr)n(om)e(an)f(Any)p
Fs(.)55 b(The)31 b(mem-)199 3650 y(ory)h(of)g(the)g(extracted)f(values)
i(of)f(these)f(types)g(now)h(belongs)f(to)h(the)g(Any)g(value.)199
3763 y(The)25 b(storage)g(is)h(fr)n(eed)f(when)g(the)g(Any)g(value)i
(is)f(deallocated.)38 b(Pr)n(eviously)25 b(the)g(ex-)199
3876 y(tracted)34 b(value)i(was)f(a)g(copy)f(and)h(the)f(application)i
(was)f(r)n(esponsible)f(for)h(r)n(eleas-)199 3989 y(ing)30
b(the)g(storage.)49 b(It)30 b(is)g(not)g(possible)g(to)f(detect)g(the)h
(old)g(usage)f(at)i(compile)f(time.)199 4102 y(In)37
b(particular)-7 b(,)41 b(unmodi\002ed)36 b(code)g(that)h(uses)e(the)h
(af)n(fected)h(Any)f(extraction)h(op-)199 4214 y(erators)c(will)j(most)
e(certainly)g(cause)h(r)o(untime)f(err)n(ors)g(to)f(occur)-7
b(.)64 b(T)-8 b(o)34 b(smooth)f(the)199 4327 y(transition)i(fr)n(om)i
(the)e(old)g(usage)g(to)g(the)g(new)-8 b(,)37 b(an)g(ORB)e
(con\002guration)g(variable)199 4440 y Ff(omniORB::omniOR)o(B_)o(27)o
(_C)o(omp)o(at)o(ib)o(le)o(An)o(yEx)o(tr)o(ac)o(ti)o(on)21
b Fs(can)29 b(be)e(set)g(to)g(r)n(e-)199 4553 y(vert)22
b(the)g(any)h(extraction)f(operators)e(to)i(the)g(old)h(semantics.)p
63 4638 V 63 4952 a Fq(9.1)119 b(Example)29 b(using)h(type)g(Any)63
5168 y Fs(Befor)n(e)22 b(going)g(thr)n(ough)g(this)h(example,)g(you)g
(should)f(make)h(sur)n(e)f(that)h(you)g(have)g(r)n(ead)h(and)63
5281 y(understood)14 b(the)j(examples)g(in)h(chapter)g(2.)26
b(The)17 b(sour)n(ce)g(code)g(for)h(this)f(example)h(is)g(included)63
5394 y(in)31 b(the)e(omniORB)i(distribution,)g(in)g(the)f(dir)n(ectory)
g Ff(src/examples/a)o(ny)o(Ex)o(amp)o(le)o Fs(.)46 b(A)1662
5622 y(87)p eop
%%Page: 88 96
88 95 bop 221 282 a Fs(88)1412 b Fg(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)221 539 y Fs(listing)h(of)g(the)e
(sour)n(ce)h(code)g(is)h(pr)n(ovided)e(at)i(the)f(end)g(of)g(this)h
(chapter)-7 b(.)221 799 y Fk(9.1.1)99 b(T)-9 b(ype)25
b(Any)g(in)g(IDL)221 978 y Fs(T)-8 b(ype)28 b(Any)h(allows)h(one)f(to)g
(delay)g(the)g(decision)h(on)f(the)g(type)f(used)g(in)i(an)g(operation)
f(un-)221 1091 y(til)34 b(r)o(un-time.)59 b(T)-8 b(o)32
b(use)f(type)h(any)h(in)g(IDL,)f(use)g(the)g(keywor)n(d)f
Ff(any)p Fs(,)j(as)f(in)h(the)e(following)221 1204 y(example:)362
1356 y Fd(//)50 b(IDL)362 1555 y Fe(interface)e(anyExample)g({)462
1655 y(any)h(testOp)o(\(in)g(any)h(mesg)o(\);)362 1754
y(};)362 1920 y Fs(The)17 b(operation)f Ff(testOp\(\)\(\))d
Fs(in)18 b(this)e(example)i(can)g(now)e(take)h(any)g(value)h(expr)n
(essible)221 2033 y(in)g(OMG)h(IDL)e(as)h(an)g(ar)n(gument,)g(and)f
(can)i(also)e(r)n(eturn)g(any)h(type)e(expr)n(essible)g(in)i(OMG)h
(IDL.)362 2147 y(T)-8 b(ype)27 b(Any)h(is)h(mapped)e(into)i(C++)g(as)f
(the)g(type)f Ff(CORBA::Any)p Fs(.)41 b(When)28 b(passed)f(as)i(an)221
2260 y(ar)n(gument)22 b(or)h(as)f(a)i(r)n(esult)e(of)g(an)h(operation,)
e(the)h(following)h(r)o(ules)f(apply:)412 2453 y Fa(In)864
b(InOut)416 b(Out)599 b(Return)p 362 2486 3039 4 v 412
2555 a Fe(const)49 b(CORBA::Any&)98 b(CORBA::Any&)f(CORBA::Any*&)147
b(CORBA::Any*)362 2733 y Fs(So,)22 b(the)g(above)h(IDL)f(would)g(map)h
(to)f(the)g(following)h(C++:)362 2884 y Fd(//)50 b(C++)362
3083 y Fe(class)f(anyExample_i)f(:)h(public)g(virtual)g(_sk_anyExample)
e({)362 3183 y(public)o(:)462 3283 y(anyExample_i)n(\(\))i({)h(})462
3382 y(virtual)e(~anyExample_i)n(\(\))h({)h(})462 3482
y(virtual)e(CORBA)o(::Any*)h(testOp)o(\(const)g(CORBA)o(::)o(Any&)h(a)o
(\);)362 3581 y(};)221 3894 y Fk(9.1.2)99 b(Inserting)25
b(and)f(Extracting)i(Basic)f(T)-9 b(ypes)26 b(from)f(an)f(Any)221
4073 y Fs(The)i(question)e(now)i(arises)g(as)g(to)g(how)g(values)g(ar)n
(e)h(inserted)d(into)i(and)g(r)n(emoved)g(fr)n(om)h(an)221
4186 y(Any)-10 b(.)27 b(This)c(is)f(achieved)h(using)f(two)g
(overloaded)f(operators:)26 b Ff(<<=)21 b Fs(and)i Ff(>>=)p
Fs(.)362 4300 y(T)-8 b(o)22 b(insert)g(a)h(value)g(into)g(an)g(Any)-10
b(,)21 b(the)h Ff(<<=)f Fs(operator)h(is)g(used,)f(as)i(in)g(this)f
(example:)362 4451 y Fd(//)50 b(C++)362 4551 y Fe(CORBA)o(::Any)f
(an_any)o(;)362 4651 y(CORBA)o(::Long)g(l)h(=)f(100;)362
4750 y(an_any)g(<<=)g(l;)362 4916 y Fs(Note)21 b(that)i(the)f
(overloaded)f Ff(<<=)g Fs(operator)g(has)i(a)g(r)n(eturn)f(type)f(of)i
Ff(void)p Fs(.)362 5030 y(T)-8 b(o)22 b(extract)g(a)i(value,)f(the)f
Ff(>>=)f Fs(operator)h(is)g(used,)g(as)g(in)i(this)e(example)h(\(wher)n
(e)f(the)g(Any)221 5143 y(contains)h(a)g(long\):)362
5294 y Fd(//)50 b(C++)362 5394 y Fe(CORBA)o(::Long)f(l;)p
eop
%%Page: 89 97
89 96 bop 63 282 a Fg(9.1.)51 b(EXAMPLE)21 b(USING)g(TYPE)h(ANY)1775
b Fs(89)204 539 y Fe(an_any)48 b(>>=)i(l;)204 738 y(cout)f(<<)g("This)g
(is)h(a)f(long:)g(")h(<<)f(l)h(<<)f(endl;)204 904 y Fs(The)33
b(overloaded)g Ff(>>=)g Fs(operator)g(r)n(eturns)g(a)i
Ff(CORBA::Boolean)o Fs(.)57 b(If)35 b(an)f(attempt)f(is)63
1017 y(made)20 b(to)f(extract)h(a)g(value)h(fr)n(om)f(an)h(Any)e(when)h
(it)g(contains)g(a)g(dif)n(fer)n(ent)g(type)f(of)h(value)h(\(e.g.)63
1130 y(an)f(attempt)f(to)h(extract)f(a)i(long)e(fr)n(om)i(an)g(Any)e
(containing)h(a)h(double\),)f(the)f(overloaded)g Ff(>>=)63
1243 y Fs(operator)k(will)j(r)n(eturn)e(False;)h(otherwise)e(it)i(will)
h(r)n(eturn)e(T)-8 b(r)o(ue.)33 b(Thus,)24 b(a)h(common)g(tactic)h(to)
63 1356 y(extract)c(values)h(fr)n(om)g(an)g(Any)f(is)h(as)f(follows:)
204 1507 y Fd(//)49 b(C++)204 1607 y Fe(CORBA)o(::)o(Long)h(l)o(;)204
1707 y(CORBA)o(::)o(Double)f(d;)204 1806 y(const)g(char)o(*)h(str)o(;)
249 b Fd(//)49 b(From)g(CORBA)g(2.3)h(onwards)n(,)g(uses)f(const)g
(char)o(*)1250 1906 y(//)g(instead)g(of)g(char*.)204
2105 y Fe(if)g(\(an_any)g(>>=)g(l\))g({)403 2205 y(cout)g(<<)h(")o
(Long:)f(")h(<<)f(l)h(<<)f(endl;)204 2304 y(})204 2404
y(else)g(if)g(\(an_any)g(>>=)g(d\))h({)403 2504 y(cout)f(<<)h(")o
(Double)o(:)g(")g(<<)f(d)h(<<)f(endl)o(;)204 2603 y(})204
2703 y(else)g(if)g(\(an_any)g(>>=)g(str\))g({)403 2803
y(cout)g(<<)h(")o(String)o(:)g(")g(<<)f(str)g(<<)h(endl)o(;)403
2902 y Fd(//)f(Since)g(2.8.0)g(the)h(storage)e(of)h(the)h(extracted)e
(string)h(is)g(still)403 3002 y(//)g(owned)g(by)h(the)f(any.)403
3101 y(//)g(In)h(pre)o(-omniORB)f(2.8.0)g(releases)n(,)h(the)f(string)g
(returned)f(is)h(a)h(copy)o(.)204 3201 y Fe(})204 3301
y(else)f({)403 3400 y(cout)g(<<)h(")o(Unknown)f(value)o(.")g(<<)h(endl)
o(;)204 3500 y(})63 3814 y Fk(9.1.3)99 b(Inserting)24
b(and)h(Extracting)g(Constructed)g(T)-9 b(ypes)26 b(from)e(an)h(Any)63
3993 y Fs(It)38 b(is)g(also)h(possible)e(to)h(insert)g(and)g(extract)h
(constr)o(ucted)d(types)h(and)h(object)h(r)n(efer)n(ences)63
4106 y(fr)n(om)23 b(an)h(Any)-10 b(.)28 b(omniidl)23
b(will)i(generate)c(insertion)h(and)h(extraction)f(operators)f(for)i
(the)f(con-)63 4219 y(str)o(ucted)33 b(type.)63 b(Note)34
b(that)g(it)h(is)h(necessary)d(to)h(specify)h(the)f Ff(-WBa)f
Fs(command-line)j(\003ag)63 4332 y(when)25 b(r)o(unning)g(omniidl)i(in)
f(or)n(der)f(to)g(generate)f(these)g(operators.)36 b(The)25
b(following)h(exam-)63 4445 y(ple)c(illustrates)g(the)g(use)g(of)g
(constr)o(ucted)f(types)g(with)h(type)f(Any:)204 4597
y Fd(//)49 b(IDL)204 4696 y Fe(struct)f(testStruct)g({)303
4796 y(long)h(l;)303 4896 y(short)g(s;)204 4995 y(};)204
5194 y(interface)f(anyExample)g({)303 5294 y(any)i(testOp)o(\()o(in)g
(any)f(mesg)o(\);)204 5394 y(};)p eop
%%Page: 90 98
90 97 bop 221 282 a Fs(90)1412 b Fg(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)362 539 y Fs(Upon)34
b(compiling)j(the)d(above)h(IDL)g(with)g Ff(omniidl)52
b(-bcxx)g(-Wba)p Fs(,)36 b(the)f(following)221 652 y(overloaded)22
b(operators)e(ar)n(e)j(generated:)335 843 y(1.)45 b Ff(void)53
b(operator<<=\(COR)o(BA)o(::A)o(ny)o(&,)48 b(const)k(testStruct&\))335
1024 y Fs(2.)45 b Ff(void)53 b(operator<<=\(COR)o(BA)o(::A)o(ny)o(&,)48
b(testStruct*\))335 1205 y Fs(3.)d Ff(CORBA::Boolean)k(operator>>=\(co)
o(ns)o(t)f(CORBA::Any&,)448 1318 y(const)53 b(testStruct*&\))362
1509 y Fs(Operators)31 b(of)h(this)f(form)h(ar)n(e)g(generated)e(for)h
(all)j(constr)o(ucted)c(types,)h(and)h(for)g(inter)n(-)221
1622 y(faces.)362 1735 y(The)26 b(\002rst)g(operator)-7
b(,)26 b Fr(\(1\))p Fs(,)i(copies)e(the)g(constr)o(ucted)f(type,)h(and)
g(inserts)f(it)i(into)f(the)g(Any)-10 b(.)221 1848 y(The)23
b(second)g(operator)-7 b(,)23 b Fr(\(2\))p Fs(,)i(inserts)d(the)h
(constr)o(ucted)g(type)f(into)i(the)f(Any)-10 b(,)23
b(and)h(then)f(man-)221 1961 y(ages)d(it.)27 b(Note)19
b(that)h(if)h(the)e(second)g(operator)g(is)h(used,)f(the)h(Any)f
(consumes)g(the)h(constr)o(ucted)221 2074 y(type,)31
b(and)g(the)e(caller)j(should)e(not)g(use)f(the)h(pointer)g(to)g
(access)g(the)g(data)h(after)f(insertion.)221 2187 y(The)d(following)h
(is)f(an)h(example)g(of)f(how)g(to)g(insert)g(a)h(value)g(into)f(an)h
(Any)f(using)g(operator)221 2300 y Fr(\(1\))p Fs(:)362
2442 y Fd(//)50 b(C++)362 2542 y Fe(CORBA)o(::Any)f(an_any)o(;)362
2741 y(testStruct)f(t;)362 2841 y(t.l)i(=)f(456;)362
2940 y(t.s)h(=)f(8;)362 3140 y(an_any)g(<<=)g(t;)362
3295 y Fs(The)31 b(thir)n(d)h(operator)-7 b(,)32 b Fr(\(3\))p
Fs(,)j(is)d(used)e(to)h(extract)g(the)g(constr)o(ucted)f(type)g(fr)n
(om)i(the)f(Any)-10 b(,)221 3408 y(and)23 b(can)g(be)g(used)e(as)i
(follows:)362 3551 y Fe(const)49 b(testStruct)n(*)h(tp;)149
b Fd(//)49 b(From)g(CORBA)g(2.3)g(onwards)o(,)h(use)1558
3651 y(//)f(const)g(testStruct)n(*)h(instead)e(of)i(testStruct)n(*)362
3850 y Fe(if)g(\(an_any)e(>>=)h(tp\))h({)562 3949 y(cout)f(<<)g
("testStruct)n(:)h(l)o(:)g(")g(<<)f(tp->)o(l)h(<<)f(endl;)562
4049 y(cout)g(<<)g(")598 b(s)o(:)50 b(")g(<<)f(tp->)o(s)h(<<)f(endl;)
362 4149 y(})362 4248 y(else)g({)562 4348 y(cout)g(<<)g("Unknown)f
(value)h(contained)f(in)i(Any)o(.")g(<<)f(endl)o(;)362
4448 y(})362 4603 y Fs(As)28 b(with)g(basic)i(types,)d(if)i(an)g
(attempt)e(is)i(made)f(to)g(extract)f(a)i(type)e(fr)n(om)i(an)g(Any)e
(that)221 4716 y(does)e(not)h(contain)i(a)f(value)h(of)e(that)h(type,)f
(the)g(extraction)g(operator)g(r)n(eturns)f(False.)40
b(If)27 b(the)221 4829 y(Any)34 b(does)f(contain)i(that)f(type,)i(the)e
(extraction)g(operator)f(r)n(eturns)g(T)-8 b(r)o(ue.)63
b(If)34 b(the)g(extrac-)221 4942 y(tion)27 b(is)g(successful,)g(the)f
(caller)7 b('s)28 b(pointer)e(will)i(point)f(to)f(memory)g(managed)h
(by)g(the)f(Any)-10 b(.)221 5055 y(The)31 b(caller)h(must)f(not)f
(delete)g(or)h(otherwise)e(change)i(this)g(storage,)g(and)g(should)g
(not)f(use)221 5168 y(this)h(storage)e(after)i(the)f(contents)f(of)i
(the)f(Any)g(ar)n(e)h(r)n(eplaced)g(\(either)f(by)h(insertion)f(or)h
(as-)221 5281 y(signment\),)25 b(or)g(after)g(the)f(Any)g(has)i(been)e
(destr)n(oyed.)32 b(In)25 b(particular)-7 b(,)27 b(management)e(of)g
(the)221 5394 y(pointer)d(should)f(not)h(be)h(assigned)e(to)h(a)h
Ff(_var)e Fs(type.)p eop
%%Page: 91 99
91 98 bop 63 282 a Fg(9.2.)51 b(TYPE)21 b(ANY)h(IN)g(OMNIORB)1951
b Fs(91)204 539 y(If)22 b(the)g(extraction)g(fails,)i(the)e(caller)7
b('s)23 b(pointer)f(will)i(be)e(set)g(to)g(point)g(to)g(null.)204
653 y(Note)k(that)h(ther)n(e)f(ar)n(e)i(special)g(r)o(ules)f(for)h
(inserting)e(and)i(extracting)f(arrays)g(\(using)g(the)63
765 y Ff(_forany)14 b Fs(types\),)j(and)h(for)g(inserting)f(and)h
(extracting)f(bounded)f(strings,)h(booleans,)i(chars,)63
878 y(and)27 b(octets.)40 b(Please)27 b(r)n(efer)g(to)g(the)f(C++)i
(Mapping)f(chapter)g(of)g(the)g(CORBA)g(2.3)h(speci\002ca-)63
991 y(tion)22 b([OMG99)r(])h(for)g(further)e(information.)p
63 1090 3289 17 v 1529 1194 a Fn(W)-7 b(arning)199 1344
y Fs(In)30 b(pr)n(e-omniORB)g(2.8.0)i(r)n(eleases,)f(it)g(was)f
(unclear)h(in)g(the)f(CORBA)g(speci\002cation)199 1457
y(whether)23 b(or)h(not)f(object)h(r)n(efer)n(ences)f(should)h(be)g
(managed)g(by)g(an)h(Any)-10 b(.)32 b(The)24 b(omni-)199
1570 y(ORB)33 b(implementation)f(leaves)h(management)g(of)f(an)i
(extracted)d(object)i(r)n(efer)n(ence)199 1683 y(to)g(the)g(caller)-7
b(.)64 b(Ther)n(efor)n(e,)35 b(the)e(pr)n(ogrammer)g(should)g(r)n
(elease)h(object)f(r)n(efer)n(ences)199 1796 y(and)c(T)-8
b(ypeCodes)27 b(that)i(have)h(been)e(extracted)g(fr)n(om)i(an)g(Any)-10
b(.)47 b(The)29 b(same)g(also)h(ap-)199 1909 y(plies)h(to)g(string)f
(extraction.)53 b(CORBA)32 b(2.3)g(has)f(clari\002ed)h(this)f(issue)f
(and)i(decr)n(eed)199 2022 y(that)j(the)g(management)h(of)f(an)h
(extracted)f(object)g(r)n(efer)n(ence)g(still)h(belongs)f(to)g(the)199
2135 y(Any!)60 b(Since)33 b(2.8.0,)k(the)32 b(omniORB)i(implementation)
f(conforms)g(to)g(the)f(CORBA)199 2248 y(2.3)d(speci\002cation.)46
b(For)27 b(backwar)n(d)j(compatibility)-10 b(,)31 b(the)c(r)o(untime)i
(variable)h Ff(omni-)199 2361 y(ORB::omniORB_27)o(_C)o(om)o(pa)o(tib)o
(le)o(An)o(yE)o(xt)o(rac)o(ti)o(on)24 b Fs(can)32 b(be)f(set)e(to)i(1)g
(to)f(get)199 2474 y(back)k(the)e(old)g(behaviour)-7
b(.)60 b(Notice)32 b(that)g(this)h(should)f(be)h(used)e(as)i(a)h
(transitional)199 2586 y(measur)n(e)23 b(and)g(in)g(the)f(long)h(r)o
(un,)g(applications)g(should)f(be)h(written)f(to)h(use)f(the)g(new)199
2699 y(behaviour)-7 b(.)p 63 2784 V 63 3088 a Fq(9.2)119
b(T)-11 b(ype)30 b(Any)g(in)g(omniORB)63 3301 y Fs(This)d(section)g
(contains)h(some)f(notes)f(on)i(the)f(use)f(and)i(behaviour)g(of)g
(type)f(Any)g(in)h(omni-)63 3414 y(ORB.)63 3671 y Fn(Generating)c
(Insertion)g(and)e(Extraction)j(Operators.)92 b Fs(T)-8
b(o)22 b(generate)f(type)h(Any)g(insertion)63 3784 y(and)h(extraction)g
(operators)f(for)h(constr)o(ucted)f(types)g(and)h(interfaces,)g(the)g
Ff(-Wba)f Fs(command)63 3897 y(line)h(\003ag)g(should)e(be)i
(speci\002ed)e(when)h(r)o(unning)h(omniidl.)63 4155 y
Fn(T)-8 b(ypeCode)19 b(comparison)j(when)e(extracting)k(from)e(an)f
(Any)-8 b(.)89 b Fs(When)21 b(an)h(attempt)e(is)i(made)63
4268 y(to)j(extract)g(a)h(type)e(fr)n(om)i(an)g(Any)-10
b(,)25 b(the)f(T)-8 b(ypeCode)23 b(of)j(the)e(type)g(is)i(checked)e
(for)i Fr(equivalence)63 4381 y Fs(with)f(the)f(T)-8
b(ypeCode)23 b(of)i(the)g(type)e(stor)n(ed)h(by)h(the)g(Any)-10
b(.)34 b(The)25 b Ff(equivalent\(\))20 b Fs(test)k(in)h(the)63
4494 y(T)-8 b(ypeCode)20 b(interface)j(is)f(used)g(for)g(this)g
(purpose)1811 4461 y Fl(1)1846 4494 y Fs(.)204 4607 y(Examples:)204
4759 y Fd(//)49 b(IDL)g(1)204 4859 y Fe(typedef)f(double)h(Double1)o(;)
204 5058 y(struct)f(Test1)h({)p 63 5123 1316 4 v 168
5179 a Fj(1)197 5211 y Fi(In)29 b(pr)o(e-omniORB)d(2.8.0)i(r)o
(eleases,)g(omniORB)f(performs)f(an)j(equality)f(test)g(and)g(will)g
(ignor)o(e)e(any)j(alias)63 5302 y(T)-7 b(ypeCodes)24
b(\()p Fh(tk_alias)p Fi(\))g(when)j(making)f(this)g(comparison.)44
b(The)26 b(semantics)g(is)f(similar)g(to)h(the)h Fh(equiva-)63
5394 y(lent\(\))17 b Fi(test)i(in)g(the)g(T)-7 b(ypeCode)18
b(interface)g(of)h(CORBA)f(2.3.)p eop
%%Page: 92 100
92 99 bop 221 282 a Fs(92)1412 b Fg(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)462 539 y Fe(Double1)48
b(a;)362 638 y(};)362 824 y Fd(//)i(IDL)f(2)362 923 y
Fe(typedef)g(double)f(Double2)o(;)362 1123 y(struct)h(Test1)g({)462
1222 y(Double2)f(a;)362 1322 y(};)362 1478 y Fs(If)25
b(an)h(attempt)e(is)h(made)g(to)g(extract)f(the)h(type)e
Ff(Test1)g Fs(de\002ned)h(in)h(IDL)g(1)h(fr)n(om)f(an)h(Any)221
1591 y(containing)j(the)f Ff(Test1)f Fs(de\002ned)g(in)i(IDL)g(2,)h
(this)f(will)h(succeed)e(\(and)h(vice-versa\),)i(as)e(the)221
1704 y(two)22 b(types)f(dif)n(fer)i(only)f(by)h(an)g(alias.)221
1952 y Fn(T)-10 b(op-level)28 b(aliases.)93 b Fs(When)28
b(a)g(type)f(is)h(inserted)e(into)i(an)g(Any)-10 b(,)29
b(the)e(Any)g(stor)n(es)f(both)i(the)221 2064 y(value)20
b(of)f(the)g(type)e(and)j(the)e(T)-8 b(ypeCode)17 b(for)i(that)g(type.)
25 b(The)18 b(tr)n(eatment)g(of)i(top-level)e(aliases)221
2177 y(fr)n(om)23 b(omniORB)g(2.8.0)h(onwar)n(ds)e(is)g(dif)n(fer)n
(ent)h(fr)n(om)g(pr)n(e-omniORB)f(2.8.0)i(r)n(eleases.)362
2290 y(In)d(pr)n(e-omniORB)g(2.8.0)h(r)n(eleases,)e(if)i(ther)n(e)f(ar)
n(e)g(any)g(top-level)g Ff(tk_alias)d Fs(T)-8 b(ypeCodes)221
2403 y(in)21 b(the)f(T)-8 b(ypeCode,)18 b(they)h(will)j(be)e(r)n
(emoved)g(fr)n(om)h(the)f(T)-8 b(ypeCode)18 b(stor)n(ed)h(in)i(the)e
(Any)-10 b(.)27 b(Note)221 2516 y(that)i(this)f(does)g(not)g(af)n(fect)
i(the)e Ff(_tc_)f Fs(T)-8 b(ypeCode)27 b(generated)f(to)j(r)n(epr)n
(esent)e(the)h(type)f(\(see)221 2629 y(section)c(on)g(T)-8
b(ypeCode,)21 b(below\).)30 b(This)23 b(behaviour)h(is)f(necessary)-10
b(,)22 b(as)h(two)g(types)e(that)j(dif)n(fer)221 2742
y(only)e(by)f(a)i(top-level)e(alias)i(can)g(use)e(the)g(same)g
(insertion)g(and)h(extraction)g(operators.)j(If)d(the)221
2855 y Ff(tk_alias)c Fs(is)k(not)e(r)n(emoved,)h(one)g(of)g(the)g
(types)f(could)h(be)g(transmitted)f(with)i(an)g(incorr)n(ect)221
2968 y Ff(tk_alias)d Fs(T)-8 b(ypeCode.)26 b(Example:)362
3110 y Fd(//)50 b(IDL)f(3)362 3210 y Fe(typedef)g(sequence)n(<double)o
(>)h(seqDouble1)n(;)362 3310 y(typedef)f(sequence)n(<double)o(>)h
(seqDouble2)n(;)362 3409 y(typedef)f(seqDouble2)347 b(seqDouble3)n(;)
362 3565 y Fs(If)28 b(either)f Ff(seqDouble1)c Fs(or)28
b Ff(seqDouble2)23 b Fs(is)28 b(inserted)e(into)h(an)i(Any)-10
b(,)28 b(the)e(T)-8 b(ypeCode)221 3678 y(stor)n(ed)34
b(in)j(the)e(Any)g(will)j(be)e(for)g(a)g Ff(sequence<double)o(>)p
Fs(,)d(and)j(not)f(for)h(an)h(alias)g(to)e(a)221 3791
y Ff(sequence<double)o(>)p Fs(.)362 3904 y(Fr)n(om)27
b(omniORB)g(2.8.0)g(onwar)n(ds,)g(ther)n(e)f(ar)n(e)h(two)f(changes.)39
b(Firstly)-10 b(,)26 b(in)i(the)d(example,)221 4017 y
Ff(seqDouble1)e Fs(and)j Ff(seqDouble2)d Fs(ar)n(e)k(now)f(distinct)h
(types)e(and)i(ther)n(efor)n(e)e(each)i(has)g(its)221
4130 y(own)c(set)f(of)h(C++)g(operators)e(for)i(Any)g(insertion)f(and)h
(extraction.)29 b(Secondly)-10 b(,)21 b(the)i(top)f(level)221
4242 y(aliases)35 b(ar)n(e)h(not)e(r)n(emoved.)63 b(For)34
b(example,)k(if)d Ff(seqDouble3)c Fs(is)j(inserted)f(into)i(an)g(Any)
-10 b(,)221 4355 y(the)23 b(insertion)f(operator)g(for)i
Ff(seqDouble2)19 b Fs(is)k(invoked)g(\(because)g Ff(seqDouble3)c
Fs(is)24 b(just)e(a)221 4468 y(C++)i(typedef)d(of)j Ff(seqDouble2)p
Fs(\).)i(Ther)n(efor)n(e,)c(the)g(T)-8 b(ypeCode)21 b(in)j(the)f(Any)f
(would)h(be)g(that)221 4581 y(of)d(seqDouble2.)26 b(If)20
b(this)f(is)h(not)f(desirable,)h(one)e(can)j(use)d(the)h(new)g(member)h
(function)f(`)p Ff(void)221 4694 y(type\(TypeCode_p)o(tr)o(\))p
Fs(')e(of)23 b(the)e(Any)h(interface)h(to)f(explicitly)h(set)f(the)g(T)
-8 b(ypeCode)20 b(to)i(the)221 4807 y(corr)n(ect)h(one.)221
5055 y Fn(Removing)h(aliases)k(from)d(T)-8 b(ypeCodes.)89
b Fs(Some)25 b(ORBs)g(\(such)g(as)g(Orbix\))i(will)f(not)f(accept)221
5168 y(T)-8 b(ypeCodes)23 b(containing)k Ff(tk_alias)22
b Fs(T)-8 b(ypeCodes.)36 b(When)25 b(using)h(type)e(Any)h(while)i
(inter)n(-)221 5281 y(operating)e(with)h(these)e(ORBs,)i(it)g(is)g
(necessary)e(to)h(r)n(emove)h Ff(tk_alias)c Fs(T)-8 b(ypeCodes)23
b(fr)n(om)221 5394 y(thr)n(oughout)e(the)h(T)-8 b(ypeCode)20
b(r)n(epr)n(esenting)g(a)j(constr)o(ucted)e(type.)p eop
%%Page: 93 101
93 100 bop 63 282 a Fg(9.3.)51 b(TYPECODE)22 b(IN)g(OMNIORB)1919
b Fs(93)204 539 y(T)-8 b(o)26 b(r)n(emove)i(all)h Ff(tk_alias)24
b Fs(T)-8 b(ypeCodes)24 b(fr)n(om)k(T)-8 b(ypeCodes)25
b(stor)n(ed)h(in)i(Anys,)f(supply)63 652 y(the)g Ff(-ORBtcAliasExp)o
(an)o(d)49 b(1)27 b Fs(command-line)i(\003ag)f(when)g(r)o(unning)f(an)i
(omniORB)f(ex-)63 764 y(ecutable.)46 b(Ther)n(e)28 b(will)i(be)e(some)g
(\(small\))i(performance)f(penalty)f(when)g(inserting)f(values)63
877 y(into)22 b(an)h(Any)-10 b(.)204 998 y(Note)32 b(that)h(the)g
Ff(_tc_)e Fs(T)-8 b(ypeCodes)31 b(generated)g(for)i(all)i(constr)o
(ucted)d(types)g(will)i(con-)63 1111 y(tain)d(the)f(complete)g(T)-8
b(ypeCode)28 b(for)i(the)g(type)f(\(including)j(any)e
Ff(tk_alias)d Fs(T)-8 b(ypeCodes\),)63 1224 y(r)n(egar)n(dless)21
b(of)i(whether)e(the)h Ff(-ORBtcAliasExp)o(an)o(d)17
b Fs(\003ag)23 b(is)f(set)g(to)g(1)h(or)f(not.)63 1522
y Fn(Recursive)41 b(T)-8 b(ypeCodes.)89 b Fs(omniORB)40
b(\(as)g(of)g(version)f(2.7\))i(supports)c(r)n(ecursive)j(T)-8
b(ype-)63 1635 y(Codes.)47 b(This)30 b(means)f(that)g(types)f(such)h
(as)h(the)f(following)h(can)g(be)g(inserted)e(or)h(extracted)63
1748 y(fr)n(om)23 b(an)g(Any:)204 1913 y Fd(//)49 b(IDL)g(4)204
2013 y Fe(struct)f(Test4)h({)303 2112 y(sequence)o(<Test4)o(>)g(a;)204
2212 y(};)63 2576 y Fn(T)-8 b(ype-unsafe)23 b(construction)h(and)f
(insertion.)91 b Fs(If)23 b(using)g(the)f(type-unsafe)g(Any)h(constr)o
(uc-)63 2689 y(tor)-7 b(,)39 b(or)c(the)h Ff(CORBA::Any::rep)o(la)o(ce)
o(\(\))30 b Fs(member)36 b(function,)j(ensur)n(e)c(that)h(the)g(value)
63 2802 y(r)n(eturned)21 b(by)i(the)f Ff(CORBA::Any::va)o(lu)o(e\(\))16
b Fs(member)23 b(function)g(and)g(the)f(T)-8 b(ypeCode)20
b(r)n(e-)63 2915 y(turned)32 b(by)i(the)f Ff(CORBA::Any::typ)o(e\(\))27
b Fs(member)34 b(function)g(ar)n(e)h(used)d(as)i(ar)n(guments)63
3027 y(to)29 b(the)g(constr)o(uctor)f(or)i(function.)49
b(Using)29 b(other)g(values)h(or)f(T)-8 b(ypeCodes)27
b(may)k(r)n(esult)e(in)h(a)63 3140 y(mismatch,)23 b(and)g(is)f
(unde\002ned)f(behaviour)-7 b(.)204 3261 y(Note)21 b(that)h(a)h
(non-CORBA)g(2)g(function,)204 3426 y Fe(CORBA)o(::)o(ULong)49
b(CORBA)o(::Any::)o(NP_length)n(\(\))h(const)204 3612
y Fs(is)25 b(supplied.)33 b(This)25 b(member)g(function)g(r)n(eturns)f
(the)g(length)g(of)h(the)f(value)h(r)n(eturned)f(by)63
3725 y(the)31 b Ff(CORBA::Any::val)o(ue)o(\(\))26 b Fs(member)32
b(function.)57 b(It)32 b(may)h(be)f(necessary)f(to)h(use)f(this)63
3837 y(function)22 b(if)i(the)e(Any's)f(value)j(is)e(to)g(be)h(stor)n
(ed)e(in)i(a)g(\002le.)63 4136 y Fn(Threads)30 b(and)f(type)g(Any)-8
b(.)90 b Fs(Inserting)27 b(and)j(extracting)f(simultaneously)g(fr)n(om)
h(the)f(same)63 4249 y(Any)22 b(\(in)h(2)g(dif)n(fer)n(ent)g(thr)n
(eads\))f(is)g(unde\002ned)f(behaviour)-7 b(.)204 4370
y(Extracting)26 b(simultaneously)f(fr)n(om)i(the)e(same)i(Any)e(\(in)i
(2)g(or)f(mor)n(e)g(dif)n(fer)n(ent)g(thr)n(eads\))63
4483 y(also)j(leads)h(to)f(unde\002ned)e(behaviour)-7
b(.)50 b(It)29 b(was)g(decided)f(not)h(to)g(pr)n(otect)g(the)g(Any)f
(with)i(a)63 4595 y(mutex,)i(as)g(this)f(condition)g(should)g(rar)n
(ely)h(arise,)h(and)f(adding)f(a)h(mutex)f(would)g(lead)g(to)63
4708 y(performance)22 b(penalties.)63 5054 y Fq(9.3)119
b(T)-11 b(ypeCode)30 b(in)g(omniORB)63 5281 y Fs(This)25
b(section)g(contains)g(some)g(notes)f(on)h(the)g(use)g(and)g(behaviour)
h(of)g(T)-8 b(ypeCode)23 b(in)j(omni-)63 5394 y(ORB)p
eop
%%Page: 94 102
94 101 bop 221 282 a Fs(94)1412 b Fg(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)221 539 y Fn(T)-8 b(ypeCodes)21
b(in)i(IDL.)90 b Fs(When)22 b(using)g(T)-8 b(ypeCodes)20
b(in)j(IDL,)f(note)f(that)i(they)e(ar)n(e)i(de\002ned)e(in)221
652 y(the)h(CORBA)h(scope.)j(Ther)n(efor)n(e,)21 b Ff(CORBA::TypeCode)
16 b Fs(should)22 b(be)g(used.)27 b(Example:)362 795
y Fd(//)50 b(IDL)f(5)362 895 y Fe(struct)g(Test5)g({)462
995 y(long)g(length)o(;)462 1094 y(CORBA)o(::TypeCode)f(desc)o(;)362
1194 y(};)221 1487 y Fn(orb.idl)90 b Fs(Inclusion)36
b(of)f(the)g(\002le)g Ff(orb.idl)d Fs(in)k(IDL)f(using)g
Ff(CORBA::TypeCode)29 b Fs(is)35 b(op-)221 1600 y(tional.)29
b(An)22 b(empty)f Ff(orb.idl)f Fs(\002le)j(is)f(pr)n(ovided)g(for)h
(compatibility)h(purposes.)221 1848 y Fn(Generating)j(T)-8
b(ypeCodes)25 b(for)h(constructed)h(types.)90 b Fs(T)-8
b(o)26 b(generate)e(a)i(T)-8 b(ypeCode)24 b(for)i(con-)221
1961 y(str)o(ucted)g(types,)h(specify)g(the)f Ff(-Wba)g
Fs(command-line)j(\003ag)f(when)f(r)o(unning)g(omniidl.)43
b(This)221 2074 y(will)26 b(generate)c(a)j Ff(_tc_)e
Fs(T)-8 b(ypeCode)22 b(describing)i(the)g(type,)f(at)h(the)g(same)g
(scope)f(as)i(the)f(type)221 2187 y(\(as)f(per)f(the)g(CORBA)g(2.3)i
(speci\002cation\).)k(Example:)362 2331 y Fd(//)50 b(IDL)f(6)362
2431 y Fe(struct)g(Test6)g({)462 2530 y(double)g(a)o(;)462
2630 y(sequence)n(<long)o(>)h(b;)362 2730 y(};)362 2887
y Fs(A)24 b(T)-8 b(ypeCode,)20 b Ff(_tc_Test6)p Fs(,)g(will)k(be)g
(generated)d(to)i(describe)f(the)h(str)o(uct)g Ff(Test6)p
Fs(.)28 b(The)221 3000 y(operations)g(de\002ned)g(in)i(the)e(T)-8
b(ypeCode)27 b(interface)j(\(see)e(section)h(10.7)i(of)e(the)g(CORBA)g
(2.3)221 3113 y(speci\002cation)e([OMG99)r(]\))g(can)h(be)f(used)e(to)h
(query)f(the)h(T)-8 b(ypeCode)25 b(about)h(the)g(type)f(it)i(r)n(ep-)
221 3226 y(r)n(esents.)221 3474 y Fn(T)-8 b(ypeCode)25
b(equality)-8 b(.)91 b Fs(The)26 b(behaviour)h(of)f Ff(CORBA::TypeCode)
o(::e)o(qu)o(al)o(\(\))20 b Fs(member)221 3587 y(function)37
b(fr)n(om)h(omniORB)f(2.8.0)h(onwar)n(ds)f(is)g(dif)n(fer)n(ent)g(fr)n
(om)h(pr)n(e-omniORB)f(2.8.0)h(r)n(e-)221 3700 y(leases.)54
b(In)31 b(summary)-10 b(,)34 b(the)c(pr)n(e-omniORB)i(2.8.0)g(is)g
(close)f(to)g(the)g(semantics)g(of)h(the)f(new)221 3813
y Ff(CORBA::TypeCode)o(::)o(equ)o(iv)o(al)o(en)o(t\()o(\))17
b Fs(member)22 b(function.)28 b(Details)23 b(ar)n(e)g(as)g(follows:)362
3926 y(The)f Ff(CORBA::TypeCode)o(::)o(eq)o(ual)o(\(\))o(\(\))16
b Fs(member)22 b(function)h(will)h(now)e(r)n(eturn)g(tr)o(ue)221
4039 y(only)17 b(if)i(the)e(two)f(T)-8 b(ypeCodes)15
b(ar)n(e)j Fr(exactly)i Fs(the)d(same.)26 b Ff(tk_alias)14
b Fs(T)-8 b(ypeCodes)14 b(ar)n(e)k(included)221 4152
y(in)29 b(this)f(comparison,)h(unlike)f(the)f(comparison)h(made)g(when)
g(values)g(ar)n(e)h(extracted)d(fr)n(om)221 4265 y(an)d(Any)f(\(see)g
(section)g(on)g(Any)-10 b(,)21 b(above\).)362 4378 y(In)31
b(pr)n(e-omniORB)h(2.8.0)g(r)n(eleases,)g(equality)f(test)f(would)h
(ignor)n(e)g(the)g(optional)g(\002elds)221 4490 y(when)d(one)g(of)h
(the)f(\002elds)g(in)h(the)f(two)g(typecodes)e(is)j(empty)-10
b(.)45 b(For)28 b(example,)i(if)f(one)f(of)h(the)221
4603 y(T)-8 b(ypeCodes)25 b(being)j(checked)f(is)h(a)h
Ff(tk_struct)p Fs(,)c Ff(tk_union)p Fs(,)h Ff(tk_enum)p
Fs(,)g(or)i Ff(tk_alias)p Fs(,)221 4716 y(and)e(has)f(an)h(empty)f(r)n
(epository)e(ID)j(parameter)-7 b(,)25 b(then)g(the)g(r)n(epository)e
(ID)j(parameter)f(will)221 4829 y(be)20 b(ignor)n(ed)f(when)g(checking)
h(for)f(equality)-10 b(.)27 b(Similarly)-10 b(,)22 b(if)f(the)e
Ff(name)f Fs(or)i Ff(member_name)15 b Fs(pa-)221 4942
y(rameters)21 b(of)h(a)g(T)-8 b(ypeCode)19 b(ar)n(e)j(empty)f(strings,)
f(they)g(will)j(be)f(ignor)n(ed)f(for)g(equality)h(check-)221
5055 y(ing)34 b(purposes.)60 b(This)34 b(is)h(because)e(a)i(CORBA)f(2)h
(ORB)f(does)f(not)g(have)i(to)e(include)i(these)221 5168
y(parameters)20 b(in)g(a)h(T)-8 b(ypeCode)18 b(\(see)h(the)h(Inter)n
(operability)f(section)h(of)g(the)g(CORBA)g(2)h(speci\002-)221
5281 y(cation)e([OMG96)r(]\).)27 b(Note)17 b(that)i(these)d
(\(optional\))j(parameters)f(ar)n(e)h(included)f(in)h(T)-8
b(ypeCodes)221 5394 y(generated)21 b(by)h(omniORB.)p
eop
%%Page: 95 103
95 102 bop 63 282 a Fg(9.3.)51 b(TYPECODE)22 b(IN)g(OMNIORB)1919
b Fs(95)204 539 y(Since)35 b(CORBA)h(2.3,)i(the)d(issue)f(of)i(T)-8
b(ypeCode)32 b(equality)k(has)f(been)g(clari\002ed.)66
b(Ther)n(e)63 652 y(is)23 b(now)f(a)h(new)g(member)f
Ff(CORBA::TypeCode)o(::e)o(qu)o(iv)o(al)o(en)o(t\(\))16
b Fs(which)23 b(pr)n(ovides)f(the)63 764 y(semantics)f(of)g(the)g
Ff(CORBA::TypeCode)o(::)o(equ)o(al)o(\(\))15 b Fs(as)21
b(implemented)g(in)h(omniORB)f(r)n(e-)63 877 y(leases)j(prior)h(to)g
(2.8.0.)37 b(So)25 b(fr)n(om)h(omniORB)g(2.8.0)g(onwar)n(ds,)g(the)e
Ff(CORBA::TypeCode)o(::)63 990 y(equal\(\))k Fs(function)j(has)g(been)g
(changed)f(to)h(enfor)n(ce)f(strict)h(equality)-10 b(.)53
b(The)31 b(pr)n(e-2.8.0)g(be-)63 1103 y(haviour)23 b(can)g(be)g
(obtained)f(with)h Ff(equivalent\(\))p Fs(.)p eop
%%Page: 96 104
96 103 bop 221 282 a Fs(96)1412 b Fg(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)221 539 y Fq(9.4)119
b(Source)30 b(Listing)221 770 y Fk(9.4.1)99 b(anyExample_impl.cc)362
1010 y Fd(//)50 b(anyExample_impl)m(.cc)f(-)h(This)f(is)g(the)h(source)
e(code)h(of)h(the)f(example)g(used)g(in)362 1110 y(//)1096
b(Chapter)48 b(9)i("Type)f(Any)g(and)g(TypeCode)o(")g(of)h(the)f
(omniORB)362 1209 y(//)1096 b(users)49 b(guide)o(.)362
1309 y(//)362 1409 y(//)1096 b(This)49 b(is)g(the)h(object)e
(implementation)n(.)362 1508 y(//)362 1608 y(//)i(Usage)o(:)f
(anyExample_impl)362 1708 y(//)362 1807 y(//)398 b(On)50
b(startup)o(,)f(the)g(object)g(reference)f(is)i(printed)e(to)i(cerr)f
(as)g(a)362 1907 y(//)398 b(stringified)48 b(IOR.)h(This)g(string)g
(should)g(be)g(used)g(as)h(the)f(argument)f(to)362 2006
y(//)398 b(anyExample_clt)n(.)362 2106 y(//)362 2305
y Fe(#include)49 b(<)o(iostream)o(.h>)362 2405 y(#include)g(<)o
(anyExample)o(.)o(hh>)362 2604 y(class)g(anyExample_i)f(:)h(public)g
(POA_anyExample)e({)362 2704 y(public)o(:)462 2803 y(inline)i
(anyExample_i)m(\(\))h({})462 2903 y(virtual)e(~anyExample_i)n(\(\))h
({})462 3003 y(virtual)f(CORBA)o(::Any*)h(testOp)o(\(const)g(CORBA)o
(::)o(Any&)h(a)o(\);)362 3102 y(};)362 3302 y(CORBA)o(::Any)o(*)g
(anyExample_i)n(::)o(testOp)o(\(const)f(CORBA)o(::Any)o(&)h(a\))362
3401 y({)462 3501 y(cout)f(<<)g("Any)g(received)o(,)h(containing)n(:)f
(")h(<<)f(endl;)362 3700 y(#ifndef)g(NO_FLOAT)462 3800
y(CORBA)o(::Double)f(d;)362 3899 y(#endif)462 4099 y(CORBA)o(::Long)h
(l)o(;)462 4198 y(const)g(char)o(*)h(str)o(;)462 4397
y(testStruct)n(*)g(tp)o(;)462 4597 y(if)f(\(a)h(>>=)f(l\))g({)562
4696 y(cout)g(<<)g("Long)o(:)h(")f(<<)h(l)f(<<)h(endl)o(;)462
4796 y(})362 4896 y(#ifndef)f(NO_FLOAT)462 4995 y(else)g(if)g(\(a)h
(>>=)f(d\))h({)562 5095 y(cout)f(<<)g("Double)o(:)g(")h(<<)f(d)h(<<)g
(endl)o(;)462 5194 y(})362 5294 y(#endif)462 5394 y(else)f(if)g(\(a)h
(>>=)f(str\))g({)p eop
%%Page: 97 105
97 104 bop 63 282 a Fg(9.4.)51 b(SOURCE)22 b(LISTING)2251
b Fs(97)403 539 y Fe(cout)49 b(<<)h(")o(String)o(:)g(")g(<<)f(str)g(<<)
h(endl)o(;)303 638 y(})303 738 y(else)f(if)h(\(a)f(>>=)h(tp)o(\))g({)
403 837 y(cout)f(<<)h(")o(testStruct)o(:)f(l:)h(")f(<<)h(tp)o(->l)g(<<)
f(endl)o(;)403 937 y(cout)g(<<)h(")597 b(s:)50 b(")f(<<)h(tp)o(->s)g
(<<)f(endl)o(;)303 1037 y(})303 1136 y(else)g({)403 1236
y(cout)g(<<)h(")o(Unknown)f(value)o(.")g(<<)h(endl)o(;)303
1336 y(})303 1535 y(CORBA)o(::Any*)f(ap)h(=)f(new)h(CORBA)o(::)o(Any;)
303 1734 y(*ap)g(<<=)f(\(CORBA)o(::)o(ULong\))g(314;)303
1933 y(cout)g(<<)h("Returning)e(Any)h(containing)n(:)h(ULong)o(:)g
(314\\)o(n")f(<<)h(endl)o(;)303 2033 y(return)f(ap;)204
2133 y(})204 2332 y Fd(//////////////////////////////////)o(//////)o
(/////)o(/////)o(//////)o(/////)o(/////)o(////)204 2531
y Fe(int)g(main)o(\(int)g(argc,)g(char**)g(argv)o(\))204
2631 y({)303 2730 y(try)h({)403 2830 y(CORBA)o(::ORB_var)e(orb)i(=)f
(CORBA)o(::ORB_init)n(\(argc)o(,)h(argv)o(,)g("omniORB3)n("\);)403
3029 y(CORBA)o(::Object_var)e(obj)h(=)h(orb)o
(->resolve_initial_references)-5 b(\(")o(RootPOA)o("\);)403
3129 y(PortableServer)m(::POA_var)49 b(poa)g(=)g(PortableServer)n(::)o
(POA::_narrow)n(\(obj)o(\);)403 3328 y(anyExample_i)n(*)g(myobj)g(=)h
(new)f(anyExample_i)n(\(\);)403 3527 y(PortableServer)m(::ObjectId_var)
f(myobjid)g(=)i(poa)o(->activate_object)m(\(myobj)o(\);)403
3727 y(obj)f(=)h(myobj)o(->_this)o(\(\);)403 3826 y(CORBA)o
(::String_var)e(sior)o(\(orb)o(->object_to_string)m(\(obj)o(\)\);)403
3926 y(cerr)h(<<)h("'")f(<<)g(\(char)o(*\)sior)g(<<)g("'")h(<<)f(endl)o
(;)403 4125 y(myobj)o(->_remove_ref)n(\(\);)403 4324
y(PortableServer)m(::POAManager_var)e(pman)i(=)h(poa)o
(->the_POAManager)m(\(\);)403 4424 y(pman)o(->activate)n(\(\);)403
4623 y(orb)o(->run\(\);)403 4723 y(orb)o(->destroy)o(\(\);)303
4823 y(})303 4922 y(catch)o(\(CORBA)o(::SystemException)m(&\))g({)403
5022 y(cerr)f(<<)h(")o(Caught)f(CORBA)o(::SystemException)m(.")g(<<)h
(endl)o(;)303 5121 y(})303 5221 y(catch)o(\(CORBA)o(::Exception)n(&\))g
({)403 5321 y(cerr)f(<<)h(")o(Caught)f(CORBA)o(::Exception)n(.")h(<<)f
(endl)o(;)p eop
%%Page: 98 106
98 105 bop 221 282 a Fs(98)1412 b Fg(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)462 539 y Fe(})462 638
y(catch)o(\(omniORB)n(::fatalException)n(&)49 b(fe\))g({)562
738 y(cerr)g(<<)g("Caught)g(omniORB)n(::fatalException)m(:")h(<<)f
(endl)o(;)562 837 y(cerr)g(<<)g(")99 b(file:)49 b(")h(<<)f(fe.file)o
(\(\))h(<<)f(endl)o(;)562 937 y(cerr)g(<<)g(")99 b(line:)49
b(")h(<<)f(fe.line)o(\(\))h(<<)f(endl)o(;)562 1037 y(cerr)g(<<)g(")99
b(mesg:)49 b(")h(<<)f(fe.errmsg)o(\(\))g(<<)h(endl)o(;)462
1136 y(})462 1236 y(catch)o(\(...\))f({)562 1336 y(cerr)g(<<)g("Caught)
g(unknown)f(exception)n(.")i(<<)f(endl;)462 1435 y(})462
1535 y(return)g(0;)362 1634 y(})p eop
%%Page: 99 107
99 106 bop 63 282 a Fg(9.4.)51 b(SOURCE)22 b(LISTING)2251
b Fs(99)63 539 y Fk(9.4.2)99 b(anyExample_clt.cc)204
811 y Fd(//)49 b(anyExample_clt)n(.)o(cc)h(-)99 b(This)49
b(is)h(the)f(source)g(code)g(of)g(the)h(example)e(used)h(in)204
911 y(//)1095 b(Chapter)49 b(9)g("Type)g(Any)h(and)f(TypeCode)n(")h(of)
f(the)h(omniORB)204 1010 y(//)1095 b(users)49 b(guide)o(.)204
1110 y(//)204 1209 y(//)1095 b(This)49 b(is)h(the)f(client)o(.)204
1309 y(//)204 1409 y(//)g(Usage)o(:)h(anyExample_clt)d(<object)i
(reference)n(>)204 1508 y(//)204 1708 y Fe(#include)f(<iostream)n(.h>)
204 1807 y(#include)g(<anyExample)n(.hh>)204 2006 y(static)g(void)i
(invokeOp)n(\(anyExample_ptr)m(&)g(tobj)o(,)g(const)f(CORBA)o(::)o
(Any&)g(a\))204 2106 y({)303 2206 y(CORBA)o(::Any_var)g(bp)o(;)303
2405 y(cout)g(<<)h("Invoking)e(operation)n(.")i(<<)f(endl;)303
2505 y(bp)h(=)f(tobj->)o(testOp)o(\(a\);)303 2704 y(cout)g(<<)h
("Operation)e(completed)n(.)i(Returned)e(Any:)h(";)303
2803 y(CORBA)o(::ULong)g(ul;)303 3003 y(if)h(\(bp)f(>>=)g(ul\))h({)403
3102 y(cout)f(<<)h(")o(ULong)o(:)g(")g(<<)f(ul)h(<<)f("\\n)o(")h(<<)g
(endl)o(;)303 3202 y(})303 3302 y(else)f({)403 3401 y(cout)g(<<)h(")o
(Unknown)f(value)o(.")g(<<)h("\\)o(n")g(<<)f(endl;)303
3501 y(})204 3600 y(})204 3800 y(static)f(void)i(hello)o(\()o
(anyExample_ptr)e(tobj)o(\))204 3899 y({)303 3999 y(CORBA)o(::Any)h(a;)
303 4198 y Fd(//)h(Sending)e(Long)303 4298 y Fe(CORBA)o(::Long)h(l)h(=)
f(100;)303 4397 y(a)h(<<=)f(l;)303 4497 y(cout)g(<<)h("Sending)e(Any)i
(containing)d(Long:)i(")h(<<)f(l)h(<<)f(endl;)303 4597
y(invokeOp)o(\(tobj)o(,a\);)303 4796 y Fd(//)h(Sending)e(Double)204
4896 y Fe(#ifndef)g(NO_FLOAT)303 4995 y(CORBA)o(::Double)h(d)g(=)h
(1.2345;)303 5095 y(a)g(<<=)f(d;)303 5194 y(cout)g(<<)h("Sending)e(Any)
i(containing)d(Double)o(:)j(")g(<<)f(d)h(<<)f(endl)o(;)303
5294 y(invokeOp)o(\(tobj)o(,a\);)204 5394 y(#endif)p
eop
%%Page: 100 108
100 107 bop 221 282 a Fs(100)1367 b Fg(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)462 638 y Fd(//)49 b(Sending)g(String)
462 738 y Fe(const)g(char)o(*)h(str)f(=)h(")o(Hello)o(";)462
837 y(a)g(<<=)f(str)o(;)462 937 y(cout)g(<<)g("Sending)g(Any)g
(containing)f(String)o(:)h(")h(<<)g(str)f(<<)g(endl)o(;)462
1037 y(invokeOp)n(\(tobj)o(,a\);)462 1236 y Fd(//)g(Sending)g
(testStruct)98 b([)o(Struct)49 b(defined)g(in)g(IDL])462
1336 y Fe(testStruct)f(t;)462 1435 y(t.l)h(=)h(456;)462
1535 y(t.s)f(=)h(8;)462 1634 y(a)g(<<=)f(t;)462 1734
y(cout)g(<<)g("Sending)g(Any)g(containing)f(testStruct)n(:)i(l:)f(")h
(<<)f(t.l)g(<<)h(endl)o(;)462 1834 y(cout)f(<<)g(")1744
b(s:)49 b(")h(<<)f(t.s)g(<<)h(endl)o(;)462 1933 y(invokeOp)n(\(tobj)o
(,a\);)362 2033 y(})362 2232 y Fd
(/////////////////////////////////////)o(/////)o(//////)o(/////)o
(/////)o(//////)o(/////)o(/)362 2431 y Fe(int)g(main)o(\(int)f(argc)o
(,)h(char)o(**)f(argv\))362 2531 y({)462 2631 y(try)g({)562
2730 y(CORBA)o(::)o(ORB_var)g(orb)g(=)h(CORBA)o(::)o(ORB_init)o(\(argc)
o(,)g(argv)o(,)f("omniORB3)o("\);)562 2930 y(if)o(\()h(argc)f(!=)g(2)h
(\))g({)661 3029 y(cerr)f(<<)h(")o(usage:)99 b(anyExample_clt)47
b(<object)i(reference)n(>")g(<<)h(endl)o(;)661 3129 y(return)f(1;)562
3229 y(})562 3428 y(CORBA)o(::)o(Object_var)f(obj)h(=)h(orb->)o
(string_to_object)m(\(argv)o([1]\);)562 3527 y(anyExample_var)d(ref)i
(=)h(anyExample)n(::)o(_narrow)o(\(obj)o(\);)562 3627
y(if)o(\()g(CORBA)o(::)o(is_nil)o(\(ref\))f(\))h({)661
3727 y(cerr)f(<<)h(")o(Can't)f(narrow)g(reference)f(to)i(type)f
(anyExample)f(\()o(or)i(it)f(was)h(nil)o(\).")910 3826
y(<<)g(endl)o(;)661 3926 y(return)f(1;)562 4026 y(})562
4125 y(hello)o(\()o(ref\);)562 4324 y(orb)o(->destroy)n(\(\);)462
4424 y(})462 4524 y(catch)o(\(CORBA)o(::)o(COMM_FAILURE)n(&)h(ex\))f({)
562 4623 y(cerr)g(<<)g("Caught)g(system)f(exception)g(COMM_FAILURE)g
(--)h(unable)g(to)h(contact)e(the)h(")811 4723 y(<<)g("object)o(.")g
(<<)h(endl)o(;)462 4823 y(})462 4922 y(catch)o(\(CORBA)o(::)o
(SystemException)n(&\))f({)562 5022 y(cerr)g(<<)g("Caught)g(a)g(CORBA)o
(::SystemException)m(.")h(<<)f(endl)o(;)462 5121 y(})462
5221 y(catch)o(\(CORBA)o(::)o(Exception)o(&\))g({)562
5321 y(cerr)g(<<)g("Caught)g(CORBA)o(::)o(Exception)o(.")g(<<)g(endl;)p
eop
%%Page: 101 109
101 108 bop 63 282 a Fg(9.4.)51 b(SOURCE)22 b(LISTING)2205
b Fs(101)303 539 y Fe(})303 638 y(catch)o(\(omniORB)o(::fatalException)
m(&)50 b(fe)o(\))g({)403 738 y(cerr)f(<<)h(")o(Caught)f(omniORB)o(::)o
(fatalException)n(:")g(<<)h(endl)o(;)403 837 y(cerr)f(<<)h(")99
b(file)o(:)50 b(")g(<<)f(fe.)o(file\(\))g(<<)h(endl)o(;)403
937 y(cerr)f(<<)h(")99 b(line)o(:)50 b(")g(<<)f(fe.)o(line\(\))g(<<)h
(endl)o(;)403 1037 y(cerr)f(<<)h(")99 b(mesg)o(:)50 b(")g(<<)f(fe.)o
(errmsg)o(\(\))h(<<)f(endl)o(;)303 1136 y(})303 1236
y(catch)o(\(...\))g({)403 1336 y(cerr)g(<<)h(")o(Caught)f(unknown)g
(exception)n(.")g(<<)h(endl)o(;)303 1435 y(})303 1535
y(return)f(0;)204 1634 y(})p eop
%%Page: 102 110
102 109 bop 221 282 a Fs(102)1367 b Fg(CHAPTER)22 b(9.)51
b(TYPE)21 b(ANY)h(AND)g(TYPECODE)p eop
%%Page: 103 111
103 110 bop 63 1162 a Fm(Chapter)44 b(10)63 1577 y Fo(Dynamic)51
b(Management)h(of)g(Any)63 1826 y(V)-23 b(alues)63 2272
y Fs(In)19 b(CORBA)h(speci\002cation)f(2.2,)i(a)f(new)f(facility\227)p
Fr(DynAny)i Fs(was)e(intr)n(oduced.)26 b(Pr)n(eviously)-10
b(,)19 b(it)63 2385 y(was)24 b(not)g(possible)f(to)h(insert)f(or)h
(extract)g(constr)o(ucted)f(and)h(other)f(complex)i(types)d(fr)n(om)j
(an)63 2498 y(Any)18 b(without)h(using)g(the)f(stub)h(code)g(generated)
e(by)i(an)h(idl)g(compiler)g(for)f(these)f(types.)25
b(This)63 2611 y(makes)j(it)h(impossible)g(to)g(write)f(generic)g
(servers)g(\(bridges,)h(event)g(channels)g(supporting)63
2723 y(\002ltering,)22 b(etc.\))28 b(because)22 b(these)f(servers)g
(can)i(not)f(have)h(static)g(knowledge)e(of)h(all)i(the)e(possi-)63
2836 y(ble)h(data)f(types)f(that)h(they)g(have)h(to)f(handle.)204
2950 y(T)-8 b(o)29 b(\002ll)i(this)f(gap,)h(the)f(DynAny)f(facility)j
(is)e(de\002ned)e(to)i(enable)g(traversal)h(of)f(the)f(data)63
3063 y(value)i(associated)e(with)i(an)g(Any)e(at)i(r)o(untime)f(and)h
(extraction)e(of)i(its)f(constituents.)49 b(This)63 3175
y(facility)30 b(also)f(enables)f(the)g(constr)o(uction)f(of)i(an)g(Any)
e(at)i(r)o(untime,)h(without)d(having)i(static)63 3288
y(knowledge)20 b(of)j(its)f(types.)204 3402 y(This)38
b(chapter)h(describes)f(how)g(DynAny)g(may)h(be)g(used.)75
b(For)38 b(completeness,)i(you)63 3515 y(should)33 b(also)h(r)n(ead)g
(the)f(DynAny)g(speci\002cation)h(de\002ned)e(in)i(Chapter)g(9)g(of)g
(the)g(CORBA)63 3628 y(2.3)22 b(speci\002cation.)27 b(Wher)n(e)21
b(possible,)f(the)h(implementation)g(in)h(omniORB)g(adher)n(es)e
(closely)63 3740 y(to)j(the)h(speci\002cation.)34 b(However)-7
b(,)23 b(ther)n(e)h(ar)n(e)g(ar)n(eas)h(in)g(the)f(speci\002cation)g
(that)h(ar)n(e)f(ambigu-)63 3853 y(ous)h(or)h(lacking)h(in)f(details.)
39 b(A)26 b(number)g(of)g(these)e(issues)h(ar)n(e)h(curr)n(ently)g
(opened)e(with)i(the)63 3966 y(ORB)d(r)n(evision)g(task)g(for)n(ce.)30
b(Until)23 b(the)g(issues)f(ar)n(e)h(r)n(esolved,)f(it)i(is)f(possible)
g(that)g(a)h(dif)n(fer)n(ent)63 4079 y(implementation)31
b(may)h(choose)e(to)g(interpr)n(et)g(the)h(speci\002cation)g(dif)n(fer)
n(ently)-10 b(.)54 b(This)31 b(chap-)63 4192 y(ter)21
b(pr)n(ovides)g(clari\002cations)i(to)f(the)f(speci\002cation,)h
(explains)f(the)g(interpr)n(etation)g(used)g(and)63 4305
y(of)n(fers)h(some)g(advice)h(and)g(warnings)f(on)g(potential)g
(portability)h(pr)n(oblems.)204 4418 y(Notice)c(that)h(the)g(DynAny)f
(interface)h(has)g(been)g(changed)f(in)i(CORBA)f(2.3,)h(particularly)63
4531 y(with)26 b(the)g(addition)g(of)h(the)f(support)e(for)j(the)f(IDL)
g(type)f Ff(valuetype)p Fs(.)36 b(Futur)n(e)25 b(r)n(eleases)h(of)63
4644 y(omniORB)c(will)i(be)f(updated)e(to)h(implement)g(the)g
(interface)h(as)g(de\002ned)d(in)j(CORBA)g(2.3.)63 4946
y Fq(10.1)118 b(C++)32 b(mapping)204 5194 y Fd(//)49
b(namespace)f(CORBA)204 5394 y Fe(class)h(ORB)g({)1639
5622 y Fs(103)p eop
%%Page: 104 112
104 111 bop 221 282 a Fs(104)594 b Fg(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)h(ANY)g(V)-10 b(ALUES)362
539 y Fe(public)o(:)462 638 y(...)462 837 y(class)49
b(InconsistentTypeCode)d(:)k(public)e(UserException)g({)h(...)g(};)462
1037 y(DynAny_ptr)f(create_dyn_any)m(\(const)h(Any)o(&)h(value)o(\);)
462 1236 y(DynAny_ptr)e(create_basic_dyn_any)l(\(TypeCode_ptr)g(tc)o
(\);)462 1435 y(DynStruct_ptr)f(create_dyn_struct)m(\(TypeCode_ptr)h
(tc)o(\);)462 1634 y(DynSequence_ptr)f(create_dyn_sequence)l
(\(TypeCode_ptr)h(tc)o(\);)462 1834 y(DynArray_ptr)f(create_dyn_array)n
(\()o(TypeCode_ptr)h(tc\);)462 2033 y(DynUnion_ptr)f(create_dyn_union)n
(\()o(TypeCode_ptr)h(tc\);)462 2232 y(DynEnum_ptr)g(create_dyn_enum)m
(\(TypeCode_ptr)f(tc\);)362 2431 y(};)362 2631 y(typedef)i(DynAny)o(*)g
(DynAny_ptr)n(;)362 2730 y(class)g(DynAny_var)f({)i(...)f(};)362
2930 y(class)g(DynAny)g({)362 3029 y(public)o(:)462 3229
y(class)g(Invalid)f(:)i(public)f(UserException)e({)j(...)f(};)462
3328 y(class)g(InvalidValue)e(:)j(public)f(UserException)e({)j(...)f
(};)462 3428 y(class)g(TypeMismatch)e(:)j(public)f(UserException)e({)j
(...)f(};)462 3527 y(class)g(InvalidSeq)f(:)h(public)g(UserException)e
({)j(...)f(};)462 3727 y(typedef)f(_CORBA_Unbounded_Sequence__Octet)c
(OctetSeq)o(;)462 3926 y(TypeCode_ptr)j(type\(\))i(const)o(;)462
4125 y(void)g(assign)o(\(DynAny_ptr)f(dyn_any)n(\))i(throw)o(\(Invalid)
o(,)o(SystemException)n(\);)462 4225 y(void)f(from_any)n(\(const)g
(Any&)g(value)o(\))h(throw)o(\(Invalid)o(,)o(SystemException)n(\);)462
4324 y(Any)o(*)g(to_any)o(\(\))f(throw)o(\(Invalid)o(,SystemException)m
(\);)462 4424 y(void)g(destroy)o(\(\);)462 4524 y(DynAny_ptr)f(copy)o
(\(\);)462 4723 y(DynAny_ptr)g(current_component)m(\(\);)462
4823 y(Boolean)g(next\(\);)462 4922 y(Boolean)g(seek\()o(Long)i(index)o
(\);)462 5022 y(void)f(rewind)o(\(\);)462 5221 y(void)g(insert_boolean)
m(\(Boolean)g(value)o(\))g(throw)o(\(InvalidValue)n(,SystemException)m
(\);)462 5321 y(void)g(insert_octet)n(\(Octet)f(value\))h(throw)o
(\(InvalidValue)n(,SystemException)m(\);)p eop
%%Page: 105 113
105 112 bop 63 282 a Fg(10.1.)51 b(C++)24 b(MAPPING)2279
b Fs(105)303 539 y Fe(void)49 b(insert_char)n(\(Char)g(value)o(\))h
(throw)o(\(InvalidValue)n(,)o(SystemException)n(\);)303
638 y(void)f(insert_short)n(\(Short)g(value)o(\))h(throw)o
(\(InvalidValue)m(,SystemException)m(\);)303 738 y(void)f
(insert_ushort)n(\(UShort)g(value)o(\))g(throw)o(\(InvalidValue)n
(,SystemException)m(\);)303 837 y(void)g(insert_long)n(\(Long)g(value)o
(\))h(throw)o(\(InvalidValue)n(,)o(SystemException)n(\);)303
937 y(void)f(insert_ulong)n(\(ULong)g(value)o(\))h(throw)o
(\(InvalidValue)m(,SystemException)m(\);)303 1037 y(void)f
(insert_float)n(\(Float)g(value)o(\))h(throw)o(\(InvalidValue)m
(,SystemException)m(\);)303 1136 y(void)f(insert_double)n(\(Double)g
(value)o(\))g(throw)o(\(InvalidValue)n(,SystemException)m(\);)303
1236 y(void)g(insert_string)n(\(const)g(char)o(*)h(value)o(\))f(throw)o
(\(InvalidValue)n(,SystemException)m(\);)303 1336 y(void)g
(insert_reference)n(\()o(Object_ptr)f(v\))i(throw)o(\(InvalidValue)m
(,SystemException)m(\);)303 1435 y(void)f(insert_typecode)n
(\(TypeCode_ptr)e(v\))j(throw)o(\()o(InvalidValue)n(,SystemException)m
(\);)303 1535 y(void)f(insert_any)o(\()o(const)g(Any&)g(value)o(\))h
(throw)o(\(InvalidValue)n(,SystemException)m(\);)303
1734 y(Boolean)f(get_boolean)n(\(\))g(throw)o(\(TypeMismatch)n
(,SystemException)m(\);)303 1834 y(Octet)g(get_octet)o(\(\))g(throw)o
(\(TypeMismatch)n(,SystemException)m(\);)303 1933 y(Char)g(get_char)o
(\(\))g(throw\()o(TypeMismatch)n(,SystemException)m(\);)303
2033 y(Short)g(get_short)o(\(\))g(throw)o(\(TypeMismatch)n
(,SystemException)m(\);)303 2133 y(UShort)g(get_ushort)n(\(\))h(throw)o
(\(TypeMismatch)m(,SystemException)m(\);)303 2232 y(Long)f(get_long)o
(\(\))g(throw\()o(TypeMismatch)n(,SystemException)m(\);)303
2332 y(ULong)g(get_ulong)o(\(\))g(throw)o(\(TypeMismatch)n
(,SystemException)m(\);)303 2431 y(Float)g(get_float)o(\(\))g(throw)o
(\(TypeMismatch)n(,SystemException)m(\);)303 2531 y(Double)g
(get_double)n(\(\))h(throw)o(\(TypeMismatch)m(,SystemException)m(\);)
303 2631 y(char*)f(get_string)n(\(\))h(throw)o(\(TypeMismatch)n(,)o
(SystemException)n(\);)303 2730 y(Object_ptr)e(get_reference)n(\(\))h
(throw)o(\(TypeMismatch)n(,SystemException)m(\);)303
2830 y(TypeCode_ptr)f(get_typecode)n(\(\))h(throw)o(\(TypeMismatch)n
(,SystemException)m(\);)303 2930 y(Any*)g(get_any)o(\(\))h(throw)o
(\(TypeMismatch)m(,SystemException)m(\);)303 3129 y(static)f
(DynAny_ptr)f(_duplicate)n(\(DynAny_ptr)n(\);)303 3229
y(static)h(DynAny_ptr)f(_narrow)o(\(DynAny_ptr)n(\);)303
3328 y(static)h(DynAny_ptr)f(_nil)o(\(\);)204 3428 y(};)204
3627 y Fd(//)h(DynFixed)g(is)g(not)g(supported)o(.)204
3826 y Fe(typedef)f(DynEnum)o(*)i(DynEnum_ptr)n(;)204
3926 y(class)f(DynEnum_var)e({)j(...)f(};)204 4125 y(class)g(DynEnum)f
(:)100 b(public)48 b(DynAny)h({)204 4225 y(public)o(:)303
4424 y(char*)g(value_as_string)n(\(\);)303 4524 y(void)g
(value_as_string)n(\(const)f(char*)h(value)o(\);)303
4623 y(ULong)g(value_as_ulong)n(\(\);)303 4723 y(void)g(value_as_ulong)
n(\(ULong)g(value)o(\);)303 4922 y(static)g(DynEnum_ptr)f(_duplicate)n
(\(DynEnum_ptr)n(\);)303 5022 y(static)h(DynEnum_ptr)f(_narrow)o(\()o
(DynAny_ptr)o(\);)303 5121 y(static)h(DynEnum_ptr)f(_nil)o(\(\);)204
5221 y(};)p eop
%%Page: 106 114
106 113 bop 221 282 a Fs(106)594 b Fg(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)h(ANY)g(V)-10 b(ALUES)362
539 y Fe(typedef)49 b(char)o(*)h(FieldName)n(;)362 638
y(typedef)f(String_var)f(FieldName_var)m(;)362 837 y(struct)h
(NameValuePair)e({)462 937 y(String_member)g(id;)462
1037 y(Any)i(value)o(;)362 1136 y(};)362 1336 y(typedef)g
(_CORBA_ConstrType_Variable_Var)-6 b(<NameValuePair)n(>)49
b(NameValuePair_var)m(;)362 1435 y(typedef)g(_CORBA_Unbounded_Sequence)
-5 b(<NameValuePair)47 b(>)j(NameValuePairSeq)m(;)362
1634 y(typedef)f(DynStruct)n(*)h(DynStruct_ptr)m(;)362
1734 y(class)f(DynStruct_var)f({)h(...)g(};)362 1933
y(class)g(DynStruct)f(:)100 b(public)48 b(DynAny)h({)362
2033 y(public)o(:)462 2232 y(char)o(*)100 b(current_member_name)l
(\(\);)462 2332 y(TCKind)49 b(current_member_kind)l(\(\);)462
2431 y(NameValuePairSeq)m(*)h(get_members)n(\(\);)462
2531 y(void)f(set_members)n(\(const)g(NameValuePairSeq)m(&)g(NVSeqVal)o
(\))1309 2631 y(throw)o(\(InvalidSeq)n(,SystemException)m(\);)462
2830 y(static)g(DynStruct_ptr)e(_duplicate)n(\(DynStruct_ptr)n(\);)462
2930 y(static)i(DynStruct_ptr)e(_narrow)o(\(DynAny_ptr)n(\);)462
3029 y(static)i(DynStruct_ptr)e(_nil)o(\(\);)362 3129
y(};)362 3328 y(typedef)i(DynUnion)n(*)h(DynUnion_ptr)n(;)362
3428 y(class)f(DynUnion_var)f({)h(...)h(};)362 3627 y(class)f(DynUnion)
f(:)100 b(public)49 b(DynAny)f({)362 3727 y(public)o(:)462
3926 y(Boolean)g(set_as_default)n(\(\);)462 4026 y(void)h
(set_as_default)m(\(Boolean)g(value)o(\);)462 4125 y(DynAny_ptr)f
(discriminator)m(\(\);)462 4225 y(TCKind)h(discriminator_kind)l(\(\);)
462 4324 y(DynAny_ptr)f(member)o(\(\);)462 4424 y(char)o(*)100
b(member_name)n(\(\);)462 4524 y(void)49 b(member_name)n(\(const)g
(char)o(*)h(value)o(\);)462 4623 y(TCKind)f(member_kind)n(\(\);)462
4823 y(static)g(DynUnion_ptr)e(_duplicate)n(\(DynUnion_ptr)n(\);)462
4922 y(static)i(DynUnion_ptr)e(_narrow)o(\(DynAny_ptr)n(\);)462
5022 y(static)i(DynUnion_ptr)e(_nil)o(\(\);)362 5121
y(};)362 5321 y(typedef)i(_CORBA_Unbounded_Sequence)-5
b(<Any)49 b(>)h(AnySeq)o(;)p eop
%%Page: 107 115
107 114 bop 63 282 a Fg(10.2.)51 b(THE)22 b(DYNANY)f(INTERF)-7
b(ACE)1759 b Fs(107)204 638 y Fe(typedef)48 b(DynSequence)n(*)i
(DynSequence_ptr)m(;)204 738 y(class)f(DynSequence_var)e({)i(...)h(};)
204 937 y(class)f(DynSequence)e(:)100 b(public)49 b(DynAny)f({)204
1037 y(public)o(:)303 1236 y(ULong)h(length)o(\(\);)303
1336 y(void)g(length)g(\(ULong)g(value)o(\);)303 1435
y(AnySeq)o(*)h(get_elements)n(\(\);)303 1535 y(void)f(set_elements)n
(\(const)g(AnySeq)o(&)g(value\))g(throw)o(\(InvalidValue)n
(,SystemException)m(\);)303 1734 y(static)g(DynSequence_ptr)e
(_duplicate)n(\(DynSequence_ptr)m(\);)303 1834 y(static)i
(DynSequence_ptr)e(_narrow)o(\(DynAny_ptr)n(\);)303 1933
y(static)i(DynSequence_ptr)e(_nil)o(\(\);)204 2033 y(};)204
2232 y(typedef)h(DynArray)o(*)h(DynArray_ptr)n(;)204
2332 y(class)g(DynArray_var)e({)j(...)f(};)204 2531 y(class)g(DynArray)
f(:)i(public)e(DynAny)h({)204 2631 y(public)o(:)303 2830
y(AnySeq)o(*)h(get_elements)n(\(\);)303 2930 y(void)f(set_elements)n
(\(const)g(AnySeq)o(&)g(value\))g(throw)o(\(InvalidValue)n
(,SystemException)m(\);)303 3129 y(static)g(DynArray_ptr)f(_duplicate)n
(\(DynArray_ptr)m(\);)303 3229 y(static)h(DynArray_ptr)f(_narrow)n
(\(DynAny_ptr)n(\);)303 3328 y(static)h(DynArray_ptr)f(_nil)o(\(\);)204
3428 y(};)63 3641 y Fq(10.2)118 b(The)30 b(DynAny)g(Interface)63
3864 y Fk(10.2.1)98 b(Example:)30 b(extract)25 b(data)f(values)i(from)e
(an)g(Any)63 4050 y Fs(If)e(an)h(Any)f(contains)g(a)h(value)h(of)e(one)
g(of)g(the)g(basic)i(data)e(types,)f(its)h(value)h(can)g(be)g
(extracted)63 4163 y(using)f(the)g(pr)n(e-de\002ned)e(operators)h(in)i
(the)f(Any)g(interface.)28 b(When)22 b(the)g(value)i(is)f(a)g(str)o
(uct)f(or)63 4276 y(other)i(non-basic)j(types,)e(one)g(can)i(use)e(the)
g(DynAny)g(interface)h(to)f(extract)h(its)f(constituent)63
4389 y(values.)204 4507 y(In)33 b(this)g(section,)i(we)e(use)f(a)i(str)
o(uct)e(as)i(an)g(example)f(to)g(illustrate)g(how)g(the)f(DynAny)63
4620 y(interface)22 b(can)i(be)e(used.)204 4737 y(The)g(example)g(str)o
(uct)g(is)h(as)g(follows:)204 4896 y Fd(//)49 b(IDL)204
4995 y Fe(struct)f(exampleStruct1)g({)303 5095 y(string)h(s;)303
5194 y(double)g(d;)303 5294 y(long)149 b(l;)204 5394
y(};)p eop
%%Page: 108 116
108 115 bop 221 282 a Fs(108)594 b Fg(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)h(ANY)g(V)-10 b(ALUES)362
539 y Fs(T)i(o)34 b(cr)n(eate)h(a)h(DynAny)e(fr)n(om)h(an)h(Any)e
(value,)k(one)d(uses)e(the)h Ff(create_dyn_any\()o(\))221
652 y Fs(method:)362 814 y Fd(//)50 b(C++)362 913 y Fe(CORBA)o
(::ORB_ptr)e(orb;)99 b Fd(//)50 b(orb)f(initialised)f(by)h(CORBA)o
(::ORB_init)n(.)362 1113 y Fe(Any)h(v)o(;)362 1212 y(...)348
b Fd(//)50 b(Initialise)e(v)h(to)h(contain)e(a)i(value)f(of)g(type)g
(exampleStruct1)n(.)362 1412 y Fe(CORBA)o(::DynAny_var)f(dv)h(=)h(orb)o
(->create_dyn_any)m(\(v\);)362 1594 y Fs(Like)24 b(CORBA)g(object)g
(and)g(pseudo)f(object)h(r)n(efer)n(ences,)f(a)i Ff(DynAny_ptr)20
b Fs(can)25 b(be)f(man-)221 1707 y(aged)c(by)h(a)g Ff(_var)e
Fs(type)g(\()p Ff(DynAny_var)p Fs(\))e(which)k(will)h(r)n(elease)f(the)
e Ff(DynAny_ptr)e Fs(automat-)221 1819 y(ically)25 b(when)d(the)f
(variable)k(goes)c(out)h(of)g(scope.)221 2110 y Fn(10.2.1.1)93
b(Iterate)25 b(through)c(the)i(components)221 2300 y
Fs(Once)f(the)e(DynAny)g(object)h(is)g(cr)n(eated,)g(we)g(can)h(use)e
(the)g(DynAny)g(interface)i(to)e(extract)h(the)221 2413
y(individual)32 b(components)c(in)j Ff(exampleStruct1)o
Fs(.)45 b(The)29 b(DynAny)g(interface)h(pr)n(ovides)f(a)221
2526 y(number)e(of)g(functions)g(to)g(extract)f(and)i(insert)e
(component)g(values.)41 b(These)26 b(functions)h(ar)n(e)221
2639 y(de\002ned)21 b(to)h(operate)f(on)h(the)g(component)f
(identi\002ed)h(by)g(the)g Fr(curr)n(ent)i(component)f
Fs(pointer)-7 b(.)362 2758 y(A)31 b Fr(curr)n(ent)i(component)f
Fs(pointer)e(is)h(an)h(internal)g(state)e(of)h(a)h(DynAny)e(object.)54
b(When)30 b(a)221 2871 y(DynAny)25 b(object)g(is)h(cr)n(eated,)f(the)g
(pointer)f(is)i(initialised)g(to)f(point)g(to)g(the)g(\002rst)f
(component)221 2984 y(of)f(the)f(any)g(value.)362 3104
y(The)29 b(pointer)f(can)i(be)f(advanced)g(to)f(the)h(next)f(component)
g(with)h(the)f Ff(next\(\))e Fs(opera-)221 3217 y(tion.)35
b(The)24 b(function)h(r)n(eturns)f(F)-7 b(ALSE)24 b(\(0\))i(if)g(ther)n
(e)e(ar)n(e)h(no)g(mor)n(e)g(components.)33 b(Otherwise)221
3329 y(it)27 b(r)n(eturns)e(TRUE)g(\(1\).)41 b(When)26
b(the)f(any)i(value)g(in)g(the)e(DynAny)h(object)g(contains)h(only)f
(one)221 3442 y(component,)21 b(the)h Ff(next\(\)\(\))d
Fs(operation)j(always)h(r)n(eturns)e(F)-7 b(ALSE\(0\).)362
3562 y(Another)28 b(way)i(of)g(adjusting)f(the)g(pointer)g(is)h(the)e
Ff(seek\(\))g Fs(operation.)48 b(The)29 b(function)221
3675 y(r)n(eturns)j(F)-7 b(ALSE)31 b(\(0\))k(if)e(ther)n(e)g(is)g(no)f
(component)g(at)h(the)g(speci\002ed)e(index.)59 b(Otherwise)32
b(it)221 3788 y(r)n(eturns)g(TRUE)h(\(1\).)61 b(The)33
b(index)g(value)h(of)f(the)g(\002rst)g(component)f(is)h(zer)n(o.)61
b(Ther)n(efor)n(e,)34 b(a)221 3900 y Ff(seek\(0\))20
b Fs(call)26 b(r)n(ewinds)c(the)h(pointer)f(to)g(the)h(\002rst)f
(component,)g(this)h(is)h(also)f(equivalent)h(to)221
4013 y(a)f(call)i(to)d(the)g Ff(rewind\(\))d Fs(operation.)362
4133 y(For)26 b(completeness,)g(we)g(should)g(also)i(mention)e(her)n(e)
g(the)h Ff(current_compon)o(en)o(t\()o(\))221 4246 y
Fs(operation.)52 b(This)31 b(operation)f(causes)h(the)f(DynAny)g
(object)h(to)f(r)n(eturn)h(a)g(r)n(efer)n(ence)g(to)f(an-)221
4359 y(other)c(DynAny)g(object)h(that)g(can)g(be)g(used)f(to)g(access)h
(the)f(curr)n(ent)h(component.)39 b(It)27 b(is)g(pos-)221
4471 y(sible)e(that)f(the)g(curr)n(ent)g(component)f(pointer)g(is)i
(not)e(pointing)h(to)g(a)h(valid)h(component,)d(for)221
4584 y(instance,)35 b(the)e Ff(next\(\))d Fs(operation)i(has)h(been)f
(invoked)g(and)h(ther)n(e)g(is)g(no)f(mor)n(e)h(compo-)221
4697 y(nent.)44 b(Under)27 b(this)h(cir)n(cumstance,)j(the)c
Ff(current_componen)o(t\()o(\))22 b Fs(operation)27 b(r)n(eturns)g(a)
221 4810 y(nil)21 b(DynAny)d(object)i(r)n(efer)n(ence)1336
4777 y Fl(1)1372 4810 y Fs(.)27 b(For)19 b(components)f(which)i(ar)n(e)
g(just)f(basic)h(data)g(types,)e(call-)221 4923 y(ing)24
b Ff(current_compone)o(nt)o(\(\))17 b Fs(is)24 b(an)h(overkill)f
(because)f(we)h(can)g(just)g(use)e(the)i(basic)h(type)221
5036 y(extraction)d(and)h(insertion)f(functions)g(dir)n(ectly)-10
b(.)p 221 5123 1316 4 v 327 5179 a Fj(1)356 5211 y Fi(T)j(esting)15
b(a)g(nil)g(DynAny)h(object)g(with)g(CORBA::is_nil\(\))e(r)o(eturns)g
(TRUE\(1\).)22 b(The)15 b(CORBA)g(2.2)h(speci\002cation)221
5302 y(does)j(not)h(specify)e(what)j(is)e(the)h(r)o(eturn)e(value)i(of)
f(this)h(function)g(when)h(the)f(curr)o(ent)f(component)h(pointer)f(is)
g(in-)221 5394 y(valid.)j(T)-7 b(o)17 b(ensur)o(e)f(portability)-8
b(,)16 b(it)i(is)e(best)i(to)f(avoid)g(calling)g Fh
(current_component\(\))d Fi(under)j(this)g(condition.)p
eop
%%Page: 109 117
109 116 bop 63 282 a Fg(10.2.)51 b(THE)22 b(DYNANY)f(INTERF)-7
b(ACE)1759 b Fs(109)63 539 y Fn(10.2.1.2)92 b(Extract)24
b(basic)g(type)f(components)63 719 y Fs(In)f(our)g(example,)g(the)g
(component)f(values)i(can)h(be)e(extracted)g(as)g(follows:)204
873 y Fe(CORBA)o(::)o(String_var)48 b(s)i(=)g(dv)o(->get_string)n
(\(\);)204 972 y(CORBA)o(::)o(Double)248 b(d)50 b(=)g(dv)o
(->get_double)n(\(\);)204 1072 y(CORBA)o(::)o(Long)348
b(l)50 b(=)g(dv)o(->get_long)n(\(\);)204 1241 y Fs(Each)23
b(get)e(basic)i(type)e(operation)h(has)g(the)g(side-ef)n(fect)f(of)i
(advancing)g(the)f(curr)n(ent)g(com-)63 1354 y(ponent)f(pointer)-7
b(.)27 b(For)21 b(instance:)204 1507 y Fe(CORBA)o(::)o(String_var)48
b(s)i(=)g(dv)o(->get_string)n(\(\);)204 1675 y Fs(is)23
b(equivalent)f(to:)204 1829 y Fe(CORBA)o(::)o(DynAny_var)48
b(temp)i(=)f(dv->)o(current_component)m(\(\);)204 1928
y(CORBA)o(::)o(String_var)f(s)i(=)g(temp)o(->get_string)n(\(\);)204
2028 y(dv)o(->next)o(\(\);)204 2197 y Fs(The)30 b(get)g(operations)g
(ensur)n(e)g(that)h(the)g(curr)n(ent)f(component)g(is)i(of)f(the)g
(same)g(type)e(as)63 2310 y(r)n(equested.)23 b(Otherwise,)18
b(the)g(object)g(thr)n(ows)f(a)h Ff(TypeMismatch)13 b
Fs(exception.)25 b(If)19 b(the)e(curr)n(ent)63 2422 y(component)j
(pointer)g(is)i(invalid)i(when)d(a)h(get)e(operation)h(is)h(called,)g
(the)f(object)h(also)g(thr)n(ows)63 2535 y(a)h Ff(TypeMismatch)17
b Fs(exception)1197 2502 y Fl(2)1233 2535 y Fs(.)204
2650 y(T)-8 b(o)29 b(r)n(epeatedly)g(access)i(the)e(components,)i(one)e
(can)j(use)d(the)h Ff(rewind\(\))d Fs(or)j Ff(seek\(\))63
2763 y Fs(operations)f(to)g(manipulate)j(the)d(curr)n(ent)h(component)g
(pointer)-7 b(.)50 b(For)30 b(instance,)i(to)e(access)63
2876 y(the)21 b Ff(d)i Fs(member)f(in)h Ff(exampleStruct1)17
b Fs(dir)n(ectly:)204 3029 y Fe(dv)o(->seek)o(\(1\);)348
b Fd(//)50 b(position)e(current)h(component)f(to)h(member)g(d.)204
3129 y Fe(CORBA)o(::)o(Double)g(d)h(=)f(dv->get_double)n(\(\);)63
3446 y Fn(10.2.1.3)92 b(Extract)24 b(complex)g(components)63
3627 y Fs(When)j(a)i(component)d(is)i(not)g(one)f(of)h(the)f(basic)i
(data)g(types,)e(it)h(is)g(not)f(possible)h(to)f(extract)63
3740 y(its)21 b(value)h(using)e(the)h(get)f(operations.)26
b(Instead,)20 b(a)h(DynAny)g(object)g(has)g(to)g(be)g(cr)n(eated)g(fr)n
(om)63 3853 y(which)i(the)f(component)f(is)i(accessed.)204
3968 y(Consider)f(this)g(example:)204 4121 y Fd(//)49
b(IDL)204 4221 y Fe(struct)f(exampleStruct2)g({)303 4320
y(string)h(m1;)303 4420 y(exampleStruct1)f(m2)o(;)204
4520 y(};)204 4688 y Fs(In)30 b(or)n(der)g(to)h(extract)f(the)g(data)h
(members)g(within)g Ff(m2)f Fs(\(of)h(type)f Ff(exampleStruct1)o
Fs(\),)63 4801 y(we)22 b(use)f Ff(current_componen)o(t\()o(\))16
b Fs(as)23 b(follows:)204 4954 y Fd(//)49 b(C++)204 5054
y Fe(CORBA)o(::)o(ORB_ptr)g(orb)o(;)100 b Fd(//)49 b(orb)h(initialised)
d(by)j(CORBA)o(::)o(ORB_init)o(.)p 63 5123 1316 4 v 168
5179 a Fj(2)197 5211 y Fi(The)28 b(CORBA)f(2.2)h(speci\002cation)g
(does)e(not)i(de\002ne)g(the)g(behavior)g(of)f(this)h(err)o(or)d
(condition.)50 b(T)-7 b(o)27 b(ensur)o(e)63 5302 y(portability)-8
b(,)14 b(it)h(is)g(best)g(to)g(avoid)g(calling)f(the)i(get)f
(operations)f(when)i(the)g(curr)o(ent)e(component)i(pointer)e(is)h
(known)63 5394 y(to)j(be)h(invalid.)p eop
%%Page: 110 118
110 117 bop 221 282 a Fs(1)-5 b(10)599 b Fg(CHAPTER)22
b(10.)51 b(DYNAMIC)22 b(MANAGEMENT)f(OF)h(ANY)g(V)-10
b(ALUES)362 539 y Fe(Any)50 b(v)o(;)362 638 y(...)348
b Fd(//)50 b(Initialise)e(v)h(to)h(contain)e(a)i(value)f(of)g(type)g
(exampleStruct2)n(.)362 837 y Fe(CORBA)o(::DynAny_var)f(dv)h(=)h(orb)o
(->create_dyn_any)m(\(v\);)362 1037 y(CORBA)o(::String_var)e(m1)h(=)h
(dv->)o(get_string)n(\(\);)99 b Fd(//)50 b(extract)e(member)h(m1)362
1136 y Fe(CORBA)o(::DynAny_var)f(dm)h(=)h(dv->)o(current_component)m
(\(\);)f Fd(//)h(DynAny)e(reference)h(to)g(m2)362 1236
y Fe(CORBA)o(::String_var)f(s)i(=)f(dm->)o(get_string)o(\(\);)148
b Fd(//)50 b(m2.)o(s)362 1336 y Fe(CORBA)o(::Double)248
b(d)50 b(=)f(dm->)o(get_double)o(\(\);)148 b Fd(//)50
b(m2.)o(d)362 1435 y Fe(CORBA)o(::Long)348 b(l)50 b(=)f(dm->)o
(get_long)o(\(\);)248 b Fd(//)50 b(m2.)o(l)221 1731 y
Fn(10.2.1.4)93 b(Clean-up)221 1908 y Fs(Now)23 b(we)g(\002nish)g(of)n
(f)h(this)g(example)f(with)h(a)g(description)e(on)h(destr)n(oying)e
(DynAny)i(objects.)221 2021 y(Ther)n(e)f(ar)n(e)h(two)f(points)f(to)h
(r)n(emember:)335 2222 y(1.)45 b(A)22 b(DynAny)f(r)n(efer)n(ence)g(\()p
Ff(DynAny_ptr)p Fs(\))d(is)j(like)h(any)g(CORBA)f(object)h(or)f(psuedo)
f(ob-)448 2335 y(ject)25 b(r)n(efer)n(ence)e(and)i(should)e(be)h
(handled)g(in)h(the)f(same)g(way)-10 b(.)33 b(In)24 b(particular)-7
b(,)25 b(one)f(has)448 2448 y(to)29 b(call)h(the)f Ff(CORBA::release)o
(\(\))22 b Fs(operation)28 b(to)g(indicate)i(that)e(a)i(DynAny)e(r)n
(efer)n(-)448 2561 y(ence)h(will)g(no)g(longer)f(be)g(accessed.)45
b(In)28 b(the)g(example,)i(this)e(is)h(done)e(automatically)448
2674 y(by)c Ff(DynAny_var)p Fs(.)335 2857 y(2.)45 b(A)32
b(DynAny)f(object)g(and)h(its)g(r)n(efer)n(ences)e(ar)n(e)j(separate)d
(entities,)j(just)e(as)h(a)g(CORBA)448 2970 y(object)d(implementation)f
(and)h(its)f(object)g(r)n(efer)n(ences)g(ar)n(e)h(dif)n(fer)n(ent)f
(entities.)45 b(While)448 3083 y Ff(CORBA::release\(\))19
b Fs(will)27 b(r)n(elease)e(any)h(r)n(esour)n(ces)e(associated)h(with)h
(a)g Ff(DynAny_)448 3196 y(ptr)p Fs(,)d(one)h(has)g(to)g(separately)f
(destr)n(oy)f(the)h(DynAny)g(object)h(to)g(avoid)h(any)f(memory)448
3309 y(leak.)k(This)23 b(is)f(done)g(by)g(calling)j(the)c
Ff(destroy\(\)\(\))d Fs(operation.)362 3510 y(In)23 b(the)e(example,)i
(the)e(DynAny)h(object)h(can)g(be)g(destr)n(oyed)c(as)k(follows:)362
3656 y Fd(//)50 b(C++)362 3756 y Fe(...)362 3855 y(CORBA)o
(::DynAny_var)e(dv)h(=)h(orb)o(->create_dyn_any)m(\(v\);)362
3955 y(...)362 4055 y(dv->destroy)n(\(\);)362 4254 y
Fd(//)g(From)f(now)g(on,)g(one)h(should)e(not)i(invoke)e(any)h
(operation)g(in)g(dv.)362 4353 y(//)h(Otherwise)e(the)h(behaviour)f(is)
i(undefined)n(.)221 4652 y Fk(10.2.2)99 b(Example:)30
b(insert)24 b(data)h(values)g(into)h(an)e(Any)221 4829
y Fs(Using)f(the)f(DynAny)h(interface,)h(one)e(can)i(cr)n(eate)g(an)g
(Any)e(value)j(fr)n(om)f(scratch.)30 b(In)23 b(this)g(ex-)221
4942 y(ample,)g(we)e(ar)n(e)i(going)e(to)h(cr)n(eate)g(an)h(Any)e
(containing)i(a)g(value)g(of)f(the)f Ff(exampleStruct1)221
5055 y Fs(type.)362 5168 y(First,)h(we)g(have)h(to)f(cr)n(eate)h(a)g
(DynAny)f(to)g(stor)n(e)f(the)h(value)i(using)e(one)g(of)g(the)g
Ff(create_)221 5281 y(dyn\(\))16 b Fs(functions.)26 b(Because)16
b Ff(exampleStruct1)c Fs(is)18 b(a)g(str)o(uct,)g(we)f(use)g(the)g
Ff(create_dyn_)221 5394 y(struct\(\))i Fs(operation.)p
eop
%%Page: 111 119
111 118 bop 63 282 a Fg(10.2.)51 b(THE)22 b(DYNANY)f(INTERF)-7
b(ACE)1769 b Fs(1)-5 b(1)g(1)204 539 y Fd(//)49 b(C++)204
638 y Fe(CORBA)o(::)o(ORB_ptr)g(orb)o(;)100 b Fd(//)49
b(orb)h(initialised)d(by)j(CORBA)o(::)o(ORB_init)o(.)204
837 y(//)f(create)g(the)g(TypeCode)g(for)g(exampleStruct)m(.)204
937 y Fe(StructMemberSeq)e(tc_members)n(;)204 1037 y(tc_members)n
(.length)o(\(3\);)204 1136 y(tc_members)n([0].)o(name)i(=)h(\(const)f
(char)o(*\))o("s";)204 1236 y(tc_members)n([0].)o(type)g(=)h(CORBA)o
(::TypeCode)n(::_duplicate)n(\(CORBA)o(::)o(_tc_string)n(\);)204
1336 y(tc_members)n([0].)o(type_def)f(=)g(CORBA)o(::IDLType)o(::)o
(_nil)o(\(\);)204 1435 y(tc_members)n([1].)o(name)g(=)h(\(const)f(char)
o(*\))o("d";)204 1535 y(tc_members)n([1].)o(type)g(=)h(CORBA)o
(::TypeCode)n(::_duplicate)n(\(CORBA)o(::)o(_tc_double)n(\);)204
1634 y(tc_members)n([1].)o(type_def)f(=)g(CORBA)o(::IDLType)o(::)o
(_nil)o(\(\);)204 1734 y(tc_members)n([2].)o(name)g(=)h(\(const)f(char)
o(*\))o("l";)204 1834 y(tc_members)n([2].)o(type)g(=)h(CORBA)o
(::TypeCode)n(::_duplicate)n(\(CORBA)o(::)o(_tc_long)o(\);)204
1933 y(tc_members)n([2].)o(type_def)f(=)g(CORBA)o(::IDLType)o(::)o
(_nil)o(\(\);)204 2033 y(CORBA)o(::)o(TypeCode_var)f(tc)i(=)f(orb->)o
(create_struct_tc)m(\("IDL)o(:exampleStruct1)m(:1.0",)2545
2133 y("exampleStruct1)m(",)2545 2232 y(tc_members)n(\);)204
2431 y Fd(//)g(create)g(the)g(DynAny)g(object)g(to)g(represent)f(the)h
(any)h(value)204 2531 y Fe(CORBA)o(::)o(DynAny_var)e(dv)i(=)g(orb)o
(->create_dyn_struct)l(\(tc\);)63 2860 y Fn(10.2.2.1)92
b(Insert)24 b(basic)g(type)e(components)63 3044 y Fs(Once)36
b(the)f(DynAny)f(object)i(is)g(cr)n(eated,)i(we)d(can)h(use)f(the)g
(DynAny)g(interface)g(to)g(insert)63 3157 y(the)23 b(components.)29
b(The)23 b(DynAny)g(interface)h(pr)n(ovides)f(a)h(number)f(of)h(insert)
f(operations)f(to)63 3270 y(insert)e(basic)j(types)c(into)i(the)f(any)i
(value.)28 b(In)21 b(our)f(example,)i(the)e(component)g(values)i(can)g
(be)63 3383 y(inserted)e(as)j(follows:)204 3539 y Fe(CORBA)o(::)o
(String_var)48 b(s)i(=)g(\(const)e(char*\))o("Hello)o(";)204
3639 y(CORBA)o(::)o(Double)248 b(d)50 b(=)g(3.1416;)204
3738 y(CORBA)o(::)o(Long)348 b(l)50 b(=)g(1;)204 3938
y(dv)o(->insert_string)n(\()o(s\);)204 4037 y(dv)o(->insert_double)n
(\()o(d\);)204 4137 y(dv)o(->insert_long)n(\(l\);)204
4310 y Fs(Each)33 b(insert)g(basic)h(type)e(operation)g(has)i(the)e
(side-ef)n(fect)h(of)g(advancing)i(the)d(curr)n(ent)63
4423 y(component)21 b(pointer)-7 b(.)27 b(For)22 b(instance:)204
4579 y Fe(dv)o(->insert_string)n(\()o(s\);)204 4752 y
Fs(is)h(equivalent)f(to:)204 4909 y Fe(CORBA)o(::)o(DynAny_var)48
b(temp)i(=)f(dv->)o(current_component)m(\(\);)204 5008
y(temp)o(->insert_string)m(\(s\);)204 5108 y(dv)o(->next)o(\(\);)204
5281 y Fs(The)22 b(insert)h(operations)f(ensur)n(e)g(that)h(the)f(curr)
n(ent)h(component)f(is)i(of)f(the)f(same)i(type)d(as)63
5394 y(the)k(inserted)f(value.)39 b(Otherwise,)25 b(the)g(object)h(thr)
n(ows)f(an)h Ff(InvalidValue)21 b Fs(exception.)37 b(If)p
eop
%%Page: 112 120
112 119 bop 221 282 a Fs(1)-5 b(12)599 b Fg(CHAPTER)22
b(10.)51 b(DYNAMIC)22 b(MANAGEMENT)f(OF)h(ANY)g(V)-10
b(ALUES)221 539 y Fs(the)31 b(curr)n(ent)h(component)e(pointer)h(is)h
(invalid)h(when)e(an)i(insert)d(operation)h(is)h(called,)j(the)221
652 y(object)23 b(also)f(thr)n(ows)g(a)h Ff(InvalidValue)17
b Fs(exception)2099 619 y Fl(3)2135 652 y Fs(.)362 765
y(Sometimes,)22 b(one)h(may)g(just)g(want)g(to)g(modify)g(one)f
(component)g(in)i(an)g(Any)e(value.)31 b(For)221 878
y(instance,)d(one)e(may)i(just)e(want)h(to)f(change)h(the)f(value)i(of)
f(the)f(double)h(member)g(in)g Ff(exam-)221 991 y(pleStruct1)p
Fs(.)d(This)e(can)h(be)g(done)e(as)i(follows:)362 1143
y Fd(//)50 b(C++)362 1242 y Fe(CORBA)o(::ORB_ptr)e(orb;)99
b Fd(//)50 b(orb)f(initialised)f(by)h(CORBA)o(::ORB_init)n(.)362
1442 y Fe(Any)h(v)o(;)362 1541 y(...)348 b Fd(//)50 b(Initialise)e(v)h
(to)h(contain)e(a)i(value)f(of)g(type)g(exampleStruct1)n(.)362
1741 y Fe(CORBA)o(::Double)g(d)g(=)h(6.28;)362 1940 y(CORBA)o
(::DynAny_var)e(dv)h(=)h(orb)o(->create_dyn_any)m(\(v\);)362
2139 y(dv->seek)o(\(1\);)362 2239 y(dv->insert_double)m(\(d\);)199
b Fd(//)49 b(Change)g(the)g(value)g(of)g(the)h(member)e(d.)362
2405 y Fs(Finally)-10 b(,)19 b(the)d(any)i(value)g(can)g(be)f(obtained)
f(fr)n(om)i(the)e(DynAny)h(object)g(using)f(the)h Ff(to_any\(\))221
2518 y Fs(operation:)362 2669 y Fe(CORBA)o(::Any_var)48
b(v)i(=)g(dv)o(->to_any)o(\(\);)199 b Fd(//)49 b(Obtain)g(the)g(any)g
(value)o(.)221 2979 y Fn(10.2.2.2)93 b(Insert)24 b(complex)f
(components)221 3158 y Fs(When)30 b(a)i(component)d(is)i(not)f(one)g
(of)h(the)f(basic)i(data)e(types,)h(it)g(is)g(not)f(possible)g(to)g
(insert)221 3271 y(its)f(value)h(using)e(the)g(insert)g(operations.)45
b(Instead,)29 b(a)h(DynAny)e(object)g(has)h(to)g(be)g(cr)n(eated)221
3384 y(thr)n(ough)22 b(which)h(the)f(component)f(can)i(be)g(inserted.)
362 3498 y(In)32 b(our)g(example,)j(one)d(can)h(insert)f(component)f
(values)h(into)h Ff(exampleStruct2)26 b Fs(as)221 3611
y(follows:)362 3762 y Fd(//)50 b(C++)362 3862 y Fe(CORBA)o(::ORB_ptr)e
(orb;)99 b Fd(//)50 b(orb)f(initialised)f(by)h(CORBA)o(::ORB_init)n(.)
362 4061 y Fe(CORBA)o(::TypeCode_var)f(tc)o(;)362 4161
y Fd(//)i(create)e(the)i(TypeCode)e(for)h(exampleStruct2)n(.)362
4261 y Fe(...)362 4360 y Fd(//)h(create)e(the)i(DynAny)e(object)h(to)h
(represent)e(the)h(any)g(value)362 4460 y Fe(CORBA)o(::DynAny_var)f(dv)
h(=)h(orb)o(->create_dyn_struct)m(\(tc)o(\);)362 4659
y(CORBA)o(::String_var)e(m1)99 b(=)50 b(\(const)f(char)o(*\))o
("Greetings)o(")o(;)362 4759 y(CORBA)o(::String_var)f(m2s)h(=)h
(\(const)f(char)o(*\))o("Hello)o(";)362 4858 y(CORBA)o(::Double)248
b(m2d)49 b(=)h(3.1416;)362 4958 y(CORBA)o(::Long)348
b(m2l)49 b(=)h(1;)p 221 5123 1316 4 v 327 5179 a Fj(3)356
5211 y Fi(The)27 b(CORBA)g(2.2)h(speci\002cation)g(does)f(not)h
(de\002ne)f(the)i(behavior)e(of)h(this)g(err)o(or)d(condition.)50
b(T)-7 b(o)27 b(ensur)o(e)221 5302 y(portability)-8 b(,)26
b(it)g(is)f(best)h(to)g(avoid)f(calling)h(the)g(insert)f(operations)g
(when)i(the)g(curr)o(ent)e(component)h(pointer)g(is)221
5394 y(known)19 b(to)g(be)g(invalid.)p eop
%%Page: 113 121
113 120 bop 63 282 a Fg(10.3.)51 b(THE)22 b(DYNSTRUCT)f(INTERF)-7
b(ACE)1616 b Fs(1)-5 b(13)204 539 y Fe(dv)o(->insert_string)n(\()o
(m1\);)149 b Fd(//)50 b(insert)e(member)h(m1)204 638
y Fe(CORBA)o(::)o(DynAny_var)f(dm)i(=)g(dv)o(->current_component)m
(\(\);)f Fd(//)g(DynAny)g(reference)f(to)i(m2)204 738
y Fe(dm)o(->insert_string)n(\()o(m2s\);)99 b Fd(//)50
b(insert)e(member)h(m2.)o(s)204 837 y Fe(dm)o(->insert_double)n(\()o
(m2d\);)99 b Fd(//)50 b(insert)e(member)h(m2.)o(d)204
937 y Fe(dm)o(->insert_long)n(\(m2l)o(\);)199 b Fd(//)50
b(insert)e(member)h(m2.)o(l)204 1136 y Fe(CORBA)o(::)o(Any_var)g(v)h(=)
f(dv->to_any)n(\(\);)99 b Fd(//)50 b(obtain)f(the)g(any)g(value)204
1336 y Fe(dv)o(->destroy)o(\(\);)497 b Fd(//)50 b(destroy)e(the)i
(DynAny)e(object)o(.)1399 1435 y(//)i(No)f(operation)f(should)h(be)g
(invoked)g(on)g(dv)1399 1535 y(//)h(from)f(this)g(point)g(on)g(except)g
(CORBA)o(::release)n(.)204 1705 y Fs(In)33 b(addition)g(to)g(the)f
(DynAny)h(interface,)j(a)d(number)h(of)f(derived)f(interfaces)h(ar)n(e)
h(de-)63 1818 y(\002ned.)41 b(These)26 b(interfaces)h(ar)n(e)h
(specialisation)g(of)g(the)f(DynAny)f(interface)i(to)f(facilitate)i
(the)63 1931 y(handling)e(of)g(any)g(values)g(containing)g(non-basic)h
(types:)35 b(str)o(uct,)27 b(sequence,)f(array)-10 b(,)28
b(enum)63 2044 y(and)22 b(union)476 2011 y Fl(4)513 2044
y Fs(.)28 b(The)22 b(next)g(few)g(sections)g(will)i(pr)n(ovide)e(mor)n
(e)g(details)h(on)f(these)f(interfaces.)63 2359 y Fq(10.3)118
b(The)30 b(DynStruct)f(Interface)63 2575 y Fs(When)38
b(a)i(DynAny)e(object)g(is)h(cr)n(eated)g(thr)n(ough)f(the)g
Ff(create_dyn_any)o(\(\))33 b Fs(operation)63 2688 y(and)k(the)f(any)i
(value)g(contains)f(a)h(str)o(uct)e(type,)j(a)f Ff(DynStruct)c
Fs(object)j(is)g(cr)n(eated.)71 b(The)63 2801 y(DynAny)23
b(r)n(efer)n(ence)h(r)n(eturned)e(can)j(be)f(narr)n(owed)g(to)f(a)i
Ff(DynStruct)20 b Fs(r)n(efer)n(ence)k(using)f(the)63
2913 y Ff(CORBA::DynStru)o(ct)o(::)o(_na)o(rr)o(ow)o(\(\))16
b Fs(operation.)204 3029 y(In)38 b(the)f(pr)n(evious)g(example,)42
b(the)37 b(components)f(ar)n(e)j(extracted)d(using)i(the)f(get)g(oper)n
(-)63 3142 y(ations.)72 b(Alternatively)-10 b(,)40 b(the)d(DynStr)o
(uct)f(interface)i(pr)n(ovides)f(an)h(additional)g(operation)63
3255 y(\()p Ff(get_members\(\))p Fs(\))12 b(to)17 b(r)n(eturn)g(all)j
(the)d(components)f(in)i(a)g(single)g(call.)28 b(The)17
b(r)n(eturned)f(value)63 3368 y(is)i(a)h(sequence)d(of)j(name)f(value)h
(pairs.)27 b(The)17 b(member)i(name)f(is)h(given)f(in)h(the)e(name)i
(\002eld)f(and)63 3481 y(its)27 b(value)h(is)g(r)n(eturned)e(as)i(an)g
(Any)f(value.)44 b(For)27 b(example,)h(an)g(alternative)g(way)g(to)f
(extract)63 3593 y(the)21 b(components)g(in)i(the)f(pr)n(evious)g
(example)h(is)f(as)h(follows:)204 3748 y Fd(//)49 b(C++)204
3848 y Fe(CORBA)o(::)o(ORB_ptr)g(orb)o(;)100 b Fd(//)49
b(orb)h(initialised)d(by)j(CORBA)o(::)o(ORB_init)o(.)204
3947 y Fe(Any)f(v;)204 4047 y(...)348 b Fd(//)49 b(Initialise)f(v)i(to)
f(contain)g(a)h(value)e(of)i(type)f(exampleStruct1)m(.)204
4147 y Fe(CORBA)o(::)o(DynAny_var)f(dv)i(=)g(orb)o(->create_dyn_any)m
(\(v\);)204 4346 y(CORBA)o(::)o(DynStruct_var)e(ds)h(=)h(CORBA)o
(::DynStruct)n(::_narrow)n(\(dv\);)204 4545 y(CORBA)o(::)o
(NameValuePairSeq)n(*)f(sq)h(=)f(ds->)o(get_members)n(\(\);)204
4744 y(char)o(*)448 b(s;)204 4844 y(CORBA)o(::)o(Double)49
b(d;)204 4944 y(CORBA)o(::)o(Long)149 b(l;)204 5143 y(\(*)o(sq\)[0].)o
(value)49 b(>>=)g(s;)398 b Fd(//)50 b(1st)f(element)g(contains)f
(member)h(s)p 63 5215 1316 4 v 168 5271 a Fj(4)197 5302
y Fi(In)21 b(the)f(CORBA)g(2.2)g(speci\002cation,)g(the)h(DynFixed)d
(interface)i(is)f(de\002ned)g(to)i(handle)f(the)g(\002xed)g(data)g
(type.)63 5394 y(This)e(is)g(not)h(supported)f(in)h(this)g
(implementation.)p eop
%%Page: 114 122
114 121 bop 221 282 a Fs(1)-5 b(14)599 b Fg(CHAPTER)22
b(10.)51 b(DYNAMIC)22 b(MANAGEMENT)f(OF)h(ANY)g(V)-10
b(ALUES)362 539 y Fe(\(*sq\)[1].)o(value)48 b(>>=)i(d;)398
b Fd(//)49 b(2nd)h(element)e(contains)g(member)h(d)362
638 y Fe(\(*sq\)[2].)o(value)f(>>=)i(l;)398 b Fd(//)49
b(3rd)h(element)e(contains)g(member)h(l)362 803 y Fs(Similarly)-10
b(,)20 b(the)c(DynStr)o(uct)h(interface)g(pr)n(ovides)f(an)i
(additional)g(operation)e(\()p Ff(set_members\(\))p Fs(\))221
916 y(to)23 b(insert)f(all)j(the)d(components)f(in)j(a)g(single)f
(call.)31 b(The)22 b(following)i(is)f(an)h(alternative)g(way)f(to)221
1029 y(insert)f(the)g(components)f(of)h(the)g(type)f
Ff(exampleStruct1)16 b Fs(into)23 b(an)g(Any)f(value:)362
1179 y Fd(//)50 b(C++)362 1279 y Fe(CORBA)o(::ORB_ptr)e(orb;)99
b Fd(//)50 b(orb)f(initialised)f(by)h(CORBA)o(::ORB_init)n(.)362
1478 y Fe(CORBA)o(::TypeCode_var)f(tc)o(;)362 1578 y
Fd(//)i(create)e(the)i(TypeCode)e(for)h(exampleStruct1)n(.)362
1678 y Fe(...)362 1777 y Fd(//)h(create)e(the)i(DynAny)e(object)h(to)h
(represent)e(the)h(any)g(value)362 1877 y Fe(CORBA)o(::DynAny_var)f(dv)
h(=)h(orb)o(->create_dyn_struct)m(\(tc)o(\);)362 2076
y(CORBA)o(::String_var)e(s)i(=)f(\(const)g(char)o(*\)"Hello)o(")o(;)362
2176 y(CORBA)o(::Double)248 b(d)50 b(=)f(3.1416;)362
2275 y(CORBA)o(::Long)348 b(l)50 b(=)f(1;)362 2475 y(CORBA)o
(::NameValuePairSeq)e(sq)o(;)362 2574 y(sq.length)o(\(3\);)362
2674 y(sq[0].)o(id)j(=)f(\(const)g(char)o(*\)"s)o(";)362
2773 y(sq[0].)o(value)g(<<=)g(CORBA)o(::Any)o(::from_string)n(\(s,0\);)
1907 2873 y Fd(//)g(1st)g(element)g(contains)f(member)h(s)362
2973 y Fe(sq[1].)o(id)h(=)f(\(const)g(char)o(*\)"d)o(";)362
3072 y(sq[1].)o(value)g(<<=)g(d;)648 b Fd(//)49 b(2nd)g(element)g
(contains)f(member)h(d)362 3172 y Fe(sq[2].)o(id)h(=)f(\(const)g(char)o
(*\)"l)o(";)362 3272 y(sq[2].)o(value)g(<<=)g(l;)648
b Fd(//)49 b(3rd)g(element)g(contains)f(member)h(l)362
3471 y Fe(dv->set_members)m(\(sq\);)362 3636 y Fs(Notice)33
b(that)g(the)g(name-value)h(pairs)g(in)g(the)e(ar)n(gument)h(to)g
Ff(set_members\(\))28 b Fs(must)221 3748 y(match)d(the)e(members)g(of)h
(the)f(str)o(uct)g(exactly)h(or)f(the)g(object)h(would)f(thr)n(ow)h
(the)f Ff(Invalid-)221 3861 y(Seq)f Fs(exception.)362
3975 y(In)h(addition)g(to)f(the)g Ff(current_compone)o(nt)o(\(\))17
b Fs(operation,)k(the)i(DynStr)o(uct)f(interface)221
4088 y(pr)n(ovides)38 b(two)f(operations:)58 b Ff(current_member)o(_n)o
(am)o(e\(\))31 b Fs(and)39 b Ff(current_member)o(_)221
4201 y(kind\(\))p Fs(,)20 b(to)i(r)n(eturn)g(information)h(about)f(the)
g(curr)n(ent)g(component.)221 4503 y Fq(10.4)119 b(The)29
b(DynSequence)h(Interface)221 4716 y Fs(Like)i(str)o(uct)g(values,)j
(sequence)c(values)i(can)g(be)g(traversed)e(using)h(the)g(operations)f
(intr)n(o-)221 4829 y(duced)23 b(in)i(section)e(10.2.)33
b(The)23 b(\002rst)g(sequence)g(element)g(can)h(be)g(accessed)f(as)h
(the)g(\002rst)f(Dyn-)221 4941 y(Any)h(component,)g(the)h(second)e
(sequence)g(element)h(as)i(the)e(second)f(DynAny)h(component)221
5054 y(and)f(so)f(on.)362 5168 y(T)-8 b(o)22 b(extract)g(component)f
(values)i(fr)n(om)h(an)f(Any)f(containing)h(a)g(sequence,)d(the)i
(length)g(of)221 5281 y(the)27 b(sequence)f(can)j(be)f(obtained)f
(using)g(the)g(get)g(length)g(operation)f(in)j(the)e(DynSequence)221
5394 y(interface.)h(Her)n(e)22 b(is)h(an)g(example)f(to)g(extract)g
(the)g(components)f(of)i(a)g(sequence)e(of)h(long:)p
eop
%%Page: 115 123
115 122 bop 63 282 a Fg(10.5.)51 b(THE)22 b(DYNARRA)-10
b(Y)21 b(INTERF)-7 b(ACE)1657 b Fs(1)-5 b(15)204 539
y Fd(//)49 b(C++)204 638 y Fe(CORBA)o(::)o(ORB_ptr)g(orb)o(;)100
b Fd(//)49 b(orb)h(initialised)d(by)j(CORBA)o(::)o(ORB_init)o(.)204
738 y Fe(Any)f(v;)204 837 y(...)348 b Fd(//)49 b(Initialise)f(v)i(to)f
(contain)g(a)h(value)e(of)i(a)f(sequence)g(of)g(long)204
937 y Fe(CORBA)o(::)o(DynAny_var)f(dv)i(=)g(orb)o(->create_dyn_any)m
(\(v\);)204 1136 y(CORBA)o(::)o(DynSequence_var)e(ds)h(=)h(CORBA)o(::)o
(DynSequence)n(::_narrow)o(\()o(dv\);)204 1236 y(CORBA)o(::)o(ULong)f
(len)h(=)f(ds->length)n(\(\);)249 b Fd(//)49 b(extract)g(the)g(length)g
(of)g(the)g(sequence)204 1336 y Fe(CORBA)o(::)o(ULong)g(index)o(;)204
1435 y(for)g(\(index)g(=)g(0;)h(index)f(<)g(len;)g(index)o(++\))h({)303
1535 y(CORBA)o(::Long)f(v)h(=)f(ds->get_long)n(\(\);)303
1634 y(cerr)g(<<)h("[")f(<<)h(index)f(<<)g("])g(=)h(")g(<<)f(v)h(<<)f
(endl)o(;)204 1734 y(})204 1945 y Fs(Conversely)-10 b(,)37
b(the)e(set)g(length)g(operation)f(is)i(pr)n(ovided)f(to)g(set)g(the)g
(length)f(of)i(the)f(se-)63 2058 y(quence.)27 b(Her)n(e)21
b(is)i(an)g(example)g(to)f(insert)f(the)h(components)f(of)i(a)g
(sequence)e(of)h(long:)204 2239 y Fd(//)49 b(C++)204
2339 y Fe(CORBA)o(::)o(ORB_ptr)g(orb)o(;)100 b Fd(//)49
b(orb)h(initialised)d(by)j(CORBA)o(::)o(ORB_init)o(.)204
2538 y Fe(CORBA)o(::)o(TypeCode_var)e(tc;)204 2638 y
Fd(//)h(create)g(the)g(TypeCode)g(for)g(a)g(sequence)g(of)g(long)o(.)
204 2738 y Fe(...)204 2837 y Fd(//)g(create)g(the)g(DynAny)g(object)g
(to)g(represent)f(the)h(any)h(value)204 2937 y Fe(CORBA)o(::)o
(DynSequence_var)e(ds)h(=)h(orb)o(->create_dyn_sequence)l(\(tc\);)204
3136 y(CORBA)o(::)o(ULong)f(len)h(=)f(3;)204 3335 y(ds)o(->length)o
(\(len)o(\);)647 b Fd(//)50 b(set)f(the)g(length)g(of)g(the)h(sequence)
204 3535 y Fe(CORBA)o(::)o(ULong)f(index)o(;)204 3634
y(for)g(\(index)g(=)g(0;)h(index)f(<)g(len;)g(index)o(++\))h({)303
3734 y(ds->insert_long)n(\()o(index\);)198 b Fd(//)50
b(insert)f(a)g(sequence)f(element)204 3833 y Fe(})204
4044 y Fs(Similar)19 b(to)e(the)f(DynStr)o(uct)h(interface,)h(the)f
Ff(get_elements\(\))11 b Fs(operation)16 b(is)h(pr)n(ovided)63
4157 y(to)30 b(r)n(eturn)g(all)j(the)d(sequence)f(elements)h(and)h(the)
f Ff(set_elements\(\))25 b Fs(operation)30 b(is)h(pr)n(o-)63
4270 y(vided)22 b(to)g(insert)g(all)i(the)d(sequence)g(elements.)63
4667 y Fq(10.5)118 b(The)30 b(DynArray)f(Interface)63
4911 y Fs(Array)g(values)h(ar)n(e)g(handled)f(by)h(the)e(DynArray)i
(interface.)49 b(The)29 b(DynArray)g(interface)g(is)63
5024 y(the)19 b(same)i(as)f(the)g(DynSequence)e(interface)j(except)e
(that)h(the)g(former)g(does)f(not)g(pr)n(ovide)h(the)63
5136 y(set)h(length)h(and)g(get)g(length)g(operations.)p
eop
%%Page: 116 124
116 123 bop 221 282 a Fs(1)-5 b(16)599 b Fg(CHAPTER)22
b(10.)51 b(DYNAMIC)22 b(MANAGEMENT)f(OF)h(ANY)g(V)-10
b(ALUES)221 539 y Fq(10.6)119 b(The)29 b(DynEnum)i(Interface)221
763 y Fs(Enum)22 b(values)h(ar)n(e)g(handled)f(by)h(the)f(DynEnum)g
(interface.)28 b(A)22 b(DynEnum)h(object)f(contains)221
876 y(a)31 b(single)f(component)g(which)h(is)f(the)g(enum)g(value.)53
b(This)30 b(value)h(cannot)g(be)f(extracted)f(or)221
989 y(inserted)21 b(using)i(the)f(get)g(and)h(insert)f(operations)f(of)
i(the)f(DynAny)h(interface.)29 b(Instead,)21 b(two)221
1102 y(pairs)i(of)g(operations)e(ar)n(e)i(pr)n(ovided)e(to)h(handle)h
(this)f(value.)362 1222 y(The)e Ff(value_as_string\()o(\))15
b Fs(operation)k(allows)j(the)e(enum)g(value)i(to)e(be)h(extracted)e
(or)221 1335 y(inserted)h(as)h(a)h(string.)27 b(The)20
b Ff(value_as_ulong\(\))15 b Fs(operation)20 b(allows)i(the)e(enum)i
(value)g(to)221 1448 y(be)h(extracted)e(or)h(inserted)f(as)i(an)g
(unsigned)e(long.)221 1788 y Fq(10.7)119 b(The)29 b(DynUnion)i
(Interface)221 2013 y Fs(Union)25 b(values)g(ar)n(e)h(handled)e(by)h
(the)f(DynUnion)h(interface.)35 b(Unfortunately)-10 b(,)24
b(the)g(CORBA)221 2126 y(2.2)e(speci\002cation)f(does)f(not)h(de\002ne)
e(the)i(DynUnion)g(interface)g(in)h(suf)n(\002cient)f(details)g(to)g
(nail)221 2239 y(down)k(its)g(intended)f(usage)1221 2206
y Fl(5)1257 2239 y Fs(.)36 b(In)25 b(this)h(section,)f(we)g(try)f(to)h
(\002ll)i(in)f(the)e(gaps)h(and)h(describe)e(a)221 2352
y(sensible)d(way)g(to)f(use)h(the)f(DynUnion)h(interface.)27
b(Wher)n(e)21 b(necessary)-10 b(,)19 b(the)i(semantics)g(of)g(the)221
2465 y(operations)27 b(is)i(clari\002ed.)46 b(It)28 b(is)g(possible)g
(that)g(the)g(behavior)h(of)f(this)g(interface)h(in)g(another)221
2578 y(ORB)24 b(is)h(dif)n(fer)n(ent)f(fr)n(om)h(this)e
(implementation.)33 b(Wher)n(e)24 b(appr)n(opriate,)f(we)h(give)g
(warnings)221 2691 y(on)e(usage)g(that)g(might)h(cause)f(pr)n(oblems)h
(with)f(portability)-10 b(.)362 2811 y(In)23 b(r)n(elation)g(to)f(the)g
(curr)n(ent)g(component)f(pointer)h(\(section)g(10.2.1.1\),)i(a)g
(DynUnion)e(ob-)221 2923 y(ject)f(contains)g(two)f(components.)26
b(The)20 b(\002rst)g(component)g(\(with)h(the)f(index)h(value)g(equals)
g(0\))221 3036 y(is)h(the)f(discriminator)i(value,)f(the)g(second)e
(one)h(is)h(the)f(member)h(value.)28 b(Ther)n(efor)n(e,)21
b(one)g(can)221 3149 y(use)k(the)g Ff(seek\(\))e Fs(and)i
Ff(current_compone)o(nt\()o(\))19 b Fs(operations)24
b(to)h(obtain)h(a)h(r)n(efer)n(ence)e(to)221 3262 y(the)g(DynAny)g
(objects)g(that)h(handle)g(the)f(two)g(components.)35
b(However)-7 b(,)25 b(it)h(is)g(better)f(to)g(use)221
3375 y(the)20 b(operations)g(de\002ned)f(in)i(the)g(DynUnion)f
(interface)h(to)g(manipulate)h(these)d(components)221
3488 y(as)k(the)f(semantics)g(of)h(the)f(operations)f(is)h(easier)h(to)
f(understand.)221 3785 y Fk(10.7.1)99 b(Three)24 b(Categories)i(of)f
(Union)221 3976 y Fs(Befor)n(e)20 b(we)h(continue,)f(it)i(is)f
(important)f(to)h(understand)e(that)i(unions)f(can)i(be)f(classi\002ed)
g(into)221 4089 y(the)h(following)h(categories:)335 4335
y(1.)45 b(One)27 b(that)f(has)g(a)h(default)f(branch)h(de\002ned)e(in)h
(the)g(IDL.)g(This)g(will)h(be)f(called)i Fr(explicit)448
4448 y(default)d(union)d Fs(in)h(the)f(r)n(est)f(of)i(this)f(section.)
335 4663 y(2.)45 b(One)21 b(that)g(has)g(no)g(default)f(branch)i(and)f
(not)f(all)j(the)d(possible)g(values)h(of)g(the)f(discrim-)448
4776 y(inator)30 b(type)f(ar)n(e)h(cover)n(ed)g(by)f(the)h(branch)h
(labels)f(in)h(the)e(IDL.)g(This)h(will)h(be)f(called)448
4889 y Fr(implicit)25 b(default)f(union)p Fs(.)335 5104
y(3.)45 b(One)18 b(that)g(has)g(no)g(default)g(branch)h(but)f(all)h
(the)f(possible)f(values)h(of)g(the)f(discriminator)448
5217 y(type)22 b(ar)n(e)h(cover)n(ed.)k(This)22 b(will)i(be)e(called)i
Fr(no)f(default)h(union)p Fs(.)p 221 5306 1316 4 v 327
5362 a Fj(5)356 5394 y Fi(This)18 b(interface)h(is)f(curr)o(ently)f(an)
j(open)f(issue)e(with)j(the)f(ORB)f(r)o(evision)f(task)i(for)o(ce.)p
eop
%%Page: 117 125
117 124 bop 63 282 a Fg(10.7.)51 b(THE)22 b(DYNUNION)f(INTERF)-7
b(ACE)1647 b Fs(1)-5 b(17)204 539 y(Of)22 b(the)f(thr)n(ee)f
(categories,)h(the)f(implicit)k(default)d(union)g(is)h(inter)n(esting)e
(because)h(by)h(def-)63 652 y(inition)g(if)h(the)e(discriminator)h
(value)h(is)f(not)f(equal)h(to)f(any)h(of)g(the)f(branch)i(labels,)g
(the)e(union)63 764 y(has)h Fr(no)h Fs(member)-7 b(.)28
b(That)22 b(is,)h(the)f(union)g(value)h(consists)f(solely)g(of)g(the)g
(discriminator)h(value.)63 1024 y Fk(10.7.2)98 b(Example:)30
b(extract)25 b(data)f(values)i(from)e(a)h(union)63 1203
y Fn(10.7.2.1)92 b(Explicit)24 b(default)f(union)63 1381
y Fs(Consider)e(a)j(union)e(of)h(the)e(following)i(type:)204
1532 y Fd(//)49 b(IDL)204 1632 y Fe(union)g(exampleUnion1)e(switch)o
(\(boolean)n(\))j({)204 1732 y(case)f(TRUE)o(:)h(long)f(l;)204
1831 y(default)n(:)150 b(double)48 b(d;)204 1931 y(};)204
2096 y Fs(The)22 b(most)g(straightforwar)n(d)f(way)i(to)f(extract)g
(the)g(member)g(value)i(is)e(as)h(follows:)204 2247 y
Fd(//)49 b(C++)204 2347 y Fe(CORBA)o(::)o(ORB_ptr)g(orb)o(;)100
b Fd(//)49 b(orb)h(initialised)d(by)j(CORBA)o(::)o(ORB_init)o(.)204
2546 y Fe(Any)f(v;)204 2646 y(...)348 b Fd(//)49 b(Initialise)f(v)i(to)
f(contain)g(a)h(value)e(of)i(type)f(exampleUnion1)m(.)204
2845 y Fe(CORBA)o(::)o(DynAny_var)f(dv)i(=)g(orb)o(->create_dyn_any)m
(\(v\);)204 2945 y(CORBA)o(::)o(DynUnion_var)e(du)i(=)f(CORBA)o
(::DynUnion)n(::_narrow)o(\()o(dv\);)204 3144 y(CORBA)o(::)o
(String_var)f(di)i(=)g(du)o(->member_name)n(\(\);)204
3243 y(CORBA)o(::)o(DynAny_var)e(dm)i(=)g(du)o(->member)o(\(\);)204
3443 y(if)f(\(strcmp)o(\(\(const)f(char*\))o(di,"l)o("\))i(==)f(0\))h
({)303 3542 y Fd(//)g(branch)f(label)f(is)i(TRUE)303
3642 y Fe(CORBA)o(::Long)f(v)h(=)f(dm->get_long)n(\(\);)303
3742 y(cerr)g(<<)h("l)f(=)h(")g(<<)f(v)h(<<)f(endl)o(;)204
3841 y(})204 4040 y(if)g(\(strcmp)o(\(\(const)f(char*\))o(di,"d)o("\))i
(==)f(0\))h({)303 4140 y Fd(//)g(Is)f(default)g(branch)303
4240 y Fe(CORBA)o(::Double)g(v)g(=)h(dm->)o(get_double)n(\(\);)303
4339 y(cerr)f(<<)h("d)f(=)h(")g(<<)f(v)h(<<)f(endl)o(;)204
4439 y(})204 4604 y Fs(In)35 b(the)f(example,)k(the)c(operation)g
Ff(member_name\(\))29 b Fs(is)35 b(used)f(to)g(determine)g(which)63
4717 y(branch)21 b(the)f(union)g(has)h(been)f(instantiated.)26
b(The)20 b(operation)f Ff(member\(\))e Fs(is)k(used)e(to)h(obtain)63
4830 y(a)j(r)n(efer)n(ence)f(to)g(the)g(DynAny)f(object)i(that)f
(handles)g(the)g(member)-7 b(.)204 4944 y(Alternatively)d(,)18
b(the)e(branch)i(can)h(be)e(determined)e(by)i(r)n(eading)h(the)e
(discriminator)i(value:)204 5095 y Fd(//)49 b(C++)204
5194 y Fe(CORBA)o(::)o(DynAny_var)f(di)i(=)g(du)o(->discriminator)m
(\(\);)204 5294 y(CORBA)o(::)o(DynAny_var)e(dm)i(=)g(du)o(->member)o
(\(\);)p eop
%%Page: 118 126
118 125 bop 221 282 a Fs(1)-5 b(18)599 b Fg(CHAPTER)22
b(10.)51 b(DYNAMIC)22 b(MANAGEMENT)f(OF)h(ANY)g(V)-10
b(ALUES)362 539 y Fe(CORBA)o(::Boolean)48 b(di_v)i(=)f(di->)o
(get_boolean)n(\(\);)362 738 y(switch)g(\(di_v)o(\))h({)362
837 y(case)f(1:)462 937 y(CORBA)o(::Long)g(v)g(=)h(dm->)o(get_long)o
(\(\);)462 1037 y(cerr)f(<<)g("l)h(=)f(")h(<<)g(v)f(<<)h(endl)o(;)462
1136 y(break)o(;)362 1236 y(default)o(:)462 1336 y(CORBA)o(::Double)e
(v)i(=)g(dm)o(->get_double)n(\(\);)462 1435 y(cerr)f(<<)g("d)h(=)f(")h
(<<)g(v)f(<<)h(endl)o(;)362 1535 y(})362 1711 y Fs(The)25
b(operation)g Ff(discriminator\(\))19 b Fs(is)26 b(used)e(to)h(obtain)i
(the)d(value)j(of)f(the)f(discrimi-)221 1824 y(nator)-7
b(.)362 1942 y(Finally)d(,)21 b(the)f(thir)n(d)f(way)h(to)g(determine)e
(the)h(branch)i(is)f(to)g(test)e(if)j(the)e(default)h(is)g(selected:)
362 2100 y Fd(//)50 b(C++)362 2200 y Fe(switch)f(\(dv)o
(->set_as_default)m(\(\)\))h({)362 2300 y(case)f(1:)462
2399 y(CORBA)o(::Double)f(v)i(=)g(dm)o(->get_double)n(\(\);)462
2499 y(cerr)f(<<)g("d)h(=)f(")h(<<)g(v)f(<<)h(endl)o(;)462
2599 y(break)o(;)362 2698 y(default)o(:)462 2798 y(CORBA)o(::Long)f(v)g
(=)h(dm->)o(get_long)o(\(\);)462 2897 y(cerr)f(<<)g("l)h(=)f(")h(<<)g
(v)f(<<)h(endl)o(;)362 2997 y(})362 3174 y Fs(The)32
b(operation)g Ff(set_as_default)o(\(\))o(\(\))26 b Fs(r)n(eturns)31
b(TRUE)h(\(1\))h(if)h(the)d(discriminator)221 3286 y(has)23
b(been)f(assigned)f(a)i(valid)h(default)f(value.)221
3566 y Fn(10.7.2.2)93 b(Implicit)23 b(default)h(union)221
3752 y Fs(Consider)e(a)h(union)g(of)f(the)g(following)h(type:)362
3911 y Fd(//)50 b(IDL)362 4010 y Fe(union)f(exampleUnion2)f(switch)n
(\(long\))h({)362 4110 y(case)g(1:)h(long)f(l;)362 4210
y(case)g(2:)h(double)e(d;)362 4309 y(};)362 4486 y Fs(This)24
b(example)f(is)h(similar)h(to)e(the)g(pr)n(evious)g(one)g(but)g(ther)n
(e)g(is)g(no)h(default)f(branch.)32 b(The)221 4599 y(description)c
(above)i(also)g(applies)f(to)g(this)h(example.)48 b(However)-7
b(,)30 b(the)e(discriminator)j(may)221 4712 y(be)25 b(set)f(to)h
(neither)f(1)i(nor)f(2.)36 b(Under)24 b(this)h(condition,)g(the)g
(implicit)i(default)e(is)g(selected)f(and)221 4825 y(the)e(union)g
(value)i(contains)e(the)g(discriminator)h(only!)362 4942
y(When)e(the)g(discriminator)h(contains)g(an)g(implicit)h(default)e
(value,)i(one)d(might)i(ask)f(what)221 5055 y(is)35 b(the)f(value)h(r)n
(eturned)e(by)i(the)f Ff(member_name\(\))29 b Fs(and)35
b Ff(member\(\))c Fs(operation.)63 b(Since)221 5168 y(ther)n(e)30
b(is)h(no)f(member)h(in)g(the)f(union)h(value,)i(omniORB)e(r)n(eturns)e
(a)j(null)f(string)f(and)h(a)g(nil)221 5281 y(DynAny)e(r)n(efer)n(ence)
h(r)n(espectively)-10 b(.)49 b(This)30 b(behavior)h(is)f(not)f
(speci\002ed)g(in)i(the)e(CORBA)h(2.2)221 5394 y(speci\002cation.)50
b(T)-8 b(o)30 b(ensur)n(e)e(that)i(your)f(application)j(is)e(portable,)
h(it)f(is)h(best)e(to)g(avoid)i(call-)p eop
%%Page: 119 127
119 126 bop 63 282 a Fg(10.7.)51 b(THE)22 b(DYNUNION)f(INTERF)-7
b(ACE)1647 b Fs(1)-5 b(19)63 539 y(ing)25 b(these)f(operations)f(when)i
(the)g(DynUnion)f(object)i(might)f(contain)h(an)g(implicit)h(default)63
652 y(value.)63 903 y Fn(10.7.2.3)92 b(No)22 b(default)i(union)63
1080 y Fs(This)e(is)h(the)f(last)g(union)h(category)-10
b(.)26 b(For)c(instance:)204 1229 y Fd(//)49 b(IDL)204
1329 y Fe(union)g(exampleUnion3)e(switch)o(\(boolean)n(\))j({)204
1428 y(case)f(TRUE)o(:)h(long)f(l;)204 1528 y(case)g(FALSE)o(:)h
(double)e(d;)204 1627 y(};)204 1790 y Fs(In)17 b(this)h(example,)g(all)
i(the)d(possible)g(values)h(of)g(the)f(discriminator)h(ar)n(e)g(used)f
(as)h(union)f(la-)63 1903 y(bels.)27 b(Ther)n(e)19 b(is)i(no)f(default)
g(branch.)28 b(The)19 b(only)h(dif)n(fer)n(ence)h(between)e(this)h
(category)f(and)h(the)63 2016 y(explicit)32 b(default)g(union)g(is)h
(that)f(the)f Ff(set_as_default\()o(\))26 b Fs(operation)31
b(always)i(r)n(eturns)63 2129 y(F)-7 b(ALSE)21 b(\(0\).)63
2383 y Fk(10.7.3)98 b(Example:)30 b(insert)25 b(data)g(values)g(into)g
(a)g(union)63 2560 y Fs(W)-7 b(riting)22 b(into)h(a)g(union)g(involves)
g(selecting)e(the)h(union)h(branch)g(with)g(the)f(appr)n(opriate)g
(dis-)63 2673 y(criminator)27 b(value)f(and)g(then)f(writing)h(the)f
(member)h(value.)39 b(Ther)n(e)25 b(ar)n(e)h(thr)n(ee)f(ways)g(to)h
(set)63 2786 y(the)21 b(discriminator)j(value:)176 2998
y(1.)46 b(Use)25 b(the)g Ff(member_name\(\)\(\))19 b
Fs(write)25 b(operation)g(to)h(specify)f(the)g(union)h(branch)h(by)290
3111 y(specifying)i(the)g(union)g(member)h(dir)n(ectly)-10
b(.)49 b(This)29 b(operation)f(has)i(the)f(side)g(ef)n(fect)h(of)290
3223 y(setting)21 b(the)h(discriminator)h(to)f(the)g(label)i(value)f
(of)g(the)f(branch.)176 3411 y(2.)46 b(W)-7 b(rite)24
b(the)g(label)i(value)f(of)g(a)g(union)g(branch)g(into)g(the)f(DynAny)f
(object)i(that)f(handles)290 3524 y(the)e(discriminator)-7
b(.)176 3711 y(3.)46 b(If)23 b(the)f(union)h(has)f(a)i(default)f
(branch,)g(either)f(explicitly)h(or)g(implicitly)-10
b(,)24 b(use)e(the)g Ff(set_)290 3824 y(as_default\(\)\(\))16
b Fs(write)21 b(operation)g(to)h(set)f(the)g(discriminator)i(to)f(a)g
(valid)i(default)290 3937 y(value.)204 4149 y(The)e(following)h
(example)f(shows)f(the)h(thr)n(ee)g(ways)g(of)g(writing)h(into)f(a)h
(union:)204 4298 y Fd(//)49 b(C++)204 4397 y Fe(CORBA)o(::)o(ORB_ptr)g
(orb)o(;)100 b Fd(//)49 b(orb)h(initialised)d(by)j(CORBA)o(::)o
(ORB_init)o(.)204 4597 y Fe(CORBA)o(::)o(TypeCode_var)e(tc;)204
4696 y Fd(//)h(create)g(the)g(TypeCode)g(for)g(exampleUnion1)m(.)204
4796 y Fe(...)204 4896 y Fd(//)g(create)g(the)g(DynAny)g(object)g(to)g
(represent)f(the)h(any)h(value)204 4995 y Fe(CORBA)o(::)o(DynUnion_var)
e(dv)i(=)f(orb->)o(create_dyn_union)m(\(tc\);)204 5194
y(CORBA)o(::)o(Any_var)g(v;)204 5294 y(DynAny_ptr)f(dm)o(;)p
eop
%%Page: 120 128
120 127 bop 221 282 a Fs(120)594 b Fg(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)h(ANY)g(V)-10 b(ALUES)362
539 y Fd(//)50 b(Use)f(member_name)f(to)h(select)g(the)g(union)g
(branch)362 638 y Fe(dv->member_name)m(\("l"\);)362 738
y(dm)h(=)f(dv->member)n(\(\);)362 837 y(dm->insert_long)m(\(10\);)362
937 y(v)h(=)g(dv)o(->to_any)o(\(\);)497 b Fd(//)50 b(transfer)e(to)h
(an)h(Any)362 1037 y Fe(CORBA)o(::release)o(\()o(dm\);)362
1236 y Fd(//)g(Setting)e(the)h(discriminator)f(value)h(to)g(select)g
(the)g(union)g(branch)362 1336 y Fe(CORBA)o(::DynAny_var)f(di)h(=)h
(dv->)o(discriminator)n(\(\);)362 1435 y(di->insert_boolean)m(\(1\);)
248 b Fd(//)50 b(set)f(discriminator)e(to)j(label)f(TRUE)362
1535 y Fe(dm)h(=)f(dv->member)n(\(\);)362 1634 y(dm->insert_long)m
(\(20\);)362 1734 y(v)h(=)g(dv)o(->to_any)o(\(\);)497
b Fd(//)50 b(transfer)e(to)h(an)h(Any)362 1834 y Fe(CORBA)o(::release)o
(\()o(dm\);)362 2033 y Fd(//)g(Use)f(set_as_default)e(to)j(select)e
(the)i(default)e(union)h(branch)362 2133 y Fe(dv->set_as_default)m
(\(1\);)362 2232 y(dm)h(=)f(dv->member)n(\(\);)362 2332
y(dm->insert_double)m(\(3.14\);)362 2431 y(v)h(=)g(dv)o(->to_any)o
(\(\);)497 b Fd(//)50 b(transfer)e(to)h(an)h(Any)362
2531 y Fe(CORBA)o(::release)o(\()o(dm\);)362 2730 y(dv->destroy)n
(\(\);)221 3033 y Fn(10.7.3.1)93 b(Ambiguous)20 b(usage)335
3210 y Fs(1.)45 b(When)21 b(the)g(discriminator)h(is)g(set)e(to)h(a)h
(dif)n(fer)n(ent)f(value,)h(a)g(dif)n(fer)n(ent)g(member)f(branch)448
3323 y(is)f(selected.)25 b(Suppose)16 b(the)j(application)h(has)f(pr)n
(eviously)g(obtained)g(a)g(DynAny)g(r)n(efer)n(-)448
3436 y(ence)i(to)g(a)h(union)f(member)g(when)g(it)g(changes)g(the)f
(discriminator)i(value.)28 b(As)21 b(a)h(r)n(esult)448
3549 y(of)27 b(the)e(value)i(change,)g(the)e(union)h(is)g(now)g
(instantiated)f(to)h(another)f(union)h(branch,)448 3662
y(i.e.)19 b(a)g(call)i(to)d(the)h Ff(member\(\))c Fs(operation)j(will)i
(now)e(r)n(eturn)h(a)g(r)n(efer)n(ence)f(to)h(a)g(dif)n(fer)n(ent)448
3775 y(DynAny)27 b(object.)41 b(If)27 b(the)f(application)i(continues)e
(to)h(access)g(the)f(DynAny)g(object)h(of)448 3888 y(the)h(old)g(union)
g(member)-7 b(,)30 b(the)d(behavior)i(of)g(the)e(ORB)h(under)f(this)h
(condition)g(is)h(not)448 4001 y(de\002ned)i(by)h(the)f(CORBA)h(2.2)h
(speci\002cation.)57 b(W)-5 b(ith)32 b(omniORB,)g(the)f(DynAny)h(ob-)
448 4114 y(ject)25 b(of)g(the)f(old)h(union)g(member)f(is)h(detached)f
(fr)n(om)h(the)g(union)f(when)g(a)i(new)e(union)448 4227
y(branch)g(is)f(selected.)28 b(Ther)n(efor)n(e)21 b(r)n(eading)i(or)g
(writing)g(this)f(object)h(will)h(not)f(have)g(any)448
4340 y(r)n(elation)30 b(to)f(the)g(curr)n(ent)g(value)h(of)f(the)g
(union.)48 b(T)-8 b(o)29 b(avoid)h(this)f(ambiguity)-10
b(,)31 b(the)e(r)n(ef-)448 4452 y(er)n(ence)d(to)f(the)h(old)f(union)h
(member)g(should)g(be)g(r)n(eleased)f(befor)n(e)h(a)g(dif)n(fer)n(ent)g
(union)448 4565 y(branch)e(is)f(selected.)335 4754 y(2.)45
b(The)33 b(write)g(operation)f Ff(set_as_default)o(\(\))27
b Fs(takes)32 b(a)i(boolean)f(ar)n(gument.)59 b(It)33
b(is)448 4867 y(ambiguous)g(to)f(call)i(this)f(function)f(with)h(the)f
(ar)n(gument)g(set)f(to)h(F)-7 b(ALSE)31 b(\(0\).)59
b(W)-5 b(ith)448 4980 y(omniORB,)23 b(such)f(a)h(call)i(will)f(be)e
(silently)h(ignor)n(ed.)335 5168 y(3.)45 b(It)24 b(is)h(also)f
(ambiguous)h(to)f(pass)f(the)h(value)h(TRUE)e(\(1\))j(to)e(the)f
Ff(set_as_default\()o(\))448 5281 y Fs(operation)18 b(when)h(the)f
(union)h(is)g(a)h(no)f(default)g(union)g(\(10.7.1\).)28
b(W)-5 b(ith)19 b(omniORB,)g(such)448 5394 y(a)24 b(call)g(will)g(be)f
(silently)f(ignor)n(ed.)p eop
%%Page: 121 129
121 128 bop 63 282 a Fg(10.8.)51 b(DUPLICA)-7 b(TE)22
b(DYNANY)f(REFERENCES)1354 b Fs(121)176 539 y(4.)46 b(When)28
b(the)f(discriminator)i(value)g(is)g(not)e(set,)i(calling)h(the)d
Ff(member\(\))e Fs(operation)i(is)290 652 y(ambiguous.)40
b(W)-5 b(ith)26 b(omniORB,)h(such)f(a)i(call)g(will)g(r)n(eturn)e(a)h
(nil)h(DynAny)d(r)n(efer)n(ence.)290 764 y(Similarly)-10
b(,)29 b(a)e(call)h(to)e(the)g Ff(member_kind\(\))21
b Fs(operation)k(under)h(this)g(condition)g(will)290
877 y(r)n(eturn)c Ff(tk_null)p Fs(.)204 1090 y(T)-8 b(o)25
b(ensur)n(e)g(portability)-10 b(,)27 b(it)g(is)f(best)g(to)f(avoid)i
(using)f(the)g(DynUnion)f(interface)i(and)f(not)63 1203
y(to)19 b(r)n(ely)g(on)h(the)f(ORB)g(to)g(behave)h(as)g(omniORB)g(does)
e(under)g(these)g(ambiguous)i(conditions.)63 1501 y Fq(10.8)118
b(Duplicate)29 b(DynAny)i(References)63 1712 y Fs(Like)j(any)i(CORBA)f
(object)h(and)f(psuedo)f(object)h(r)n(efer)n(ences,)i(a)f(DynAny)f(r)n
(efer)n(ence)g(can)63 1825 y(be)28 b(duplicated)g(using)g(the)f
Ff(_duplicate\(\)\(\))22 b Fs(operations.)44 b(When)27
b(an)i(application)h(has)63 1938 y(obtained)35 b(multiple)g(DynAny)g(r)
n(efer)n(ences)f(to)h(the)g(same)g(DynAny)f(object,)39
b(it)c(should)g(be)63 2051 y(noted)27 b(that)h(a)h(change)f(made)h(to)e
(the)h(object)g(by)h(invoking)f(on)g(one)g(r)n(efer)n(ence)g(is)h(also)
f(visi-)63 2164 y(ble)f(thr)n(ough)f(the)g(other)g(r)n(efer)n(ences.)40
b(In)27 b(particular)-7 b(,)29 b(if)f(a)g(call)h(thr)n(ough)d(one)g(r)n
(efer)n(ence)h(has)63 2277 y(caused)34 b(the)f(curr)n(ent)i(component)e
(pointer)g(to)h(be)h(changed,)h(subsequent)d(calls)j(thr)n(ough)63
2390 y(other)21 b(r)n(efer)n(ences)h(will)h(operate)f(on)g(the)g(new)g
(curr)n(ent)g(component)f(pointer)-7 b(.)63 2689 y Fq(10.9)118
b(Other)29 b(Operations)63 2900 y Fs(The)22 b(following)h(is)g(a)h
(short)d(summary)i(of)g(the)g(other)e(operations)h(in)h(the)f(DynAny)g
(interface)63 3012 y(which)h(have)g(not)f(been)g(cover)n(ed)g(in)h(pr)n
(evious)f(sections:)63 3225 y Fc(assign\(\))41 b Fs(initialises)26
b(a)g(DynAny)e(object)h(with)f(another)g(DynAny)g(object.)35
b(The)24 b(two)g(ob-)290 3338 y(jects)e(must)g(have)h(the)f(same)g
(typecode.)63 3525 y Fc(from_any\(\))41 b Fs(initialises)26
b(a)f(DynAny)g(object)f(fr)n(om)i(the)e(value)i(in)g(an)f(any)-10
b(.)36 b(The)24 b(typecode)290 3638 y(in)f(the)f(two)g(objects)g(must)g
(be)g(the)g(same.)63 3826 y Fc(copy\(\))42 b Fs(cr)n(eates)27
b(a)h(new)f(DynAny)g(object)g(whose)f(value)i(is)f(a)h(deep)e(copy)h
(of)g(the)g(curr)n(ent)290 3939 y(object.)63 4127 y Fc(type\(\))42
b Fs(r)n(eturns)22 b(the)g(typecode)e(associated)i(with)g(the)g(DynAny)
g(object.)p eop
%%Page: 122 130
122 129 bop 221 282 a Fs(122)594 b Fg(CHAPTER)22 b(10.)51
b(DYNAMIC)22 b(MANAGEMENT)f(OF)h(ANY)g(V)-10 b(ALUES)p
eop
%%Page: 123 131
123 130 bop 63 1178 a Fm(Chapter)44 b(1)-6 b(1)63 1609
y Fo(The)52 b(Dynamic)f(Invocation)g(Interface)63 2085
y Fs(The)17 b(Dynamic)i(Invocation)f(Interface)f(\(or)g(DII\))h(allows)
g(applications)h(to)e(invoke)g(operations)63 2198 y(on)23
b(CORBA)g(objects)g(about)h(which)g(they)e(have)i(no)f(static)h
(information.)31 b(That)24 b(is)f(to)g(say)g(the)63 2311
y(application)29 b(has)f(not)f(been)h(linked)f(with)h(stub)g(code)f
(which)i(performs)e(the)g(r)n(emote)g(oper)n(-)63 2424
y(ation)j(invocation.)50 b(Thus)28 b(using)h(the)g(DII)h(applications)g
(may)g(invoke)g(operations)e(on)h Fr(any)63 2537 y Fs(CORBA)h(object,)i
(possibly)e(determining)g(the)f(object's)i(interface)f(dynamically)j
(by)d(using)63 2650 y(an)23 b(Interface)f(Repository)-10
b(.)204 2779 y(This)24 b(chapter)h(pr)n(esents)d(an)j(overview)g(of)g
(the)e(Dynamic)k(Invocation)e(Interface.)33 b(A)25 b(toy)63
2892 y(example)35 b(use)f(of)h(the)g(DII)g(can)h(be)f(found)g(in)h(the)
e(omniORB)h(distribution)g(in)h(the)e Ff(src/)63 3005
y(examples/dii)16 b Fs(dir)n(ectory)-10 b(.)27 b(The)22
b(DII)f(makes)h(extensive)f(use)g(of)h(the)g(type)e(Any)-10
b(,)21 b(so)h(ensur)n(e)63 3118 y(that)j(you)g(have)i(r)n(ead)e
(chapter)h(9.)38 b(For)25 b(mor)n(e)h(information)g(r)n(efer)g(to)f
(the)g(Dynamic)j(Invoca-)63 3231 y(tion)22 b(Interface)g(and)h(C++)g
(Mapping)f(sections)g(of)g(the)g(CORBA)h(speci\002cation)g([OMG99)r(].)
63 3631 y Fq(1)l(1.1)118 b(Overview)63 3875 y Fs(T)-8
b(o)29 b(invoke)g(an)i(operation)e(on)g(a)i(CORBA)f(object)g(an)g
(application)i(needs)c(an)i(object)g(r)n(efer)n(-)63
3988 y(ence,)g(the)e(name)i(of)f(the)f(operation)g(and)i(a)f(list)h(of)
f(the)f(parameters.)47 b(In)29 b(addition)g(the)f(ap-)63
4101 y(plication)f(must)e(know)g(whether)f(the)h(operation)g(is)g
(one-way)-10 b(,)26 b(what)g(user)n(-de\002ned)d(excep-)63
4214 y(tions)30 b(it)h(may)g(thr)n(ow)-8 b(,)32 b(any)f(user)n
(-context)e(strings)g(which)i(must)g(be)f(supplied,)i(a)f(`context')63
4327 y(to)26 b(take)h(these)f(values)i(fr)n(om)g(and)f(the)g(type)f(of)
h(the)g(r)n(eturned)e(value.)43 b(This)27 b(information)h(is)63
4440 y(given)i(by)f(the)h(IDL)f(interface)h(declaration,)i(and)e(so)f
(is)i(normally)f(made)g(available)j(to)c(the)63 4553
y(application)j(via)h(the)e(stub)f(code.)54 b(In)31 b(the)f(DII)h(this)
h(information)g(is)f(encapsulated)f(in)i(the)63 4666
y Ff(CORBA::Request)16 b Fs(pseudo-object.)204 4795 y(T)-8
b(o)23 b(perform)g(an)i(operation)e(invocation)i(the)e(application)i
(must)f(obtain)g(an)h(instance)f(of)63 4908 y(a)c Ff(Request)d
Fs(object,)k(supply)d(the)i(information)h(listed)e(above)h(and)h(call)h
(one)d(of)h(the)f(methods)63 5021 y(to)g(actually)i(make)f(the)g
(invocation.)28 b(If)20 b(the)f(invocation)i(causes)e(an)i(exception)e
(to)g(be)h(thr)n(own)63 5134 y(then)h(this)i(may)g(be)f(r)n(etrieved)g
(and)g(inspected,)f(or)h(the)g(r)n(eturn)g(value)h(on)g(success.)1639
5622 y(123)p eop
%%Page: 124 132
124 131 bop 221 282 a Fs(124)703 b Fg(CHAPTER)21 b(1)-5
b(1.)52 b(THE)21 b(DYNAMIC)h(INVOCA)-7 b(TION)22 b(INTERF)-7
b(ACE)221 539 y Fq(1)l(1.2)118 b(Pseudo)31 b(Objects)221
761 y Fs(The)22 b(DII)h(de\002nes)e(a)i(number)g(of)g(psuedo-object)d
(types,)h(all)j(de\002ned)d(in)i(the)f Ff(CORBA)f Fs(names-)221
874 y(pace.)39 b(These)25 b(objects)g(behave)i(in)g(many)f(ways)g(like)
g(CORBA)h(objects.)38 b(They)25 b(should)g(only)221 987
y(be)d(accessed)g(by)g(r)n(efer)n(ence)g(\(thr)n(ough)f
Ff(foo_ptr)e Fs(or)j Ff(foo_var)p Fs(\),)d(may)k(not)f(be)g
(instantiated)221 1099 y(dir)n(ectly)27 b(and)f(should)g(be)g(r)n
(eleased)g(by)h(calling)h Ff(CORBA::release)o(\(\))2820
1066 y Fl(1)2851 1099 y Fs(.)40 b(A)26 b(nil)i(r)n(efer)n(ence)221
1212 y(should)22 b(only)g(be)h(r)n(epr)n(esented)c(by)k
Ff(foo::_nil\(\))p Fs(.)362 1331 y(These)j(pseudo)f(objects,)j
(although)f(de\002ned)e(in)j(pseudo-IDL)d(in)j(the)e(speci\002cation)i
(do)221 1444 y(not)18 b(follow)g(the)g(normal)h(mapping)f(for)g(CORBA)g
(objects.)26 b(In)18 b(particular)h(the)f(memory)f(man-)221
1557 y(agement)28 b(r)o(ules)h(ar)n(e)h(dif)n(fer)n(ent\227see)d(the)h
(CORBA)i(2.3)f(speci\002cation)h([OMG99)r(])f(for)g(mor)n(e)221
1670 y(details.)e(New)21 b(instances)g(of)g(these)f(objects)h(may)h
(only)f(be)g(cr)n(eated)g(by)g(the)g(ORB.)g(A)g(number)221
1782 y(of)i(methods)e(ar)n(e)i(de\002ned)d(in)k Ff(CORBA::ORB)18
b Fs(to)k(do)g(this.)221 2071 y Fk(1)l(1.2.1)99 b(Request)221
2259 y Fs(A)31 b Ff(Request)c Fs(encapsulates)j(a)h(single)f(operation)
g(invocation.)53 b(It)30 b(may)h Fr(not)g Fs(be)f(r)n(e-used\227)221
2372 y(even)22 b(for)h(another)f(call)i(with)e(the)g(same)h(ar)n
(guments.)362 2532 y Fe(class)49 b(Request)g({)362 2632
y(public)o(:)462 2732 y(virtual)f(Object_ptr)397 b(target)o(\(\))49
b(const)o(;)462 2831 y(virtual)f(const)h(char*)348 b(operation)n(\(\))
50 b(const)o(;)462 2931 y(virtual)e(NVList_ptr)397 b(arguments)n(\(\);)
462 3031 y(virtual)48 b(NamedValue_ptr)197 b(result)o(\(\);)462
3130 y(virtual)48 b(Environment_ptr)147 b(env\(\);)462
3230 y(virtual)48 b(ExceptionList_ptr)f(exceptions)n(\(\);)462
3329 y(virtual)h(ContextList_ptr)147 b(contexts)o(\(\);)462
3429 y(virtual)48 b(Context_ptr)347 b(ctxt)o(\(\))50
b(const)o(;)462 3529 y(virtual)e(void)697 b(ctx\()o(Context_ptr)n(\);)
462 3728 y(virtual)48 b(Any&)h(add_in_arg)o(\(\);)462
3828 y(virtual)f(Any&)h(add_in_arg)o(\()o(const)g(char*)g(name)o(\);)
462 3927 y(virtual)f(Any&)h(add_inout_arg)n(\(\);)462
4027 y(virtual)f(Any&)h(add_inout_arg)n(\(const)g(char)o(*)h(name)o
(\);)462 4126 y(virtual)e(Any&)h(add_out_arg)n(\(\);)462
4226 y(virtual)f(Any&)h(add_out_arg)n(\(const)g(char)o(*)h(name)o(\);)
462 4425 y(virtual)e(void)h(set_return_type)n(\(TypeCode_ptr)e(tc\);)
462 4525 y(virtual)h(Any&)h(return_value)n(\(\);)462
4724 y(virtual)f(Status)99 b(invoke)o(\(\);)462 4824
y(virtual)48 b(Status)99 b(send_oneway)n(\(\);)462 4924
y(virtual)48 b(Status)99 b(send_deferred)n(\(\);)462
5023 y(virtual)48 b(Status)99 b(get_response)n(\(\);)462
5123 y(virtual)48 b(Boolean)h(poll_response)n(\(\);)p
221 5306 1316 4 v 327 5362 a Fj(1)356 5394 y Fi(if)18
b(not)h(managed)g(by)g(a)g Fh(_var)f Fi(type.)p eop
%%Page: 125 133
125 132 bop 63 282 a Fg(1)-5 b(1.2.)51 b(PSEUDO)23 b(OBJECTS)2150
b Fs(125)303 539 y Fe(static)49 b(Request_ptr)f(_duplicate)n
(\(Request_ptr)n(\);)303 638 y(static)h(Request_ptr)f(_nil)o(\(\);)204
738 y(};)63 1056 y Fk(1)l(1.2.2)99 b(NamedV)-11 b(alue)63
1236 y Fs(A)30 b(pair)g(consisting)f(of)i(a)f(string)g(and)g(a)g
(value\227encapsulated)g(in)h(an)f(Any)-10 b(.)50 b(The)29
b(name)h(is)63 1349 y(optional.)d(This)c(type)e(is)i(used)e(to)h
(encapsulate)g(parameters)f(and)i(r)n(eturned)e(values.)204
1502 y Fe(class)49 b(NamedValue)f({)204 1601 y(public)o(:)303
1701 y(virtual)h(const)g(char)o(*)h(name)o(\(\))f(const)o(;)303
1801 y Fd(//)h(Retains)e(ownership)h(of)g(return)g(value)o(.)303
2000 y Fe(virtual)g(Any)o(*)h(value)o(\(\))g(const)o(;)303
2099 y Fd(//)g(Retains)e(ownership)h(of)g(return)g(value)o(.)303
2299 y Fe(virtual)g(Flags)g(flags)o(\(\))g(const)o(;)303
2498 y(static)g(NamedValue_ptr)e(_duplicate)n(\(NamedValue_ptr)n(\);)
303 2598 y(static)i(NamedValue_ptr)e(_nil\(\);)204 2697
y(};)63 3015 y Fk(1)l(1.2.3)99 b(NVList)63 3195 y Fs(A)22
b(list)h(of)g Ff(NamedValue)18 b Fs(objects.)204 3348
y Fe(class)49 b(NVList)f({)204 3448 y(public)o(:)303
3547 y(virtual)h(ULong)g(count)o(\(\))g(const)o(;)303
3647 y(virtual)g(NamedValue_ptr)e(add\()o(Flags)o(\);)303
3747 y(virtual)i(NamedValue_ptr)e(add_item)o(\()o(const)i(char*,)g
(Flags)o(\);)303 3846 y(virtual)g(NamedValue_ptr)e(add_value)n(\(const)
i(char)o(*,)h(const)f(Any)o(&,)h(Flags)o(\);)303 3946
y(virtual)f(NamedValue_ptr)e(add_item_consume)m(\(char)o(*,Flags)o(\);)
303 4045 y(virtual)i(NamedValue_ptr)e(add_value_consume)m(\(char)o(*,)i
(Any*,)g(Flags)o(\);)303 4145 y(virtual)g(NamedValue_ptr)e(item)o
(\(ULong)i(index)o(\);)303 4245 y(virtual)g(Status)g(remove)f(\(ULong)o
(\);)303 4444 y(static)h(NVList_ptr)f(_duplicate)n(\(NVList_ptr)n(\);)
303 4544 y(static)h(NVList_ptr)f(_nil)o(\(\);)204 4643
y(};)63 4961 y Fk(1)l(1.2.4)99 b(Context)63 5141 y Fs(Repr)n(esents)19
b(a)k(set)f(of)h(context)e(strings.)204 5294 y Fe(class)49
b(Context)f({)204 5394 y(public)o(:)p eop
%%Page: 126 134
126 133 bop 221 282 a Fs(126)703 b Fg(CHAPTER)21 b(1)-5
b(1.)52 b(THE)21 b(DYNAMIC)h(INVOCA)-7 b(TION)22 b(INTERF)-7
b(ACE)462 539 y Fe(virtual)48 b(const)h(char*)g(context_name)n(\(\))g
(const)o(;)462 638 y(virtual)f(CORBA)o(::Context_ptr)g(parent)o(\(\))h
(const)o(;)462 738 y(virtual)f(CORBA)o(::Status)h(create_child)n(\()o
(const)g(char*,)g(Context_out)n(\);)462 837 y(virtual)f(CORBA)o
(::Status)h(set_one_value)m(\(const)g(char)o(*,)h(const)f(CORBA)o(::)o
(Any&\);)462 937 y(virtual)f(CORBA)o(::Status)h(set_values)n(\(CORBA)o
(::)o(NVList_ptr)o(\);)462 1037 y(virtual)f(CORBA)o(::Status)h
(delete_values)m(\(const)g(char)o(*\);)462 1136 y(virtual)f(CORBA)o
(::Status)h(get_values)n(\(const)g(char)o(*)h(start_scope)m(,)2106
1236 y(CORBA)o(::)o(Flags)f(op_flags)o(,)2106 1336 y(const)g(char)o(*)h
(pattern)n(,)2106 1435 y(CORBA)o(::)o(NVList_out)e(values)o(\);)462
1535 y Fd(//)h(Throws)g(BAD_CONTEXT)f(if)h(<start_scope)n(>)h(is)f(not)
g(found)o(.)462 1634 y(//)g(Returns)g(a)g(nil)h(NVList)e(in)i(<values)o
(>)f(if)h(no)f(matches)g(are)g(found)o(.)462 1834 y Fe(static)g
(Context_ptr)e(_duplicate)o(\()o(Context_ptr)n(\);)462
1933 y(static)i(Context_ptr)e(_nil\(\);)362 2033 y(};)221
2332 y Fk(1)l(1.2.5)99 b(ContextList)221 2508 y Fs(A)26
b Ff(ContextList)21 b Fs(is)27 b(a)f(list)h(of)f(strings,)f(and)h(is)h
(used)d(to)i(specify)g(which)g(strings)f(fr)n(om)i(the)221
2621 y(`context')22 b(should)g(be)g(sent)g(with)g(an)h(operation.)362
2767 y Fe(class)49 b(ContextList)f({)362 2867 y(public)o(:)462
2966 y(virtual)g(ULong)h(count)o(\(\))h(const)o(;)462
3066 y(virtual)e(void)h(add\(const)g(char)o(*)h(ctxt)o(\);)462
3165 y(virtual)e(void)h(add_consume)n(\(char*)g(ctxt)o(\);)462
3265 y Fd(//)g(consumes)g(ctxt)462 3464 y Fe(virtual)f(const)h(char*)g
(item)o(\(ULong)g(index)o(\);)462 3564 y Fd(//)g(retains)g(ownership)f
(of)h(return)g(value)462 3763 y Fe(virtual)f(Status)h(remove)o(\(ULong)
g(index)o(\);)462 3962 y(static)g(ContextList_ptr)e(_duplicate)n
(\(ContextList_ptr)m(\);)462 4062 y(static)i(ContextList_ptr)e(_nil)o
(\(\);)362 4162 y(};)221 4460 y Fk(1)l(1.2.6)99 b(ExceptionList)221
4637 y Ff(ExceptionList)p Fs(s)31 b(contain)38 b(a)h(list)e(of)h(T)-8
b(ypeCodes\227and)34 b(ar)n(e)k(used)f(to)f(specify)h(which)221
4750 y(user)n(-de\002ned)20 b(exceptions)h(an)i(operation)f(may)h(thr)n
(ow)-8 b(.)362 4896 y Fe(class)49 b(ExceptionList)f({)362
4995 y(public)o(:)462 5095 y(virtual)g(ULong)h(count)o(\(\))h(const)o
(;)462 5194 y(virtual)e(void)h(add\(TypeCode_ptr)e(tc\);)462
5294 y(virtual)h(void)h(add_consume)n(\(TypeCode_ptr)f(tc)o(\);)462
5394 y Fd(//)h(Consumes)g(<)o(tc>.)p eop
%%Page: 127 135
127 134 bop 63 282 a Fg(1)-5 b(1.2.)51 b(PSEUDO)23 b(OBJECTS)2150
b Fs(127)303 638 y Fe(virtual)49 b(TypeCode_ptr)f(item)o(\(ULong)g
(index\);)303 738 y Fd(//)i(Retains)e(ownership)h(of)g(return)g(value)o
(.)303 937 y Fe(virtual)g(Status)g(remove)o(\()o(ULong)g(index)o(\);)
303 1136 y(static)g(ExceptionList_ptr)e(_duplicate)n
(\(ExceptionList_ptr)m(\);)303 1236 y(static)i(ExceptionList_ptr)e
(_nil)o(\(\);)204 1336 y(};)63 1669 y Fk(1)l(1.2.7)99
b(UnknownUserException)63 1853 y Fs(When)26 b(a)h(user)n(-de\002ned)e
(exception)g(is)i(thr)n(own)f(by)h(an)g(operation)f(it)h(is)g
(unmarshalled)g(into)63 1966 y(a)h(value)h(of)f(type)f(Any)-10
b(.)43 b(This)28 b(is)g(encapsulated)f(in)h(an)h Ff(UnknownUserExc)o
(ep)o(tio)o(n)p Fs(.)38 b(This)63 2079 y(type)c(follows)i(all)i(the)d
(usual)h(r)o(ules)g(for)g(user)n(-de\002ned)e(exceptions\227it)g(is)j
(not)e(a)i(pseudo)63 2192 y(object,)22 b(and)g(its)h(r)n(esour)n(ces)e
(may)i(be)g(r)n(eleased)e(by)i(using)f Ff(delete)p Fs(.)204
2348 y Fe(class)49 b(UnknownUserException)d(:)j(public)g(UserException)
e({)204 2448 y(public)o(:)303 2548 y(UnknownUserException)m(\(Any)o(*)j
(ex)o(\);)303 2647 y Fd(//)g(Consumes)e(<ex>)h(which)g(MUST)g(be)h(a)f
(UserException)n(.)303 2847 y Fe(virtual)g(~UnknownUserException)l
(\(\);)303 3046 y(Any&)g(exception)o(\(\);)303 3245 y(virtual)g(void)g
(_raise)o(\(\);)303 3345 y(static)g(const)g(UnknownUserException)l(*)h
(_downcast)n(\(const)f(Exception)n(*\);)303 3444 y(static)g
(UnknownUserException)l(*)h(_downcast)n(\(Exception)n(*\);)303
3544 y(static)f(UnknownUserException)l(*)h(_narrow)o(\(Exception)n
(*\);)303 3644 y Fd(//)g(_narrow)e(is)i(a)f(deprecated)f(function)h
(from)g(CORBA)g(2.2,)303 3743 y(//)h(use)f(_downcast)f(instead)o(.)204
3843 y Fe(};)63 4176 y Fk(1)l(1.2.8)99 b(Environment)63
4360 y Fs(An)33 b Ff(Environment)c Fs(is)34 b(used)e(to)h(hold)h(an)g
(instance)g(of)f(a)i(system)d(exception)g(or)i(an)g Ff(Un-)63
4473 y(knownUserExcep)o(ti)o(on)o Fs(.)204 4630 y Fe(class)49
b(Environment)e({)303 4729 y(virtual)i(void)g(exception)n(\(Exception)n
(*\);)303 4829 y(virtual)g(Exception)n(*)h(exception)n(\(\))g(const)o
(;)303 4929 y(virtual)f(void)g(clear)o(\(\);)303 5128
y(static)g(Environment_ptr)e(_duplicate)n(\(Environment_ptr)m(\);)303
5227 y(static)i(Environment_ptr)e(_nil)o(\(\);)204 5327
y(};)p eop
%%Page: 128 136
128 135 bop 221 282 a Fs(128)703 b Fg(CHAPTER)21 b(1)-5
b(1.)52 b(THE)21 b(DYNAMIC)h(INVOCA)-7 b(TION)22 b(INTERF)-7
b(ACE)221 539 y Fq(1)l(1.3)118 b(Creating)30 b(Requests)221
754 y Ff(CORBA::Object)20 b Fs(de\002nes)k(thr)n(ee)g(methods)g(which)i
(may)g(be)f(used)g(to)g(cr)n(eate)g(a)h Ff(Request)221
867 y Fs(object)d(which)g(may)g(be)f(used)g(to)f(perform)h(a)i(single)e
(operation)f(invocation)j(on)e(that)g(object:)362 1020
y Fe(class)49 b(Object)g({)462 1120 y(...)462 1220 y(Status)g
(_create_request)m(\(Context_ptr)e(ctx,)1608 1319 y(const)i(char)o(*)g
(operation)o(,)1608 1419 y(NVList_ptr)f(arg_list)n(,)1608
1519 y(NamedValue_ptr)f(result)o(,)1608 1618 y(Request_out)g(request)o
(,)1608 1718 y(Flags)i(req_flags)n(\);)462 1917 y(Status)g
(_create_request)m(\(Context_ptr)e(ctx,)1608 2017 y(const)i(char)o(*)g
(operation)o(,)1608 2116 y(NVList_ptr)f(arg_list)n(,)1608
2216 y(NamedValue_ptr)f(result)o(,)1608 2316 y(ExceptionList_ptr)f
(exceptions)n(,)1608 2415 y(ContextList_ptr)h(ctxlist)n(,)1608
2515 y(Request_out)g(request)o(,)1608 2614 y(Flags)i(req_flags)n(\);)
462 2814 y(Request_ptr)f(_request)n(\(const)h(char)o(*)h(operation)n
(\);)462 2913 y(...)362 3013 y(};)362 3182 y Ff(operation)16
b Fs(is)j(the)g(name)h(of)f(the)g(operation\227which)g(is)g(the)g(same)
g(as)h(the)e(name)i(given)221 3295 y(in)j(IDL.)f(T)-8
b(o)22 b(access)h(attributes)e(the)h(name)h(should)e(be)i(pr)n
(e\002xed)e(by)i Ff(_get_)d Fs(or)i Ff(_set_)p Fs(.)362
3410 y(In)17 b(the)g(\002rst)f(two)h(cases)g(above)h(the)e(list)i(of)f
(parameters)f(may)i(be)f(supplied.)25 b(If)17 b(the)g(param-)221
3523 y(eters)23 b(ar)n(e)i(not)g(supplied)e(in)i(these)e(cases,)i(or)f
Ff(_request\(\))d Fs(is)k(used)e(then)h(the)g(parameters)221
3636 y(\(if)i(any\))f(may)g(be)f(speci\002ed)f(using)h(the)g
Ff(add_*_arg\(\))c Fs(methods)j(on)h(the)g Ff(Request)p
Fs(.)30 b(Y)-8 b(ou)221 3749 y(must)28 b(use)g(one)g(method)f(or)i(the)
f(other)n(\227not)f(a)i(mixtur)n(e)g(of)g(the)e(two.)46
b(For)28 b Fr(in)p Fs(/)p Fr(inout)h Fs(ar)n(gu-)221
3862 y(ments)20 b(the)g(value)h(must)f(be)g(initialised,)i(for)f
Fr(out)g Fs(ar)n(guments)e(only)i(the)f(type)f(need)g(be)h(given.)221
3975 y(Similarly)26 b(the)d(type)f(of)i(the)f(r)n(esult)g(may)h(be)g
(speci\002ed)e(by)i(passing)f(a)h Ff(NamedValue)19 b
Fs(which)221 4087 y(contains)g(an)h(Any)e(which)i(has)f(been)f
(initialised)i(to)e(contain)i(a)f(value)h(of)f(that)g(type,)f(or)g(it)i
(may)221 4200 y(be)j(speci\002ed)e(using)h(the)g Ff(set_return_type)o
(\(\))16 b Fs(method)21 b(of)i Ff(Request)p Fs(.)362
4315 y(When)c(using)f Ff(_create_request)o(\(\))p Fs(,)13
b(the)19 b(management)f(of)h(any)h(pseudo-object)d(r)n(ef-)221
4428 y(er)n(ences)31 b(passed)f(in)i(r)n(emains)g(the)f(r)n
(esponsibility)h(of)f(the)g(application.)57 b(That)32
b(is,)h(the)e(val-)221 4541 y(ues)i(ar)n(e)i(not)e(consumed\227and)g
(must)h(be)g(r)n(eleased)f(using)g Ff(CORBA::release\(\))o
Fs(.)57 b(The)221 4654 y(CORBA)32 b(speci\002cation)g(is)f(unclear)i
(about)e(when)g(these)f(values)i(may)g(be)g(r)n(eleased,)h(so)e(to)221
4767 y(be)23 b(sur)n(e)f(of)h(portability)g(do)f(not)h(r)n(elease)f
(them)g(until)i(after)f(the)f(r)n(equest)f(has)i(been)f(r)n(eleased.)
221 4880 y(V)-8 b(alues)22 b(which)i(ar)n(e)f(not)f(needed)f(need)h
(not)g(be)h(supplied\227so)d(if)k(no)f(parameters)f(ar)n(e)h(speci-)221
4993 y(\002ed)e(then)g(it)h(defaults)f(to)g(an)h(empty)e(parameter)h
(list.)28 b(If)22 b(no)f(r)n(esult)g(type)f(is)i(speci\002ed)e(then)h
(it)221 5106 y(defaults)j(to)f(void.)32 b(A)24 b Ff(Context)d
Fs(need)h(only)i(be)g(given)g(if)h(a)f(non-empty)f Ff(ContextList)c
Fs(is)221 5219 y(speci\002ed.)27 b(The)22 b Ff(req_flags)c
Fs(ar)n(gument)k(is)h(not)f(used)f(in)i(the)f(C++)h(mapping.)p
eop
%%Page: 129 137
129 136 bop 63 282 a Fg(1)-5 b(1.4.)51 b(INVOKING)22
b(OPERA)-7 b(TIONS)1828 b Fs(129)63 539 y Fk(1)l(1.3.1)99
b(Examples)63 715 y Fs(An)22 b(operation)g(might)g(be)h(speci\002ed)e
(in)i(IDL)f(as:)204 860 y Fe(short)49 b(anOpn)o(\(in)g(string)g(a\);)63
1018 y Fs(An)22 b(operation)g(invocation)h(may)g(be)g(cr)n(eated)f(as)g
(follows:)204 1163 y Fe(CORBA)o(::)o(ORB_var)49 b(orb)g(=)h(CORBA)o
(::ORB_init)n(\(argc)o(,)g(argv)o(,)g(")o(omniORB3)o("\);)204
1263 y(...)204 1363 y(CORBA)o(::)o(NVList_var)e(args;)204
1462 y(orb)o(->create_list)n(\(1,)h(args)o(\);)204 1562
y(*\()o(args->)o(add\(CORBA)o(::)o(ARG_IN)o(\)->value)o(\(\)\))g(<<=)g
(\(const)g(char)o(*\))h(")o(Hello)f(World)o(!";)204 1761
y(CORBA)o(::)o(NamedValue_var)f(result)o(;)204 1861 y(orb)o
(->create_named_value)m(\()o(result)o(\);)204 1960 y(result)o(->)o
(value)o(\(\)->replace)n(\(CORBA)o(::_tc_short)n(,)i(0\);)204
2160 y(CORBA)o(::)o(Request_var)e(req)i(=)f(obj->)o(_create_request)m
(\(CORBA)o(::Context)o(::)o(_nil)o(\(\),)2196 2259 y("anOpn)o(",)h
(args)o(,)g(result)n(,)g(0\);)63 2417 y Fs(or)22 b(alternatively)h(and)
g(much)g(mor)n(e)f(concisely:)204 2562 y Fe(CORBA)o(::)o(Request_var)48
b(req)i(=)f(obj->)o(_request)o(\(")o(anOpn)o("\);)204
2662 y(req)o(->add_in_arg)n(\(\))g(<<=)h(\(const)e(char*\))h("Hello)g
(World)o(!")o(;)204 2761 y(req)o(->set_return_type)m(\(CORBA)o
(::_tc_short)n(\);)63 3103 y Fq(1)l(1.4)118 b(Invoking)31
b(Operations)63 3314 y Fs(Once)k(the)e Ff(Request)f Fs(object)i(has)h
(been)f(pr)n(operly)f(constr)o(ucted,)i(the)f(operation)g(may)h(be)63
3427 y(invoked)21 b(by)i(calling)h(one)e(of)h(the)f(following)g
(methods)f(on)i(the)e(r)n(equest)g(object:)63 3676 y
Fc(invoke\(\))87 b Fs(blocks)26 b(until)h(the)e(r)n(equest)g(has)h
(completed.)37 b(The)26 b(application)h(should)e(then)63
3789 y(test)31 b(to)h(see)f(if)i(an)h(exception)d(was)h(raised.)58
b(Since)32 b(the)g(CORBA)h(spec)f(is)g(not)g(clear)i(about)63
3902 y(whether)24 b(or)i(not)g(system)e(exceptions)h(should)g(be)i(thr)
n(own)e(fr)n(om)i(this)f(method,)g(a)h(r)o(untime)63
4015 y(con\002guration)22 b(variable)i(is)f(supplied)e(so)h(that)h(you)
e(can)j(specify)e(the)g(behavior:)204 4160 y Fe(namespace)48
b(omniORB)g({)303 4259 y(...)303 4359 y(CORBA)o(::Boolean)h
(diiThrowsSysExceptions)l(;)303 4458 y(...)204 4558 y(};)204
4716 y Fs(If)29 b(this)f(is)h(F)-7 b(ALSE,)27 b(and)i(the)f
(application)i(should)e(call)i(the)e Ff(env\(\))f Fs(method)h(of)g(the)
g(r)n(e-)63 4829 y(quest)33 b(to)h(r)n(etrieve)f(an)i(exception)f(\(it)
h(r)n(eturns)e(0)i(\(nil\))h(if)f(no)f(exception)f(was)i(generated\).)
63 4942 y(If)j(it)h(is)g(TRUE)f(then)g(system)f(exceptions)g(will)j(be)
f(thr)n(own)f(out)g(of)g Ff(invoke\(\))p Fs(.)73 b(User)n(-)63
5055 y(de\002ned)30 b(exceptions)g(ar)n(e)i(always)g(passed)e(via)j
Ff(env\(\))p Fs(,)e(which)i(will)g(r)n(eturn)d(a)j(pointer)d(to)63
5168 y(a)23 b Ff(CORBA::UnknownU)o(se)o(rE)o(xce)o(pt)o(io)o(n)p
Fs(.)f(The)h(application)h(can)f(determine)f(which)h(type)63
5281 y(of)d(exception)f(was)h(r)n(eturned)f(by)h Ff(env\(\)\(\))d
Fs(by)k(calling)h(the)d Ff(_narrow\(\))d Fs(method)j(de\002ned)63
5394 y(for)j(each)h(exception)f(type.)p eop
%%Page: 130 138
130 137 bop 221 282 a Fs(130)703 b Fg(CHAPTER)21 b(1)-5
b(1.)52 b(THE)21 b(DYNAMIC)h(INVOCA)-7 b(TION)22 b(INTERF)-7
b(ACE)p 221 520 3289 17 v 1687 624 a Fn(W)g(arning)358
774 y Fs(In)19 b(pr)n(e-omniORB)g(2.8.0)i(r)n(eleases,)e(the)g(default)
h(value)g(of)g Ff(diiThrowsSysEx)o(ce)o(p-)358 887 y(tions)g
Fs(is)j(F)-7 b(ALSE.)20 b(Fr)n(om)j(omniORB)g(2.8.0)g(onwar)n(ds,)f
(the)g(default)g(value)h(is)g(TRUE.)p 221 972 V 362 1102
a(After)k(determining)f(that)h(no)g(exception)f(was)h(thr)n(own)g(the)f
(application)j(may)f(r)n(etrieve)221 1215 y(any)23 b(r)n(eturned)e
(values)i(by)f(calling)i Ff(return_value\(\))17 b Fs(and)22
b Ff(arguments\(\))p Fs(.)221 1465 y Fc(send_oneway\(\))85
b Fs(has)33 b(the)f(same)g(semantics)h(as)f(a)i Fr(oneway)f
Fs(IDL)f(operation.)57 b(It)32 b(is)h(im-)221 1578 y(portant)24
b(to)f(note)h(that)g(oneway)f(operations)g(have)i(at-most-once)f
(semantics,)g(and)h(it)f(is)h(not)221 1691 y(guaranteed)f(that)h(they)f
(will)j(not)d(block.)36 b(Any)25 b(operation)f(may)i(be)f(invoked)f
(`oneway')h(us-)221 1804 y(ing)33 b(the)e(DII,)h(even)g(if)h(it)f(was)h
(not)e(declar)n(ed)i(as)f(`oneway')g(in)h(IDL.)f(A)g(system)e
(exception)221 1917 y(may)22 b(be)f(generated,)f(in)i(which)g(case)f
(it)h(will)h(either)d(be)i(thr)n(own)f(or)g(may)h(be)f(r)n(etrieved)g
(using)221 2030 y Ff(env\(\))g Fs(depending)f(on)i Ff(diiThrowsSysExc)o
(ept)o(io)o(ns)16 b Fs(as)23 b(above.)221 2280 y Fc(send_deferred\(\))
84 b Fs(initiates)34 b(the)f(invocation,)k(and)c(then)g(r)n(eturns)f
(without)h(waiting)221 2393 y(for)g(the)g(r)n(esult.)59
b(At)33 b(some)f(point)h(in)h(the)e(futur)n(e)h(the)g(application)h
(must)f(r)n(etrieve)f(the)h(r)n(e-)221 2506 y(sult)d(of)h(the)e
(operation\227but)g(other)h(than)g(testing)f(for)h(completion)g(of)h
(the)e(operation)h(the)221 2619 y(application)24 b(must)e(not)g(call)i
(any)f(of)g(the)e(r)n(equest's)g(methods)g(in)i(the)f(meantime.)358
2823 y Fp(\017)45 b Ff(get_response\(\))17 b Fs(blocks)22
b(until)h(the)f(r)n(eply)g(is)h(r)n(eceived.)358 3007
y Fp(\017)45 b Ff(poll_response\(\))14 b Fs(r)n(eturns)19
b(TRUE)g(if)i(the)e(r)n(eply)h(has)g(been)f(r)n(eceived,)h(and)h(F)-7
b(ALSE)448 3120 y(if)24 b(not.)j(It)22 b(does)f(not)h(block.)362
3324 y(Once)j Ff(poll_response\()o(\))18 b Fs(has)24
b(r)n(eturned)e(TRUE,)g(or)i Ff(get_response\(\))18 b
Fs(has)24 b(been)221 3437 y(called)39 b(and)e(r)n(eturned,)j(the)c
(application)j(may)f(test)e(for)i(an)g(exception)e(and)i(r)n(etrieve)f
(r)n(e-)221 3550 y(turned)d(values)i(as)g(above.)67 b(If)36
b Ff(diiThrowsSysEx)o(ce)o(pt)o(ion)o(s)29 b Fs(is)36
b(tr)o(ue,)i(then)d(a)h(system)221 3663 y(exception)19
b(may)h(be)g(thr)n(own)f(fr)n(om)h Ff(get_response\(\))p
Fs(.)h(Fr)n(om)e(omniORB)h(2.8.0)h(onwar)n(ds,)221 3776
y Ff(poll_response\(\))h Fs(will)30 b(raise)e(a)h(system)e(exception)g
(if)j(one)d(has)i(occurr)n(ed)f(during)g(the)221 3889
y(invocation.)63 b(Pr)n(eviously)-10 b(,)37 b Ff(poll_response\()o(\))
28 b Fs(would)33 b(not)h(raise)g(an)g(exception,)i(so)d(if)221
4002 y(polling,)25 b(the)e(application)j(also)e(had)g(to)g(call)i
(another)e(method)f(to)g(give)i(the)e(r)n(equest)g(an)h(op-)221
4115 y(portunity)16 b(to)h(raise)g(the)g(exception.)25
b(This)17 b(could)g(be)h(one)e(of)i(the)e(methods)g(to)h(r)n(etrieve)g
(values)221 4228 y(fr)n(om)23 b(the)f(r)n(equest,)f(or)h
Ff(get_response\(\))p Fs(.)221 4525 y Fq(1)l(1.5)118
b(Multiple)29 b(Requests)221 4736 y Fs(The)22 b(following)h(methods)f
(ar)n(e)h(pr)n(ovided)f(by)h(the)f(ORB)g(to)h(enable)g(multiple)g(r)n
(equests)e(to)h(be)221 4849 y(invoked)g(asynchr)n(onously)-10
b(.)362 4995 y Fe(namespace)48 b(CORBA)h({)462 5095 y(...)462
5194 y(class)g(ORB)g({)462 5294 y(public)o(:)562 5394
y(...)p eop
%%Page: 131 139
131 138 bop 63 282 a Fg(1)-5 b(1.5.)51 b(MUL)-7 b(TIPLE)21
b(REQUESTS)1977 b Fs(131)403 539 y Fe(Status)49 b
(send_multiple_requests_oneway)-6 b(\(const)49 b(RequestSeq)n(&\);)403
638 y(Status)g(send_multiple_requests_deferred)-6 b(\(const)49
b(RequestSeq)n(&\);)403 738 y(Boolean)g(poll_next_response)l(\(\);)403
837 y(Status)g(get_next_response)m(\()o(Request_out)n(\);)403
937 y(...)303 1037 y(};)303 1136 y(...)204 1236 y(};)63
1537 y Fc(send_multiple_)o(re)o(qu)o(est)o(s_)o(on)o(ew)o(ay)o(\(\))84
b Fs(is)20 b(used)d(to)i(invoke)g(a)g(number)g(of)h(oneway)63
1650 y(r)n(equests.)42 b(An)28 b(attempt)g(will)h(be)f(made)g(to)g
(invoke)g(each)h(of)f(the)f(r)n(equests,)h(even)f(if)i(one)f(or)63
1763 y(mor)n(e)i(of)h(the)f(early)h(r)n(equests)e(fails.)54
b(The)30 b(application)i(may)f(check)g(for)g(failur)n(e)h(of)f(any)g
(of)63 1876 y(the)25 b(r)n(equests)e(by)j(testing)f(the)g(r)n(equest's)
f Ff(env\(\))f Fs(method.)37 b(System)24 b(exceptions)g(ar)n(e)i(never)
63 1989 y(raised)c(by)g(this)h(method.)63 2240 y Fc(send_multiple_)o
(re)o(qu)o(est)o(s_)o(de)o(fe)o(rr)o(ed\()o(\))85 b Fs(will)36
b(initiate)g(an)g(invocation)g(of)f(each)63 2353 y(of)17
b(the)g(given)h(r)n(equests,)e(and)h(r)n(eturn)g(without)g(waiting)h
(for)f(the)g(r)n(eply)-10 b(.)26 b(At)17 b(some)f(point)h(in)h(the)63
2466 y(futur)n(e)i(the)g(application)i(must)e(r)n(etrieve)g(the)g(r)n
(eply)g(by)h(calling)h Ff(get_next_respons)o(e\()o(\))p
Fs(,)63 2579 y(which)f(r)n(eturns)e(a)i(completed)e(r)n(equest.)26
b(If)20 b(no)g(r)n(equests)f(have)h(yet)g(completed)f(it)i(will)g
(block.)63 2692 y(This)g(method)g(never)g(thr)n(ows)g
(exceptions\227the)e(r)n(equest's)h Ff(env\(\))g Fs(method)g(must)h(be)
h(used)63 2805 y(to)k(determine)f(if)j(an)f(exception)f(was)h
(generated.)38 b(If)27 b(not)f(then)g(any)h(r)n(eturned)e(values)i(may)
63 2918 y(then)21 b(be)i(queried.)204 3031 y Ff(poll_next_resp)o(ons)o
(e\()o(\))d Fs(r)n(eturns)25 b(TRUE)g(if)i(ther)n(e)f(ar)n(e)h(any)f
(completed)f(r)n(equests,)63 3144 y(and)36 b(F)-7 b(ALSE)35
b(otherwise,)j(without)d(blocking.)70 b(If)37 b(this)f(r)n(eturns)f(tr)
o(ue)h(then)f(the)h(next)g(call)63 3257 y(to)26 b Ff(get_next_respon)o
(se\()o(\))21 b Fs(will)29 b(not)d(block.)42 b(However)-7
b(,)27 b(if)i(another)d(thr)n(ead)h(may)g(also)63 3369
y(be)e(calling)i Ff(get_next_respon)o(se)o(\(\))19 b
Fs(then)25 b(it)g(could)g(r)n(etrieve)g(the)g(completed)f(message)63
3482 y(\002rst\227in)e(which)h(case)g(this)f(thr)n(ead)g(might)g
(block.)204 3595 y(Ther)n(e)e(ar)n(e)h(no)g(guarantee)f(as)h(to)f(the)h
(or)n(der)f(in)h(which)h(r)n(eplies)e(will)j(be)e(r)n(eceived.)27
b(If)21 b(mul-)63 3708 y(tiple)29 b(thr)n(eads)g(ar)n(e)i(using)e(this)
h(interface)g(then)f(it)h(is)g(not)f(even)h(guaranteed)e(that)i(a)g
(thr)n(ead)63 3821 y(will)i(r)n(eceive)e(r)n(eplies)g(to)g(the)g(r)n
(equests)f(it)h(sent.)51 b(Any)30 b(thr)n(ead)g(may)h(r)n(eceive)f(r)n
(eplies)g(to)g(r)n(e-)63 3934 y(quests)20 b(sent)i(by)h(any)f(other)g
(thr)n(ead.)27 b(It)c(is)f(legal)i(to)e(call)i Ff(get_next_respons)o
(e\()o(\))17 b Fs(even)22 b(if)63 4047 y(no)k(r)n(equests)f(have)j(yet)
e(been)g(invoked\227in)h(which)g(case)g(the)g(calling)i(thr)n(ead)d
(blocks)h(until)63 4160 y(another)21 b(thr)n(ead)h(invokes)g(a)h(r)n
(equest)e(and)i(the)f(r)n(eply)g(is)h(r)n(eceived.)p
eop
%%Page: 132 140
132 139 bop 221 282 a Fs(132)703 b Fg(CHAPTER)21 b(1)-5
b(1.)52 b(THE)21 b(DYNAMIC)h(INVOCA)-7 b(TION)22 b(INTERF)-7
b(ACE)p eop
%%Page: 133 141
133 140 bop 63 1163 a Fm(Chapter)44 b(12)63 1580 y Fo(The)52
b(Dynamic)f(Skeleton)h(Interface)63 2042 y Fs(The)18
b(Dynamic)j(Skeleton)c(Interface)i(\(or)g(DSI\))g(allows)h
(applications)g(to)e(pr)n(ovide)h(implemen-)63 2154 y(tations)30
b(of)h(the)f(operations)f(on)i(CORBA)g(objects)f(without)g(static)h
(knowledge)d(of)j(the)f(ob-)63 2267 y(ject's)19 b(interface.)27
b(It)19 b(is)h(the)f(server)n(-side)f(equivalent)i(of)g(the)f(Dynamic)i
(Invocation)e(Interface.)204 2382 y(This)k(chapter)h(pr)n(esents)d(the)
j(Dynamic)h(Skeleton)d(Interface)h(and)h(explains)g(how)f(to)h(use)63
2495 y(it.)62 b(A)34 b(toy)g(example)g(use)f(of)h(the)f(DSI)i(can)g(be)
f(found)f(in)i(the)e(omniORB)i(distribution)e(in)63 2608
y(the)25 b Ff(src/examples/dsi)20 b Fs(dir)n(ectory)-10
b(.)38 b(For)26 b(further)g(information)h(r)n(efer)f(to)g(the)g
(Dynamic)63 2721 y(Skeleton)20 b(Interface)i(and)h(C++)g(Mapping)g
(sections)e(of)i(the)f(CORBA)g(2.3)i(speci\002cation.)204
2836 y(The)h(DSI)h(interface)h(has)f(changed)g(in)g(CORBA)h(2.3.)39
b(omniORB)26 b(3)h(uses)e(the)g(new)h(map-)63 2949 y(ping,)36
b(but)e(since)h(the)e(mapping)i(depends)c(on)j Ff(PortableServer::)o
(Cu)o(rr)o(en)o(t)p Fs(,)d(which)63 3062 y(is)f(not)g(yet)f
(implemented,)i(not)f(all)i(facilities)g(ar)n(e)f(available.)55
b(This)30 b(chapter)g(describes)f(an)63 3175 y(appr)n(oach)23
b(to)f(building)h(DSI)f(servers)f(which)j(works)d(with)h(omniORB)h(3.)
63 3486 y Fq(12.1)118 b(Overview)63 3701 y Fs(When)26
b(an)h(ORB)f(r)n(eceives)g(an)h(invocation)h(r)n(equest,)e(the)f
(information)j(includes)e(the)g(object)63 3814 y(r)n(efer)n(ence)d(and)
h(the)g(name)g(of)g(the)g(operation.)31 b(T)-8 b(ypically)25
b(this)f(information)g(is)h(used)d(by)i(the)63 3927 y(ORB)31
b(to)g(select)f(a)i(servant)f(object)g(and)h(call)h(into)e(the)f
(implementation)i(of)f(the)g(operation)63 4040 y(\(which)c(knows)e(how)
h(to)g(unmarshal)i(the)e(parameters)f(etc.\).)40 b(The)26
b(Dynamic)i(Skeleton)d(In-)63 4153 y(terface)30 b(however)g(makes)g
(this)g(information)i(dir)n(ectly)e(available)k(to)c(the)g
(application\227so)63 4266 y(that)23 b(it)h(can)h(implement)f(the)f
(operation)g(\(or)g(pass)h(it)g(on)f(to)g(another)g(server\))g(without)
g(static)63 4379 y(knowledge)d(of)j(the)f(interface.)28
b(In)22 b(fact)i(it)f(is)g(not)f(even)g(necessary)f(for)i(the)e(server)
h(to)g(always)63 4491 y(implement)g(the)g(same)g(interface)h(on)g(any)f
(particular)i(object!)204 4606 y(T)-8 b(o)19 b(pr)n(ovide)g(an)h
(implementation)g(for)g(one)f(or)g(mor)n(e)h(objects)f(an)h
(application)h(must)f(sub-)63 4719 y(class)30 b Ff(PortableServer)o(::)
o(Dy)o(na)o(mic)o(Im)o(pl)o(em)o(en)o(tat)o(io)o(n)23
b Fs(and)30 b(override)e(the)h(method)63 4832 y Ff(invoke\(\))p
Fs(.)38 b(An)27 b(instance)g(of)g(this)g(class)h(is)g(r)n(egister)n(ed)
d(with)i(a)h(POA)f(and)h(is)f(assigned)f(an)63 4945 y(object)i(r)n
(efer)n(ence)f(\(see)g(below\).)44 b(When)28 b(the)f(ORB)h(r)n(eceives)
g(a)g(r)n(equest)f(for)h(that)f(object)h(the)63 5058
y Ff(invoke\(\))15 b Fs(method)i(is)i(called)g(and)g(will)h(be)f
(passed)e(a)i Ff(CORBA::ServerRe)o(qu)o(es)o(t)13 b Fs(object)63
5171 y(which)23 b(pr)n(ovides:)199 5394 y Fp(\017)46
b Fs(the)22 b(operation)f(name)1639 5622 y(133)p eop
%%Page: 134 142
134 141 bop 221 282 a Fs(134)821 b Fg(CHAPTER)22 b(12.)51
b(THE)22 b(DYNAMIC)g(SKELET)n(ON)f(INTERF)-7 b(ACE)358
539 y Fp(\017)45 b Fs(context)22 b(strings)358 727 y
Fp(\017)45 b Fs(access)23 b(to)f(the)g(parameters)358
915 y Fp(\017)45 b Fs(a)24 b(way)e(to)g(set)g(the)f(r)n(eturned)g
(values)358 1103 y Fp(\017)45 b Fs(a)24 b(way)e(to)g(thr)n(ow)g(user)n
(-de\002ned)e(exceptions.)221 1403 y Fq(12.2)119 b(DSI)29
b(T)-11 b(ypes)221 1618 y Fk(12.2.1)99 b
(PortableServer::DynamicImplementation)221 1795 y Fs(This)20
b(class)g(must)f(be)g(sub-classed)g(by)h(the)f(application)h(to)f(pr)n
(ovide)h(an)g(implementation)f(for)221 1908 y(DSI)k(objects.)k(The)22
b(method)f Ff(invoke\(\))e Fs(will)24 b(be)e(called)i(for)f(each)g
(operation)e(invocation.)362 2058 y Fe(namespace)48 b(PortableServer)g
({)462 2157 y(...)462 2357 y(class)h(DynamicImplementation)d(:)j
(public)g(virtual)g(ServantBase)e({)462 2456 y(public)o(:)562
2556 y(virtual)h(~DynamicImplementation)l(\(\);)562 2755
y(CORBA)o(::)o(Object_ptr)g(_this)o(\(\);)562 2855 y
Fd(//)h(Must)g(only)g(be)h(called)e(from)h(within)g(invoke)o(\(\).)g
(Caller)g(must)g(release)562 2954 y(//)g(the)g(reference)f(returned)o
(.)562 3154 y Fe(virtual)g(void)h(invoke)o(\(CORBA)o
(::ServerRequest_ptr)d(request)o(\))j(=)h(0;)562 3253
y(virtual)e(char)o(*)i(_primary_interface)m(\()o(const)f(ObjectId)o(&)g
(oid,)g(POA_ptr)g(poa)o(\))h(=)g(0;)562 3452 y(virtual)e(CORBA)o
(::Boolean)g(_is_a)o(\(const)h(char)o(*)h(logical_type_id)m(\);)562
3552 y Fd(//)f(The)g(default)g(implementation)e(uses)i
(_primary_interface)m(\(\),)562 3652 y(//)g(but)g(may)g(be)h
(overridden)e(by)h(subclasses)n(.)462 3751 y Fe(};)462
3851 y(...)362 3951 y(};)221 4256 y Fk(12.2.2)99 b(ServerRequest)221
4434 y Fs(A)22 b Ff(ServerRequest)16 b Fs(object)21 b(pr)n(ovides)g
(the)g(interface)h(between)e(a)i(dynamic)g(implementa-)221
4547 y(tion)h(and)f(the)g(ORB.)362 4696 y Fe(namespace)48
b(CORBA)h({)462 4796 y(...)462 4995 y(class)g(ServerRequest)e({)462
5095 y(public)o(:)562 5194 y(virtual)h(const)h(char)o(*)h(operation)n
(\(\))g(=)f(0;)562 5294 y(virtual)f(void)398 b(arguments)n
(\(NVList_ptr)n(&)50 b(parameters)n(\))f(=)h(0;)562 5394
y(virtual)e(Context_ptr)g(ctx)o(\(\))i(=)f(0;)p eop
%%Page: 135 143
135 142 bop 63 282 a Fg(12.3.)51 b(CREA)-7 b(TING)22
b(DYNAMIC)g(IMPLEMENT)-7 b(A)g(TIONS)1043 b Fs(135)403
539 y Fe(virtual)49 b(void)397 b(set_result)n(\(const)49
b(Any&)g(value)o(\))h(=)g(0;)403 638 y(virtual)f(void)397
b(set_exception)n(\(const)49 b(Any)o(&)h(value)o(\))f(=)h(0;)303
837 y(protected)o(:)403 937 y(inline)f(ServerRequest)m(\(\))h({})403
1037 y(virtual)f(~)o(ServerRequest)n(\(\);)303 1136 y(};)303
1236 y(...)204 1336 y(};)63 1676 y Fq(12.3)118 b(Creating)30
b(Dynamic)g(Implementations)63 1887 y Fs(The)24 b(application)j(must)e
(override)f(the)g Ff(invoke\(\))e Fs(method)i(of)i Ff(DynamicImpleme)o
(nt)o(a-)63 2000 y(tion)d Fs(to)i(pr)n(ovide)g(an)h(implementation)f
(for)g(DSI)g(objects.)35 b(This)25 b(method)f(must)h(behave)g(as)63
2113 y(follows:)199 2310 y Fp(\017)46 b Fs(It)24 b(may)i(be)f(called)h
(concurr)n(ently)f(by)g(multiple)g(thr)n(eads)f(of)h(execution,)g(and)g
(so)f(must)290 2423 y(be)e(thr)n(ead-safe.)199 2606 y
Fp(\017)46 b Fs(It)27 b(may)i(not)e(thr)n(ow)g(any)h(exceptions.)42
b(Both)27 b(user)n(-de\002ned)e(and)j(system)e(exceptions)290
2719 y(ar)n(e)39 b(passed)d(in)j(a)g(value)g(of)f(type)f(Any)g(via)j(a)
e(call)i(to)e Ff(ServerRequest::)o(se)o(t_)290 2831 y(exception\(\))p
Fs(.)199 3014 y Fp(\017)46 b Fs(The)35 b(operations)f(on)h(the)f
Ff(ServerRequest)c Fs(object)35 b(must)g(be)g(carried)h(out)e(in)i(the)
290 3127 y(corr)n(ect)22 b(or)n(der)-7 b(,)22 b(as)h(described)e(below)
-8 b(.)63 3379 y Fk(12.3.1)98 b(Operations)25 b(on)h(the)e
(ServerRequest)63 3556 y Ff(operation\(\))k Fs(will)34
b(r)n(eturn)e(the)g(name)h(of)g(the)f(operation,)j(and)d(may)i(be)f
(called)g(at)h(any)63 3669 y(time.)63 b(For)33 b(attribute)h(access)h
(the)e(operation)h(name)g(is)h(the)f(IDL)g(name)g(of)h(the)e
(attribute,)63 3782 y(pr)n(e\002xed)24 b(by)h Ff(_get_)e
Fs(or)j Ff(_set_)p Fs(.)34 b(If)25 b(the)g(operation)f(name)i(is)g(not)
f(r)n(ecognised)f(a)i Ff(CORBA::)63 3895 y(BAD_OPERATION)21
b Fs(exception)26 b(should)g(be)i(passed)d(back)j(thr)n(ough)f
Ff(set_exception\()o(\))p Fs(.)63 4008 y(This)22 b(will)i(allow)f(the)f
(ORB)h(to)f(then)f(see)h(if)h(it)g(is)g(one)f(of)g(the)g(standar)n(d)g
(object)h(operations.)204 4120 y(Firstly)f Ff(arguments\(\))17
b Fs(must)22 b(be)h(called)g(passing)f(a)h Ff(CORBA::NVList)2823
4087 y Fl(1)2877 4120 y Fs(which)g(must)63 4233 y(be)g(initialised)h
(to)f(contain)h(the)f(type)f(and)h(mode)g(of)g(the)g(parameters.)29
b(The)23 b(ORB)g(consumes)63 4346 y(this)31 b(value)i(and)f(will)h(r)n
(elease)f(it)g(when)f(the)h(operation)f(is)h(complete.)55
b(At)31 b(this)h(point)g(any)63 4459 y Fr(in)p Fs(/)p
Fr(inout)c Fs(ar)n(guments)f(will)j(be)e(unmarshalled,)h(and)g(when)e
(this)h(operation)f(r)n(eturns,)h(their)63 4572 y(values)22
b(will)h(be)f(in)h(the)e Ff(NVList)p Fs(.)k(The)c(application)i(may)g
(set)e(the)g(value)i(of)f Fr(inout)p Fs(/)p Fr(out)g
Fs(ar)n(gu-)63 4685 y(ments)f(by)i(modifying)f(this)g(parameter)h
(list.)204 4798 y(If)h(the)f(operation)h(has)g(user)n(-context)e
(information,)j(then)f Ff(ctx\(\))e Fs(must)h(be)h(called)i(after)63
4911 y Ff(arguments\(\))17 b Fs(to)22 b(r)n(etrieve)g(it.)204
5024 y Ff(set_result\(\))j Fs(must)30 b(then)g(be)h(called)h(exactly)f
(once)f(if)i(the)e(operation)f(has)i(a)h(non-)63 5137
y(void)24 b(r)n(eturn)g(value)h(\(unless)f(an)h(exception)e(is)h(thr)n
(own\).)33 b(The)24 b(value)h(passed)e(should)h(be)g(an)63
5250 y(Any)e(allocated)h(with)f Ff(new)p Fs(,)f(and)i(will)h(be)f(fr)n
(eed)e(by)i(the)f(ORB.)p 63 5306 1316 4 v 168 5362 a
Fj(1)197 5394 y Fi(obtained)d(by)g(calling)f Fh
(CORBA::ORB::create_list\(\))p eop
%%Page: 136 144
136 143 bop 221 282 a Fs(136)821 b Fg(CHAPTER)22 b(12.)51
b(THE)22 b(DYNAMIC)g(SKELET)n(ON)f(INTERF)-7 b(ACE)362
539 y Fs(At)29 b(any)h(point)e(in)i(the)f(above)h(sequence)d
Ff(set_exception\(\))c Fs(may)30 b(be)f(called)h(to)f(set)221
652 y(a)k(user)n(-de\002ned)c(exception)i(or)h(a)h(system)d(exception.)
55 b(If)32 b(this)f(happens)g(then)g(no)h(further)221
764 y(operations)23 b(should)h(be)h(invoked)f(on)g(the)g
Ff(ServerRequest)19 b Fs(object,)25 b(and)g(the)f Ff(invoke\(\))221
877 y Fs(method)d(should)h(r)n(eturn.)362 993 y(W)-5
b(ithin)24 b(the)e Ff(invoke\(\))d Fs(method)j Ff(_this\(\))e
Fs(may)j(be)g(called)h(to)e(obtain)i(the)e(object)h(r)n(ef-)221
1106 y(er)n(ence.)k(This)c(method)e(may)i(not)f(be)g(used)f(at)i(any)g
(other)e(time.)221 1421 y Fq(12.4)119 b(Registering)30
b(Dynamic)g(Objects)221 1638 y Fs(T)-8 b(o)34 b(use)g(a)h
Ff(DynamicImplemen)o(ta)o(ti)o(on)28 b Fs(servant,)37
b(a)f(CORBA)e(object)h(must)f(be)h(cr)n(eated)221 1751
y(and)24 b(associated)f(with)g(it,)h(just)f(as)g(for)h(any)f(other)f
(servant.)30 b(Dynamic)25 b(servants)e(can)h(also)g(be)221
1864 y(cr)n(eated)e(on)h(demand)f(by)g(Servant)g(Managers,)g(just)g
(like)h(static)g(servants.)221 2179 y Fq(12.5)119 b(Example)221
2396 y Fs(This)17 b(implementation)h(of)f Ff(DynamicImplemen)o(ta)o(ti)
o(on:)o(:i)o(nv)o(ok)o(e\()o(\))11 b Fs(is)18 b(taken)f(fr)n(om)h(an)
221 2509 y(example)30 b(which)g(can)g(be)g(found)e(in)i(the)f(omniORB)h
(distribution.)48 b(The)28 b Ff(echoString\(\))221 2622
y Fs(operation)22 b(is)g(declar)n(ed)h(in)g(IDL)f(as:)362
2776 y Fe(string)49 b(echoString)n(\(in)g(string)g(mesg)o(\);)221
2947 y Fs(Her)n(e)22 b(is)h(the)e(Dynamic)k(Implementation)c(Routine:)
362 3102 y Fe(void)362 3202 y(MyDynImpl)o(::)o(invoke)o(\(CORBA)o
(::ServerRequest_ptr)46 b(request)o(\))362 3302 y({)462
3401 y(try)j({)562 3501 y(if)o(\()h(strcmp)o(\()o(request)o
(->operation)n(\(\),)f("echoString)n("\))h(\))661 3600
y(throw)f(CORBA)o(::BAD_OPERATION)m(\(0,)h(CORBA)o(::)o(COMPLETED_NO)n
(\);)562 3800 y(CORBA)o(::)o(NVList_ptr)e(args)o(;)562
3899 y(orb)o(->create_list)n(\(0,)h(args)o(\);)562 3999
y(CORBA)o(::)o(Any)g(a;)562 4099 y(a)o(.replace)o(\(CORBA)o(::)o
(_tc_string)o(,)g(0\);)562 4198 y(args)o(->)o(add_value)o(\("")o(,)h
(a,)f(CORBA)o(::ARG_IN)o(\);)562 4397 y(request)n(->arguments)n(\(args)
o(\);)562 4597 y(const)f(char*)h(mesg;)562 4696 y(*\()o(args)o(->item)o
(\(0\)->)o(value)o(\(\)\))h(>>=)f(mesg)o(;)562 4896 y(CORBA)o(::)o
(Any*)g(result)g(=)h(new)f(CORBA)o(::Any)o(\(\);)562
4995 y(*)o(result)g(<<=)g(CORBA)o(::Any)o(::from_string)n(\(mesg)o(,)h
(0\);)562 5095 y(request)n(->set_result)n(\(*result)o(\);)462
5194 y(})462 5294 y(catch)o(\(CORBA)o(::)o(SystemException)n(&)f(ex\){)
562 5394 y(CORBA)o(::)o(Any)g(a;)p eop
%%Page: 137 145
137 144 bop 63 282 a Fg(12.5.)51 b(EXAMPLE)2479 b Fs(137)403
539 y Fe(a)50 b(<<=)f(ex;)403 638 y(request)o(->)o(set_exception)n
(\(a\);)303 738 y(})303 837 y(catch)o(\(...\){)403 937
y(cout)g(<<)h(")o(echo_dsiimpl)n(:)g(MyDynImpl)n(::invoke)e(-)i(caught)
f(an)g(unknown)g(exception)n(.")652 1037 y(<<)h(endl)o(;)403
1136 y(CORBA)o(::Any)f(a;)403 1236 y(a)h(<<=)f(CORBA)o(::UNKNOWN)n
(\(0,)h(CORBA)o(::)o(COMPLETED_NO)n(\);)403 1336 y(request)o(->)o
(set_exception)n(\(a\);)303 1435 y(})204 1535 y(})p eop
%%Page: 138 146
138 145 bop 221 282 a Fs(138)821 b Fg(CHAPTER)22 b(12.)51
b(THE)22 b(DYNAMIC)g(SKELET)n(ON)f(INTERF)-7 b(ACE)p
eop
%%Page: 139 147
139 146 bop 63 1163 a Fm(Appendix)44 b(A)63 1579 y Fo
(hosts_access\(5\))63 2029 y Fk(DESCRIPTION)63 2209 y
Fs(This)19 b(manual)h(page)f(describes)f(a)h(simple)g(access)g(contr)n
(ol)h(language)f(that)f(is)i(based)e(on)h(client)63 2322
y(\(host)27 b(name/addr)n(ess,)i(user)e(name\),)j(and)f(server)e(\(pr)n
(ocess)g(name,)j(host)d(name/addr)n(ess\))63 2435 y(patterns.)48
b(Examples)30 b(ar)n(e)h(given)f(at)g(the)g(end.)49 b(The)30
b(impatient)g(r)n(eader)f(is)i(encouraged)d(to)63 2548
y(skip)22 b(to)g(the)f(EXAMPLES)g(section)h(for)g(a)h(quick)g(intr)n
(oduction.)204 2662 y(An)k(extended)e(version)i(of)h(the)f(access)h
(contr)n(ol)g(language)f(is)h(described)f(in)h(the)f(hosts_)63
2775 y(options\(5\))37 b(document.)74 b(The)38 b(extensions)e(ar)n(e)i
(turned)f(on)h(at)g(pr)n(ogram)g(build)h(time)g(by)63
2888 y(building)23 b(with)f(-DPROCESS_OPTIONS.)204 3002
y(In)32 b(the)f(following)h(text,)i Fr(daemon)f Fs(is)f(the)f(pr)n
(ocess)g(name)i(of)f(a)h(network)d(daemon)i(pr)n(o-)63
3115 y(cess,)25 b(and)g Fr(client)h Fs(is)g(the)f(name)g(and/or)g(addr)
n(ess)f(of)i(a)g(host)e(r)n(equesting)g(service.)36 b(Network)63
3228 y(daemon)22 b(pr)n(ocess)f(names)h(ar)n(e)h(speci\002ed)f(in)h
(the)f(inetd)g(con\002guration)g(\002le.)63 3492 y Fk(ACCESS)i(CONTROL)
h(FILES)63 3672 y Fs(The)d(access)g(contr)n(ol)h(softwar)n(e)f
(consults)f(two)h(\002les.)28 b(The)21 b(sear)n(ch)i(stops)e(at)i(the)f
(\002rst)f(match:)199 3892 y Fp(\017)46 b Fs(Access)25
b(will)j(be)e(granted)f(when)h(a)h(\(daemon,client\))f(pair)h(matches)f
(an)h(entry)e(in)h(the)290 4004 y Ff(/etc/hosts.allo)o(w)16
b Fs(\002le.)199 4198 y Fp(\017)46 b Fs(Otherwise,)37
b(access)e(will)h(be)f(denied)f(when)h(a)g(\(daemon,client\))g(pair)h
(matches)f(an)290 4311 y(entry)21 b(in)i(the)f Ff(/etc/hosts.deny)16
b Fs(\002le.)199 4504 y Fp(\017)46 b Fs(Otherwise,)21
b(access)i(will)h(be)e(granted.)204 4724 y(A)30 b(non-existing)g
(access)g(contr)n(ol)h(\002le)g(is)f(tr)n(eated)g(as)g(if)i(it)f(wer)n
(e)e(an)j(empty)d(\002le.)52 b(Thus,)63 4837 y(access)22
b(contr)n(ol)h(can)g(be)g(turned)e(of)n(f)i(by)g(pr)n(oviding)f(no)h
(access)f(contr)n(ol)h(\002les.)63 5101 y Fk(ACCESS)h(CONTROL)h(RULES)
63 5281 y Fs(Each)i(access)g(contr)n(ol)h(\002le)f(consists)f(of)h(zer)
n(o)g(or)g(mor)n(e)g(lines)h(of)f(text.)40 b(These)26
b(lines)h(ar)n(e)h(pr)n(o-)63 5394 y(cessed)20 b(in)k(or)n(der)d(of)i
(appearance.)28 b(The)22 b(sear)n(ch)g(terminates)g(when)g(a)h(match)g
(is)g(found.)1639 5622 y(139)p eop
%%Page: 140 148
140 147 bop 221 282 a Fs(140)1719 b Fg(APPENDIX)21 b(A.)45
b(HOSTS_ACCESS\(5\))358 539 y Fp(\017)g Fs(A)24 b(newline)f(character)h
(is)g(ignor)n(ed)f(when)f(it)i(is)g(pr)n(eceded)e(by)h(a)h(backslash)g
(character)-7 b(.)448 652 y(This)23 b(permits)f(you)f(to)h(br)n(eak)h
(up)f(long)g(lines)h(so)f(that)g(they)g(ar)n(e)h(easier)f(to)g(edit.)
358 883 y Fp(\017)45 b Fs(Blank)29 b(lines)g(or)f(lines)h(that)f(begin)
h(with)f(a)i Ff(#)e Fs(character)h(ar)n(e)g(ignor)n(ed.)46
b(This)28 b(permits)448 996 y(you)22 b(to)g(insert)g(comments)g(and)g
(whitespace)g(so)g(that)g(the)g(tables)h(ar)n(e)g(easier)f(to)g(r)n
(ead.)358 1227 y Fp(\017)45 b Fs(All)30 b(other)d(lines)i(should)f
(satisfy)g(the)g(following)h(format,)h(things)e(between)f([])i(being)
448 1340 y(optional:)f Ff(daemon_list)50 b(:)108 b(client_list)50
b([)k(:)109 b(shell_command)48 b(])362 1607 y(daemon_list)20
b Fs(is)25 b(a)h(list)f(of)g(one)f(or)h(mor)n(e)g(daemon)f(pr)n(ocess)g
(names)h(\(ar)n(gv[0])h(values\))221 1720 y(or)c(wildcar)n(ds)i(\(see)d
(below\).)362 1844 y Ff(client_list)g Fs(is)26 b(a)h(list)f(of)g(one)f
(or)g(mor)n(e)h(host)f(names,)h(host)f(addr)n(esses,)f(patterns)g(or)
221 1957 y(wildcar)n(ds)c(\(see)f(below\))h(that)f(will)i(be)f(matched)
f(against)h(the)f(client)h(host)e(name)i(or)g(addr)n(ess.)362
2081 y(The)k(mor)n(e)g(complex)g(forms)g Ff(daemon@host)19
b Fs(and)24 b Ff(user@host)c Fs(ar)n(e)25 b(explained)e(in)i(the)221
2194 y(sections)20 b(on)g(server)g(endpoint)f(patterns)g(and)i(on)f
(client)h(username)f(lookups,)f(r)n(espectively)-10 b(.)362
2318 y(List)22 b(elements)f(should)h(be)h(separated)e(by)h(blanks)h
(and/or)f(commas.)362 2442 y(W)-5 b(ith)25 b(the)e(exception)g(of)i
(NIS)e(\(YP\))i(netgr)n(oup)d(lookups,)h(all)j(access)e(contr)n(ol)h
(checks)f(ar)n(e)221 2554 y(case)f(insensitive.)221 2876
y Fk(P)-7 b(A)e(TTERNS)221 3075 y Fs(The)22 b(access)h(contr)n(ol)f
(language)h(implements)f(the)f(following)i(patterns:)358
3343 y Fp(\017)45 b Fs(A)29 b(string)f(that)g(begins)g(with)h(a)g
Ff(.)46 b Fs(character)-7 b(.)47 b(A)29 b(host)e(name)i(is)g(matched)f
(if)i(the)e(last)448 3456 y(components)17 b(of)h(its)f(name)i(match)f
(the)f(speci\002ed)g(pattern.)25 b(For)17 b(example,)i(the)e(pattern)
448 3569 y Ff(.tue.nl)j Fs(matches)i(the)g(host)g(name)h
Ff(wzv.win.tue.nl)o Fs(.)358 3800 y Fp(\017)45 b Fs(A)29
b(string)e(that)h(ends)f(with)i(a)g Ff(.)45 b Fs(character)-7
b(.)46 b(A)28 b(host)g(addr)n(ess)f(is)h(matched)g(if)i(its)e(\002rst)
448 3913 y(numeric)h(\002elds)e(match)i(the)e(given)h(string.)43
b(For)27 b(example,)i(the)e(pattern)g Ff(131.155.)448
4026 y Fs(matches)22 b(the)e(addr)n(ess)g(of)h(\(almost\))h(every)e
(host)g(on)h(the)g(Eindhoven)f(University)h(net-)448
4139 y(work)h(\()p Ff(131.155.x.x)p Fs(\).)358 4370 y
Fp(\017)45 b Fs(A)34 b(string)f(that)g(begins)g(with)h(an)68
b(character)34 b(is)g(tr)n(eated)e(as)i(an)g(NIS)f(\(formerly)g(YP\))
448 4483 y(netgr)n(oup)16 b(name.)27 b(A)18 b(host)e(name)j(is)f
(matched)f(if)i(it)f(is)g(a)h(host)d(member)i(of)g(the)f(speci\002ed)
448 4596 y(netgr)n(oup.)43 b(Netgr)n(oup)25 b(matches)j(ar)n(e)h(not)e
(supported)e(for)j(daemon)g(pr)n(ocess)e(names)448 4709
y(or)d(for)f(client)h(user)f(names.)358 4940 y Fp(\017)45
b Fs(An)20 b(expr)n(ession)e(of)h(the)g(form)h Ff(n.n.n.n/m.m.m.m)13
b Fs(is)20 b(interpr)n(eted)d(as)j(a)g(`net/mask')448
5053 y(pair)-7 b(.)29 b(A)21 b(host)f(addr)n(ess)g(is)h(matched)g(if)h
(`net')f(is)g(equal)h(to)e(the)h(bitwise)g(AND)g(of)g(the)g(ad-)448
5166 y(dr)n(ess)26 b(and)h(the)g(`mask'.)41 b(For)27
b(example,)g(the)g(net/mask)f(pattern)g Ff(131.155.72.0/)448
5279 y(255.255.254.0)34 b Fs(matches)40 b(every)e(addr)n(ess)g(in)j
(the)d(range)h Ff(131.155.72.0)c Fs(to)448 5392 y Ff(131.155.73.255)p
Fs(.)p eop
%%Page: 141 149
141 148 bop 3215 282 a Fs(141)63 539 y Fk(WILDCARDS)63
723 y Fs(The)22 b(access)g(contr)n(ol)h(language)f(supports)e(explicit)
j(wildcar)n(ds:)63 953 y Ff(ALL)290 1066 y Fs(The)f(universal)h
(wildcar)n(d,)g(always)g(matches.)63 1268 y Ff(LOCAL)290
1381 y Fs(Matches)f(any)h(host)e(whose)g(name)i(does)e(not)h(contain)h
(a)g(dot)f(character)-7 b(.)63 1583 y Ff(UNKNOWN)290
1696 y Fs(Matches)34 b(any)g(user)f(whose)f(name)j(is)f(unknown,)h(and)
f(matches)g(any)g(host)f(whose)290 1809 y(name)26 b(or)g(addr)n(ess)f
(ar)n(e)h(unknown.)37 b(This)26 b(pattern)f(should)g(be)h(used)e(with)i
(car)n(e:)36 b(host)290 1922 y(names)26 b(may)h(be)f(unavailable)j(due)
d(to)g(temporary)f(name)i(server)e(pr)n(oblems.)39 b(A)26
b(net-)290 2035 y(work)e(addr)n(ess)f(will)j(be)f(unavailable)j(when)c
(the)g(softwar)n(e)g(cannot)h(\002gur)n(e)g(out)f(what)290
2148 y(type)d(of)i(network)d(it)j(is)g(talking)g(to.)63
2350 y Ff(KNOWN)290 2463 y Fs(Matches)e(any)h(user)f(whose)g(name)h(is)
g(known,)e(and)i(matches)g(any)g(host)f(whose)f(name)290
2576 y(and)26 b(addr)n(ess)f(ar)n(e)h(known.)37 b(This)26
b(pattern)f(should)g(be)h(used)f(with)h(car)n(e:)36 b(host)25
b(names)290 2689 y(may)36 b(be)f(unavailable)j(due)c(to)g(temporary)g
(name)i(server)e(pr)n(oblems.)65 b(A)35 b(network)290
2802 y(addr)n(ess)26 b(will)k(be)e(unavailable)i(when)d(the)h(softwar)n
(e)f(cannot)h(\002gur)n(e)f(out)g(what)h(type)290 2914
y(of)23 b(network)d(it)j(is)g(talking)g(to.)63 3117 y
Ff(PARANOID)290 3229 y Fs(Matches)34 b(any)g(host)f(whose)g(name)h
(does)f(not)g(match)i(its)f(addr)n(ess.)61 b(When)34
b(tcpd)f(is)290 3342 y(built)24 b(with)f(-DP)-8 b(ARANOID)22
b(\(default)i(mode\),)e(it)h(dr)n(ops)f(r)n(equests)f(fr)n(om)j(such)f
(clients)290 3455 y(even)17 b(befor)n(e)h(looking)f(at)i(the)e(access)h
(contr)n(ol)g(tables.)26 b(Build)18 b(without)f(-DP)-8
b(ARANOID)290 3568 y(when)22 b(you)g(want)g(mor)n(e)h(contr)n(ol)f
(over)g(such)h(r)n(equests.)63 3845 y Fk(OPERA)-9 b(TORS)63
4029 y Ff(EXCEPT)290 4142 y Fs(Intended)16 b(use)i(is)h(of)g(the)f
(form:)26 b Ff(list_1)16 b(EXCEPT)g(list_2)p Fs(;)h(this)i(constr)o
(uct)f(matches)290 4255 y(anything)h(that)g(matches)g
Ff(list_1)d Fs(unless)i(it)i(matches)f Ff(list_2)p Fs(.)24
b(The)18 b Ff(EXCEPT)f Fs(oper)n(-)290 4368 y(ator)i(can)g(be)g(used)f
(in)h Ff(daemon_lists)14 b Fs(and)19 b(in)g Ff(client_lists)p
Fs(.)i(The)e Ff(EXCEPT)d Fs(op-)290 4481 y(erator)24
b(can)h(be)g(nested:)30 b(if)25 b(the)f(contr)n(ol)h(language)g(would)f
(permit)g(the)g(use)g(of)g(par)n(en-)290 4594 y(theses,)30
b Ff(a)54 b(EXCEPT)e(b)i(EXCEPT)e(c)30 b Fs(would)g(parse)f(as)i
Ff(\(a)54 b(EXCEPT)e(\(b)h(EXCEPT)290 4707 y(c\)\))p
Fs(.)63 4984 y Fk(SHELL)24 b(COMMANDS)63 5168 y Fs(If)k(the)g
(\002rst-matched)g(access)g(contr)n(ol)h(r)o(ule)f(contains)h(a)g
(shell)f(command,)j(that)d(command)63 5281 y(is)d(subjected)f(to)h
Ff(\045<letter>)c Fs(substitutions)j(\(see)g(next)g(section\).)36
b(The)24 b(r)n(esult)h(is)h(executed)63 5394 y(by)34
b(a)g(/bin/sh)h(child)f(pr)n(ocess)f(with)h(standar)n(d)g(input,)i
(output)c(and)i(err)n(or)g(connected)e(to)p eop
%%Page: 142 150
142 149 bop 221 282 a Fs(142)1719 b Fg(APPENDIX)21 b(A.)45
b(HOSTS_ACCESS\(5\))221 539 y Fs(/dev/null.)54 b(Specify)31
b(an)h Ff(&)f Fs(at)g(the)g(end)f(of)i(the)e(command)i(if)g(you)f(do)f
(not)h(want)g(to)g(wait)221 652 y(until)23 b(it)g(has)g(completed.)362
765 y(Shell)35 b(commands)g(should)e(not)h(r)n(ely)h(on)f(the)f(P)-8
b(A)h(TH)34 b(setting)f(of)h(the)g(inetd.)63 b(Instead,)221
878 y(they)20 b(should)h(use)f(absolute)h(path)g(names,)g(or)g(they)f
(should)g(begin)h(with)h(an)f(explicit)h Ff(PATH=)221
991 y(whatever)d Fs(statement.)362 1104 y(The)i(hosts_options\(5\))f
(document)h(describes)f(an)i(alternative)h(language)e(that)h(uses)e
(the)221 1217 y(shell)j(command)g(\002eld)f(in)h(a)h(dif)n(fer)n(ent)e
(and)h(incompatible)g(way)-10 b(.)221 1475 y Fk(\045)25
b(EXP)-7 b(ANSIONS)221 1653 y Fs(The)22 b(following)h(expansions)e(ar)n
(e)i(available)j(within)d(shell)f(commands:)21 1868 y
Ff(\045a)54 b(\(\045A\))43 b Fs(The)22 b(client)h(\(server\))g(host)e
(addr)n(ess.)294 2058 y Ff(\045c)44 b Fs(Client)37 b(information:)54
b(user@host,)36 b(user@addr)n(ess,)g(a)h(host)d(name,)39
b(or)c(just)h(an)g(ad-)448 2171 y(dr)n(ess,)21 b(depending)g(on)h(how)g
(much)h(information)g(is)g(available.)294 2361 y Ff(\045d)44
b Fs(The)22 b(daemon)g(pr)n(ocess)g(name)h(\(ar)n(gv[0])h(value\).)21
2551 y Ff(\045h)54 b(\(\045H\))43 b Fs(The)22 b(client)h(\(server\))g
(host)e(name)i(or)f(addr)n(ess,)f(if)i(the)f(host)g(name)h(is)f
(unavailable.)21 2740 y Ff(\045n)54 b(\(\045N\))43 b
Fs(The)22 b(client)h(\(server\))g(host)e(name)i(\(or)f("unknown")f(or)h
("paranoid"\).)294 2930 y Ff(\045p)44 b Fs(The)22 b(daemon)g(pr)n
(ocess)g(id.)294 3120 y Ff(\045s)44 b Fs(Server)17 b(information:)25
b(daemon@host,)16 b(daemon@addr)n(ess,)g(or)h(just)g(a)g(daemon)g
(name,)448 3233 y(depending)k(on)h(how)g(much)h(information)g(is)g
(available.)294 3423 y Ff(\045u)44 b Fs(The)22 b(client)h(user)f(name)h
(\(or)f("unknown"\).)294 3612 y Ff(\045\045)44 b Fs(Expands)22
b(to)g(a)h(single)f Ff(\045)g Fs(character)-7 b(.)362
3828 y(Characters)27 b(in)f(\045)g(expansions)f(that)h(may)g(confuse)f
(the)g(shell)h(ar)n(e)h(r)n(eplaced)f(by)g(under)n(-)221
3940 y(scor)n(es.)221 4199 y Fk(SER)-7 b(VER)24 b(ENDPOINT)g(P)-7
b(A)e(TTERNS)221 4376 y Fs(In)33 b(or)n(der)f(to)h(distinguish)f
(clients)i(by)f(the)g(network)e(addr)n(ess)h(that)h(they)f(connect)h
(to,)i(use)221 4489 y(patterns)21 b(of)i(the)f(form:)362
4603 y Ff(process_name@ho)o(st_)o(pa)o(tt)o(er)o(n)48
b(:)109 b(client_list)50 b(...)362 4716 y Fs(Patterns)34
b(like)g(these)f(can)i(be)g(used)e(when)h(the)g(machine)h(has)g(dif)n
(fer)n(ent)f(internet)g(ad-)221 4829 y(dr)n(esses)28
b(with)i(dif)n(fer)n(ent)f(internet)g(hostnames.)48 b(Service)30
b(pr)n(oviders)f(can)i(use)e(this)g(facility)221 4942
y(to)e(of)n(fer)h(FTP)-12 b(,)27 b(GOPHER)g(or)h(WWW)f(ar)n(chives)i
(with)e(internet)g(names)g(that)h(may)g(even)f(be-)221
5055 y(long)g(to)g(dif)n(fer)n(ent)h(or)n(ganisations.)42
b(See)27 b(also)g(the)g(`twist')g(option)g(in)h(the)f
(hosts_options\(5\))221 5168 y(document.)38 b(Some)26
b(systems)f(\(Solaris,)i(Fr)n(eeBSD\))f(can)h(have)g(mor)n(e)f(than)h
(one)f(internet)f(ad-)221 5281 y(dr)n(ess)36 b(on)h(one)f(physical)i
(interface;)44 b(with)38 b(other)e(systems)f(you)h(may)i(have)f(to)g(r)
n(esort)f(to)221 5394 y(SLIP)g(or)h(PPP)g(pseudo)e(interfaces)h(that)h
(live)h(in)g(a)f(dedicated)f(network)f(addr)n(ess)h(space.)p
eop
%%Page: 143 151
143 150 bop 3215 282 a Fs(143)63 539 y(The)34 b Ff(host_pattern)c
Fs(obeys)k(the)h(same)g(syntax)g(r)o(ules)g(as)g(host)f(names)i(and)f
(addr)n(esses)63 652 y(in)28 b Ff(client_list)23 b Fs(context.)42
b(Usually)-10 b(,)29 b(server)e(endpoint)f(information)j(is)f
(available)j(only)63 764 y(with)22 b(connection-oriented)f(services.)63
1029 y Fk(CLIENT)j(USERNAME)g(LOOKUP)63 1209 y Fs(When)37
b(the)h(client)h(host)e(supports)f(the)i(RFC)g(931)i(pr)n(otocol)e(or)g
(one)f(of)i(its)f(descendants)63 1322 y(\(T)-7 b(AP)-12
b(,)18 b(IDENT)-7 b(,)16 b(RFC)i(1413\))i(the)d(wrapper)g(pr)n(ograms)g
(can)i(r)n(etrieve)e(additional)i(information)63 1435
y(about)24 b(the)f(owner)g(of)h(a)g(connection.)32 b(Client)24
b(username)f(information,)i(when)e(available,)k(is)63
1548 y(logged)21 b(together)f(with)i(the)g(client)h(host)f(name,)g(and)
h(can)g(be)g(used)e(to)h(match)h(patterns)e(like:)204
1662 y Ff(daemon_list)49 b(:)109 b(...)f(user_pattern@h)o(os)o(t_p)o
(at)o(te)o(rn)48 b(...)204 1777 y Fs(The)39 b(daemon)g(wrappers)f(can)j
(be)f(con\002gur)n(ed)e(at)i(compile)g(time)g(to)f(perform)g(r)o(ule-)
63 1890 y(driven)e(username)f(lookups)g(\(default\))i(or)f(to)f(always)
i(interr)n(ogate)e(the)g(client)i(host.)71 b(In)63 2002
y(the)27 b(case)h(of)g(r)o(ule-driven)g(username)f(lookups,)h(the)f
(above)h(r)o(ule)g(would)g(cause)f(username)63 2115 y(lookup)21
b(only)h(when)g(both)g(the)g Ff(daemon_list)c Fs(and)23
b(the)e Ff(host_pattern)d Fs(match.)204 2230 y(A)27 b(user)f(pattern)g
(has)i(the)e(same)h(syntax)g(as)g(a)h(daemon)f(pr)n(ocess)f(pattern,)h
(so)f(the)h(same)63 2343 y(wildcar)n(ds)35 b(apply)g(\(netgr)n(oup)f
(membership)h(is)g(not)f(supported\).)63 b(One)35 b(should)f(not)h(get)
63 2456 y(carried)23 b(away)g(with)f(username)g(lookups,)f(though.)199
2676 y Fp(\017)46 b Fs(The)27 b(client)g(username)g(information)h
(cannot)f(be)h(tr)o(usted)d(when)i(it)g(is)h(needed)d(most,)290
2789 y(i.e.)65 b(when)34 b(the)h(client)g(system)e(has)i(been)g(compr)n
(omised.)64 b(In)35 b(general,)j(ALL)c(and)290 2902 y(\(UN\)KNOWN)22
b(ar)n(e)h(the)f(only)g(user)g(name)g(patterns)f(that)i(make)f(sense.)
199 3096 y Fp(\017)46 b Fs(Username)16 b(lookups)g(ar)n(e)h(possible)g
(only)f(with)h(TCP-based)g(services,)h(and)f(only)g(when)290
3209 y(the)33 b(client)h(host)e(r)o(uns)h(a)h(suitable)g(daemon;)k(in)c
(all)h(other)d(cases)h(the)g(r)n(esult)g(is)g(`un-)290
3322 y(known'.)199 3516 y Fp(\017)46 b Fs(A)29 b(well-known)h(UNIX)e
(kernel)h(bug)g(may)h(cause)g(loss)f(of)h(service)f(when)g(username)290
3628 y(lookups)34 b(ar)n(e)i(blocked)f(by)g(a)i(\002r)n(ewall.)68
b(The)34 b(wrapper)h(README)g(document)f(de-)290 3741
y(scribes)22 b(a)h(pr)n(ocedur)n(e)f(to)g(\002nd)g(out)g(if)h(your)f
(kernel)g(has)g(this)g(bug.)199 3935 y Fp(\017)46 b Fs(Username)33
b(lookups)f(may)i(cause)g(noticeable)g(delays)f(for)h(non-UNIX)e
(users.)60 b(The)290 4048 y(default)27 b(timeout)g(for)g(username)g
(lookups)f(is)h(10)i(seconds:)35 b(too)27 b(short)f(to)h(cope)g(with)
290 4161 y(slow)22 b(networks,)e(but)j(long)f(enough)f(to)h(irritate)h
(PC)g(users.)204 4382 y(Selective)g(username)f(lookups)g(can)i
(alleviate)h(the)e(last)g(pr)n(oblem.)31 b(For)22 b(example,)h(a)h(r)o
(ule)63 4494 y(like:)204 4609 y Ff(daemon_list)49 b(:)109
b(@pcnetgroup)50 b(ALL@ALL)204 4723 y Fs(would)29 b(match)h(members)f
(of)h(the)f(pc)g(netgr)n(oup)f(without)h(doing)g(username)f(lookups,)63
4836 y(but)22 b(would)g(perform)g(username)g(lookups)f(with)h(all)i
(other)e(systems.)63 5101 y Fk(DETECTING)j(ADDRESS)f(SPOOFING)h(A)-9
b(TT)g(ACKS)63 5281 y Fs(A)17 b(\003aw)h(in)h(the)d(sequence)g(number)i
(generator)e(of)h(many)h(TCP/IP)g(implementations)f(allows)63
5394 y(intr)o(uders)23 b(to)h(easily)g(impersonate)g(tr)o(usted)e
(hosts)h(and)i(to)e(br)n(eak)i(in)g(via,)h(for)f(example,)f(the)p
eop
%%Page: 144 152
144 151 bop 221 282 a Fs(144)1719 b Fg(APPENDIX)21 b(A.)45
b(HOSTS_ACCESS\(5\))221 539 y Fs(r)n(emote)25 b(shell)g(service.)37
b(The)24 b(IDENT)h(\(RFC931)i(etc.\))36 b(service)26
b(can)g(be)f(used)g(to)f(detect)g(such)221 652 y(and)f(other)e(host)h
(addr)n(ess)f(spoo\002ng)f(attacks.)362 764 y(Befor)n(e)29
b(accepting)i(a)f(client)h(r)n(equest,)f(the)f(wrappers)g(can)i(use)e
(the)h(IDENT)f(service)h(to)221 877 y(\002nd)f(out)f(that)h(the)f
(client)i(did)e(not)h(send)e(the)i(r)n(equest)e(at)i(all.)49
b(When)28 b(the)h(client)g(host)f(pr)n(o-)221 990 y(vides)38
b(IDENT)f(service,)k(a)e(negative)e(IDENT)g(lookup)g(r)n(esult)g(\(the)
h(client)g(matches)g Ff(UN-)221 1103 y(KNOWN@host)p Fs(\))19
b(is)j(str)n(ong)g(evidence)g(of)g(a)h(host)f(spoo\002ng)e(attack.)362
1216 y(A)i(positive)g(IDENT)f(lookup)f(r)n(esult)i(\(the)f(client)i
(matches)f Ff(KNOWN@host)p Fs(\))17 b(is)23 b(less)e(tr)o(ust-)221
1329 y(worthy)-10 b(.)47 b(It)28 b(is)i(possible)f(for)g(an)h(intr)o
(uder)e(to)h(spoof)f(both)h(the)g(client)h(connection)e(and)i(the)221
1442 y(IDENT)24 b(lookup,)h(although)g(doing)f(so)h(is)h(much)f(har)n
(der)h(than)f(spoo\002ng)e(just)i(a)h(client)g(con-)221
1555 y(nection.)i(It)22 b(may)h(also)f(be)h(that)f(the)g(client's)h
(IDENT)e(server)h(is)h(lying.)362 1668 y(Note:)k(IDENT)21
b(lookups)g(don't)h(work)f(with)i(UDP)g(services.)221
1920 y Fk(EXAMPLES)221 2097 y Fs(The)f(language)h(is)f(\003exible)h
(enough)f(that)g(dif)n(fer)n(ent)g(types)f(of)i(access)f(contr)n(ol)h
(policy)g(can)g(be)221 2210 y(expr)n(essed)17 b(with)j(a)h(minimum)h
(of)e(fuss.)26 b(Although)19 b(the)g(language)h(uses)f(two)g(access)h
(contr)n(ol)221 2323 y(tables,)i(the)f(most)g(common)h(policies)g(can)g
(be)g(implemented)f(with)h(one)f(of)g(the)g(tables)h(being)221
2435 y(trivial)j(or)d(even)g(empty)-10 b(.)362 2548 y(When)21
b(r)n(eading)h(the)e(examples)h(below)h(it)f(is)h(important)f(to)g(r)n
(ealise)h(that)f(the)g(allow)i(table)221 2661 y(is)d(scanned)g(befor)n
(e)f(the)g(deny)g(table,)i(that)e(the)g(sear)n(ch)i(terminates)e(when)g
(a)h(match)h(is)f(found,)221 2774 y(and)j(that)f(access)h(is)f(granted)
g(when)g(no)g(match)h(is)g(found)f(at)h(all.)362 2887
y(The)c(examples)g(use)f(host)h(and)g(domain)h(names.)27
b(They)18 b(can)i(be)g(impr)n(oved)f(by)g(including)221
3000 y(addr)n(ess)g(and/or)i(network/netmask)c(information,)22
b(to)e(r)n(educe)f(the)h(impact)i(of)e(temporary)221
3113 y(name)j(server)f(lookup)f(failur)n(es.)221 3365
y Fk(MOSTL)-9 b(Y)25 b(CLOSED)221 3542 y Fs(In)i(this)f(case,)i(access)
f(is)g(denied)f(by)h(default.)41 b(Only)27 b(explicitly)h(authorised)d
(hosts)h(ar)n(e)h(per)n(-)221 3655 y(mitted)22 b(access.)362
3768 y(The)g(default)h(policy)f(\(no)h(access\))g(is)g(implemented)e
(with)i(a)g(trivial)h(deny)e(\002le:)221 3952 y Fe(/etc/hosts.deny:)420
4051 y(ALL:)49 b(ALL)362 4249 y Fs(This)27 b(denies)f(all)i(service)f
(to)f(all)j(hosts,)d(unless)g(they)g(ar)n(e)h(permitted)f(access)g(by)h
(entries)221 4362 y(in)c(the)f(allow)i(\002le.)362 4474
y(The)e(explicitly)h(authorised)f(hosts)f(ar)n(e)i(listed)e(in)j(the)d
(allow)j(\002le.)k(For)22 b(example:)221 4658 y Fe(/etc/hosts.allow:)
371 4758 y(ALL:)49 b(LOCAL)g(@some_netgroup)371 4858
y(ALL:)g(.foobar.edu)e(EXCEPT)i(terminalserver.foobar.edu)362
5055 y Fs(The)30 b(\002rst)g(r)o(ule)h(permits)e(access)i(fr)n(om)g
(hosts)e(in)i(the)e(local)j(domain)f(\(no)g(.)51 b(in)31
b(the)f(host)221 5168 y(name\))23 b(and)f(fr)n(om)h(members)f(of)g(the)
g Ff(some_netgroup)16 b Fs(netgr)n(oup.)26 b(The)c(second)f(r)o(ule)h
(per)n(-)221 5281 y(mits)35 b(access)f(fr)n(om)h(all)h(hosts)d(in)i
(the)f Ff(foobar.edu)c Fs(domain)35 b(\(notice)g(the)f(leading)g
(dot\),)221 5394 y(with)23 b(the)f(exception)f(of)i Ff(terminalserver)o
(.f)o(oo)o(ba)o(r.)o(edu)o Fs(.)p eop
%%Page: 145 153
145 152 bop 3215 282 a Fs(145)63 539 y Fk(MOSTL)-9 b(Y)25
b(OPEN)63 715 y Fs(Her)n(e,)j(access)h(is)f(granted)f(by)h(default;)j
(only)d(explicitly)h(speci\002ed)e(hosts)g(ar)n(e)i(r)n(efused)e(ser)n
(-)63 828 y(vice.)204 941 y(The)k(default)g(policy)h(\(access)g
(granted\))e(makes)i(the)e(allow)j(\002le)f(r)n(edundant)e(so)h(that)g
(it)63 1054 y(can)25 b(be)f(omitted.)31 b(The)23 b(explicitly)i
(non-authorised)e(hosts)f(ar)n(e)j(listed)e(in)i(the)e(deny)g(\002le.)
32 b(For)63 1167 y(example:)63 1323 y Fe(/etc/hosts.deny:)212
1422 y(ALL:)49 b(some.host.name,)e(.some.domain)212 1522
y(ALL)i(EXCEPT)g(in.fingerd:)f(other.host.name,)f(.other.domain)204
1691 y Fs(The)25 b(\002rst)g(r)o(ule)h(denies)e(some)h(hosts)f(and)i
(domains)g(all)h(services;)g(the)e(second)f(r)o(ule)i(still)63
1804 y(permits)21 b(\002nger)h(r)n(equests)f(fr)n(om)i(other)e(hosts)g
(and)i(domains.)63 2051 y Fk(BOOBY)j(TRAPS)63 2228 y
Fs(The)e(next)g(example)i(permits)e(tftp)g(r)n(equests)g(fr)n(om)h
(hosts)f(in)i(the)e(local)j(domain)e(\(notice)g(the)63
2341 y(leading)i(dot\).)40 b(Requests)25 b(fr)n(om)i(any)g(other)f
(hosts)g(ar)n(e)h(denied.)40 b(Instead)26 b(of)h(the)f(r)n(equested)63
2454 y(\002le,)i(a)g(\002nger)f(pr)n(obe)g(is)g(sent)f(to)h(the)g(of)n
(fending)g(host.)41 b(The)27 b(r)n(esult)f(is)i(mailed)g(to)f(the)g
(supe-)63 2566 y(r)o(user)-7 b(.)63 2722 y Fe(/etc/hosts.allow:)212
2822 y(in.tftpd:)48 b(LOCAL,)h(.my.domain)63 3021 y(/etc/hosts.deny:)
212 3120 y(in.tftpd:)f(ALL:)h(\(/some/where/safe\\_finger)c(-l)50
b(@\045h)f(|)h(\\)411 3220 y(/usr/ucb/mail)e(-s)h(\045d-\045h)g(root\))
g(&)204 3389 y Fs(The)23 b Ff(safe_finger)c Fs(command)25
b(comes)f(with)g(the)f(tcpd)g(wrapper)h(and)g(should)f(be)h(in-)63
3502 y(stalled)h(in)h(a)g(suitable)g(place.)37 b(It)25
b(limits)h(possible)f(damage)g(fr)n(om)h(data)g(sent)e(by)i(the)f(r)n
(emote)63 3615 y(\002nger)c(server)-7 b(.)27 b(It)22
b(gives)g(better)g(pr)n(otection)f(than)i(the)f(standar)n(d)g(\002nger)
f(command.)204 3728 y(The)26 b(expansion)g(of)g(the)g(\045h)i(\(client)
f(host\))f(and)h(\045d)f(\(service)h(name\))h(sequences)c(is)j(de-)63
3840 y(scribed)22 b(in)h(the)f(section)g(on)g(shell)h(commands.)204
3953 y(W)-8 b(arning:)35 b(do)25 b(not)h(booby-trap)g(your)f(\002nger)g
(daemon,)i(unless)e(you)h(ar)n(e)g(pr)n(epar)n(ed)g(for)63
4066 y(in\002nite)c(\002nger)g(loops.)204 4179 y(On)i(network)e(\002r)n
(ewall)j(systems)d(this)h(trick)h(can)h(be)f(carried)g(even)g(further)
-7 b(.)31 b(The)23 b(typical)63 4292 y(network)31 b(\002r)n(ewall)j
(only)f(pr)n(ovides)f(a)i(limited)f(set)f(of)h(services)g(to)f(the)g
(outer)g(world.)59 b(All)63 4405 y(other)29 b(services)g(can)i(be)f
("bugged")f(just)g(like)h(the)g(above)h(tftp)e(example.)51
b(The)29 b(r)n(esult)h(is)g(an)63 4518 y(excellent)22
b(early-warning)h(system.)63 4765 y Fk(DIAGNOSTICS)63
4942 y Fs(An)33 b(err)n(or)g(is)g(r)n(eported)f(when)g(a)j(syntax)d
(err)n(or)h(is)h(found)e(in)i(a)g(host)f(access)g(contr)n(ol)h(r)o
(ule;)63 5055 y(when)19 b(the)h(length)f(of)h(an)h(access)f(contr)n(ol)
g(r)o(ule)h(exceeds)d(the)h(capacity)j(of)e(an)h(internal)f(buf)n(fer;)
63 5168 y(when)31 b(an)i(access)f(contr)n(ol)g(r)o(ule)g(is)g(not)g
(terminated)f(by)h(a)h(newline)f(character;)37 b(when)31
b(the)63 5281 y(r)n(esult)i(of)h(expansion)e(would)h(over\003ow)h(an)g
(internal)g(buf)n(fer;)39 b(when)33 b(a)i(system)d(call)j(fails)63
5394 y(that)22 b(shouldn)575 5382 y(\264)575 5394 y(t.)k(All)e(pr)n
(oblems)e(ar)n(e)h(r)n(eported)e(via)j(the)d(syslog)g(daemon.)p
eop
%%Page: 146 154
146 153 bop 221 282 a Fs(146)1719 b Fg(APPENDIX)21 b(A.)45
b(HOSTS_ACCESS\(5\))221 539 y Fk(FILES)221 715 y Ff(/etc/hosts.allo)o
(w)p Fs(,)16 b(\(daemon,client\))23 b(pairs)g(that)f(ar)n(e)h(granted)e
(access.)221 828 y Ff(/etc/hosts.deny)o Fs(,)c(\(daemon,client\))23
b(pairs)f(that)h(ar)n(e)g(denied)e(access.)221 1083 y
Fk(SEE)k(ALSO)221 1260 y Fs(tcpd\(8\))e(tcp/ip)g(daemon)f(wrapper)f(pr)
n(ogram.)221 1373 y(tcpdchk\(8\),)i(tcpdmatch\(8\),)g(test)e(pr)n
(ograms.)221 1628 y Fk(BUGS)221 1805 y Fs(If)g(a)h(name)f(server)f
(lookup)g(times)g(out,)g(the)g(host)g(name)h(will)i(not)d(be)h
(available)j(to)c(the)g(access)221 1918 y(contr)n(ol)j(softwar)n(e,)e
(even)i(though)e(the)g(host)h(is)h(r)n(egister)n(ed.)362
2030 y(Domain)h(name)g(server)d(lookups)h(ar)n(e)h(case)g(insensitive;)
f(NIS)g(\(formerly)h(YP\))g(netgr)n(oup)221 2143 y(lookups)e(ar)n(e)i
(case)g(sensitive.)221 2398 y Fk(AUTHOR)221 2575 y Fs(W)-5
b(ietse)22 b(V)-10 b(enema)22 b(\(wietse@wzv)-10 b(.win.tue.nl\))221
2688 y(Department)22 b(of)g(Mathematics)h(and)g(Computing)f(Science)221
2801 y(Eindhoven)g(University)g(of)g(T)-8 b(echnology)221
2914 y(Den)23 b(Dolech)g(2,)g(P)-12 b(.O.)22 b(Box)g(513,)221
3027 y(5600)j(MB)d(Eindhoven,)f(The)h(Netherlands)p eop
%%Page: 147 155
147 154 bop 63 1203 a Fo(Bibliography)63 1662 y Fs([BLFIM98])45
b(T)-7 b(.)28 b(Berners-Lee,)e(R.)h(Fielding,)i(U.C.)e(Irvine,)i(and)f
(L.)g(Masinter)-7 b(.)49 b Fr(Uniform)28 b(Re-)538 1775
y(sour)n(ce)c(Identi\002ers)h(\(URI\):)e(Generic)g(Syntax)p
Fs(.)33 b(RFC)22 b(2396,)j(August)20 b(1998.)63 1962
y([HV99])183 b(Michi)21 b(Henning)f(and)g(Steve)f(V)-5
b(inoski.)27 b Fr(Advanced)21 b(CORBA)e(Pr)n(ogramming)j(with)538
2075 y(C++)p Fs(.)32 b(Addison-W)-8 b(esley)20 b(pr)n(ofessional)i
(computing)g(series,)f(1999.)63 2263 y([OMG96])99 b(Object)27
b(Management)f(Gr)n(oup.)44 b Fr(The)27 b(Common)f(Object)i(Request)f
(Br)n(oker:)37 b(Ar)n(chi-)538 2376 y(tectur)n(e)e(and)g
(Speci\002cation)p Fs(,)j(2.0)c(edition,)i(1996.)71 b(Fr)n(om)33
b Ff(http://cgi.omg.)538 2489 y(org/corba/cich)o(pte)o(r.)o(ht)o(ml)o
Fs(.)63 2676 y([OMG98])99 b(Object)32 b(Management)f(Gr)n(oup.)60
b Fr(CORBAServices:)45 b(Common)31 b(Object)h(Services)538
2789 y(Speci\002cation)p Fs(,)24 b(December)e(1998.)63
2977 y([OMG99])99 b(Object)36 b(Management)g(Gr)n(oup.)75
b Fr(The)36 b(Common)f(Object)i(Request)g(Br)n(oker:)56
b(Ar-)538 3090 y(chitectur)n(e)37 b(and)f(Speci\002cation)p
Fs(,)k(2.3.1)c(edition,)i(October)d(1999.)75 b(Fr)n(om)35
b Ff(http:)538 3203 y(//cgi.omg.org/)o(cor)o(ba)o(/c)o(ic)o(hp)o(ter)o
(.h)o(tm)o(l)p Fs(.)63 3390 y([OMG00])99 b(Object)31
b(Management)e(Gr)n(oup.)57 b Fr(Inter)n(operable)34
b(Naming)d(Service)h(r)n(evised)h(chap-)538 3503 y(ters)p
Fs(,)51 b(August)42 b(2000.)104 b(Fr)n(om)44 b Ff(http://cgi.omg.o)o
(rg)o(/c)o(gi)o(-)t(bi)o(n/)o(do)o(c?)538 3616 y(ptc/00-)t(08-)t(07)p
Fs(.)63 3804 y([Ric96a])153 b(T)-8 b(ristan)33 b(Richar)n(dson.)69
b Fr(The)35 b(OMNI)f(Development)i(Envir)n(onment)e(V)-8
b(ersion)35 b(4.0)p Fs(.)538 3917 y(A)-7 b(T&T)22 b(Laboratories)f
(Cambridge,)i(November)f(1996.)63 4104 y([Ric96b])148
b(T)-8 b(ristan)24 b(Richar)n(dson.)38 b Fr(The)25 b(OMNI)f(Thr)n(ead)j
(Abstraction)p Fs(.)40 b(A)-7 b(T&T)23 b(Laboratories)538
4217 y(Cambridge,)g(October)f(1996.)1639 5622 y(147)p
eop
%%Trailer
end
userdict /end-hook known{end-hook}if
%%EOF
