
Fri Nov 14 17:29:16 GMT 1997 tjr
================================

mk/platforms/alpha_osf1_3.2.mk	- add -O when compiling C programs
mk/platforms/alpha_osf1_4.0.mk	- add -O when compiling C programs


Fri Oct 31 17:24:36 GMT 1997 tjr
================================

mk/platforms/alpha_linux_2.0	- remove incorrect path from gcc and g++


Tue Oct 28 16:18:59 GMT 1997 tjr
================================

mk/win32.mk	- add SOCKET_LIB


Sat Sep 20 20:26:00 BST 1997 dpg1
=================================

Added LifeCycle support.

Modified _widenFromTheMostDerivedIntf() to take a second argument,
is_cxx_type. If this is true, the repoID string represents a C++ class
name rather than a repository ID. This is required by the LifeCycle
stuff.

include/omniORB2/omniInternal.h		- change to _widen...; declare
					  a new hash table of wrapped
					  objects.
include/omniORB2/Naming_NT.hh		- change to _widen...
include/omniORB2/omniLifeCycle.h	- new
include/omniORB2/reDirect.h		- new

src/tool/omniidl2/include/idl_defines.h	- new compiler flag
src/tool/omniidl2/omniORB2_be/o2be.h	- new name and produce functions

src/tool/omniidl2/omniORB2_be/o2be_attribute.cc
					- new LifeCycle code generation

src/tool/omniidl2/omniORB2_be/o2be_cfe_interface.cc
					- new -l compile flag

src/tool/omniidl2/omniORB2_be/o2be_interface.cc
					- change to _widen...; new
					  LifeCycle code generation

src/tool/omniidl2/omniORB2_be/o2be_operation.cc
					- new LifeCycle code generation

src/tool/omniidl2/omniORB2_be/o2be_root.cc
					- new #include generation

src/lib/omniORB2/dir.mk			- new omniLC library
src/lib/omniORB2/NamingSK_NT.cc		- change to _widen...
src/lib/omniORB2/objectRef.cc		- change to _widen...;
					  initialise new LifeCycle
					  hash table
src/lib/omniORB2/omniLifeCycle.cc	- new file
src/lib/omniORB2/omniLifeCycle.idl	- new file
src/lib/omniORB2/reDirect.cc		- new file
src/lib/omniORB2/unshared.cc		- LifeCycle hash table
src/lib/omniORB2/sharedlib/dir.mk	- version 2.3.1; new omniLC library

mk/unix.mk				- new variables for LifeCycle stuff
mk/win32.mk				- new variables for LifeCycle stuff

src/examples/lifecycle			- new directory
src/examples/lifecycle/client.cc	- new
src/examples/lifecycle/dir.mk		- new
src/examples/lifecycle/echolag.idl	- new
src/examples/lifecycle/remove.cc	- new
src/examples/lifecycle/server.cc	- new
src/examples/dir.mk			- add lifecycle to SUBDIRS




Wed Aug 27 18:55:28 BST 1997 sll
================================

- More (final!) fix for typedef Object X // IDL

src/tool/omniidl2/omniORB2_be/o2be_interface.cc
src/tool/omniidl2/omniORB2_be/o2be_typedef.cc


Wed Aug 27 11:24:10 BST 1997 sll
================================

- The definition file for NT omniORB2 DLL export symbols are now generated 
  automatically.
- Fixes for the bugs listed below:

------------------------

On unix, an omniORB server exits when the number of open filedescriptors
reaches the soft limit, normally 64.

Fixed so that the server does not exit. The limit needs to be increased with
your shell, for example 'limit descriptors 1024'


Reported by: Bernhard Ruememapp

------------------------

Deadlock occurs when the destructor of an object implementation class calls
CORBA::_release(CORBA::Object_ptr).

Reported by: Matthew Newhook, Duncan Grisby
----------------------

Calling _sk_<interface>::_dispose() when the object's reference count == 1
corrupts the internal object table.

Reported by: Matthew Newhook, Duncan Grisby

-----------------------

IDL union bug, the stub generated for the IDL below does not compile:

union U switch(long)
{
case 1: double d;
case 2: long e;
default: short s;
};


Reported internally

------------------------------

New system exceptions

TRANSACTION_REQUIRED
TRANSACTION_ROLLEDBACK
INVALID_TRANSACTION
WRONG_TRANSACTION


Reported by Mark Little

-------------------------------

Memory leaks

Reported by Mathew Barrow, Matthew Newhook

-------------------------------

CORBA::String_member copy ctor tests _ptr before initialising it.

Reported by Mathew Barrow, Matthew Newhook

----------------------------------

omniNames:

In the case when BindingIterator::next_one() returns false, the value of
binding_type in the out argument is not initialised. This causes
marshalling failures on the remote end sometimes (the value is neither nobject
or ncontext).

Reported by Matthew Newhook

-------------------------------

User exceptions:

The stub code to unmarshal user exception allocates the wrong size buffer
for the repository ID string. This causes marshalling failures when the
exception has a #pragma prefix defined.

Reported by Matthew Newhook, Mathew Barrow and Juergen Keil

----------------------------

Interface Inheritance:

// IDL	
  interface person
  {
    attribute string ID;
  };

  interface kid: person
  {
    attribute person mom;
  };

  interface mother: person
  {
    attribute person child;
  };

// C++

  kid_ptr    k = ...;                  // k is a remote object
  person_ptr a = k->mom();             // k actually returns an object ref
                                       // of interface mother
  mother_ptr m = mother::_narrow(a);
  assert(CORBA::is_nil(m) != 0);      // Bug: assertion failed.


This bug is fixed but requires both sides to have the stub of all the
interfaces linked into the executable. The next release will remove this
restriction.

Reported by  Ernie van der Meer

-----------------------------------

Wrong typedef for CORBA::ORBid
Wrong signature for CORBA::ORB_init()

Reported by Mark Little

-------------------------------

Port to run under x86 linux, glib 2.0.4, gcc2.7.2.2

Reported by Marcel Ruff

-------------------------------

Sequence of array does not work

// IDL
   typedef float rc[3];
   typedef sequence<rc> rcSeq;

    interface Ri {
      void Dummy(in rcSeq colors);
    };

Reported by John Connett

------------------------------

Wrong stub for

// IDL
typedef Object O;

Reported by Wolfgang Ruppel
----------------------------

Port to AIX 4.2

Reported by Andrey Slepuhin


XXX - miss out the patch to log.cc, await reply from AS
--------------------------

omniidl2 does not detect name clashes between identifiers that
differ in case only.

    // Extract from OTS IDL
    typedef ... Coordinator;
    typedef ... Terminator;
    struct TransIdentity
    {
        Coordinator coordinator;
        Terminator terminator;
        otid_t otid;
    };

  IDL compiler should report name clashes between Coordinator-coordinator and
  Terminator-terminator.

Reported by Mark Little
-----------------------------------------

catior SEGV when supplied with a stringified IOR with a few digits missing

Reported internally

------------------------------------------

Using 'c' as the name of an OUT/INOUT variable length argument in an
operation clashes with an internal variable used by the proxy stub code.

Reported internally

--------------------------------------------


src/tool/omniidl2/include/utl_identifier.hh
src/tool/omniidl2/include/utl_scope.hh
src/tool/omniidl2/ast/ast_enum.cc
src/tool/omniidl2/ast/ast_exception.cc
src/tool/omniidl2/ast/ast_interface.cc
src/tool/omniidl2/ast/ast_module.cc
src/tool/omniidl2/ast/ast_operation.cc
src/tool/omniidl2/ast/ast_structure.cc
src/tool/omniidl2/ast/ast_union.cc
src/tool/omniidl2/driver/drv_fork.cc
src/tool/omniidl2/driver/drv_preproc.cc
src/tool/omniidl2/omniORB2_be/o2be_attribute.cc
src/tool/omniidl2/omniORB2_be/o2be_interface.cc
src/tool/omniidl2/omniORB2_be/o2be_name.cc
src/tool/omniidl2/omniORB2_be/o2be_operation.cc
src/tool/omniidl2/omniORB2_be/o2be_union.cc
src/tool/omniidl2/omniORB2_be/o2be_sequence.cc
src/tool/omniidl2/util/utl_identifier.cc
src/tool/omniidl2/util/utl_scope.cc

src/lib/omniORB2/dir.mk
src/lib/omniORB2/objectRef.cc
src/lib/omniORB2/constants.cc
src/lib/omniORB2/giopServer.cc
src/lib/omniORB2/giopClient.cc
src/lib/omniORB2/orb.cc
src/lib/omniORB2/object.cc
src/lib/omniORB2/tcpSocket_UNIX.cc
src/lib/omniORB2/tcpSocket_ATMos.cc
src/lib/omniORB2/tcpSocket_NT.cc
src/lib/omniORB2/exception.cc
src/lib/omniORB2/initFile.cc
src/lib/omniORB2/ior.cc
src/lib/omniORB2/libcWrapper.cc
src/lib/omnithread/posix.cc
src/lib/omniORB2/sharedlib/dir.mk
src/lib/omniORB2/sharedlib/omniORB2.def              deleted

src/appl/omniNames/BindingIterator_i.h
src/appl/utils/nameclt/nameclt.cc

src/examples/echo/greeting.cc

include/omniORB2/CORBA.h
include/omniORB2/giopDriver.h
include/omniORB2/IIOP.h
include/omniORB2/CORBA_basetypes.h
include/omniORB2/seqtemplates.h
include/omniORB2/CORBA_sysdep.h
include/omniORB2/bufferedStream.h
include/omniORB2/templates.h
include/omniORB2/initFile.h                 moved to src/lib/omniORB2
include/omnithread.h


Mon Aug 18 15:18:00 BST 1997 tjr
================================

Add dependency analysis to CORBA stubs

mk/afterdir.mk		- new rule for compiling stubs - cd into the stub
			  directory and use omake so that .d files are used.
mk/beforedir.mk		- add new stub files to CORBA_STUB_FILES
mk/unix.mk		- remove CompileCorbaStubRule
mk/win32.mk		- remove CompileCorbaStubRule
mk/atmos.mk		- remove CompileCorbaStubRule


Wed Aug 13 10:23:55 BST 1997 sll
================================

Fixed problem with omniidl2 generates the wrong stub for user exceptions.

src/tool/omniidl2/omniORB2_be/o2be_exception.cc
src/lib/omniORB2/sharedlib/dir.mk                 - version number is 2.2.1


Fr Aug  8 10:36:36 BST 1997 sll
================================

Fixed problem with not passing the repository ID of the most derived type
in an IOR.

src/lib/omniORB2/objectRef.cc

Wed Jul 30 15:47:49 BST 1997 tjr
================================

src/tool/win32/clwrapper.c	- fix for >9 mounts
src/tool/win32/libwrapper.c	- fix for >9 mounts
src/tool/win32/linkwrapper.c	- fix for >9 mounts
src/tool/omkdepend/gnuwin32.c	- fix for >9 mounts


Wed Jul 30 13:52:15 BST 1997 tjr
================================

src/tool/win32/clwrapper.c	- fix to use b18 mounts
src/tool/win32/libwrapper.c	- fix to use b18 mounts
src/tool/win32/linkwrapper.c	- fix to use b18 mounts
src/tool/omkdepend/gnuwin32.c	- fix to use b18 mounts


Thu Jul 24 18:06:29 BST 1997 tjr
================================

src/appl/omniNames/log.cc	- change #if to fix bug in sparcworks C++,
				  not solaris


Mon Jul 21 18:07:50 BST 1997 tjr
================================

include/omniORB2/CORBA_sysdep.h - use new OS / processor defines


Mon Jul 21 17:14:09 BST 1997 tjr
================================

Fix all dir.mk to use new platform make variables

src/dir.mk
src/tool/dir.mk
src/tool/nt			- moved to win32
src/tool/win32			- moved from nt
src/tool/win32/dir.mk
src/tool/omkdepend/dir.mk
src/tool/omniidl2/dir.mk
src/tool/omniidl2/ast/dir.mk
src/tool/omniidl2/driver/dir.mk
src/tool/omniidl2/fe/dir.mk
src/tool/omniidl2/narrow/dir.mk
src/tool/omniidl2/util/dir.mk
src/tool/omniidl2/omniORB2_be/dir.mk
src/lib/dir.mk
src/lib/omnithread/dir.mk
src/lib/omnithread/sharedlib/dir.mk - use same technique as omniORB2 sharedlib
				      dir.mk
src/lib/omniORB2/dir.mk
src/lib/omniORB2/sharedlib/dir.mk
src/appl/dir.mk
src/appl/omniNames/dir.mk
src/appl/utils/dir.mk
src/examples/dir.mk


Mon Jul 21 15:14:26 BST 1997 tjr
=================================

new method for doing dependencies + new make vars for determining platform

mk/afterdir/mk
mk/unix.mk
mk/atmos.mk
mk/nt.mk			- removed
mk/win32.mk			- new file
mk/platforms/x86_nt_3.5.mk	- use win32.mk not nt.mk
mk/platforms/sun4_sosV_5.5.mk
mk/platforms/i586_linux_2.0.mk
mk/platforms/alpha_osf1_3.2.mk
mk/platforms/alpha_linux_2.0.mk

src/tool/omkdepend		- moved from src/tool/nt/omkdepend
src/tool/omkdepend/dir.mk	- enable use on unix platforms
src/tool/omkdepend/ifparser.c	- simpler parsing of #if expressions
src/tool/omkdepend/include.c	- enable use on unix platforms
src/tool/omkdepend/main.c	- Change the output so that processing xxx.c
				  or xxx.cc produces xxx.d. Also remove
				  unnecessary code.
src/tool/omkdepend/pr.c		- enable use on unix platforms
src/tool/dir.mk			- add omkdepend
src/tool/nt/dir.mk		- remove omkdepend


Mon Jul 21 14:40:26 BST 1997 tjr
================================

Version 5.2 tree copied from version5.1 tree.
